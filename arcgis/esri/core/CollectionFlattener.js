// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.1/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Collection ./HandleRegistry".split(" "),function(l,m,h,d,c,f,k){return function(g){function a(a){g.call(this);this._handles=new k;this.root=null;this.refresh=this.refresh.bind(this);this.updateCollections=this.updateCollections.bind(this)}h(a,g);a.prototype.initialize=function(){this._handles.add(this.rootCollectionNames.map(function(a){return this.watch("root."+a,this.updateCollections,
!0)},this));this.updateCollections()};a.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null};a.prototype.updateCollections=function(){var a=this;this._collections=this.rootCollectionNames.map(function(e){return a.get("root."+e)}).filter(function(a){return null!=a});this.refresh()};a.prototype.refresh=function(){var a=this._handles;a.remove("collections");this.removeAll();for(var e=this._collections.slice(),b=0,c=this._collections;b<c.length;b++)this._processCollection(e,
this,c[b]);for(b=0;b<e.length;b++)a.add(e[b].on("after-changes",this.refresh),"collections")};a.prototype._createNewInstance=function(a){return new f(a)};a.prototype._processCollection=function(a,c,b){var d=this;b&&(a.push(b),b.forEach(function(b){b&&(c.push(b),d._processCollection(a,c,d.getChildrenFunction(b)))}))};d([c.property()],a.prototype,"rootCollectionNames",void 0);d([c.property()],a.prototype,"root",void 0);d([c.property()],a.prototype,"getChildrenFunction",void 0);return a=d([c.subclass("esri.core.CollectionFlattener")],
a)}(c.declared(f))});