// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.1/esri/copyright.txt for details.
//>>built
require({cache:{"esri/geometry/ScreenPoint":function(){define(["./Point"],function(h){return h.createSubclass({declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/views/Vue":function(){define("dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-class ../Graphic ../core/Accessoire ../core/Collection ../core/CollectionFlattener ../core/Evented ../core/HandleRegistry ../core/AccessoirePromise ../core/watchUtils ../core/promiseUtils ../core/Scheduler ../geometry/SpatialReference ../geometry/Extent ./BreakpointsOwnoire ./DOMContainoire ./LayerViewManager ./BasemapView ./GroundView ./PopupManager ./ui/DefaultUI ./support/DefaultsFromMap ../widgets/Popup".split(" "),
function(h,l,c,f,b,a,e,k,g,m,n,d,q,y,p,u,s,w,r,t,z,x,v,P,L){return a.createSubclass([n,w,g,s],{declaredClass:"esri.views.View",classMetadata:{properties:{allLayerViews:{},basemapView:{},container:{},animation:{},resizing:{},interacting:{},graphics:{type:e.ofType(b)},groundView:{},initialExtent:{readOnly:!0,type:u,dependsOn:["defaultsFromMap.extent"]},initialExtentRequired:{},layerViews:{type:e},map:{},popup:{type:L},ready:{readOnly:!0,dependsOn:"map spatialReference surface width height suspended initialExtentRequired initialExtent defaultsFromMap.isDone map.loaded".split(" ")},
root:{},spatialReference:{type:p,dependsOn:["defaultsFromMap.spatialReference"]},stationary:{dependsOn:["animation","interacting","resizing"]},surface:{},type:{},ui:{type:v},updating:{},width:{},height:{},suspended:{}}},constructor:function(a){this._viewHandles=new m;this._viewHandles.add(this.watch("ready",function(a,g){this._currentSpatialReference=a?this.spatialReference:null;this.notifyChange("spatialReference");!a&&g&&this.layerViewManager.empty()}.bind(this)));this.defaultsFromMap=new P({view:this});
this.allLayerViews=new k({root:this,rootCollectionNames:["basemapView.baseLayerViews","groundView.layerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:function(a){return a.layerViews}})},getDefaults:function(){return h.mixin(this.inherited(arguments),{layerViews:[],graphics:[],padding:{left:0,top:0,right:0,bottom:0},popup:{},ui:{}})},initialize:function(){var a=this.validate().then(function(){this._isValid=!0;this.notifyChange("ready");return d.whenOnce(this,"ready")}.bind(this));
this.addResolvingPromise(a);this.basemapView=new t({view:this});this.groundView=new z({view:this});this.layerViewManager=new r({view:this});this._resetInitialViewPropertiesFromContent()},destroy:function(){this.basemapView.destroy();this.groundView.destroy();this.destroyLayerViews();this.ui.destroy();this.popup&&this.popup.destroy();this.defaultsFromMap.destroy();this.defaultsFromMap=null;this._viewHandles.destroy();this.container=this.map=null},destroyLayerViews:function(){this.layerViewManager.destroy()},
_viewHandles:null,_isValid:!1,_readyCycleForced:!1,_userSpatialReference:null,_currentSpatialReference:null,activeTool:"navigation",animation:null,basemapView:null,groundView:null,container:null,_containerSetter:function(a,g){a=l.byId(a);if(g===a)return g;g&&(f.remove(g,"esri-view"),this.popupManager.destroy(),this.popupManager=null,c.destroy(this.root),this.root=null);a?(f.add(a,"esri-view"),this.root=c.create("div",{className:"esri-view-root"},a,"first"),this.surface=c.create("div",{className:"esri-view-surface"},
this.root),l.setSelectable(this.surface,!1),this._forceReadyCycle(),this.popupManager=new x({enabled:!0,view:this})):this.surface=null;return a},graphics:null,_graphicsSetter:function(a){this._graphicsView&&(this._graphicsView.graphics=a);return a},interacting:!1,_interactingSetter:function(a){var g=this.surface;g&&g.setAttribute("data-interacting",a);return a},layerViews:null,map:null,_mapSetter:function(a,g){if(a===g)return a;a&&a.load&&a.load();this._forceReadyCycle();this._resetInitialViewPropertiesFromContent();
return a},padding:null,_popupSetter:function(a,g){if(a===g)return g;this._viewHandles.remove("view-popup");g&&g.destroy();a&&(a.viewModel.view=this,a._started||a.startup(),this._viewHandles.add([d.init(this,"root",function(g,d){var b=a.domNode;l.isDescendant(b.parentNode,d)&&b.parentNode.removeChild(b);g&&!b.parentNode&&a.placeAt(g)})],"view-popup"));return a},_readyGetter:function(a){return!(!this._isValid||this._readyCycleForced||!this.map||!(null!=this.surface&&0!==this.width&&0!==this.height&&
this.spatialReference&&(!this.map.load||this.map.loaded)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isDone)&&this.isSpatialReferenceSupported(this.spatialReference)))},spatialReference:null,_spatialReferenceGetter:function(){return this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null},_spatialReferenceSetter:function(a){return this._userSpatialReference=a},stationary:!0,
_stationaryGetter:function(){return!this.animation&&!this.interacting&&!this.resizing},surface:null,type:null,_uiSetter:function(a,g){if(a===g)return g;this._viewHandles.remove("ui");g&&g.destroy();a&&(a.view=this,this._viewHandles.add([d.init(this,"root",function(g){a.container=g?c.create("div",null,g):null})],"ui"));return a},updating:!1,initialExtentRequired:!0,initialExtent:null,_initialExtentGetter:function(){return this.defaultsFromMap&&this.defaultsFromMap.extent},whenLayerView:function(a){return this.layerViewManager.whenLayerView(a)},
addHandler:function(a){this.gestureManager&&this.gestureManager.addHandler(a);return this},removeHandler:function(a){this.gestureManager&&this.gestureManager.removeHandler(a);return this},pageToContent:function(a,g,d){var b=this.padding;d=this.pageToContainer(a,g,d);b&&(d[0]-=b.left,d[1]-=b.top);return d},getDefaultSpatialReference:function(){return this.get("defaultsFromMap.spatialReference")},validate:function(){return q.resolve()},isSpatialReferenceSupported:function(){return!0},_resetInitialViewPropertiesFromContent:function(){if(this.defaultsFromMap){var a=
this.defaultsFromMap.start.bind(this.defaultsFromMap);this.defaultsFromMap.reset();this._currentSpatialReference=null;this.notifyChange("spatialReference");this._viewHandles.remove("defaultsFromMap");this._viewHandles.add([d.watch(this,"spatialReference",a),d.watch(this,"initialExtentRequired",a),y.schedule(a)],"defaultsFromMap")}},_forceReadyCycle:function(){this.ready&&(this._readyCycleForced=!0,this.notifyChange("ready"),d.whenFalseOnce(this,"ready",function(){this._readyCycleForced=!1;this.notifyChange("ready")}.bind(this)))}})})},
"esri/views/BreakpointsOwnoire":function(){define("../core/Accessoire ../core/ArrayPool ../core/HandleRegistry ../core/watchUtils dojo/_base/lang dojo/dom-class".split(" "),function(h,l,c,f,b,a){var e={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var e=this.values;return b<=a.xsmall?e.xsmall:b<=a.small?e.small:b<=a.medium?e.medium:b<=a.large?e.large:e.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",
small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",
xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(a){var b=a.viewSize[1];a=a.breakpoints;var e=this.values;return b<=a.xsmall?e.xsmall:b<=a.small?e.small:b<=a.medium?e.medium:b<=a.large?e.large:e.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",
small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",
xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(a){a=a.viewSize;var b=this.values;return a[1]>=a[0]?b.portrait:b.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},k={xsmall:544,small:768,medium:992,large:1200};return h.createSubclass({classMetadata:{properties:{breakpoints:{},
orientation:{},widthBreakpoint:{},heightBreakpoint:{}}},constructor:function(){this._handles=new c},getDefaults:function(){return b.mixin(this.inherited(arguments),{breakpoints:k})},initialize:function(){this._handles.add(f.init(this,"size",this._updateClassNames))},destroy:function(){this._removeActiveClassNames();this._handles.destroy();this.view=this._handles=null},_breakpointsSetter:function(a,e){if(a===e)return a;var c;c=(c=a)&&c.xsmall<c.small&&c.small<c.medium&&c.medium<c.large;var d;c||(d=
JSON.stringify(k,null,2),console.warn("provided breakpoints are not valid, using defaults:"+d));a=c?a:k;return b.mixin({},a)},_updateClassNames:function(){if(this.container){var a=l.acquire(),b=l.acquire(),k=!1,d,c,f;for(d in e)c=this[d],f=e[d].getValue({viewSize:this.size,breakpoints:this.breakpoints}),c!==f&&(k=!0,this[d]=f,b.push(e[d].valueToClassName[c]),a.push(e[d].valueToClassName[f]));k&&(this._applyClassNameChanges(a,b),l.release(a),l.release(b))}},_applyClassNameChanges:function(g,b){var e=
this.container;e&&(a.remove(e,b),a.add(e,g))},_removeActiveClassNames:function(){var g=this.container,b;if(g)for(b in e)a.remove(g,e[b].valueToClassName[this[b]])}})})},"esri/views/DOMContainoire":function(){define(["dojo/on","../core/Accessoire","../core/Scheduler","../core/watchUtils"],function(h,l,c,f){var b=[0,0];return l.createSubclass({declaredClass:"esri.views.DOMContainer",classMetadata:{properties:{container:{},height:{},position:{},resizing:{},size:{dependsOn:["width","height"],readOnly:!0},
suspended:{},width:{}}},constructor:function(){Object.defineProperty(this,"_measureInfo",{enumerable:!1,writable:!1,value:{task:null,freq:16,time:750}})},initialize:function(){var a=this._measureInfo,b=null;f.init(this,"container",function(k,g,m,f){b&&(b.remove(),b=null,a.freq=16,a.time=750);a.task&&(a.task.remove(),a.task=null);k?(b=h(window,"resize",function(){a.freq=16;a.time=750}.bind(f)),a.task=c.addFrameTask({prepare:function(a){var b=this._measureInfo;b.time+=a.deltaTime;b.time<b.freq||(b.time=
0,this._measure()?(b.freq=16,this.resizing=!0):(b.freq=Math.min(750,2*b.freq),512<=b.freq&&(this.resizing=!1)))}.bind(f)})):this.resizing=!1;this._measure();k=this.root;g=this.surface;m=this.width;f=this.height;k&&(g&&m&&f)&&(k.style.width=g.style.width=m+"px",k.style.height=g.style.height=f+"px")})},destroy:function(){this.container=null},_measureInfo:null,size:null,_sizeGetter:function(a,b){b||(b=[0,0]);b[0]=this.width;b[1]=this.height;return b},position:null,height:0,resizing:!1,suspended:!0,width:0,
pageToContainer:function(a,b,k){var g=this.position;a-=g[0];b-=g[1];k?(k[0]=a,k[1]=b):k=[a,b];return k},containerToPage:function(a,b,k){var g=this.position;a+=g[0];b+=g[1];k?(k[0]=a,k[1]=b):k=[a,b];return k},_measure:function(){var a=this.container,e=a?a.clientWidth:0,k=a?a.clientHeight:0;if(0===e||0===k||"hidden"===window.getComputedStyle(a).visibility)return this.suspended=!0,!1;var g=this.root,c=this.surface,f=this.width,d=this.height,q=this.position;if(e===f&&k===d)return this.suspended=!1;g&&
c&&(g.style.width=c.style.width=e+"px",g.style.height=c.style.height=k+"px");this.width=e;this.height=k;this.suspended=!1;g=a.ownerDocument||window.document;g=g.parentWindow||g.defaultView;a=a.getBoundingClientRect();b[0]=a.left+g.pageXOffset;b[1]=a.top+g.pageYOffset;if(!q||b[0]!==q[0]||b[1]!==q[1])this.position=b.slice();this.emit("resize",{oldWidth:f,oldHeight:d,width:e,height:k});return!0}})})},"esri/views/inputs/GestureManager":function(){define(["../../core/declare","../../core/Accessoire","./HandlerList",
"./HammerInput"],function(h,l,c,f){return h([l],{constructor:function(b){(b=b.surface||this.surface)?(this.inputManager=new f(b),this.handlers=new c({gestureManager:this})):console.error("GestureManager requires a surface dom element to work.")},view:null,surface:null,trackHover:!1,handlers:null,_handlersSetter:function(b,a){null==b?b=new c({gestureManager:this}):b.gestureManager=this;this._removeListeners(a);this._addListeners(b,b);return b},_inputManager:null,on:function(b,a){var e=this.inputManager;
return e&&e.on(b,a)},addGesture:function(b){var a=this.inputManager;if("input"===(b&&b.event))console.log("'input' is not a configurable gesture. listen to 'input' event with the 'on' function");else return(b=a.addGesture(b))?this:b},addHandler:function(b){this.handlers||(this.handlers=new c);this.handlers.add(b);this._addListeners(this.handlers,b);return this},removeHandler:function(b){if(this.handlers){this._removeListeners(this.handlers);this.handlers.remove(b);for(b=this.handlers.first;b;)this._addListeners(this.handlers,
b),b=this.handlers.next()}return this},removeGesture:function(b){return this.inputManager.removeGesture(b)},configureGesture:function(b,a){return this.inputManager.configureGesture(b,a)},_addListeners:function(b,a){var e=a.events,k=b.removers||[],g=this;e&&(e=e.map(function(a){return g.on(a,b.processEvent.bind(b))}),b.removers=k.concat(e))},_removeListeners:function(b){(b=b&&b.removers)&&b.forEach(function(a){a&&a.remove()})}})})},"esri/views/inputs/HandlerList":function(){define(["../../core/LinkedList",
"../../core/declare"],function(h,l){return l([h],{classMetadata:{properties:{view:{dependsOn:["gestureManager.view"]}}},constructor:function(){this.on("add, remove",this._collectEvents.bind(this))},removers:null,_gestureManager:null,_gestureManagerSetter:function(c){this._addCustomGestures();return c},_gestures:null,_eventsGetter:function(){return this._gestures},_customGestures:null,_customGesturesSetter:function(c){this._addCustomGestures();return c},_viewGetter:function(){return this.get("gestureManager.view")},
_gestureConfig:null,_phaseDict:{1:"start",2:"move",4:"end",8:"cancel",START:1,MOVE:2,END:4,CANCEL:8},processEvent:function(c){var f=c&&(c.type||c.name||c.eventType);c.lastEvent=this._lastEvt;"hammer.input"===f&&(f="input");var b=this.first,a=!0;if(!c.screenPoint){var e=this.view.pageToContainer(c.center.x,c.center.y);c.screenPoint={x:e[0],y:e[1]}}for(;b;){if(e=b[f])b=e.call(b,c),a=!1!==b&&!0!==c.canceled;b=a&&this.next()}this._lastEvt=c.eventType<this._phaseDict.END&&"scroll"!==f?c:null;a&&this.view.emit(f,
c)},_collectEvents:function(){var c=this.first,f=[];for(this._gestureConfig=this._collectCustoms();c;)f=f.concat(c.get("events")),c=this.next();return this._gestures=f},_collectCustoms:function(){for(var c=this.first,f=null;c;){if(c=c.customGestures)if(f)for(var b=Object.keys(c),a=b.length-1;0<=a;a--){var e=b[a];f[e]||(f[e]=c[e])}else f=c;c=this.next()}if(null!=f&&this.gestureManager){this._gestureConfig=f;var k=this.gestureManager;f.forEach(function(a){k.addGesture(a)})}return f},_addCustomGestures:function(){if(this._gestureManager&&
this._customGestures){var c=this._gestureManager;this.customGestures.forEach(function(f){c.addGesture(f)})}}})})},"esri/core/LinkedList":function(){define(["./declare","../core/Accessoire","../core/Evented"],function(h,l,c){return h([l,c],{next:function(){var c=this.item||this.first;return this.item=c&&c.next?c.next:null},add:function(c){if(!c)return!1;0===this.count?this.last=c:c.next=this.first;this.item=this.first=c;this.count++;this.emit("add",c);return this},remove:function(c){!c&&null!=this.item&&
(c=this.item);for(var b=this.first,a=null;b!=c&&b.next;)a=this.item,b=this.next();b==c&&(b.next?a?a.next=b.next:this.first=b.next:(a.next=null,this.last=a),this.item=this.first,this.emit("remove",c));return this},reset:function(){this.item=this.first},empty:function(c){this.reset();for(var b=this.item,a=b.next;null!=b;)b.next=null,c&&(b.destroy&&"function"==typeof b.destroy)&&b.destroy(),b=this.item=a,a=this.next();this.last=this.first=null;return this},first:null,last:null,count:0})})},"esri/views/inputs/HammerInput":function(){define(["../../core/hammerExtended",
"../../core/declare","dojo/aspect"],function(h,l,c){var f={drag:{event:"drag",action:"pan",button:0},click:{event:"click",action:"tap",threshold:5,posThreshold:20,interval:185,exclusiveTo:["double-click"]},"right-click":{event:"right-click",action:"tap",button:2},altdrag:{event:"altdrag",action:"pan",button:2,exclusiveTo:["drag"]},pinch:{threshold:0.01,firesWith:["drag","rotation"]},rotation:{threshold:5,firesWith:["drag","pinch"]},hold:{time:350},swipe:{firesWith:["drag"]},scroll:!0,"double-click":{event:"double-click",
action:"tap",taps:2,threshold:30,posThreshold:30,firesWith:["click"]}},b=/\s*,\s*/g;return l(null,{gestures:null,manager:null,constructor:function(a){var b=function(a){a.preventDefault()};a.addEventListener("selectstart",b,!1);a.addEventListener("dragstart",b,!1);a.addEventListener("contextmenu",b,!1);this.manager=new h.Manager(a);this.gestures={};c.after(this.manager,"add",this._emitAdd.bind(this.manager),!0)},on:function(a,e){var k=this.manager,g=f[a];if(b.test(a)){var c=this;a.split(b).forEach(function(a){c.on(a,
e)});return{remove:function(){k.off(a.replace(b," "),e)}}}"input"!=a&&(!k.get(a)&&g)&&this.addGesture({action:g.action||a,event:g.event||a,rules:!0===g?void 0:g});return this.gestures&&this.gestures[a]||"input"==a?("input"==a&&(a="hammer.input"),k.on(a,e),{remove:function(){k.off(a,e)}}):!1},addGesture:function(a){if(!a)return!1;var b=a.action,k=a.event,g=a.rules;a=g&&g.firesWith;var m=g&&g.exclusiveTo,b="hold"==b?"Press":b&&b.slice(0,1).toUpperCase()+b.slice(1);if(h[b]&&"function"==typeof h[b])return g=
new h[b](g),this.gestures[k||b]=g,this.manager&&this.manager.add(g),c.around(g,"recognizeWith",this._checkGestureLinks.bind(g)),c.around(g,"requireFailure",this._checkGestureLinks.bind(g)),a&&(Array.isArray(a)||(a=[a]),g.recognizeWith(a)),m&&g.requireFailure(m),!0;console.warn("no such action to base the new gesture on");return!1},removeGesture:function(a){return this.manager&&this.manager.remove(a)},configureGesture:function(a,b){return this.manager&&this.manager.set(a,b)},_checkGestureLinks:function(a){var b=
this.manager;a=a.bind(this);return function(b){return function(g){if(b&&b.get(g)||Array.isArray(g))a(g);else{var e=function(c){g==c.gesture.options.event&&(a(g),b.off("add",e))};b.on("add",e)}}}(b)},_emitAdd:function(a){this.emit("add",{gesture:a})}})})},"esri/core/hammerExtended":function(){define(["./libs/hammer/hammer"],function(h){function l(){k.apply(this,arguments)}h.INPUT_TYPE_TOUCH="touch";h.INPUT_TYPE_PEN="pen";h.INPUT_TYPE_MOUSE="mouse";h.INPUT_TYPE_KINECT="kinect";var c={mousedown:h.INPUT_START,
mousemove:h.INPUT_MOVE,mouseup:h.INPUT_END,wheel:h.INPUT_MOVE},f={pointerdown:h.INPUT_START,pointermove:h.INPUT_MOVE,pointerup:h.INPUT_END,pointercancel:h.INPUT_CANCEL,pointerout:h.INPUT_CANCEL,wheel:h.INPUT_MOVE},b={2:h.INPUT_TYPE_TOUCH,3:h.INPUT_TYPE_PEN,4:h.INPUT_TYPE_MOUSE,5:h.INPUT_TYPE_KINECT};h.prototype._emit=h.prototype.emit;h.prototype.emit=function(a,b){b.cancelled=!1;b.cancel=function(){b.srcEvent.preventDefault();b.srcEvent.stopImmediatePropagation();b.cancelled=!0};this._emit(a,b)};
h.extend(h.MouseInput.prototype,{_lastButton:null,handler:function(a){var b=c[a.type];b&h.INPUT_START&&(0===a.button||2===a.button)?(this.pressed=!0,this._lastButton=a.button):b&h.INPUT_MOVE&&"wheel"===a.type&&(this.pressed=!0,a.preventDefault());b&h.INPUT_MOVE&&(null!=this._lastButton&&a.which!==this._lastButton+1)&&(b=h.INPUT_END);this.pressed&&this.allow&&(b&h.INPUT_END&&(this.pressed=!1,this._lastButton=null),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:h.INPUT_TYPE_MOUSE,
srcEvent:a,button:a.button,scrollDelta:a.deltaY&&-1*a.deltaY}))}});h.extend(h.PointerEventInput.prototype,{handler:function(a){var e=this.store,k=!1,d=!1,c=null,l=a.type.toLowerCase().replace("ms",""),l=f[l],p=b[a.pointerType]||a.pointerType,u=p==h.INPUT_TYPE_TOUCH,s=h.inArray(e,a.pointerId,"pointerId");l&h.INPUT_START&&(0===a.button||2===a.button||u)?(0>s&&(d=!0),this.pressed=!0,c=this._lastButton=a.button):l&h.INPUT_MOVE&&"wheel"===a.type?(0>s&&(d=!0),k=this.pressed=!0,a.preventDefault()):l&h.INPUT_MOVE&&
this.pressed?c=this._lastButton:l&(h.INPUT_END|h.INPUT_CANCEL)&&(k=!0,this.pressed=!1,c=a.button);!0===d&&(e.push(a),s=e.length-1);0>s||(e[s]=a,this.callback(this.manager,l,{pointers:e,changedPointers:[a],pointerType:p,srcEvent:a,button:c,scrollDelta:a.deltaY&&-1*a.deltaY}),k&&(e.splice(s,1),this._lastButton=this.pressed=!1))}});var a=h.Tap.prototype.process,e=function(a){var b;b=a.pointerType!=h.INPUT_TYPE_MOUSE||null==this.options.button?null:this.options.button;return null===b||a.button===b};h.extend(h.AttrRecognizer.prototype,
{_attrTest:h.AttrRecognizer.prototype.attrTest,_btnTest:e,attrTest:function(a){return this._attrTest(a)&&this._btnTest(a)}});h.extend(h.Tap.prototype.defaults,{button:0});h.extend(h.Tap.prototype,{_btnTest:e,_tapProcess:a,process:function(a){return this._btnTest(a)?this._tapProcess(a):h.STATE_FAILED}});h.extend(h.Pan.prototype,{process:function(a){a=this._super.process.call(this,a);a>=h.STATE_CANCELLED&&(a=h.STATE_FAILED);return a}});var k=h.AttrRecognizer;h.inherit(l,k,{defaults:{event:"scroll",
threshold:0,pointers:0},getTouchAction:function(){return[h.TOUCH_ACTION_COMPUTE]},attrTest:function(a){return this._super.attrTest.call(this,a)&&Math.abs(a.scrollDelta)>this.options.threshold},process:function(a){a=this._super.process.call(this,a);a>=h.STATE_CANCELLED&&(a=h.STATE_FAILED);return a}});h.Scroll=l;return h})},"esri/core/libs/hammer/hammer":function(){define([],function(){function h(a,b,d){return Array.isArray(a)?(l(a,d[b],d),!0):!1}function l(a,b,d){var g;if(a)if(a.forEach)a.forEach(b,
d);else if(void 0!==a.length)for(g=0;g<a.length;)b.call(d,a[g],g,a),g++;else for(g in a)a.hasOwnProperty(g)&&b.call(d,a[g],g,a)}function c(a,b,d){for(var g=Object.keys(b),e=0;e<g.length;){if(!d||d&&void 0===a[g[e]])a[g[e]]=b[g[e]];e++}return a}function f(a,b){return c(a,b,!0)}function b(a,b,d){b=b.prototype;var g;g=a.prototype=Object.create(b);g.constructor=a;g._super=b;d&&c(g,d)}function a(a,b){return function(){return a.apply(b,arguments)}}function e(a,b){return typeof a==Ca?a.apply(b?b[0]||void 0:
void 0,b):a}function k(a,b,d){l(n(b),function(b){a.addEventListener(b,d,!1)})}function g(a,b,d){l(n(b),function(b){a.removeEventListener(b,d,!1)})}function m(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function n(a){return a.trim().split(/\s+/g)}function d(a,b,d){if(a.indexOf&&!d)return a.indexOf(b);for(var g=0;g<a.length;){if(d&&a[g][d]==b||!d&&a[g]===b)return g;g++}return-1}function q(a){return Array.prototype.slice.call(a,0)}function y(a,b,g){for(var e=[],k=[],c=0;c<a.length;){var v=
b?a[c][b]:a[c];0>d(k,v)&&e.push(a[c]);k[c]=v;c++}g&&(e=b?e.sort(function(a,d){return a[b]>d[b]}):e.sort());return e}function p(a,b){for(var d,g=b[0].toUpperCase()+b.slice(1),e=0;e<ra.length;){d=(d=ra[e])?d+g:b;if(d in a)return d;e++}}function u(a){a=a.ownerDocument||a;return a.defaultView||a.parentWindow||window}function s(a,b){var d=this;this.manager=a;this.callback=b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){e(a.options.enable,[a])&&d.handler(b)};this.init()}
function w(a){var b=a.options.inputClass;return new (b?b:Da?ga:Ea?Z:sa?ha:L)(a,r)}function r(a,b,d){var g=d.pointers.length,e=d.changedPointers.length,k=b&B&&0===g-e,g=b&(A|C)&&0===g-e;d.isFirst=!!k;d.isFinal=!!g;k&&(a.session={});d.eventType=b;b=a.session;k=d.pointers;g=k.length;b.firstInput||(b.firstInput=t(d));1<g&&!b.firstMultiple?b.firstMultiple=t(d):1===g&&(b.firstMultiple=!1);var e=b.firstInput,c=(g=b.firstMultiple)?g.center:e.center,f=d.center=z(k);d.timeStamp=ia();d.deltaTime=d.timeStamp-
e.timeStamp;d.angle=P(c,f);d.distance=v(c,f);var e=d.center,c=b.offsetDelta||{},f=b.prevDelta||{},q=b.prevInput||{};if(d.eventType===B||q.eventType===A)f=b.prevDelta={x:q.deltaX||0,y:q.deltaY||0},c=b.offsetDelta={x:e.x,y:e.y};d.deltaX=f.x+(e.x-c.x);d.deltaY=f.y+(e.y-c.y);d.offsetDirection=x(d.deltaX,d.deltaY);d.scale=g?v(k[0],k[1],$)/v(g.pointers[0],g.pointers[1],$):1;d.rotation=g?P(k[1],k[0],$)-P(g.pointers[1],g.pointers[0],$):0;c=b.lastInterval||d;k=d.timeStamp-c.timeStamp;d.eventType!=C&&(k>Fa||
void 0===c.velocity)?(e=c.deltaX-d.deltaX,c=c.deltaY-d.deltaY,f=e/k||0,q=c/k||0,k=f,g=q,f=Q(f)>Q(q)?f:q,e=x(e,c),b.lastInterval=d):(f=c.velocity,k=c.velocityX,g=c.velocityY,e=c.direction);d.velocity=f;d.velocityX=k;d.velocityY=g;d.direction=e;b=a.element;m(d.srcEvent.target,b)&&(b=d.srcEvent.target);d.target=b;a.emit("hammer.input",d);a.recognize(d);a.session.prevInput=d}function t(a){for(var b=[],d=0;d<a.pointers.length;)b[d]={clientX:M(a.pointers[d].clientX),clientY:M(a.pointers[d].clientY)},d++;
return{timeStamp:ia(),pointers:b,center:z(b),deltaX:a.deltaX,deltaY:a.deltaY}}function z(a){var b=a.length;if(1===b)return{x:M(a[0].clientX),y:M(a[0].clientY)};for(var d=0,g=0,e=0;e<b;)d+=a[e].clientX,g+=a[e].clientY,e++;return{x:M(d/b),y:M(g/b)}}function x(a,b){return a===b?aa:Q(a)>=Q(b)?0<a?R:S:0<b?T:U}function v(a,b,d){d||(d=ta);var g=b[d[0]]-a[d[0]];a=b[d[1]]-a[d[1]];return Math.sqrt(g*g+a*a)}function P(a,b,d){d||(d=ta);return 180*Math.atan2(b[d[1]]-a[d[1]],b[d[0]]-a[d[0]])/Math.PI}function L(){this.evEl=
Ga;this.evWin=Ha;this.allow=!0;this.pressed=!1;s.apply(this,arguments)}function ga(){this.evEl=ua;this.evWin=va;s.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function qa(){this.evTarget=Ia;this.evWin=Ja;this.started=!1;s.apply(this,arguments)}function Z(){this.evTarget=Ka;this.targetIds={};s.apply(this,arguments)}function Ba(a,b){var d=q(a.touches),g=this.targetIds;if(b&(B|J)&&1===d.length)return g[d[0].identifier]=!0,[d,d];var e,k=q(a.changedTouches),c=[],v=this.target;
e=d.filter(function(a){return m(a.target,v)});if(b===B)for(d=0;d<e.length;)g[e[d].identifier]=!0,d++;for(d=0;d<k.length;)g[k[d].identifier]&&c.push(k[d]),b&(A|C)&&delete g[k[d].identifier],d++;if(c.length)return[y(e.concat(c),"identifier",!0),c]}function ha(){s.apply(this,arguments);var b=a(this.handler,this);this.touch=new Z(this.manager,b);this.mouse=new L(this.manager,b)}function ja(a,b){this.manager=a;this.set(b)}function La(a){if(-1<a.indexOf(V))return V;var b=-1<a.indexOf(W),d=-1<a.indexOf(X);
return b&&d?W+" "+X:b||d?b?W:X:-1<a.indexOf(ka)?ka:wa}function G(a){this.id=Ma++;this.manager=null;this.options=f(a||{},this.defaults);this.options.enable=void 0===this.options.enable?!0:this.options.enable;this.state=ba;this.simultaneous={};this.requireFail=[]}function xa(a){return a==U?"down":a==T?"up":a==R?"left":a==S?"right":""}function ca(a,b){var d=b.manager;return d?d.get(a):a}function E(){G.apply(this,arguments)}function da(){E.apply(this,arguments);this.pY=this.pX=null}function la(){E.apply(this,
arguments)}function ma(){G.apply(this,arguments);this._input=this._timer=null}function na(){E.apply(this,arguments)}function oa(){E.apply(this,arguments)}function ea(){G.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=0}function N(a,b){b=b||{};b.recognizers=void 0===b.recognizers?N.defaults.preset:b.recognizers;return new pa(a,b)}function pa(a,b){b=b||{};this.options=f(b,N.defaults);this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session=
{};this.recognizers=[];this.element=a;this.input=w(this);this.touchAction=new ja(this,this.options.touchAction);ya(this,!0);l(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}function ya(a,b){var d=a.element;d.style&&l(a.options.cssProps,function(a,g){d.style[p(d.style,g)]=b?a:""})}function Na(a,b){var d=document.createEvent("Event");d.initEvent(a,!0,!0);d.gesture=b;b.target.dispatchEvent(d)}var ra=" webkit moz MS ms o".split(" "),
Oa=document.createElement("div"),Ca="function",M=Math.round,Q=Math.abs,ia=Date.now,Ma=1,fa=/mobile|tablet|ip(ad|hone|od)|android/i,sa="ontouchstart"in window,Da=void 0!==p(window,"PointerEvent"),Ea=sa&&fa.test(navigator.userAgent),Fa=25,B=1,J=2,A=4,C=8,aa=1,R=2,S=4,T=8,U=16,F=R|S,K=T|U,fa=F|K,ta=["x","y"],$=["clientX","clientY"];s.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler);this.evTarget&&k(this.target,this.evTarget,this.domHandler);this.evWin&&
k(u(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&g(this.element,this.evEl,this.domHandler);this.evTarget&&g(this.target,this.evTarget,this.domHandler);this.evWin&&g(u(this.element),this.evWin,this.domHandler)}};var Pa={mousedown:B,mousemove:J,mouseup:A},Ga="mousedown wheel",Ha="mousemove mouseup";b(L,s,{handler:function(a){var b=Pa[a.type];b&B&&0===a.button&&(this.pressed=!0);b&J&&1!==a.which&&(b=A);this.pressed&&this.allow&&(b&A&&(this.pressed=!1),this.callback(this.manager,
b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var Qa={pointerdown:B,pointermove:J,pointerup:A,pointercancel:C,pointerout:C},Ra={2:"touch",3:"pen",4:"mouse",5:"kinect"},ua="pointerdown wheel",va="pointermove pointerup pointercancel";window.MSPointerEvent&&(ua="MSPointerDown wheel",va="MSPointerMove MSPointerUp MSPointerCancel");b(ga,s,{handler:function(a){var b=this.store,g=!1,e=a.type.toLowerCase().replace("ms",""),e=Qa[e],k=Ra[a.pointerType]||a.pointerType,c="touch"==k,
v=d(b,a.pointerId,"pointerId");e&B&&(0===a.button||c)?0>v&&(b.push(a),v=b.length-1):e&(A|C)&&(g=!0);0>v||(b[v]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:k,srcEvent:a}),g&&b.splice(v,1))}});var Sa={touchstart:B,touchmove:J,touchend:A,touchcancel:C},Ia="touchstart",Ja="touchstart touchmove touchend touchcancel";b(qa,s,{handler:function(a){var b=Sa[a.type];b===B&&(this.started=!0);if(this.started){var d;d=q(a.touches);var g=q(a.changedTouches);b&(A|C)&&(d=y(d.concat(g),
"identifier",!0));d=[d,g];b&(A|C)&&0===d[0].length-d[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:d[0],changedPointers:d[1],pointerType:"touch",srcEvent:a})}}});var Ta={touchstart:B,touchmove:J,touchend:A,touchcancel:C},Ka="touchstart touchmove touchend touchcancel";b(Z,s,{handler:function(a){var b=Ta[a.type],d=Ba.call(this,a,b);d&&this.callback(this.manager,b,{pointers:d[0],changedPointers:d[1],pointerType:"touch",srcEvent:a})}});b(ha,s,{handler:function(a,b,d){var g="mouse"==
d.pointerType;if("touch"==d.pointerType)this.mouse.allow=!1;else if(g&&!this.mouse.allow)return;b&(A|C)&&(this.mouse.allow=!0);this.callback(a,b,d)},destroy:function(){this.touch.destroy();this.mouse.destroy()}});var za=p(Oa.style,"touchAction"),Aa=void 0!==za,wa="auto",ka="manipulation",V="none",W="pan-x",X="pan-y";ja.prototype={set:function(a){"compute"==a&&(a=this.compute());Aa&&this.manager.element.style&&(this.manager.element.style[za]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},
compute:function(){var a=[];l(this.manager.recognizers,function(b){e(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))});return La(a.join(" "))},preventDefaults:function(a){if(!Aa){var b=a.srcEvent;a=a.offsetDirection;if(this.manager.session.prevented)b.preventDefault();else{var d=this.actions,g=-1<d.indexOf(V),e=-1<d.indexOf(X),d=-1<d.indexOf(W);if(g||e&&a&F||d&&a&K)return this.preventSrc(b)}}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};var ba=1,D=2,O=4,I=
8,H=I,Y=16;G.prototype={defaults:{},set:function(a){c(this.options,a);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(a){if(h(a,"recognizeWith",this))return this;var b=this.simultaneous;a=ca(a,this);b[a.id]||(b[a.id]=a,a.recognizeWith(this));return this},dropRecognizeWith:function(a){if(h(a,"dropRecognizeWith",this))return this;a=ca(a,this);delete this.simultaneous[a.id];return this},requireFailure:function(a){if(h(a,"requireFailure",this))return this;var b=this.requireFail;
a=ca(a,this);-1===d(b,a)&&(b.push(a),a.requireFailure(this));return this},dropRequireFailure:function(a){if(h(a,"dropRequireFailure",this))return this;a=ca(a,this);a=d(this.requireFail,a);-1<a&&this.requireFail.splice(a,1);return this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(e){d.manager.emit(d.options.event+(e?g&Y?"cancel":g&I?"end":g&O?"move":g&D?"start":"":""),a)}var d=this,g=this.state;
g<I&&b(!0);b();g>=I&&b(!0)},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=32},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|ba)))return!1;a++}return!0},recognize:function(a){a=c({},a);e(this.options.enable,[this,a])?(this.state&(H|Y|32)&&(this.state=ba),this.state=this.process(a),this.state&(D|O|I|Y)&&this.tryEmit(a)):(this.reset(),this.state=32)},process:function(a){},getTouchAction:function(){},reset:function(){}};b(E,G,{defaults:{pointers:1},
attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,d=a.eventType,g=b&(D|O);a=this.attrTest(a);return g&&(d&C||!a)?b|Y:g||a?d&A?b|I:!(b&D)?D:b|O:32}});b(da,E,{defaults:{event:"pan",threshold:10,pointers:1,direction:fa},getTouchAction:function(){var a=this.options.direction,b=[];a&F&&b.push(X);a&K&&b.push(W);return b},directionTest:function(a){var b=this.options,d=!0,g=a.distance,e=a.direction,k=a.deltaX,c=a.deltaY;e&b.direction||
(b.direction&F?(e=0===k?aa:0>k?R:S,d=k!=this.pX,g=Math.abs(a.deltaX)):(e=0===c?aa:0>c?T:U,d=c!=this.pY,g=Math.abs(a.deltaY)));a.direction=e;return d&&g>b.threshold&&e&b.direction},attrTest:function(a){return E.prototype.attrTest.call(this,a)&&(this.state&D||!(this.state&D)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;this.pY=a.deltaY;var b=xa(a.direction);b&&this.manager.emit(this.options.event+b,a);this._super.emit.call(this,a)}});b(la,E,{defaults:{event:"pinch",threshold:0,pointers:2},
getTouchAction:function(){return[V]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&D)},emit:function(a){this._super.emit.call(this,a);1!==a.scale&&this.manager.emit(this.options.event+(1>a.scale?"in":"out"),a)}});b(ma,G,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[wa]},process:function(b){var d=this.options,g=b.pointers.length===d.pointers,e=b.distance<d.threshold,k=b.deltaTime>d.time;
this._input=b;if(!e||!g||b.eventType&(A|C)&&!k)this.reset();else if(b.eventType&B)this.reset(),this._timer=setTimeout(a(function(){this.state=H;this.tryEmit()},this),d.time);else if(b.eventType&A)return H;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===H&&(a&&a.eventType&A?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ia(),this.manager.emit(this.options.event,this._input)))}});b(na,E,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[V]},
attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&D)}});b(oa,E,{defaults:{event:"swipe",threshold:10,velocity:0.65,direction:F|K,pointers:1},getTouchAction:function(){return da.prototype.getTouchAction.call(this)},attrTest:function(a){var b=this.options.direction,d;b&(F|K)?d=a.velocity:b&F?d=a.velocityX:b&K&&(d=a.velocityY);return this._super.attrTest.call(this,a)&&b&a.direction&&a.distance>this.options.threshold&&Q(d)>this.options.velocity&&
a.eventType&A},emit:function(a){var b=xa(a.direction);b&&this.manager.emit(this.options.event+b,a);this.manager.emit(this.options.event,a)}});b(ea,G,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ka]},process:function(b){var d=this.options,g=b.pointers.length===d.pointers,e=b.distance<d.threshold,k=b.deltaTime<d.time;this.reset();if(b.eventType&B&&0===this.count)return this.failTimeout();if(e&&k&&g){if(b.eventType!=A)return this.failTimeout();
g=this.pTime?b.timeStamp-this.pTime<d.interval:!0;e=!this.pCenter||v(this.pCenter,b.center)<d.posThreshold;this.pTime=b.timeStamp;this.pCenter=b.center;this.count=!e||!g?1:this.count+1;this._input=b;if(0===this.count%d.taps)return this.hasRequireFailures()?(this._timer=setTimeout(a(function(){this.state=H;this.tryEmit()},this),d.interval),D):H}return 32},failTimeout:function(){this._timer=setTimeout(a(function(){this.state=32},this),this.options.interval);return 32},reset:function(){clearTimeout(this._timer)},
emit:function(){this.state==H&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});N.VERSION="2.0.4";N.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[na,{enable:!1}],[la,{enable:!1},["rotate"]],[oa,{direction:F}],[da,{direction:F},["swipe"]],[ea],[ea,{event:"doubletap",taps:2},["tap"]],[ma]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};
pa.prototype={set:function(a){c(this.options,a);a.touchAction&&this.touchAction.update();a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init());return this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var d,g=this.recognizers,e=b.curRecognizer;if(!e||e&&e.state&H)e=b.curRecognizer=null;for(var k=0;k<g.length;)d=g[k],2!==b.stopped&&(!e||d==e||d.canRecognizeWith(e))?d.recognize(a):
d.reset(),!e&&d.state&(D|O|I)&&(e=b.curRecognizer=d),k++}},get:function(a){if(a instanceof G)return a;for(var b=this.recognizers,d=0;d<b.length;d++)if(b[d].options.event==a)return b[d];return null},add:function(a){if(h(a,"add",this))return this;var b=this.get(a.options.event);b&&this.remove(b);this.recognizers.push(a);a.manager=this;this.touchAction.update();return a},remove:function(a){if(h(a,"remove",this))return this;var b=this.recognizers;a=this.get(a);b.splice(d(b,a),1);this.touchAction.update();
return this},on:function(a,b){var d=this.handlers;l(n(a),function(a){d[a]=d[a]||[];d[a].push(b)});return this},off:function(a,b){var g=this.handlers;l(n(a),function(a){b?g[a].splice(d(g[a],b),1):delete g[a]});return this},emit:function(a,b){this.options.domEvents&&Na(a,b);var d=this.handlers[a]&&this.handlers[a].slice();if(d&&d.length){b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};for(var g=0;g<d.length;)d[g](b),g++}},destroy:function(){this.element&&ya(this,!1);this.handlers=
{};this.session={};this.input.destroy();this.element=null}};c(N,{INPUT_START:B,INPUT_MOVE:J,INPUT_END:A,INPUT_CANCEL:C,STATE_POSSIBLE:ba,STATE_BEGAN:D,STATE_CHANGED:O,STATE_ENDED:I,STATE_RECOGNIZED:H,STATE_CANCELLED:Y,STATE_FAILED:32,DIRECTION_NONE:aa,DIRECTION_LEFT:R,DIRECTION_RIGHT:S,DIRECTION_UP:T,DIRECTION_DOWN:U,DIRECTION_HORIZONTAL:F,DIRECTION_VERTICAL:K,DIRECTION_ALL:fa,Manager:pa,Input:s,TouchAction:ja,TouchInput:Z,MouseInput:L,PointerEventInput:ga,TouchMouseInput:ha,SingleTouchInput:qa,Recognizer:G,
AttrRecognizer:E,Tap:ea,Pan:da,Swipe:oa,Pinch:la,Rotate:na,Press:ma,on:k,off:g,each:l,merge:f,extend:c,inherit:b,bindFn:a,prefixed:p,inArray:d});return N})},"esri/views/2d/AnimationManager":function(){define("../../core/declare ../../core/Accessoire ../../core/Scheduler ../../core/now ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(h,l,c,f,b,a,e){var k=function(b,e,k,d){var c=b.targetGeometry,f=e.targetGeometry;d?"string"===typeof d&&(d=a.parse(d)||a.ease):d=a.ease;this.easing=
d;this.duration=k;this.sCenterX=c.x;this.sCenterY=c.y;this.sScale=b.scale;this.sRotation=b.rotation;this.tCenterX=f.x;this.tCenterY=f.y;this.tScale=e.scale;this.tRotation=e.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)};k.prototype.applyRatio=function(a,b){var e=this.easing(b),d,k,c;1<=b?(d=
this.tCenterX,k=this.tCenterY,c=this.tRotation,e=this.tScale):(d=this.sCenterX+e*this.dCenterX,k=this.sCenterY+e*this.dCenterY,c=this.sRotation+e*this.dRotation,e=this.sScale+e*this.dScale);a.targetGeometry.x=d;a.targetGeometry.y=k;a.scale=e;a.rotation=c};return h(l,{constructor:function(){this._updateTask=c.addFrameTask({postRender:this._postRender.bind(this)});this._updateTask.pause()},getDefaults:function(){return{viewpoint:e.create()}},duration:200,transition:null,easing:a.ease,animateTo:function(a,
c,h){e.copy(this.viewpoint,c);this.transition=new k(this.viewpoint,a,h&&h.duration||this.duration,h&&h.easing||this.easing);this.animation&&(this.animation.stop(),this.animation=null);a=this.animation=new b({target:a.clone()});a.always(function(){this._updateTask&&(this._updateTask.pause(),this.animation=null)}.bind(this));this._startTime=f();this._updateTask.resume();return a},_postRender:function(a){a=this.animation;if(!a||a.state===b.STOPPED)this._updateTask.pause();else{a=(f()-this._startTime)/
this.transition.duration;var e=1<=a;this.transition.applyRatio(this.viewpoint,a);this.animation._dfd.progress(this.viewpoint);e&&this.animation.finish()}}})})},"esri/views/2d/unitBezier":function(){define([],function(){var h=function(c,f,b,a){function e(a,b){var d,e,c,f;b=null==b?1E-6:b;c=a;for(e=0;8>e;e++){f=((m*c+g)*c+k)*c-a;if(Math.abs(f)<b)return c;d=(3*m*c+2*g)*c+k;if(1E-6>Math.abs(d))break;c-=f/d}d=0;e=1;c=a;if(c<d)return d;if(c>e)return e;for(;d<e;){f=((m*c+g)*c+k)*c;if(Math.abs(f-a)<b)break;
a>f?d=c:e=c;c=0.5*(e-d)+d}return c}var k=3*c,g=3*(b-c)-k,m=1-k-g,h=3*f,d=3*(a-f)-h,q=1-h-d;return function(a,b){var g=e(a,b);return((q*g+d)*g+h)*g}},l=/^cubic-bezier\((.*)\)/;h.parse=function(c){var f=h[c]||null;if(!f&&(c=l.exec(c)))c=c[1].split(",").map(function(b){return parseFloat(b.trim())}),4===c.length&&!c.some(function(b){return isNaN(b)})&&(f=h.apply(h,c));return f};h.ease=h(0.25,0.1,0.25,1);h.linear=h(0,0,1,1);h.easeIn=h["ease-in"]=h(0.42,0,1,1);h.easeOut=h["ease-out"]=h(0,0,0.58,1);h.easeInOut=
h["ease-in-out"]=h(0.42,0,0.58,1);return h})},"esri/views/2d/PaddedViewState":function(){define("./viewpointUtils ./ViewState ./math/vec2 ./math/mat2d ./math/common ../../core/Accessoire".split(" "),function(h,l,c,f,b,a){var e=a.createSubclass({classMetadata:{properties:{left:{},top:{},right:{},bottom:{}}},left:0,top:0,right:0,bottom:0});e.copy=function(a,b){a.left=b.left;a.top=b.top;a.right=b.right;a.bottom=b.bottom};return l.createSubclass({declaredClass:"esri.views.2d.PaddedViewState",classMetadata:{properties:{padding:{type:e,
copy:e.copy},transform:{dependsOn:["padding"]},paddedScreenCenter:{dependsOn:["size","padding"],readOnly:!0,copy:c.copy},clipRect:{dependsOn:["worldScreenWidth","rotation","paddedScreenCenter","screenCenter"],readOnly:!0,copy:function(a,b){a.top=b.top;a.left=b.left;a.right=b.right;a.bottom=b.bottom}}}},getDefaults:function(){return{content:new l,padding:new e,size:c.fromValues(0,0)}},_clipRectGetter:function(){var a=c.create(),e=f.create();return function(m){var h=this.worldScreenWidth;if(!h)return null;
var d=b.toRadian(this.rotation),q=Math.abs(Math.cos(d)),l=Math.abs(Math.sin(d)),q=this.width*q+this.height*l;if(h>q)return null;c.copy(a,this.screenCenter);f.fromTranslation(e,a);f.rotate(e,e,d);c.negate(a,a);f.translate(e,e,a);c.transformMat2d(a,this.paddedScreenCenter,e);m||(m={});m.top=-Math.round(q);m.left=Math.round(a[0]-0.5*h);m.right=Math.round(a[0]+0.5*h);m.bottom=+Math.round(q);return m}}(),_padding:null,_paddingSetter:function(a){this._padding=a||new e;this._updateContent();return a},_size:null,
_sizeSetter:function(a){this._size=a;this._updateContent();return a},_paddedScreenCenterGetter:function(a){var b=this.content.size,e=this.padding;a||(a=c.create());c.scale(a,b,0.5);a[0]+=e.left;a[1]+=e.top;return a},viewpoint:null,_viewpointSetter:function(){var a;return function(b,e){a||(a=b.clone());this.content.viewpoint=b;h.addPadding(a,b,this._size,this._padding);return!e?h.addPadding(a.clone(),b,this._size,this._padding):h.addPadding(e,b,this._size,this._padding)}}(),_updateContent:function(){var a=
c.create();return function(){var b=this._size,e=this._padding;if(b&&e){var f=this.content;c.set(a,e.left+e.right,e.top+e.bottom);c.subtract(a,b,a);f.size=a;if(b=f.viewpoint)this.viewpoint=b}}}()})})},"esri/views/2d/ViewState":function(){define(["./viewpointUtils","./math/vec2","./math/mat2d","../../geometry/Extent","../../core/Accessoire"],function(h,l,c,f,b){var a=b.createSubclass({declaredClass:"esri.views.2d.ViewState",classMetadata:{properties:{center:{copy:l.copy,dependsOn:["viewpoint"]},extent:{dependsOn:["viewpoint",
"size"],copy:function(a,b){a.xmin=b.xmin;a.ymin=b.ymin;a.xmax=b.xmax;a.ymax=b.ymax;a.spatialReference=b.spatialReference}},height:{dependsOn:["size"]},inverseTransform:{readOnly:!0,copy:c.copy,dependsOn:["transform"]},latitude:{dependsOn:["viewpoint"]},longitude:{dependsOn:["viewpoint"]},resolution:{dependsOn:["viewpoint"]},rotation:{dependsOn:["viewpoint"]},scale:{dependsOn:["viewpoint"]},screenCenter:{readOnly:!0,copy:l.copy,dependsOn:["size"]},size:{copy:l.copy},spatialReference:{dependsOn:["viewpoint"]},
transform:{readOnly:!0,copy:c.copy,dependsOn:["viewpoint","size"]},transformNoRotation:{readOnly:!0,copy:c.copy,dependsOn:["viewpoint","size"]},version:{readOnly:!0,dependsOn:["transform"]},viewpoint:{copy:h.copy},width:{dependsOn:["size"]},worldScreenWidth:{readOnly:!0,dependsOn:["worldWidth","resolution"]},worldWidth:{readOnly:!0,dependsOn:["spatialReference"]},wrappable:{readOnly:!0,dependsOn:["spatialReference"]},x:{dependsOn:["center"]},y:{dependsOn:["center"]}}},_centerGetter:function(a){var b=
this.viewpoint.targetGeometry;return!a?l.fromValues(b.x,b.y):l.set(a,b.x,b.y)},_extentGetter:function(a){a||(a=new f);return h.getExtent(a,this.viewpoint,this.size)},_heightGetter:function(){return this.size?this.size[1]:0},_inverseTransformGetter:function(a){a||(a=c.create());return c.invert(a,this.transform)},_latitudeGetter:function(){return this.viewpoint.targetGeometry.latitude},_longitudeGetter:function(){return this.viewpoint.targetGeometry.longitude},_resolutionGetter:function(){return h.getResolution(this.viewpoint)},
_rotationGetter:function(){return this.viewpoint.rotation},_scaleGetter:function(){return this.viewpoint.scale},_screenCenterGetter:function(a){var b=this.size;a||(a=l.create());return l.scale(a,b,0.5)},size:null,_sizeSetter:function(a,b){return!b?l.clone(a):l.copy(b,a)},_spatialReferenceGetter:function(){return this.viewpoint.targetGeometry.spatialReference},_transformGetter:function(a){a||(a=c.create());return h.getTransform(a,this.viewpoint,this.size)},_transformNoRotationGetter:function(a){a||
(a=c.create());return h.getTransformNoRotation(a,this.viewpoint,this.size)},version:0,_versionGetter:function(a){return a+1},viewpoint:null,_viewpointSetter:function(a,b){return!b?a.clone():h.copy(b,a)},_widthGetter:function(){return this.size?this.size[0]:0},_worldScreenWidthGetter:function(){return this.worldWidth/this.resolution},_worldWidthGetter:function(){if(this.wrappable){var a=this.spatialReference._getInfo();return a.valid[1]-a.valid[0]}return 0},_wrappableGetter:function(){return!!this.spatialReference&&
this.spatialReference.isWrappable},_xGetter:function(){return this.center[0]},_yGetter:function(){return this.center[1]},copy:function(a){return this.set({viewpoint:a.viewpoint,size:a.size})},clone:function(){return new a({viewpoint:this.viewpoint.clone(),size:l.clone(this.size)})},toMap:function(a,b){return l.transformMat2d(a,b,this.inverseTransform)},toScreen:function(a,b){return l.transformMat2d(a,b,this.transform)},pixelSizeAt:function(a){return h.pixelSizeAt(a,this.viewpoint,this.size)}});return a})},
"esri/views/2d/MapViewConstraints":function(){define(["../../core/Accessor","../../core/Evented","../../layers/support/LOD","./constraints/ZoomConstraint","./constraints/RotationConstraint"],function(h,l,c,f,b){f=f.default;b=b.default;return h.createSubclass([l],{declaredClass:"esri.views.2d.MapViewConstraints",destroy:function(){this.view=null},initialize:function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)},properties:{effectiveLODs:{readOnly:!0,aliasOf:"_zoom.effectiveLODs"},
effectiveMinScale:{readOnly:!0,aliasOf:"_zoom.effectiveMinScale"},effectiveMaxScale:{readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"},effectiveMinZoom:{readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"},effectiveMaxZoom:{readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"},enabled:!0,lods:{value:null,type:[c]},minScale:0,maxScale:0,minZoom:-1,maxZoom:-1,rotationEnabled:!0,snapToZoom:!0,view:{value:null},_zoom:{type:f,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom view.tileInfo".split(" "),get:function(){return new f({lods:this.lods||
this.view&&this.view.tileInfo&&this.view.tileInfo.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}},_rotation:{type:b,dependsOn:["rotationEnabled"],get:function(){return new b({rotationEnabled:this.rotationEnabled})}}},constrain:function(a,b,c){if(!this.enabled)return a;this._zoom.constrain(a,b,c);this._rotation.constrain(a,b,c);return a},zoomToScale:function(a){return this._zoom.zoomToScale(a)},scaleToZoom:function(a){return this._zoom.scaleToZoom(a)},
snapScale:function(a,b){return this._zoom.snapScale(a,b)}})})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../layers/support/LOD".split(" "),function(h,l,c,f,b,a,e){h=function(a){function g(){a.apply(this,arguments);this._lodByScale={};this._scales=[];this.effectiveLODs=null;this.effectiveMaxZoom=this.effectiveMinZoom=
-1;this.effectiveMaxScale=this.effectiveMinScale=0;this.enabled=!0;this.lods=null;this.maxZoom=this.minZoom=-1;this.maxScale=this.minScale=0;this.snapToZoom=!0}c(g,a);g.prototype.initialize=function(){var a=this,b=this.lods,d=this.minScale,e=this.maxScale,g=this.minZoom,c=this.maxZoom,k=-1,f=-1,h=!1,l=!1;0!==d&&(0!==e&&d<e)&&(e=[e,d],d=e[0],e=e[1]);if(b&&b.length){b=b.map(function(a){return a.clone()});b.sort(function(a,b){return b.scale-a.scale});b.forEach(function(a,b){return a.level=b});for(var t,
z=0,x=b;z<x.length;z++){var v=x[z];!h&&(0<d&&d>=v.scale)&&(k=v.level,h=!0);!l&&(0<e&&e>=v.scale)&&(f=t?t.level:-1,l=!0);t=v}-1===g&&(g=0===d?0:k);-1===c&&(c=0===e?b.length-1:f);g=Math.max(g,0);g=Math.min(g,b.length-1);c=Math.max(c,0);c=Math.min(c,b.length-1);g>c&&(d=[c,g],g=d[0],c=d[1]);d=b[g].scale;e=b[c].scale;b.splice(0,g);b.splice(c-g+1,b.length);b.forEach(function(b,d){a._lodByScale[b.scale]=b;a._scales[d]=b.scale});this._set("effectiveLODs",b);this._set("effectiveMinZoom",g);this._set("effectiveMaxZoom",
c)}this._set("effectiveMinScale",d);this._set("effectiveMaxScale",e)};g.prototype.constrain=function(a,b,d){if(!this.enabled||b&&a.scale===b.scale)return a;var e=this.effectiveMinScale,g=this.effectiveMaxScale;d=a.targetGeometry;var c=b&&b.targetGeometry,k=0!==e&&a.scale>e;if(0!==g&&a.scale<g||k)e=k?e:g,c&&(b=(e-b.scale)/(a.scale-b.scale),d.x=c.x+(d.x-c.x)*b,d.y=c.y+(d.y-c.y)*b),a.scale=e;this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale));return a};g.prototype.zoomToScale=
function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,a);var b=this._scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var d=Math.round(a-0.5),e=Math.round(a);return b[e]+(e-a)*(b[d]-b[e])};g.prototype.scaleToZoom=function(a){if(!this.effectiveLODs)return-1;var b=this._scales,d=0,e=b.length-1,g,c;for(d;d<e;d++){g=b[d];c=b[d+1];if(g<=a)return d+this.effectiveMinZoom;if(c===a)return d+1+this.effectiveMinZoom;if(g>a&&c<a)return d+1-(a-c)/(g-c)+this.effectiveMinZoom}return d};
g.prototype.snapScale=function(a,b){void 0===b&&(b=0.95);if(!this.effectiveLODs)return a;var d=this.scaleToZoom(a);return(d+1)%Math.floor(d+1)>=b?this.zoomToScale(Math.ceil(d)):this.zoomToScale(Math.floor(d))};g.prototype.clone=function(){return new g({enabled:this.enabled,lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})};g.prototype._getClosestScale=function(a){if(this._lodByScale[a])return this._lodByScale[a].scale;a=this._scales.reduce(function(b,
d,e,g){return Math.abs(d-a)<=Math.abs(b-a)?d:b},this._scales[0]);return this._lodByScale[a].scale};f([b.shared("esri.views.2d.constraints.ZoomConstraint")],g.prototype,"declaredClass",void 0);f([b.property({readOnly:!0})],g.prototype,"effectiveLODs",void 0);f([b.property({readOnly:!0})],g.prototype,"effectiveMinZoom",void 0);f([b.property({readOnly:!0})],g.prototype,"effectiveMaxZoom",void 0);f([b.property({readOnly:!0})],g.prototype,"effectiveMinScale",void 0);f([b.property({readOnly:!0})],g.prototype,
"effectiveMaxScale",void 0);f([b.property()],g.prototype,"enabled",void 0);f([b.property({type:[e]})],g.prototype,"lods",void 0);f([b.property()],g.prototype,"minZoom",void 0);f([b.property()],g.prototype,"maxZoom",void 0);f([b.property()],g.prototype,"minScale",void 0);f([b.property()],g.prototype,"maxScale",void 0);f([b.property()],g.prototype,"snapToZoom",void 0);return g=f([b.subclass()],g)}(b.declared(a));Object.defineProperty(l,"__esModule",{value:!0});l.default=h})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(h,l,c,f,b,a){h=function(a){function k(){a.apply(this,arguments);this.rotationEnabled=this.enabled=!0}c(k,a);k.prototype.constrain=function(a,b,e){if(!this.enabled)return a;this.rotationEnabled||(a.rotation=0);return a};k.prototype.clone=function(){return new k({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};f([b.shared("esri.views.2d.constraints.RotationConstraint")],k.prototype,"declaredClass",void 0);f([b.property()],k.prototype,"enabled",void 0);f([b.property()],k.prototype,
"rotationEnabled",void 0);return k=f([b.subclass()],k)}(b.declared(a));Object.defineProperty(l,"__esModule",{value:!0});l.default=h})},"esri/views/2d/layers/GraphicsView2D":function(){define("dojox/gfx dojo/dom-style ../engine/Container ../../layers/GraphicsView ./LayerView2D ../../../geometry/support/webMercatorUtils ../VectorGroup ../Vector".split(" "),function(h,l,c,f,b,a,e,k){return f.createSubclass({declaredClass:"esri.views.2d.layers.GraphicsView2D",properties:{needsRedraw:{dependsOn:["gfx",
"mapView.stationary"]},renderer:{},view:{},gfx:{},mapView:{}},constructor:function(){this.mapView=null},initialize:function(){var a=this.view;if(!a||!this.graphics)throw Error("view and graphics are required parameter options");a.then(function(){this.container=new c({visible:!1});this._vectors={};this._bgVectors={};this._prevScale=null;var e=a.isInstanceOf(b),k=this.container.render;this.container.render=function(b){this.container.visible=e?a.layer.visible:!0;k.call(this.container,b);this.render()}.bind(this);
this.container.watch("surface",this._surfaceCreateHandler.bind(this));this.watch("needsRedraw, graphics, mapView.state.version, view.suspended",this.redraw.bind(this));this.watch("renderer",this._resymbolizeGraphics.bind(this));e?(this.mapView=this.view.view,this.container.visible=a.layer.visible,a.container.addChild(this.container)):(this.mapView=this.view,this.container.visible=!0,a.stage.addChild(this.container))}.bind(this))},destroy:function(){this._colChgHandle&&(this._colChgHandle.remove(),
this._colChgHandle=null);this.group&&this.group.destroy();this.bgGroup&&this.bgGroup.destroy();this._vectors=this._bgVectors=this.container=this.group=this.bgGroup=this.mapView=null},_graphicsSetter:function(a){var b=this.graphics;a!==b&&(b&&(this._colChgHandle.remove(),this._colChgHandle=null,this.removeAll()),a&&(this.addMany(a.toArray()),this._colChgHandle=a.on("change",function(a){this.addMany(a.added);this.remove(a.removed)}.bind(this))),this._set("graphics",a))},_needsRedrawGetter:function(){return(this.group||
this.bgGroup)&&this.mapView.stationary},hitTest:function(a,e){null!=a&&"object"===typeof a&&(e=a.y,a=a.x);var c=this.mapView,d=this.view.isInstanceOf(b)?this.view.container.surface:this.container.surface,k=null,f;f=[a,e];c.containerToPage(a,e,f);d&&(c=d.style.zIndex,d.style.zIndex="10000",l.getComputedStyle(d),k=(f=(k=(k=document.elementFromPoint(f[0],f[1]))&&k.vector)&&(k.parent===this.group||k.parent===this.bgGroup))&&k.graphic||null,d.style.zIndex=c);return k},redraw:function(){if(this.mapView.ready&&
(this.needsRedraw&&!this.view.suspended)&&this.mapView.stationary){var a=this.mapView.state,b={},e=!1;a.resolution!==this.group.resolution&&(b.x=a.x,b.y=a.y,b.resolution=a.resolution,e=!0,this._prevScale!==this.mapView.scale&&(this._prevScale=this.mapView.scale,this._resizeGraphics()));a.rotation!==this.group.rotation&&(b.rotation=a.rotation,e=!0);e?(this.group.set(b),this.bgGroup.set(b),this.group._updateTransform(),this.bgGroup._updateTransform(),this.group.draw(),this.bgGroup.draw(),this.render()):
(this.group.draw(),this.bgGroup.draw())}},render:function(){if(!this.view.suspended&&this.group){var a=this.mapView.state;this.gfx.setDimensions(a.width,a.height);this.group.applyState(a);this.bgGroup.applyState(a)}},add:function(a){this.addMany([a])},addMany:function(a){if(a&&this.group){a.hasOwnProperty("length")||(a=[a]);var b,e=a.length,d,c,f=this.mapView.extent.spatialReference;for(b=0;b<e;b++)if(d=a[b],c=this.getRenderingInfo(d)){var h=c.renderer&&c.renderer.backgroundFillSymbol,l=d.uid,s=d.geometry,
w=this._projectGeometry(s,f),r=this._isPolygonMarkerSymbol(c.symbol.type,s),t=c.outlineSize;null==t&&(t=c.size);this._vectors[l]=new k({graphic:d,symbol:c.symbol,color:c.color,size:c.size,opacity:c.opacity,rotationAngle:c.rotationAngle,outlineSize:t,geometry:r?s&&s.centroid:s,projectedGeometry:w&&(r?w.centroid:w)});this.group.addVector(this._vectors[l]);r&&h&&(this._bgVectors[l]=new k({graphic:d,symbol:h,outlineSize:c.outlineSize,geometry:s,projectedGeometry:w}),this.bgGroup.addVector(this._bgVectors[l]))}this.group.draw();
this.bgGroup.draw();this.render()}},remove:function(a){if(a){a.hasOwnProperty("length")||(a=[a]);var b,e=a.length,d,c;for(b=0;b<e;b++)if(d=a[b],c=this._vectors[d.uid],this.group.removeVector(c),delete this._vectors[d.uid],c=this._bgVectors[d.uid])this.bgGroup.removeVector(c),delete this._bgVectors[d.uid]}},removeAll:function(){this._clear(this.group,this._vectors);this._vectors={};this._clear(this.bgGroup,this._bgVectors);this._bgVectors={}},_isPolygonMarkerSymbol:function(a,b){return b&&"polygon"===
b.type&&("simple-marker-symbol"===a||"picture-marker-symbol"===a||"text-symbol"===a)},_clear:function(a,b){Object.getOwnPropertyNames(b).forEach(function(e){a.removeVector(b[e])}.bind(this))},_projectGeometry:function(b,e){var c=b&&b.spatialReference,d;c&&(e&&!c.equals(e)&&a.canProject(c,e))&&(d=e.isWebMercator?a.geographicToWebMercator(b):a.webMercatorToGeographic(b,!0));return d},_resymbolizeGraphics:function(){if(this.group){var a=this._vectors,b=this.mapView.extent.spatialReference;Object.getOwnPropertyNames(a).forEach(function(e){var d=
a[e],c=d.graphic,f=this.getRenderingInfo(c);if(f){var h=f.renderer&&f.renderer.backgroundFillSymbol,l=c.geometry,s=this._projectGeometry(l,b),w=this._isPolygonMarkerSymbol(f.symbol.type,l),r=f.outlineSize;null==r&&(r=f.size);d.symbol=f.symbol;d.color=f.color;d.size=f.size;d.opacity=f.opacity;d.rotationAngle=f.rotationAngle;d.outlineSize=r;d.geometry=w?l&&l.centroid:l;d.projectedGeometry=s&&(w?s.centroid:s);d=this._bgVectors[e];w&&h?d?(d.symbol=h,d.outlineSize=f.outlineSize,d.geometry=l,d.projectedGeometry=
s):(this._bgVectors[e]=new k({graphic:c,symbol:h,outlineSize:f.outlineSize,geometry:l,projectedGeometry:s}),this.bgGroup.addVector(this._bgVectors[e])):d&&(this.bgGroup.removeVector(d),delete this._bgVectors[e])}}.bind(this));this.group.draw(!0);this.bgGroup.draw(!0);this.render()}},_resizeGraphics:function(){if(this.group){var a=this._vectors;Object.getOwnPropertyNames(a).forEach(function(b){var e=a[b],d=this.getRenderingInfo(e.graphic);if(d){var c=d.outlineSize;null==c&&(c=d.size);e.size=d.size;
e.outlineSize=c;if(e=this._bgVectors[b])e.outlineSize=d.outlineSize}}.bind(this))}},_createVectorGroup:function(){var a=this.mapView.state;return new e({view:this.mapView,x:a.x,y:a.y,resolution:a.resolution,rotation:a.rotation,surface:this.gfx.createGroup(),layer:this.view.layer})},_surfaceCreateHandler:function(a,b,e,d){a=this.mapView.state;this.gfx=h.createSurface(this.container.surface,a.width,a.height);this.bgGroup=this._createVectorGroup();this.group=this._createVectorGroup();this.addMany(this.graphics.toArray())}})})},
"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(h,l,c){l.switchTo(c);return l})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(h,l,c,f,b,a,e,k,g){var m=l.getObject("dojox.gfx",!0),n=m._base={};m._hasClass=function(a,b){var d=a.getAttribute("className");return d&&0<=(" "+d+" ").indexOf(" "+b+" ")};
m._addClass=function(a,b){var d=a.getAttribute("className")||"";if(!d||0>(" "+d+" ").indexOf(" "+b+" "))a.setAttribute("className",d+(d?" ":"")+b)};m._removeClass=function(a,b){var d=a.getAttribute("className");d&&a.setAttribute("className",d.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};n._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},d,e;f("ie")&&(e=b.doc.documentElement.style.fontSize||
"",e||(b.doc.documentElement.style.fontSize="100%"));var c=k.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(d in a)c.style.fontSize=d,a[d]=16*Math.round(12*c.offsetHeight/16)/12/1E3;f("ie")&&(b.doc.documentElement.style.fontSize=e);b.body().removeChild(c);return a};var d=null;n._getCachedFontMeasurements=function(a){if(a||!d)d=n._getFontMeasurements();
return d};var q=null,y={};n._getTextBox=function(a,d,e){var c,f,h=arguments.length,v;q||(q=k.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));c=q;c.className="";f=c.style;f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";if(1<h&&d)for(v in d)v in y||(f[v]=d[v]);2<h&&e&&(c.className=e);c.innerHTML=a;c.getBoundingClientRect?(f=c.getBoundingClientRect(),f={l:f.left,t:f.top,w:f.width||f.right-f.left,h:f.height||f.bottom-f.top}):f=g.getMarginBox(c);
c.innerHTML="";return f};n._computeTextLocation=function(a,b,d,e){var c={};switch(a.align){case "end":c.x=a.x-b;break;case "middle":c.x=a.x-b/2;break;default:c.x=a.x}c.y=a.y-d*(e?0.75:1);return c};n._computeTextBoundingBox=function(a){if(!m._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var d=a.getFont()||m.defaultFont;a=a.getTextWidth();d=m.normalizedLength(d.size);b=n._computeTextLocation(b,a,d,!0);return{x:b.x,y:b.y,width:a,height:d}};n._isRendered=function(a){for(a=
a.parent;a&&a.getParent;)a=a.parent;return null!==a};var p=0;n._getUniqueId=function(){var a;do a=h._scopeName+"xUnique"+ ++p;while(e.byId(a));return a};var u=f("pointer-events")?"touchAction":f("MSPointer")?"msTouchAction":null;n._fixMsTouchAction=u?function(a){a.rawNode.style[u]="none"}:function(){};l.mixin(m,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},
defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,
color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var d=a[b];if(d)return new d;d=a[b]=new Function;d.prototype=m["default"+b];return new d}}(),normalizeColor:function(a){return a instanceof
c?a:new c(a)},normalizeParameters:function(a,b){var d;if(b){var e={};for(d in a)d in b&&!(d in e)&&(a[d]=b[d])}return a},makeParameters:function(a,b){var d=null;if(!b)return l.delegate(a);var e={};for(d in a)d in e||(e[d]=l.clone(d in b?b[d]:a[d]));return e},formatNumber:function(a,b){var d=a.toString();if(0<=d.indexOf("e"))d=a.toFixed(4);else{var e=d.indexOf(".");0<=e&&5<d.length-e&&(d=a.toFixed(4))}return 0>a?d:b?" "+d:d},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+
a.size+" "+a.family},splitFontString:function(a){var b=m.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var d=a[3].indexOf("/");b.size=0>d?a[3]:a[3].substring(0,d);var e=4;0>d&&("/"==a[4]?e=6:"/"==a[4].charAt(0)&&(e=5));e<a.length&&(b.family=a.slice(e).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return m._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*m.px_in_pt()},px2pt:function(a){return a/
m.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=m.px_in_pt(),d=parseFloat(a);switch(a.slice(-2)){case "px":return d;case "pt":return d*b;case "in":return 72*d*b;case "pc":return 12*d*b;case "mm":return d*m.mm_in_pt*b;case "cm":return d*m.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===
b},switchTo:function(b){var d="string"==typeof b?m[b]:b;d&&(a.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){m[a]=d[a]}),"string"==typeof b?m.renderer=b:a.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return m.renderer=m[a]&&m[a].Surface===m.Surface?a:null}))}});return m})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window",
"dojo/_base/config"],function(h,l,c,f,b){var a=null;c.add("vml",function(a,b,c){c.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in c.firstChild;c.innerHTML="";return a});return{load:function(e,k,g){function m(){k(["dojox/gfx/"+n],function(b){h.renderer=n;a=b;g(b)})}if(a&&"force"!=e)g(a);else{var n=b.forceGfxRenderer;e=!n&&(l.isString(b.gfxRenderer)?b.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var d,q;!n&&e.length;)switch(e.shift()){case "svg":"SVGAngle"in f.global&&(n="svg");break;
case "vml":c("vml")&&(n="vml");break;case "silverlight":try{c("ie")?(d=new ActiveXObject("AgControl.AgControl"))&&d.IsVersionSupported("1.0")&&(q=!0):navigator.plugins["Silverlight Plug-In"]&&(q=!0)}catch(y){q=!1}finally{d=null}q&&(n="silverlight");break;case "canvas":f.global.CanvasRenderingContext2D&&(n="canvas")}"canvas"===n&&!1!==b.canvasEvents&&(n="canvasWithEvents");b.isDebug&&console.log("gfx renderer \x3d "+n);"svg"==n&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(m):m()}}}})},
"esri/views/2d/engine/Container":function(){define(["./DisplayObject","./bitFlagUtil"],function(h,l){return h.createSubclass({declaredClass:"esri.views.2D.engine.Container","-chains-":{childAdded:"after",childRemoved:"after"},constructor:function(){this.children=[];this.trash={children:[],ids:{}}},tag:"inherit",_stageSetter:function(c){var f=this._get("stage"),b=this.children,a,e;this.inherited(arguments);if(f!==c){if(b){a=0;for(e=b.length;a<e;a++)f=b[a],f.stage=c}return this._set("stage",c)}},_numChildrenGetter:function(){return this.children.length},
addChild:function(c){return this.addChildAt(c,this.children.length)},addChildAt:function(c,f){var b;if(this.contains(c))return c;(b=c.parent)&&b.removeChild(c);f=Math.min(this.children.length,f);this.children.splice(f,0,c);this.trash.ids[c.id]&&(this.trash.ids[c.id]=null,this.trash.children.splice(this.trash.children.indexOf(c),1));this.childAdded(c,f);this.notifyChange("numChildren");return c},childAdded:function(c,f){c.set({parent:this,stage:this.stage});this.requestRender()},removeAllChildren:function(){for(var c=
this.numChildren;c--;)this.removeChildAt(0)},removeChild:function(c){var f=this.children.indexOf(c);return-1<f?this.removeChildAt(f):c},removeChildAt:function(c){if(0>c||c>=this.children.length)return null;c=this.children.splice(c,1)[0];this.trash.ids[c.id]=c;this.trash.children.push(c);this.childRemoved(c);this.notifyChange("numChildren");return c},childRemoved:function(c){c.parent=null;c.stage=null;this.requestRender()},contains:function(c){return-1<this.getChildIndex(c)},getChildIndex:function(c){return this.children.indexOf(c)},
getChildAt:function(c){return 0>c||c>this.children.length?null:this.children[c]},setChildIndex:function(c,f){var b=this.getChildIndex(c);-1<b&&(this.children.splice(b,1),this.children.splice(f,0,c),this.requestRender())},requestChildRender:function(c){c&&c.parent===this&&this.requestRender()},reflow:function(c){var f=this.children,b=f.length,a;c.emptyTrash(this);c.pushParent(this);for(a=0;a<b;a++)c.reflowChild(f[a],a);c.popParent()},render:function(c){var f=this._flags;this._renderFlag=!1;this._flags=
0;f&&(l.isSet(f,h.SIZE)&&c.setSize(this.width,this.height),l.isSet(f,h.VISIBLE)&&c.setVisibility(this.visible),l.isSet(f,h.BLENDMODE)&&c.setBlendMode(this.blendMode),l.isSet(f,h.OPACITY)&&c.setOpacity(this.opacity));var b=(f=this.children)&&f.length||0,a;c.pushParent(this);for(a=0;a<b;a++)c.pushMatrix(),c.renderChild(f[a]),c.popMatrix();c.popParent()}})})},"esri/views/2d/engine/DisplayObject":function(){define("dojo/_base/lang ../../../core/Accessor ../math/common ../math/mat2d ../math/vec2 ./bitFlagUtil".split(" "),
function(h,l,c,f,b,a){var e=0,k=0,g={TRANSFORM:1<<k++,VISIBLE:1<<k++,SIZE:1<<k++,BLENDMODE:1<<k++,CLIP:1<<k++,OPACITY:1<<k++},m="multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity".split(" "),n=l.createSubclass({declaredClass:"esri.views.2d.engine.DisplayObject",tag:null,className:"esri-display-object",constructor:function(){this.id="esri-display-object-"+e++},_flags:0,_renderFlag:!1,_flipY:!0,properties:{blendMode:{value:"normal",
cast:function(a){return-1<m.indexOf(a)?a:"normal"},set:function(a){this._invalidateFlag(g.BLENDMODE);this._set("blendMode",a)}},coords:{set:function(a){this._invalidateFlag(g.TRANSFORM);this._set("coords",a)}},opacity:{value:1,cast:function(a){return Math.min(1,Math.max(a,0))},set:function(a){this._get("opacity")!==a&&(this._invalidateFlag(g.OPACITY),this._set("opacity",a))}},parent:{value:null,set:function(a){this._get("parent")!==a&&(a&&this._renderFlag&&a.requestChildRender(this),this._set("parent",
a))}},resolution:{value:NaN,set:function(a){this._get("resolution")!==a&&(this._invalidateFlag(g.TRANSFORM),this._set("resolution",a))}},rotation:{value:0,set:function(a){this._get("rotation")!==a&&(this._invalidateFlag(g.TRANSFORM),this._set("rotation",a||0))}},size:{value:null,set:function(a){this._get("size")!==a&&(this._invalidateFlag(g.SIZE),this._set("size",a))}},stage:{},surface:{},transform:{readOnly:!0,dependsOn:["rotation","coords","resolution","size"],get:function(){var a=this._get("transform"),
e=this.coords,g=this.size,k=this.resolution,h=this.rotation;if(e)if(k){if(!a||6!==a.length)a=f.create();g&&f.translate(a,a,g);f.scale(a,a,b.fromValues(1/k,(this._flipY?-1:1)*(1/k)));f.rotate(a,a,c.toRadian(h));f.translate(a,a,b.negate(b.create(),e))}else{if(!a||2!==a.length)return b.clone(e);b.copy(a,e)}else if(h){if(!a||6!==a.length)a=f.create();f.rotate(a,a,c.toRadian(h))}return a}},visible:{value:!0,set:function(a){this._get("visible")!==a&&(this._invalidateFlag(g.VISIBLE),this._set("visible",
a))}}},requestRender:function(){var a=this.parent;this._renderFlag||(this._renderFlag=!0,a&&a.requestChildRender(this))},createSurface:function(){if(!this.surface){var a=document.createElement("div");a.className=this.className;this.surface=a}return this.surface},reflow:function(a){},render:function(b){var e=this._flags;this._renderFlag=!1;this._flags=0;e&&(a.isSet(e,n.SIZE)&&b.setSize(this.width,this.height),a.isSet(e,n.VISIBLE)&&b.setVisibility(this.visible),a.isSet(e,n.BLENDMODE)&&b.setBlendMode(this.blendMode),
a.isSet(e,n.OPACITY)&&b.setOpacity(this.opacity))},_invalidateFlag:function(b){this._flags=a.set(this._flags,b,!0);this.requestRender()}});h.mixin(n,g);return n})},"esri/views/2d/engine/bitFlagUtil":function(){define([],function(){return{isSet:function(h,l){return l==(h&l)},set:function(h,l,c){if(c){if((h&l)===l)return h;h|=l}else{if(0===(h&l))return h;h&=~l}return h}}})},"esri/views/layers/GraphicsView":function(){define(["../../core/Accessor","../../core/declare"],function(h,l){return l([h],{declaredClass:"esri.views.layers.GraphicsView",
graphics:null,renderer:null,view:null,getRenderer:function(c){if(!c||c.symbol)return null;var f=this._rndForScale||this.renderer;c&&(f&&f.getObservationRenderer)&&(f=f.getObservationRenderer(c));return f},getSymbol:function(c){if(c.symbol)return c.symbol;var f=this.getRenderer(c);return f&&f.getSymbol(c)},getRenderingInfo:function(c){var f=this.getRenderer(c),b=this.getSymbol(c);if(!b)return null;b={renderer:f,symbol:b};if(f&&f.visualVariables){var a=this.view.view.state,f=f.getVisualVariableValues(c,
{resolution:a.resolution,scale:a.scale});c=["proportional","proportional","proportional"];for(a=0;a<f.length;a++){var e=f[a],k=e.variable.type;"color"===k?b.color=e.value:"size"===k?e.variable.target?b.outlineSize=e.value:(k=e.variable.axis,e=e.variable.useSymbolValue?"symbolValue":e.value,"width"===k?c[0]=e:"depth"===k?c[1]=e:"height"===k?c[2]=e:c[0]="width-and-depth"===k?c[1]=e:c[1]=c[2]=e):"opacity"===k?b.opacity=e.value:"rotation"===k&&(b.rotationAngle=e.value)}if(isFinite(c[0])||isFinite(c[1])||
isFinite(c[2]))b.size=c}return b},_evalSDRenderer:function(c){}})})},"esri/views/2d/layers/LayerView2D":function(){define(["../../layers/LayerVue","../../../core/watchUtils","../engine/Container"],function(h,l,c){return h.createSubclass({declaredClass:"esri.views.2d.layers.LayerView2D",classMetadata:{properties:{suspended:{dependsOn:["view.scale","layer.minScale","layer.maxScale"]}}},constructor:function(f){this.container=new c({visible:!1});this.watch("suspended",this._suspendedWatcher.bind(this));
this._opacityWatch=this.watch("fullOpacity",function(b){this.container.opacity=b}.bind(this));this._opacityWatch=this.watch("layer.blendMode",function(b){this.container.blendMode=b}.bind(this))},destroy:function(){this._opacityWatch.remove();this._opacityWatch=null;this.updateNeeded=!1;this.layer=null},_viewChangeHdl:null,_viewSetter:function(c){this.inherited(arguments);this._viewChangeHdl&&(this._viewChangeHdl.remove(),this._viewChangeHdl=null);c&&(this._viewChangeHdl=l.when(c,"state.transform",
function(b){this.emit("view-change")}.bind(this)));return c},hitTest:function(c,b){return null},needUpdate:function(){this.updateNeeded||(this.updateNeeded=!0,this.suspended||this.view.scheduleLayerViewUpdate(this))},_commitUpdate:function(){this.updateNeeded&&(this.updateNeeded=!1,this.update())},canResume:function(){var c=this.inherited(arguments);if(c){var c=this.view.scale,b=this.layer,a=b.minScale,b=b.maxScale,e=!a,k=!b;!e&&c<=a&&(e=!0);!k&&c>=b&&(k=!0);c=e&&k}return c},_suspendedWatcher:function(c){this.container.visible=
!c;!c&&this.updateNeeded&&this.view.scheduleLayerViewUpdate(this)}})})},"esri/views/layers/LayerVue":function(){define(["../../core/declare","../../core/Accessoire","../../core/Evented","../../core/AccessoirePromise"],function(h,l,c,f){var b=0;return h([l,c,f],{declaredClass:"esri.views.layers.LayerView",classMetadata:{properties:{refreshTimer:{readOnly:!0,dependsOn:["suspended","layer.refreshInterval"]},suspended:{dependsOn:["view","visible","layer.loaded","parent.suspended"],readOnly:!0},updating:{dependsOn:["suspended"],
value:!1},visible:{dependsOn:["layer.visible"]},fullOpacity:{dependsOn:["layer.opacity","parent.fullOpacity"]}}},constructor:function(){this.uid=Date.now().toString(16)+"-layerview-"+b++;this._layerHandles=[];this.watch("suspended",this._suspendedWatcher.bind(this))},initialize:function(){this.addResolvingPromise(this.layer)},destroy:function(){this.layer=this.parent=null},layer:null,_layerSetter:function(a){var b=this._layerHandles;b.forEach(function(a){a.remove()});b.length=0;a&&b.push(a.on("refresh",
this.refresh.bind(this)));return a},parent:null,_refreshTimerGetter:function(a){var b=this.suspended,c=this.get("layer.refreshInterval")||0;a&&(clearTimeout(a),a=null);!b&&c&&(a=setTimeout(this.refresh.bind(this),6E4*c));return a},suspended:!0,_suspendedGetter:function(){return!this.canResume()},_updating:!1,_updatingGetter:function(){return!(!this._updating||this.suspended)},_updatingSetter:function(a){this._updating=!!a},visible:!0,_visibleSetter:function(a){this._visible=a},_visibleGetter:function(){return null!=
this._visible?this._visible:this.get("layer.visible")},_fullOpacityGetter:function(){var a=this.get("layer.opacity"),a=null!=a?a:1,b=this.get("parent.fullOpacity");return a*(null!=b?b:1)},refresh:function(){},canResume:function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},_suspendedWatcher:function(a){a?this.emit("suspend"):this.emit("resume")}})})},"esri/views/2d/VectorGroup":function(){define("../../core/declare dojo/_base/lang dojox/gfx dojox/gfx/matrix ./math/common ./math/mat2d ./math/vec2 ./Projector ./viewpointUtils ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/webMercatorUtils ../../symbols/SimpleMarkerSymbol ../../symbols/support/gfxUtils ../../core/screenUtils ../../core/Accessoire".split(" "),
function(h,l,c,f,b,a,e,k,g,m,n,d,q,y,p,u){var s=0,w=-1!==c.renderer.toLowerCase().indexOf("svg"),r={"picture-marker-symbol":"image","picture-fill-symbol":"path","simple-fill-symbol":"path","simple-line-symbol":"path","cartographic-line-symbol":"path","text-symbol":"text"},t={square:1,cross:1,x:1,diamond:1,target:1};return h(u,{declaredClass:"esri.views.2d.VectorGroup",constructor:function(b){this.id="vecgp"+s++;this._transform=a.create();this._projector=new k;this.vectors=[];this.adding=[];this.removing=
[];this.updating=[]},applyState:function(b){if(this.transform){var d=a.invert(this._transform,this.transform);a.multiply(d,b.transformNoRotation,d);this.surface.setTransform({xx:d[0],yx:d[1],xy:d[2],yy:d[3],dx:d[4],dy:d[5]})}},requestVectorDraw:function(a){},addVector:function(a){return this.addVectorAt(a,this.vectors.length)},addVectorAt:function(a,b){b=Math.min(this.vectors.length,b);this.vectors.splice(b,0,a);a.set({parent:this,view:this.view});return a},removeVector:function(a){if(!this.vectors)return a;
var b=this.vectors.indexOf(a);-1<b&&(a=this.vectors.splice(b,1)[0],a.set({parent:null,view:null}),this._removeShape(a));return a},draw:function(a){this.transform||this._updateTransform();var b=this.view,e=b.state;if(0<e.width-e.worldScreenWidth){var c=e.size.concat();c[0]=Math.min(c[0],Math.round(e.worldScreenWidth));this._viewExtent=g.getExtent(new m,e.viewpoint,c)}else this._viewExtent=b.extent;this._viewGeoExtent=b.spatialReference.isWebMercator?d.webMercatorToGeographic(this._viewExtent,!0):null;
this.surface.openBatch();e=0;for(c=this.vectors.length;e<c;e++)(b=this.vectors[e])&&this.drawVector(b,a);this.surface.closeBatch()},drawVector:function(a,b){var d=a.extent,e=a.shape,c,g,k,f=a.geometry,h=a.projectedGeometry;if(a.graphic.visible&&d&&(c=this._getScreenOffsets(this.view,d))&&(g=a.symbol)){if(a.resolution!==this.resolution||a.rotation!==this.rotation||!a.offsets||!this._compareOffsets(a.offsets,c)?a.offsets=c:k=!0,!e||b||!k)d=f.type,a.resolution=this.resolution,a.rotation=this.rotation,
"point"===d?(this._isInvalidShape(g,e)&&this._removeShape(a),e=a.shape=this._drawPoint(this.surface,h||f,g,a,c),this._stylePoint(a,g)):"multipoint"===d?(e=a.shape=this._drawMarkers(this.surface,h||f,g,a,c),this._styleMarkers(a,g)):g&&(this._isInvalidShape(g,e)&&this._removeShape(a,!1),e=a.shape=this._drawShape(this.surface,h||f,a,c),this._styleShape(a,g)),e.getNode().vector=a}else e&&this._removeShape(a)},_compareOffsets:function(a,b){var d=!1;return d=a.length===b.length?a.every(function(a,d){return a===
b[d]}):!1},_getScreenOffsets:function(a,b){var d=b.spatialReference,d=this._viewGeoExtent&&4326===d.wkid?this._viewGeoExtent:this._viewExtent,e=d.spatialReference;if(e.isWrappable){var c=[],g=e._getInfo(),k=a.state.worldScreenWidth,e=b._partwise,f,h;f=d._getParts(g);e&&e.length?(h=[],e.forEach(function(a){h=h.concat(a._getParts(g))})):h=b._getParts(g);h.forEach(function(a){f.forEach(function(b){b.extent.intersects(a.extent)&&a.frameIds.forEach(function(a){a=(b.frameIds[0]-a)*k;-1===c.indexOf(a)&&
c.push(a)})}.bind(this))}.bind(this));return c.length?c.sort():null}return d.intersects(b)?[0]:null},_isInvalidShape:function(a,b){var d=b&&b.shape&&b.shape.type,e=a&&a.type,c=a&&a.style;e&&(c=r[e]||c);t[c]&&(c="path");return!(!d||!(c&&d!==c))},_removeShape:function(a,b){var d=a.shape,e=d&&d.getNode();d&&(d.removeShape(),d.destroy());a.shape=a.offsets=null;!1!==b&&this._removeBgShape(a);e&&(e.e_graphic=null)},_removeBgShape:function(a){var b=a.bgShape,d=b&&b.getNode();b&&(b.removeShape(),b.destroy());
a.bgShape=null;d&&(d.e_graphic=null)},_drawPoint:function(a,d,c,g,k,h){var l=c.type;d=this._projector.toScreenPoint(d,k[0]);var m=e.fromValues(d.x,d.y);d=m[0];k=m[1];var n=null!=h?g.shape&&g.shape.children[h]:g.shape,r;h=[];var t=g.rotationAngle,u;if(g=g.size)g=isFinite(g[0])&&g[0],u=!!g;g=u?p.pt2px(g):null;m={x:m[0],y:m[1]};if(null==t){var s=b.toRadian(360-this.view.rotation);h.push(f.rotateAt(s,m))}t&&h.push(f.rotategAt(t,m));t=p.pt2px(c.xoffset);s=p.pt2px(c.yoffset);(0!==t||0!==s)&&h.push(f.translate(t,
-s));0!==c.angle&&h.push(f.rotategAt(c.angle,m));if("simple-marker-symbol"===l)switch(r=c.style,l=Math.round,g=u?g:p.pt2px(c.size),r){case q.STYLE_SQUARE:case q.STYLE_CROSS:case q.STYLE_X:case q.STYLE_DIAMOND:c=isNaN(g)?16:g/2;r=this._drawPath(a,n,this._smsToPath(q,r,d,k,l(d-c),l(d+c),l(k-c),l(k+c)));break;case q.STYLE_TARGET:u=p.pt2px(c._targetWidth)/2;m=p.pt2px(c._targetHeight)/2;r=this._drawPath(a,n,this._smsToPath(q,r,d,k,l(d-u),l(d+u),l(k-m),l(k+m),p.pt2px(c._spikeSize)));break;case q.STYLE_PATH:r=
this._drawPath(a,n,c.path,!0);c=r.getBoundingBox();a=this._getScaleMatrix(c,g);(1!==a.xx||1!==a.yy)&&h.push(f.scaleAt(a.xx,a.yy,m));h.push(f.translate(-(c.x+c.width/2)+d,-(c.y+c.height/2)+k));break;default:c=isNaN(g)?16:g/2,r=this._drawCircle(a,n,{cx:d,cy:k,r:c})}else if("shield-label-symbol"===l)m=p.pt2px(c.width),u=p.pt2px(c.height),r=a.createGroup(),n=a.createImage({x:d-m/2,y:k-u/2,width:m,height:u,src:c.url}),r.add(n),null!=c.font&&(k+=0.2*p.pt2px(c.getHeight()),a=a.createText({type:"text",text:c.text,
x:d,y:k,align:"middle",decoration:c.decoration,rotated:c.rotated,kerning:c.kerning}),u=c.font.clone(),u.size=p.pt2px(u.size),a.setFont(u),a.setFill(c.color),r.add(a));else if("picture-marker-symbol"===l)m=u?g:p.pt2px(c.width),u=u?g:p.pt2px(c.height),r=this._drawImage(a,n,{x:d-m/2,y:k-u/2,width:m,height:u,src:c.url});else if("text-symbol"===l){if(u=c.font)u=u.clone(),u.size=null!=g?g:p.pt2px(u.size);r=this._drawText(a,n,{type:"text",text:c.text,x:d,y:k,align:y.getSVGAlign(c),decoration:c.decoration||
u&&u.decoration,rotated:c.rotated,kerning:c.kerning});u&&r.setFont(u);w&&(a=r.getNode(),d=y.getSVGBaseline(c),c=y.getSVGBaselineShift(c),a&&(a.setAttribute("dominant-baseline",d),c&&a.setAttribute("baseline-shift",c)))}r.setTransform(f.multiply(h));return r},_getScaleMatrix:function(a,b){var d=a.width/a.height,c=1,e=1;isNaN(b)||(1<d?(c=b/a.width,e=b/d/a.height):(e=b/a.height,c=b*d/a.width));return{xx:c,yy:e}},_drawMarkers:function(a,b,d,c,e){var g=b.points;a=c.shape||a.createGroup();var k,f,h=g.length,
m=[],l=0,q,p=e?e.length:0;a.children[0]&&this._isInvalidShape(d,a.children[0])&&a.clear();for(f=0;f<h;f++){k=g[f];for(q=0;q<p;q++)m[0]=e[q],a.add(this._drawPoint(a,{x:k[0],y:k[1],spatialReference:b.spatialReference},d,c,m,l++))}b=a.children.length;if(h*e.length<b)for(f=b-1;f>=h*e.length;f--)a.children[f].removeShape();return a},_drawShape:function(a,b,d,c){var e=b.type;d=d.shape;var g=this._projector,k=[],f,h;"extent"===e&&(b=n.fromExtent(b),e=b.type);if("polyline"===e||"polygon"===e){f=0;for(h=c.length;f<
h;f++)k=k.concat(g.toScreenPath(b,c[f]));d=this._drawPath(a,d,k);this._rendererLimits&&("polyline"===e?this._clipPolyline(d,b):this._clipPolygon(d,b))}return d},_drawRect:function(a,b,d){return b?b.setShape(d):a.createRect(d)},_drawImage:function(a,b,d){return b?b.setShape(d):a.createImage(d)},_drawCircle:function(a,b,d){return b?b.setShape(d):a.createCircle(d)},_drawPath:function(a,b,d,c){d=c?d:d.join(" ");return b?b.setShape(d):a.createPath(d)},_drawText:function(a,b,d){return b?b.setShape(d):a.createText(d)},
_smsToPath:function(a,b,d,c,e,g,k,f,h){switch(b){case a.STYLE_SQUARE:return["M",e+","+k,g+","+k,g+","+f,e+","+f,"Z"];case a.STYLE_CROSS:return["M",d+","+k,d+","+f,"M",e+","+c,g+","+c];case a.STYLE_X:return["M",e+","+k,g+","+f,"M",e+","+f,g+","+k];case a.STYLE_DIAMOND:return["M",d+","+k,g+","+c,d+","+f,e+","+c,"Z"];case a.STYLE_TARGET:return["M",e+","+k,g+","+k,g+","+f,e+","+f,e+","+k,"M",e-h+","+c,e+","+c,"M",d+","+(k-h),d+","+k,"M",g+h+","+c,g+","+c,"M",d+","+(f+h),d+","+f]}},_stylePoint:function(a,
b,d){var c=b.type,e=b.style;d=null!=d?a.shape&&a.shape.children[d]:a.shape;if(!("shield-label-symbol"===c||"picture-marker-symbol"===c)){var g=y.getStroke(b);b=y.getFill(b);var e=e===q.STYLE_X||e===q.STYLE_CROSS,k=g&&g.color,f=a.color||(e?k:b);a=a.opacity;f&&null!=a&&(f=this._applyOpacity(f,a));f&&(e?f!==k&&(g=g?l.mixin({},g):{},g.color=f):f!==b&&(b=f));"text-symbol"===c?d.setFill(b):"simple-marker-symbol"===c&&d.setFill(b).setStroke(g)}},_styleMarkers:function(a,b){var d,c=a.shape.children.length;
for(d=0;d<c;d++)this._stylePoint(a,b,d)},_styleShape:function(a,b){var d=y.getStroke(b),c=y.getFill(b),e=b.type,g=a.shape,k=a.outlineSize,f=-1!==e.indexOf("line-symbol"),h=f?"none"!==b.style:b.outline&&"none"!==b.outline.style,m,q,r;k&&Array.isArray(k)&&(k=isFinite(k[0])&&k[0]);k=null!=k?p.pt2px(k):null;if((a.color||null!=a.opacity)&&"picture-fill-symbol"!==e)e=a.color,m=a.opacity,f?(q=e||d&&d.color)&&null!=m&&(q=this._applyOpacity(q,m)):c&&c.toCss&&(r=e||c)&&null!=m&&(r=this._applyOpacity(r,m));
g.setStroke(!h||null==k&&!q?d:l.mixin({},d,null!=k?{width:k}:null,q&&{color:q})).setFill(r||c);w&&g.rawNode.setAttribute("vector-effect","non-scaling-stroke")},_applyOpacity:function(a,b){null!=b&&(a=a.clone(),a.a=b);return a},_updateTransform:function(){var b=this.transform=this.transform||a.create(),d=this.resolution,c=e.fromValues(0.5*this.view.width,0.5*this.view.height),g=e.fromValues(1/d,-1/d),k=e.fromValues(-this.x,-this.y);a.identity(b);a.translate(b,b,c);a.scale(b,b,g);a.translate(b,b,k);
b[4]=Math.round(b[4]);b[5]=Math.round(b[5]);this._projector.set({resolution:d,transform:b})}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(h,l){var c=h.matrix={},f={};c._degToRad=function(b){return f[b]||(f[b]=Math.PI*b/180)};c._radToDeg=function(b){return 180*(b/Math.PI)};c.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var a=c.normalize(b[0]),e=1;e<b.length;++e){var k=a,g=c.normalize(b[e]),a=new c.Matrix2D;
a.xx=k.xx*g.xx+k.xy*g.yx;a.xy=k.xx*g.xy+k.xy*g.yy;a.yx=k.yx*g.xx+k.yy*g.yx;a.yy=k.yx*g.xy+k.yy*g.yy;a.dx=k.xx*g.dx+k.xy*g.dy+k.dx;a.dy=k.yx*g.dx+k.yy*g.dy+k.dy}l.mixin(this,a)}}else l.mixin(this,b)};l.extend(c.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});l.mixin(c,{identity:new c.Matrix2D,flipX:new c.Matrix2D({xx:-1}),flipY:new c.Matrix2D({yy:-1}),flipXY:new c.Matrix2D({xx:-1,yy:-1}),translate:function(b,a){return 1<arguments.length?new c.Matrix2D({dx:b,dy:a}):new c.Matrix2D({dx:b.x,dy:b.y})},scale:function(b,
a){return 1<arguments.length?new c.Matrix2D({xx:b,yy:a}):"number"==typeof b?new c.Matrix2D({xx:b,yy:b}):new c.Matrix2D({xx:b.x,yy:b.y})},rotate:function(b){var a=Math.cos(b);b=Math.sin(b);return new c.Matrix2D({xx:a,xy:-b,yx:b,yy:a})},rotateg:function(b){return c.rotate(c._degToRad(b))},skewX:function(b){return new c.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return c.skewX(c._degToRad(b))},skewY:function(b){return new c.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return c.skewY(c._degToRad(b))},
reflect:function(b,a){1==arguments.length&&(a=b.y,b=b.x);var e=b*b,k=a*a,g=e+k,f=2*b*a/g;return new c.Matrix2D({xx:2*e/g-1,xy:f,yx:f,yy:2*k/g-1})},project:function(b,a){1==arguments.length&&(a=b.y,b=b.x);var e=b*b,k=a*a,g=e+k,f=b*a/g;return new c.Matrix2D({xx:e/g,xy:f,yx:f,yy:k/g})},normalize:function(b){return b instanceof c.Matrix2D?b:new c.Matrix2D(b)},isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(b){var a=new c.Matrix2D,e;for(e in b)"number"==
typeof b[e]&&("number"==typeof a[e]&&a[e]!=b[e])&&(a[e]=b[e]);return a},invert:function(b){b=c.normalize(b);var a=b.xx*b.yy-b.xy*b.yx;return b=new c.Matrix2D({xx:b.yy/a,xy:-b.xy/a,yx:-b.yx/a,yy:b.xx/a,dx:(b.xy*b.dy-b.yy*b.dx)/a,dy:(b.yx*b.dx-b.xx*b.dy)/a})},_multiplyPoint:function(b,a,c){return{x:b.xx*a+b.xy*c+b.dx,y:b.yx*a+b.yy*c+b.dy}},multiplyPoint:function(b,a,e){b=c.normalize(b);return"number"==typeof a&&"number"==typeof e?c._multiplyPoint(b,a,e):c._multiplyPoint(b,a.x,a.y)},multiplyRectangle:function(b,
a){var e=c.normalize(b);a=a||{x:0,y:0,width:0,height:0};if(c.isIdentity(e))return{x:a.x,y:a.y,width:a.width,height:a.height};var k=c.multiplyPoint(e,a.x,a.y),g=c.multiplyPoint(e,a.x,a.y+a.height),f=c.multiplyPoint(e,a.x+a.width,a.y),h=c.multiplyPoint(e,a.x+a.width,a.y+a.height),e=Math.min(k.x,g.x,f.x,h.x),d=Math.min(k.y,g.y,f.y,h.y),l=Math.max(k.x,g.x,f.x,h.x),k=Math.max(k.y,g.y,f.y,h.y);return{x:e,y:d,width:l-e,height:k-d}},multiply:function(b){for(var a=c.normalize(b),e=1;e<arguments.length;++e){var k=
a,g=c.normalize(arguments[e]),a=new c.Matrix2D;a.xx=k.xx*g.xx+k.xy*g.yx;a.xy=k.xx*g.xy+k.xy*g.yy;a.yx=k.yx*g.xx+k.yy*g.yx;a.yy=k.yx*g.xy+k.yy*g.yy;a.dx=k.xx*g.dx+k.xy*g.dy+k.dx;a.dy=k.yx*g.dx+k.yy*g.dy+k.dy}return a},_sandwich:function(b,a,e){return c.multiply(c.translate(a,e),b,c.translate(-a,-e))},scaleAt:function(b,a,e,k){switch(arguments.length){case 4:return c._sandwich(c.scale(b,a),e,k);case 3:return"number"==typeof e?c._sandwich(c.scale(b),a,e):c._sandwich(c.scale(b,a),e.x,e.y)}return c._sandwich(c.scale(b),
a.x,a.y)},rotateAt:function(b,a,e){return 2<arguments.length?c._sandwich(c.rotate(b),a,e):c._sandwich(c.rotate(b),a.x,a.y)},rotategAt:function(b,a,e){return 2<arguments.length?c._sandwich(c.rotateg(b),a,e):c._sandwich(c.rotateg(b),a.x,a.y)},skewXAt:function(b,a,e){return 2<arguments.length?c._sandwich(c.skewX(b),a,e):c._sandwich(c.skewX(b),a.x,a.y)},skewXgAt:function(b,a,e){return 2<arguments.length?c._sandwich(c.skewXg(b),a,e):c._sandwich(c.skewXg(b),a.x,a.y)},skewYAt:function(b,a,e){return 2<arguments.length?
c._sandwich(c.skewY(b),a,e):c._sandwich(c.skewY(b),a.x,a.y)},skewYgAt:function(b,a,e){return 2<arguments.length?c._sandwich(c.skewYg(b),a,e):c._sandwich(c.skewYg(b),a.x,a.y)}});h.Matrix2D=c.Matrix2D;return c})},"esri/views/2d/Projector":function(){define(["../../core/Accessoire","../../geometry/Polyline"],function(h,l){var c=function(f,b){var a=f.length,e=f[0],k=f[a-1],g=0,h=0,l,d;for(l=1;l<a-1;l++){d=f[l];var q=e,y=k,p=void 0,u=void 0,p=void 0;q[0]===y[0]?p=Math.abs(d[0]-q[0]):(p=(y[1]-q[1])/(y[0]-
q[0]),u=q[1]-p*q[0],p=Math.abs(p*d[0]-d[1]+u)/Math.sqrt(p*p+1));d=p;d>g&&(h=l,g=d)}g>b?(a=c(f.slice(0,h+1),b),h=c(f.slice(h),b),h=a.concat(h)):h=[e,k];return h};return h.createSubclass({_transformSetter:function(c){this._transformers=[];return c},toScreenPoint:function(c,b,a){b=this.getTransformer(b);a||(a={x:0,y:0});b.transformPoint(c.x,c.y,function(b,c){a.x=b;a.y=c});return a},toScreenPath:function(f,b){var a=f instanceof l,e=a?f.paths:f.rings,k=this.getTransformer(b),g=[],h,n,d=function(a,b){g.push(a+
","+b)};if(e){h=0;for(n=e.length;h<n;h++)g.push("M"),k.forEach(c(e[h],this.resolution),d),a||g.push("Z")}return g},getTransformer:function(c){if(!this._transformers[c]){var b=this.transform,a=b[0],e=b[1],k=b[2],g=b[3],h=b[4]+c,l=b[5],d=0!==e&&0!==k,q,y,p=Math.round;this._transformers[c]={transformPoint:function(){return d?function(b,d,c){c(p(a*b+k*d+h),p(e*b+g*d+l))}:function(b,d,c){c(p(a*b+h),p(g*d+l))}}(),forEach:function(a,b){q=0;for(y=a.length;q<y;q++)this.transformPoint(a[q][0],a[q][1],b)}}}return this._transformers[c]}})})},
"esri/symbols/support/gfxUtils":function(){define(["require","dojo/_base/lang","dojox/gfx/_base","../../core/screenUtils"],function(h,l,c,f){var b=h.toUrl("../../symbols/patterns/"),a={left:"start",center:"middle",right:"end",justify:"start"},e={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},k=function(a){var d=null,e=a.style;if(a){var g=a.constructor;switch(a.type){case "simple-marker-symbol":e!==g.STYLE_CROSS&&e!==g.STYLE_X&&(d=a.color);break;case "simple-fill-symbol":e===
g.STYLE_SOLID?d=a.color:e!==g.STYLE_NULL&&(d=l.mixin({},c.defaultPattern,{src:b+e+".png",width:10,height:10}));break;case "picture-fill-symbol":d=l.mixin({},c.defaultPattern,{src:a.url,width:f.pt2px(a.width)*a.xscale,height:f.pt2px(a.height)*a.yscale,x:f.pt2px(a.xoffset),y:f.pt2px(a.yoffset)});break;case "text-symbol":d=a.color}}return d},g=function d(a){var b=null;if(a){var c=a.constructor,e=f.pt2px(a.width);switch(a.type){case "simple-fill-symbol":case "picture-fill-symbol":case "simple-marker-symbol":b=
d(a.outline);break;case "simple-line-symbol":a.style!==c.STYLE_NULL&&0!==e&&(b={color:a.color,style:m(a.style),width:e});break;case "cartographic-line-symbol":a.style!==c.STYLE_NULL&&0!==e&&(b={color:a.color,style:m(a.style),width:e,cap:a.cap,join:a.join===c.JOIN_MITER?f.pt2px(a.miterLimit):a.join});break;default:b=null}}return b},m=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();return{getFill:k,getStroke:g,getShapeDescriptors:function(a){if(!a)return{defaultShape:null,
fill:null,stroke:null};var b={fill:k(a),stroke:g(a)},e=a.constructor,h=e.defaultProps,l=null;switch(a.type){case "simple-marker-symbol":var m=a.style,h=0.5*f.pt2px(a.size||h.size),w=-h,r=+h,t=-h,z=+h;switch(m){case e.STYLE_CIRCLE:l={type:"circle",cx:0,cy:0,r:h};break;case e.STYLE_CROSS:l={type:"path",path:"M "+w+",0 L "+r+",0 M 0,"+t+" L 0,"+z+" E"};break;case e.STYLE_DIAMOND:l={type:"path",path:"M "+w+",0 L 0,"+t+" L "+r+",0 L 0,"+z+" L "+w+",0 Z"};break;case e.STYLE_SQUARE:l={type:"path",path:"M "+
w+","+z+" L "+w+","+t+" L "+r+","+t+" L "+r+","+z+" L "+w+","+z+" Z"};break;case e.STYLE_X:l={type:"path",path:"M "+w+","+z+" L "+r+","+t+" M "+w+","+t+" L "+r+","+z+" E"};break;case e.STYLE_PATH:l={type:"path",path:a.path||""}}break;case "simple-line-symbol":case "cartographic-line-symbol":l={type:"path",path:"M -15,0 L 15,0 E"};break;case "picture-fill-symbol":case "simple-fill-symbol":l={type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 E"};break;case "picture-marker-symbol":l={type:"image",
x:-Math.round(f.pt2px(a.width)/2),y:-Math.round(f.pt2px(a.height)/2),width:f.pt2px(a.width),height:f.pt2px(a.height),src:a.source&&a.source.imageData?"data:"+a.source.contentType+";base64,"+a.source.imageData:a.url||""};break;case "text-symbol":e=a.font,m=f.pt2px(e.size),l={type:"text",text:a.text,x:0,y:0.25*c.normalizedLength(e?m:0),align:"middle",decoration:a.decoration||e&&e.decoration,rotated:a.rotated,kerning:a.kerning},b.font=e&&{size:m,style:e.style,variant:e.variant,decoration:e.decoration,
weight:e.weight,family:e.family}}b.defaultShape=l;return b},getSVGAlign:function(b){return b=(b=b.horizontalAlignment)&&a[b.toLowerCase()]||"middle"},getSVGBaseline:function(a){return(a=a.verticalAlignment)&&e[a.toLowerCase()]||"alphabetic"},getSVGBaselineShift:function(a){return"bottom"===a.verticalAlignment?"super":null}}})},"esri/views/2d/Vector":function(){define(["../../core/declare","../../geometry/Extent","../../core/Accessoire"],function(h,l,c){var f=0;return h([c],{declaredClass:"esri.views.2d.Vector",
constructor:function(){this.id="vec"+f++},_graphicSetter:function(b,a){if(b===a)return a;this.extent=b?this._getGraphicExtent(b):null;this.graphicChanged();return b},_symbolSetter:function(b,a){if(b===a)return a;this._symbolChangeHandle&&(this._symbolChangeHandle.remove(),this._symbolChangeHandle=null);this.symbolChanged();return b},_colorSetter:function(b,a){if(b===a)return a;this.symbolChanged();return b},_sizeSetter:function(b,a){if(b===a)return a;this.symbolChanged();return b},_opacitySetter:function(b,
a){if(b===a)return a;this.symbolChanged();return b},_rotationAngleSetter:function(b,a){if(b===a)return a;this.symbolChanged();return b},_outlineSizeSetter:function(b,a){if(b===a)return a;this.symbolChanged();return b},_geometrySetter:function(b,a){if(b===a)return a;this.graphicChanged();return b},_projectedGeometrySetter:function(b,a){if(b===a)return a;this.graphicChanged();return b},_parentSetter:function(b,a){if(b===a)return a;b&&this._requestDrawFlag&&b.requestVectorDraw(this);return b},graphicChanged:function(){this._graphicChanged=
!0;this.requestDraw()},symbolChanged:function(){this._symbolChanged=!0;this.requestDraw()},rendered:function(){this._symbolChanged=this._graphicChanged=!1},requestDraw:function(){this._requestDrawFlag||(this._requestDrawFlag=!0,this.parent&&this.parent.requestVectorDraw(this))},_getGraphicExtent:function(b){b=b.geometry;var a=null;if(b&&(a=b.extent,!a)){var c;if("esri.geometry.Point"===b.declaredClass)a=b.x,c=b.y;else if("esri.geometry.Multipoint"===b.declaredClass)a=b.points[0][0],c=b.points[0][1];
else return null;a=new l(a,c,a,c,b.spatialReference)}return a}})})},"esri/views/2d/handlers/Navigation":function(){define(["../../../core/declare","dojo/keys","../../../core/sniff","../../inputs/Handler","../../2d/viewpointUtils"],function(h,l,c,f,b){return h(f,{declaredClass:"esri.views.2d.handlers.Navigation",constructor:function(){!1!==this.mouseRotate&&null!=this.mouseRotate&&(this.altdrag=this._altdrag)},_scrollAccum:0,_scrollTimeout:null,_lastPosition:null,_canZoom:!0,mouseRotate:c("mac")?l.META:
l.CTRL,mouseZoomOut:l.SHIFT,mouseWheelZoom:!0,drag:function(a){var c=a.deltaX,k=a.deltaY,g=a.lastEvent,c=g?g.deltaX-c:-c,k=g?k-g.deltaY:k,g=this.view,f=a.eventType;f==this._phaseDict.START&&(g.interacting=!0);f>=this._phaseDict.END?(g.interacting=!1,this._coords=this._lastPosition=null):(g.interacting||(g.interacting=!0),0===c&&0===k||(this._hasRotateKey(a.srcEvent)?this._altdrag(a):g.viewpoint=b.translateBy(this.viewpoint,g.viewpoint,[c||0,k||0])))},"double-click":function(a){var b=a.srcEvent.shiftKey?
0.5:2,c=this.view;a=a.screenPoint;c.interacting=!1;c.goTo(this._scaleAndRotateViewpoint(a.x,a.y,b))},pinch:function(a){var b=this.view,c=a.lastEvent,g=a.scale,f=a.rotation,h=a.eventType;if(!(1===g&&0===f)){a=a.screenPoint;var f=c?f-c.rotation:f,g=c?g/c.scale:g,c=Math.abs(1-g),d=Math.abs(f/90);h>=this._phaseDict.END?(b.interacting=!1,b.constraints._zoom.enabled=!0,b.goTo(b.viewpoint)):(!1===b.interacting&&(b.interacting=!0,b.constraints._zoom.enabled=!1),c>=d&&1!==g?b.viewpoint=this._scaleAndRotateViewpoint(a.x,
a.y,g):d>c&&0!==f&&(b.viewpoint=this._scaleAndRotateViewpoint(a.x,a.y,g,f)))}},scroll:function(a){if(this.mouseWheelZoom){var b=this.view,c=a.scrollDelta,g=a.screenPoint.x;a=a.screenPoint.y;if(!(0===c||-0===c)&&this._canZoom)this._canZoom=!1,b.interacting=!1,b.goTo(this._scaleAndRotateViewpoint(g,a,0>c?0.5:2)),this._scrollTimeout=setTimeout(function(){this._canZoom=!0}.bind(this),100)}},click:function(a){a.mapPoint=this.view.toMap(a.screenPoint)},hold:function(a){this.view.emit("hold",a)},altdrag:function(a){},
_altdrag:function(a){var c=a.deltaX,k=a.deltaY,g=a.lastEvent,c=g?g.deltaX-c:-c,k=g?g.deltaY-k:k,g=this.view,f=0,f=a.eventType;a=[a.screenPoint.x,a.screenPoint.y];f==this._phaseDict.START&&(g.interacting=!0);f>=this._phaseDict.END?(g.interacting=!1,this._coords=this._lastPosition=null):(g.interacting||(g.interacting=!0),0===c&&0===k||(f=b.angleBetween(g.state.paddedScreenCenter,this._lastPosition||a,a),g.viewpoint=b.rotateBy(this.viewpoint,g.content.viewpoint,f),c=this._lastPosition,this._lastPosition=
a,this._coords=c))},_contextStop:function(a){a.preventDefault()},_scaleAndRotateViewpoint:function(a,c,k,g){var f=this.view;a=[a,c];c=[];b.getPaddingScreenTranslation(c,f.size,f.padding);var h=f.animation?f.animation.target:f.viewpoint;a[0]+=c[0];a[1]+=c[1];return null==g||!1===g?b.scaleBy(this.viewpoint,h,k,a,f.size):b.scaleAndRotateBy(this.viewpoint,h,k,g,a,f.content.size)},_hasRotateKey:function(a){var b=c("mac")?l.META:l.CTRL,k=!1;if(!1===b)return k;a.altKey&&b==l.ALT?k=!0:a.ctrlKey&&b==l.CTRL?
k=!0:a.metaKey&&b==l.META?k=!0:a.shiftKey&&b==l.SHIFT&&(k=!0);return k}})})},"esri/views/inputs/Handler":function(){define(["../../core/Accessoire","../../core/declare","../2d/viewpointUtils"],function(h,l,c){return l([h],{declaredClass:"esri.views.Handler",classMetadata:{properties:{surface:{dependsOn:["view.surface"]}}},constructor:function(f){this.viewpoint=c.create()},destroy:function(){this.view=null},next:null,customGestures:null,viewpoint:null,_surfaceGetter:function(){return this.get("view.surface")},
_phaseDict:{1:"start",2:"move",4:"end",8:"cancel",START:1,MOVE:2,END:4,CANCEL:8},_eventsGetter:function(){var c=Object.keys(this.constructor.prototype),b=Object.keys(h.prototype);return c.filter(function(a){return a&&"_"!==a[0]&&0!==a.indexOf("get")&&"events"!==a&&"function"==typeof this[a]&&0>b.indexOf(a)},this)}})})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),
function(h,l,c,f,b,a,e){return function(a){function g(){a.call(this)}c(g,a);g.prototype.getDefaults=function(){return e.mixin(this.inherited(arguments),{components:["attribution","zoom"]})};return g=f([b.subclass("esri.views.ui.2d.DefaultUI2D")],g)}(b.declared(a))})},"esri/views/ui/ZoomBox":function(){define("dojo/_base/lang dojo/dom-construct ../../core/Accessoire ../../core/HandleRegistry ../../core/requestAnimationFrame ../2d/handlers/ZoomBox".split(" "),function(h,l,c,f,b,a){var e={container:"esri-zoom-box__container",
overlay:"esri-zoom-box__overlay",background:"esri-zoom-box__overlay-background",box:"esri-zoom-box__outline"};return c.createSubclass({declaredClass:"esri.views.ui.ZoomBox",constructor:function(){this._event={x:0,y:0,width:0,height:0};this._handles=new f;this._redraw=this._redraw.bind(this)},destroy:function(){this.view=null},_container:null,_overlay:null,_backgroundShape:null,_boxShape:null,_handler:null,_handles:null,_event:null,view:null,_viewSetter:function(b,c){this._handler&&(this._handles.removeAll(),
this.view.removeHandler(this._handler),this._handler=this._handler.view=null,this._destroyOverlay(c));if(b){var e=this._handler=new a({view:b});b.addHandler(e);this._handles.add(e.on("start",this._startHandler.bind(this)),e.on("update",this._updateHandler.bind(this)),e.on("end",this._endHandler.bind(this)))}return b},css:e,_updateBox:function(a,b,c,f){var d=this._boxShape;d.setAttributeNS(null,"x",a);d.setAttributeNS(null,"y",b);d.setAttributeNS(null,"width",c);d.setAttributeNS(null,"height",f);d.setAttributeNS(null,
"class",e.box)},_updateBackground:function(a,b,c,e){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,b,c,e,this.view.width,this.view.height))},_createContainer:function(){var a=l.create("div",{className:e.container});this.view.root.appendChild(a);this._container=a},_createOverlay:function(){var a=this.view.width,b=this.view.height,c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+b+" L 0 "+b+" Z");c.setAttributeNS(null,
"class",e.background);a=document.createElementNS("http://www.w3.org/2000/svg","rect");b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");b.setAttributeNS(null,"class",e.overlay);b.appendChild(c);b.appendChild(a);this._container.appendChild(b);this._backgroundShape=c;this._boxShape=a;this._overlay=b},_destroyOverlay:function(a){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);
this._container=this._backgroundShape=this._boxShape=this._overlay=null},_toSVGPath:function(a,b,c,e,d,f){c=a+c;e=b+e;return"M 0 0 L "+d+" 0 L "+d+" "+f+" L 0 "+f+" ZM "+a+" "+b+" L "+a+" "+e+" L "+c+" "+e+" L "+c+" "+b+" Z"},_redraw:function(){this._rafId=null;if(this._overlay){var a=this._event;this._updateBox(a.x,a.y,a.width,a.height);this._updateBackground(a.x,a.y,a.width,a.height);this._rafId=b(this._redraw)}},_startHandler:function(a){this._createContainer();this._createOverlay()},_updateHandler:function(a){h.mixin(this._event,
a);this._rafId||(this._rafId=b(this._redraw))},_endHandler:function(a){var b=this.view,c=b.toMap(a.x+0.5*a.width,a.y+0.5*a.height),e=Math.min(a.width/b.width,a.height/b.height);-1===a.direction&&(e=1/e);this._destroyOverlay();b.goTo({center:c,scale:b.scale*e})}})})},"esri/views/2d/handlers/ZoomBox":function(){define(["../../../core/Evented","../../inputs/Handler"],function(h,l){return l.createSubclass([h],{declaredClass:"esri.views.2d.handlers.ZoomBox",constructor:function(){this._event={x:0,y:0,
width:0,height:0}},_panStarted:!1,_startCoords:{},view:null,enabled:!1,drag:function(c){var f=this._event,b=c.eventType,a=c.screenPoint.x,e=c.screenPoint.y,k=this._startCoords.x||null,g=this._startCoords.y||null;!0===c.srcEvent.shiftKey&&(!1===this._panStarted&&4!==b)&&(this._panStarted=!0,b=this._phaseDict.START);if(b===this._phaseDict.START&&!0===c.srcEvent.shiftKey)return c.preventDefault(),this.enabled=!0,this._startCoords={x:a,y:e},f.x=a,f.y=e,f.width=0,f.height=0,this.emit("start",f),!1;a>k?
(f.x=k,f.width=a-k):(f.x=a,f.width=k-a);e>g?(f.y=g,f.height=e-g):(f.y=e,f.height=g-e);if(this.enabled)return c.preventDefault(),b>=this._phaseDict.END?(this.enabled=!1,this._startCoords={},this._panStarted=!1,f.direction=c.srcEvent.ctrlKey?-1:1,this.emit("end",f)):this.emit("update",f),!1}})})},"esri/views/2d/engine/Stage":function(){define(["../../../core/Accessoire","../../../core/HandleRegistry","./cssUtils","./Container","./RenderContext"],function(h,l,c,f,b){return h.createSubclass({classMetadata:{properties:{clipVisible:{}}},
constructor:function(){this._handles=new l},getDefaults:function(a){return{context:new b,root:new f,wrapper:new f({stage:this,parent:this,surface:a.container})}},initialize:function(){this._handles.add(this.watch("clipVisible",this.rerender.bind(this)))},destroy:function(){this.stop();this._handles.destroy();this._handles=null},_rerender:!1,clipVisible:!0,_stateSetter:function(a,b){b&&this._handles.remove("version");a&&this._handles.add(a.watch("version",this.rerender.bind(this)),"version");return a},
rerender:function(){this._rerender||(this._rerender=!0,this._running&&this.task.isPaused()&&this.task.resume())},run:function(){this._running||(this.wrapper.addChild(this.root),this.task=this.scheduler.addFrameTask({render:this._render.bind(this)}),this._running=!0)},stop:function(){this._running&&(this.wrapper.removeChild(this.root),this.task.remove(),this.task=null,this._running=!1)},addChild:function(a){return this.root.addChild(a)},addChildAt:function(a,b){return this.root.addChildAt(a,b)},removeChild:function(a){return this.root.removeChild(a)},
removeAllChildren:function(){this.root.removeAllChildren()},removeChildAt:function(a){return this.root.removeChildAt(a)},contains:function(a){return this.root.contains(a)},getChildIndex:function(a){return this.root.getChildIndex(a)},getChildAt:function(a){return this.root.getChildAt(a)},setChildIndex:function(a,b){return this.root.setChildIndex(a,b)},requestChildRender:function(a){this.rerender()},_render:function(){if(this._rerender){var a=this.context,b=this.state,f=this.wrapper,g=this.root;this._rerender=
!1;a.setViewTransform(b.transformNoRotation);f.reflow(a);f.render(a);g.render(a);f=g.surface.style;g=this.clipVisible&&b.clipRect;c.setOrigin(f,b.screenCenter);c.setTransformStyle(f,c.rotateZ(b.rotation));c.clip(f,g);a.reset();this._rerender||this.task.pause()}}})})},"esri/views/2d/engine/cssUtils":function(){define(["dojo/has"],function(h){var l=h("ff"),c=h("ie"),f=h("webkit");h=h("opera");var b=f&&"-webkit-transform"||l&&"-moz-transform"||h&&"-o-transform"||c&&"-ms-transform"||"transform",a=!c||
9<c,e={supports3DTransforms:a,transformStyleName:b,clip:function(a,b){a.clip=b?"rect("+b.top+"px, "+b.right+"px, "+b.bottom+"px,"+b.left+"px)":""},setTransform:function(a,b){var c=null;2===b.length&&(c=e.translate(b));6===b.length&&(c=e.matrix3d(b));e.setTransformStyle(a,c)},setTransformStyle:function(a,c){a.transform=a[b]=c},setOrigin:function(){return a?function(a,b){a["transform-origin"]=b[0]+"px "+b[1]+"px"}:function(a,b){a["transform-origin"]=b[0]+"px "+b[1]+"px 0"}}(),matrix:function(a){return"matrix("+
a[0].toFixed(10)+","+a[1].toFixed(10)+","+a[2].toFixed(10)+","+a[3].toFixed(10)+","+a[4]+","+a[5]+")"},matrix3d:function(){return a?function(a){if(6===a.length)return"matrix3d("+a[0].toFixed(10)+","+a[1].toFixed(10)+",0,0,"+a[2].toFixed(10)+","+a[3].toFixed(10)+",0,0,0,0,1,0,"+Math.round(a[4]).toFixed(10)+","+Math.round(a[5]).toFixed(10)+",0,1)"}:function(a){return"matrix("+a[0].toFixed(10)+","+a[1].toFixed(10)+","+a[2].toFixed(10)+","+a[3].toFixed(10)+","+Math.round(a[4])+","+Math.round(a[5])+")"}}(),
translate:function(a){return"translate("+Math.round(a[0])+"px, "+Math.round(a[1])+"px)"},rotate:function(a){return e.rotateZ(a.toFixed(3))},rotateZ:function(){return a?function(a){return"rotateZ("+a+"deg)"}:function(a){return"rotate("+a+"deg)"}}()};return e})},"esri/views/2d/engine/RenderContext":function(){define(["dojo/dom-construct","../math/mat2d","../math/vec2","./cssUtils"],function(h,l,c,f){var b=function(){this._parentStack=[];this._tStack=[];this._tStackSize=0;this._tmpMat2d=l.create();this._tmpVec2=
c.create();this.transform=l.create();this.viewTransform=l.create()};b.prototype={reset:function(){this._tStackSize=this._parentStack.length=0;this.child=null;l.identity(this.transform)},setSize:function(a,b){this.surface.style.width=a+"px";this.surface.style.height=b+"px"},setOpacity:function(a){this.surface.style.opacity=a},setVisibility:function(a){this.surface.style.display=a?"block":"none"},setBlendMode:function(a){this.surface.style["mix-blend-mode"]=a?a:"normal"},setViewTransform:function(a){l.copy(this.transform,
a);l.copy(this.viewTransform,a)},reflowChild:function(a,b){this.child=a;this.placeChild(a,b);a.reflow(this)},renderChild:function(a,b){this.child=a;this.surface=a.surface;this.setChildTransform(a);a.render(this)},placeChild:function(a,b){var c=this._parentStack[this._parentStack.length-1].surface,g=c.childNodes,f=a.createSurface();g[b]?g[b]!==f&&c.insertBefore(f,g[b]):c.appendChild(f)},setChildTransform:function(a){a=a.transform;var b=null;a&&(6===a.length?(b=l.invert(this._tmpMat2d,a),l.multiply(b,
this.transform,b),f.setTransform(this.surface.style,b),l.copy(this.transform,a)):2===a.length&&(b=c.transformMat2d(this._tmpVec2,a,this.transform),f.setTransform(this.surface.style,b)))},pushParent:function(a){this._parentStack.push(a)},popParent:function(){this._parentStack.pop()},pushMatrix:function(){var a=this._tStack;a.length<this._tStackSize+1&&a.push(l.create());l.copy(a[this._tStackSize++],this.transform)},popMatrix:function(){l.copy(this.transform,this._tStack[--this._tStackSize])},emptyTrash:function(a){if(a.trash&&
a.trash.children.length){a=a.trash;var b=a.children,c,g;c=0;for(g=b.length;c<g;c++)h.destroy(b[c].surface);b.length=0;a.ids={}}}};return b})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),function(h,l,c,f,b,a,e,k,g,m,n,d){function q(a,b){return c.doc.createElementNS?c.doc.createElementNS(a,b):c.doc.createElement(b)}function y(a){return p.useSvgWeb?
c.doc.createTextNode(a,!0):c.doc.createTextNode(a)}var p=m.svg={};p.useSvgWeb="undefined"!=typeof window.svgweb;var u=navigator.userAgent,s=l("ios"),w=l("android"),r=l("chrome")||w&&4<=w?"auto":"optimizeLegibility";p.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};p.getRef=function(a){return!a||"none"==a?null:a.match(/^url\(#.+\)$/)?f.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?f.byId(a.slice(1)):null};p.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,
1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var t=0;p.Shape=b("dojox.gfx.svg.Shape",n.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");(a=p.getRef(a))&&a.parentNode.removeChild(a)}if(this.clip&&(a=this.rawNode.getAttribute("clip-path")))(a=f.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);n.Shape.prototype.destroy.apply(this,
arguments)},setFill:function(b){if(!b)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var d,c=function(a){this.setAttribute(a,d[a].toFixed(8))};if("object"==typeof b&&"type"in b){switch(b.type){case "linear":d=m.makeParameters(m.defaultLinearGradient,b);b=this._setFillObject(d,"linearGradient");a.forEach(["x1","y1","x2","y2"],c,b);break;case "radial":d=m.makeParameters(m.defaultRadialGradient,b);b=this._setFillObject(d,"radialGradient");
a.forEach(["cx","cy","r"],c,b);break;case "pattern":d=m.makeParameters(m.defaultPattern,b),b=this._setFillObject(d,"pattern"),a.forEach(["x","y","width","height"],c,b)}this.fillStyle=d;return this}this.fillStyle=d=m.normalizeColor(b);this.rawNode.setAttribute("fill",d.toCss());this.rawNode.setAttribute("fill-opacity",d.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",
0),this;if("string"==typeof a||h.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=m.makeParameters(m.defaultStroke,a);a.color=m.normalizeColor(a.color);if(a){var d=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",a.color.a);b.setAttribute("stroke-width",d);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);
var c=a.style.toLowerCase();c in p.dasharray&&(c=p.dasharray[c]);if(c instanceof Array){var c=h._toArray(c),e;for(e=0;e<c.length;++e)c[e]*=d;if("butt"!=a.cap){for(e=0;e<c.length;e+=2)c[e]-=d,1>c[e]&&(c[e]=1);for(e=1;e<c.length;e+=2)c[e]+=d}c=c.join(",")}b.setAttribute("stroke-dasharray",c);b.setAttribute("dojoGfxStrokeStyle",a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof m.Surface);a=a.parent);return a},_setFillObject:function(a,b){var d=p.xmlns.svg;this.fillStyle=
a;var c=this._getParentSurface().defNode,e=this.rawNode.getAttribute("fill");if(e=p.getRef(e))if(e.tagName.toLowerCase()!=b.toLowerCase()){var g=e.id;e.parentNode.removeChild(e);e=q(d,b);e.setAttribute("id",g);c.appendChild(e)}else for(;e.childNodes.length;)e.removeChild(e.lastChild);else e=q(d,b),e.setAttribute("id",m._base._getUniqueId()),c.appendChild(e);if("pattern"==b)e.setAttribute("patternUnits","userSpaceOnUse"),d=q(d,"image"),d.setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",
(0>a.width?0:a.width).toFixed(8)),d.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),d.setAttributeNS?d.setAttributeNS(p.xmlns.xlink,"xlink:href",a.src):d.setAttribute("xlink:href",a.src),e.appendChild(d);else{e.setAttribute("gradientUnits","userSpaceOnUse");for(c=0;c<a.colors.length;++c){var g=a.colors[c],f=q(d,"stop"),k=g.color=m.normalizeColor(g.color);f.setAttribute("offset",g.offset.toFixed(8));f.setAttribute("stop-color",k.toCss());f.setAttribute("stop-opacity",k.a);e.appendChild(f)}}this.rawNode.setAttribute("fill",
"url(#"+e.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return e},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+","+a.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill",
"none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=m.makeParameters(this.shape,a);for(var b in this.shape)if("type"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);
return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!b)return this;"polyline"===b&&(a=h.clone(a),a.points=a.points.join(","));var d,c=k.get(this.rawNode,"clip-path");c&&(d=f.byId(c.match(/gfx_clip[\d]+/)[0]))&&d.removeChild(d.childNodes[0]);a?(d?(b=q(p.xmlns.svg,b),d.appendChild(b)):
(c="gfx_clip"+ ++t,this.rawNode.setAttribute("clip-path","url(#"+c+")"),d=q(p.xmlns.svg,"clipPath"),b=q(p.xmlns.svg,b),d.appendChild(b),this.rawNode.parentNode.insertBefore(d,this.rawNode),k.set(d,"id",c)),k.set(b,a)):(this.rawNode.removeAttribute("clip-path"),d&&d.parentNode.removeChild(d));return this},_removeClipNode:function(){var a,b=k.get(this.rawNode,"clip-path");b&&(a=f.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});p.Group=b("dojox.gfx.svg.Group",p.Shape,{constructor:function(){n.Container._init.call(this)},
setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);p.Shape.prototype.destroy.apply(this,arguments)}});p.Group.nodeType="g";p.Rect=b("dojox.gfx.svg.Rect",[p.Shape,n.Rect],{setShape:function(a){this.shape=m.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),
this.rawNode.setAttribute("rx",this.shape.r));return this}});p.Rect.nodeType="rect";p.Ellipse=b("dojox.gfx.svg.Ellipse",[p.Shape,n.Ellipse],{});p.Ellipse.nodeType="ellipse";p.Circle=b("dojox.gfx.svg.Circle",[p.Shape,n.Circle],{});p.Circle.nodeType="circle";p.Line=b("dojox.gfx.svg.Line",[p.Shape,n.Line],{});p.Line.nodeType="line";p.Polyline=b("dojox.gfx.svg.Polyline",[p.Shape,n.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=m.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&
this.shape.points.push(this.shape.points[0])):this.shape=m.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();for(var d=[],c=this.shape.points,e=0;e<c.length;++e)d.push(c[e].x.toFixed(8),c[e].y.toFixed(8));this.rawNode.setAttribute("points",d.join(" "));return this}});p.Polyline.nodeType="polyline";p.Image=b("dojox.gfx.svg.Image",[p.Shape,n.Image],{setShape:function(a){this.shape=m.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=
b){var d=this.shape[b];if("width"===b||"height"===b)d=0>d?0:d;a.setAttribute(b,d)}a.setAttribute("preserveAspectRatio","none");a.setAttributeNS?a.setAttributeNS(p.xmlns.xlink,"xlink:href",this.shape.src):a.setAttribute("xlink:href",this.shape.src);a.__gfxObject__=this;return this}});p.Image.nodeType="image";p.Text=b("dojox.gfx.svg.Text",[p.Shape,n.Text],{setShape:function(a){this.shape=m.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",
b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",r);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(y(b.text));return this},getTextWidth:function(){var a=this.rawNode,b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var d=0,c=a.firstChild.nodeValue;b.appendChild(a);if(""!=c)for(;!d;)d=a.getBBox?parseInt(a.getBBox().width):
68;b.removeChild(a);return d},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(b){a={x:0,y:0,width:0,height:0}}return a}});p.Text.nodeType="text";p.Path=b("dojox.gfx.svg.Path",[p.Shape,d.Path],{_updateWithSegment:function(a){this.inherited(arguments);"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");
return this}});p.Path.nodeType="path";p.TextPath=b("dojox.gfx.svg.TextPath",[p.Shape,d.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==typeof this.shape.path){var a=this.rawNode;if(!a.firstChild){var b=q(p.xmlns.svg,"textPath"),d=y("");b.appendChild(d);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(p.xmlns.xlink,"href"))&&p.getRef(b);if(!b&&
(d=this._getParentSurface())){var d=d.defNode,b=q(p.xmlns.svg,"path"),c=m._base._getUniqueId();b.setAttribute("id",c);d.appendChild(b);a.firstChild.setAttributeNS?a.firstChild.setAttributeNS(p.xmlns.xlink,"xlink:href","#"+c):a.firstChild.setAttribute("xlink:href","#"+c)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var b=q(p.xmlns.svg,"textPath"),d=y("");b.appendChild(d);a.appendChild(b)}a=a.firstChild;b=this.text;a.setAttribute("alignment-baseline",
"middle");switch(b.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor","end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.firstChild.data=b.text}});p.TextPath.nodeType=
"text";var z=534<function(){var a=/WebKit\/(\d*)/.exec(u);return a?a[1]:0}();p.Surface=b("dojox.gfx.svg.Surface",n.Surface,{constructor:function(){n.Container._init.call(this)},destroy:function(){n.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;var d=0>a?0:a,c=0>b?0:b;this.rawNode.setAttribute("width",d);this.rawNode.setAttribute("height",c);z&&(this.rawNode.style.width=d,this.rawNode.style.height=c);return this},
getDimensions:function(){return this.rawNode?{width:m.normalizedLength(this.rawNode.getAttribute("width")),height:m.normalizedLength(this.rawNode.getAttribute("height"))}:null}});p.createSurface=function(a,b,d){var c=new p.Surface;c.rawNode=q(p.xmlns.svg,"svg");c.rawNode.setAttribute("overflow","hidden");b&&c.rawNode.setAttribute("width",0>b?0:b);d&&c.rawNode.setAttribute("height",0>d?0:d);b=q(p.xmlns.svg,"defs");c.rawNode.appendChild(b);c.defNode=b;c._parent=f.byId(a);c._parent.appendChild(c.rawNode);
m._base._fixMsTouchAction(c);return c};l={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var x=n.Container;b=p.Container={openBatch:function(){if(!this._batch){var a;a=p.useSvgWeb?c.doc.createDocumentFragment(!0):c.doc.createDocumentFragment();this.fragment=a}++this._batch;
return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),x.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==
a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),x.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return x.clear.apply(this,arguments)},getBoundingBox:x.getBoundingBox,_moveChildToFront:x._moveChildToFront,_moveChildToBack:x._moveChildToBack};d=p.Creator={createObject:function(a,b){if(!this.rawNode)return null;
var d=new a,c=q(p.xmlns.svg,a.nodeType);d.setRawNode(c);d.setShape(b);this.add(d);return d}};h.extend(p.Text,l);h.extend(p.TextPath,l);h.extend(p.Group,b);h.extend(p.Group,n.Creator);h.extend(p.Group,d);h.extend(p.Surface,b);h.extend(p.Surface,n.Creator);h.extend(p.Surface,d);p.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=s&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};p.useSvgWeb&&(p.createSurface=function(a,b,d){var c=new p.Surface;b=0>b?0:b;d=0>
d?0:d;if(!b||!d){var g=e.position(a);b=b||g.w;d=d||g.h}a=f.byId(a);var g=a.id?a.id+"_svgweb":m._base._getUniqueId(),k=q(p.xmlns.svg,"svg");k.id=g;k.setAttribute("width",b);k.setAttribute("height",d);svgweb.appendChild(k,a);k.addEventListener("SVGLoad",function(){c.rawNode=this;c.isLoaded=!0;var a=q(p.xmlns.svg,"defs");c.rawNode.appendChild(a);c.defNode=a;if(c.onLoad)c.onLoad(c)},!1);c.isLoaded=!1;return c},p.Surface.extend({destroy:function(){var a=this.rawNode;svgweb.removeChild(a,a.parentNode)}}),
l={connect:function(a,b,d){"on"===a.substring(0,2)&&(a=a.substring(2));d=2==arguments.length?b:h.hitch(b,d);this.getEventSource().addEventListener(a,d,!1);return[this,a,d]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},h.extend(p.Shape,l),h.extend(p.Surface,l));return p})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(h,l,c,f,b,a,e,k,g,m){var n=h.shape={};n.Shape=c("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(b("gfxRegistry")){var a=n.register(this);this.getUID=function(){return a}}},destroy:function(){b("gfxRegistry")&&n.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},
getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[m.multiplyPoint(b,a.x,a.y),m.multiplyPoint(b,a.x+a.width,a.y),m.multiplyPoint(b,a.x+a.width,a.y+a.height),m.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},
setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=h.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);break;case "pattern":b=h.makeParameters(h.defaultPattern,a)}else b=h.normalizeColor(a);this.fillStyle=
b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||l.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=h.makeParameters(h.defaultStroke,a);a.color=h.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=m.clone(a?m.normalize(a):m.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=
this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},
_updateParentMatrix:function(a){this.parentMatrix=a?m.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=m.multiply(b.matrix,a)),b=b.parent;return a}});n._eventsProcessing={on:function(b,c){return a(this.getEventSource(),b,n.fixCallback(this,h.fixTarget,c))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?l.hitch(b,c):b)},disconnect:function(a){return a.remove()}};n.fixCallback=function(a,
b,c,e){e||(e=c,c=null);if(l.isString(e)){c=c||f.global;if(!c[e])throw['dojox.gfx.shape.fixCallback: scope["',e,'"] is null (scope\x3d"',c,'")'].join("");return function(g){return b(g,a)?c[e].apply(c,arguments||[]):void 0}}return!c?function(g){return b(g,a)?e.apply(c,arguments):void 0}:function(g){return b(g,a)?e.apply(c,arguments||[]):void 0}};l.extend(n.Shape,n._eventsProcessing);n.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},
add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,1);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;
e.forEach(this.children,function(b){var c=b.getBoundingBox();c&&((b=b.getTransform())&&(c=m.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.push(a);break}return this},
_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.unshift(a);break}return this}};n.Surface=c("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){e.forEach(this._nodes,k.destroy);this._nodes=[];e.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(b("ie"))for(;this._parent.lastChild;)k.destroy(this._parent.lastChild);
else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(b,c){var e=l.hitch(b,c);if(this.isLoaded)e(this);else a.once(this,"load",function(a){e(a)})}});l.extend(n.Surface,n._eventsProcessing);n.Rect=c("dojox.gfx.shape.Rect",n.Shape,{constructor:function(a){this.shape=h.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});n.Ellipse=c("dojox.gfx.shape.Ellipse",
n.Shape,{constructor:function(a){this.shape=h.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});n.Circle=c("dojox.gfx.shape.Circle",n.Shape,{constructor:function(a){this.shape=h.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});n.Line=c("dojox.gfx.shape.Line",
n.Shape,{constructor:function(a){this.shape=h.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});n.Polyline=c("dojox.gfx.shape.Polyline",n.Shape,{constructor:function(a){this.shape=h.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&
this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],e=0;e<b;e+=2)c.push({x:a[e],y:a[e+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],e=c.x,g=c.y,f=c.x,k=c.y,h=1;h<b;++h)c=a[h],e>c.x&&(e=c.x),f<c.x&&(f=c.x),g>c.y&&(g=c.y),k<c.y&&(k=c.y);this.bbox={x:e,y:g,width:f-
e,height:k-g}}return this.bbox}});n.Image=c("dojox.gfx.shape.Image",n.Shape,{constructor:function(a){this.shape=h.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});n.Text=c(n.Shape,{constructor:function(a){this.fontStyle=null;this.shape=h.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,
a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=h._base._computeTextBoundingBox(this));return a}});n.Creator={createShape:function(a){switch(a.type){case h.defaultPath.type:return this.createPath(a);case h.defaultRect.type:return this.createRect(a);case h.defaultCircle.type:return this.createCircle(a);case h.defaultEllipse.type:return this.createEllipse(a);case h.defaultLine.type:return this.createLine(a);case h.defaultPolyline.type:return this.createPolyline(a);
case h.defaultImage.type:return this.createImage(a);case h.defaultText.type:return this.createText(a);case h.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(h.Group)},createRect:function(a){return this.createObject(h.Rect,a)},createEllipse:function(a){return this.createObject(h.Ellipse,a)},createCircle:function(a){return this.createObject(h.Circle,a)},createLine:function(a){return this.createObject(h.Line,a)},createPolyline:function(a){return this.createObject(h.Polyline,
a)},createImage:function(a){return this.createObject(h.Image,a)},createText:function(a){return this.createObject(h.Text,a)},createPath:function(a){return this.createObject(h.Path,a)},createTextPath:function(a){return this.createObject(h.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return n})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(h,l,c,f,b){b=c("dojox.gfx.path.Path",b.Shape,{constructor:function(a){this.shape=
l.clone(h.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=a;this.segmented=!1},setAbsoluteMode:function(a){this._confirmSegmented();this.absolute="string"==typeof a?"absolute"==a:a;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();
if(this.tbbox)return this.tbbox;var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var c=0,g=this.segments.length;c<g;++c)this._updateWithSegment(this.segments[c],b);b=this.bbox;this.bbox=a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(a,b,c){c&&(b=f.multiplyPoint(c,
a,b),a=b.x,b=b.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}},_updateWithSegment:function(a,b){var c=a.args,g=c.length,f;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(f=0;f<g;f+=2)this._updateBBox(c[f],c[f+1],b);this.last.x=c[g-2];this.last.y=c[g-1];this.absolute=!0;break;case "H":for(f=0;f<g;++f)this._updateBBox(c[f],this.last.y,b);
this.last.x=c[g-1];this.absolute=!0;break;case "V":for(f=0;f<g;++f)this._updateBBox(this.last.x,c[f],b);this.last.y=c[g-1];this.absolute=!0;break;case "m":f=0;"x"in this.last||(this._updateBBox(this.last.x=c[0],this.last.y=c[1],b),f=2);for(;f<g;f+=2)this._updateBBox(this.last.x+=c[f],this.last.y+=c[f+1],b);this.absolute=!1;break;case "l":case "t":for(f=0;f<g;f+=2)this._updateBBox(this.last.x+=c[f],this.last.y+=c[f+1],b);this.absolute=!1;break;case "h":for(f=0;f<g;++f)this._updateBBox(this.last.x+=
c[f],this.last.y,b);this.absolute=!1;break;case "v":for(f=0;f<g;++f)this._updateBBox(this.last.x,this.last.y+=c[f],b);this.absolute=!1;break;case "c":for(f=0;f<g;f+=6)this._updateBBox(this.last.x+c[f],this.last.y+c[f+1],b),this._updateBBox(this.last.x+c[f+2],this.last.y+c[f+3],b),this._updateBBox(this.last.x+=c[f+4],this.last.y+=c[f+5],b);this.absolute=!1;break;case "s":case "q":for(f=0;f<g;f+=4)this._updateBBox(this.last.x+c[f],this.last.y+c[f+1],b),this._updateBBox(this.last.x+=c[f+2],this.last.y+=
c[f+3],b);this.absolute=!1;break;case "A":for(f=0;f<g;f+=7)this._updateBBox(c[f+5],c[f+6],b);this.last.x=c[g-2];this.last.y=c[g-1];this.absolute=!0;break;case "a":for(f=0;f<g;f+=7)this._updateBBox(this.last.x+=c[f+5],this.last.y+=c[f+6],b);this.absolute=!1}var l=[a.action];for(f=0;f<g;++f)l.push(h.formatNumber(c[f],!0));if("string"==typeof this.shape.path)this.shape.path+=l.join("");else{f=0;for(g=l.length;f<g;++f)this.shape.path.push(l[f])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},
_pushSegment:function(a,b){this.tbbox=null;var c=this._validSegments[a.toLowerCase()];"number"==typeof c&&(c?b.length>=c&&(c={action:a,args:b.slice(0,b.length-b.length%c)},this.segments.push(c),this._updateWithSegment(c)):(c={action:a,args:[]},this.segments.push(c),this._updateWithSegment(c)))},_collectArgs:function(a,b){for(var c=0;c<b.length;++c){var f=b[c];"boolean"==typeof f?a.push(f?1:0):"number"==typeof f?a.push(f):f instanceof Array?this._collectArgs(a,f):"x"in f&&"y"in f&&a.push(f.x,f.y)}},
moveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"M":"m",a);return this},lineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"L":"l",a);return this},hLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"H":"h",a);return this},vLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);
this._pushSegment(this.absolute?"V":"v",a);return this},curveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"C":"c",a);return this},smoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"S":"s",a);return this},qCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"Q":"q",a);return this},qSmoothCurveTo:function(){this._confirmSegmented();
var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"T":"t",a);return this},arcTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"A":"a",a);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(a){a=
l.isArray(a)?a:a.match(h.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(a){for(var b="",c=[],f=a.length,m=0;m<f;++m){var n=a[m],d=parseFloat(n);isNaN(d)?(b&&this._pushSegment(b,c),c=[],b=n):c.push(d)}this._pushSegment(b,c)}},setShape:function(a){this.inherited(arguments,["string"==typeof a?{path:a}:a]);this.segmented=!1;this.segments=[];h.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});c=c("dojox.gfx.path.TextPath",b,{constructor:function(a){"text"in
this||(this.text=l.clone(h.defaultTextPath));"fontStyle"in this||(this.fontStyle=l.clone(h.defaultFont))},getText:function(){return this.text},setText:function(a){this.text=h.makeParameters(this.text,"string"==typeof a?{text:a}:a);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,a);this._setFont();return this}});return h.path={Path:b,TextPath:c}})},"esri/views/2d/layers/GraphicsLayerView2D":function(){define("../../../core/HandleRegistry ../../../core/promiseUtils ../../../core/Error ../../../layers/graphics/QueryEngine ./LayerView2D ./GraphicsView2D".split(" "),
function(h,l,c,f,b,a){return b.createSubclass({declaredClass:"esri.views.2d.layers.GraphicsLayerView2D",classMetadata:{properties:{updating:{dependsOn:["_controller.isQueryInProgress","_controller._socketConnector.status"],getter:function(){return!0===this.get("_controller.isQueryInProgress")||0===this.get("_controller._socketConnector.status")}}}},constructor:function(){this._rendererChanged=this._rendererChanged.bind(this);this._handlesGLV=new h},initialize:function(){this._createController().then(this._startup.bind(this)).otherwise(function(){console.log("GraphicsLayerView2D: unable to startup graphics layer view.")})},
destroy:function(){this._handlesGLV.destroy();this._controller&&this._controller.destroy&&this._controller.destroy();this._graphicsView&&this._graphicsView.destroy();this._handlesGLV=this._controller=this._graphicsView=null},layer:null,view:null,_controller:null,_graphics:null,_graphicsView:null,_handlesGLV:null,hitTest:function(a,b){return this._graphicsView?this._graphicsView.hitTest(a,b):null},queryGraphics:function(){return this._queryEngine?this._queryEngine.queryFeatures():this._rejectQuery()},
queryFeatures:function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()},queryObjectIds:function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()},queryFeatureCount:function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()},queryExtent:function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery()},_startup:function(){this._queryEngine=new f({features:this._graphics,
objectIdField:this.layer.objectIdField});this._createGraphicsView();this._setupWatchers()},_createController:function(){return this.layer.createGraphicsController({layerView:this}).then(function(a){this._controller=a;this._graphics=a.graphics}.bind(this)).otherwise(function(){console.log("GraphicsLayerView2D: unable to create controller.")})},_createGraphicsView:function(){this._graphicsView=new a({view:this,graphics:this._graphics,renderer:this.layer.renderer})},_setupWatchers:function(){this._handlesGLV.add(this.layer.watch("renderer",
this._rendererChanged))},_rendererChanged:function(){this._graphicsView.renderer=this.layer.renderer},_rejectQuery:function(a){return l.reject(new c("GraphicsLayerView2D","Not ready to execute query"))}})})},"esri/views/2d/layers/TiledLayerView2D":function(){define("dojo/on dojo/has ../../../core/Collection ../ResourceLoader ../TileInfoView ../Tile ../math/vec2 ../collections/ReferenceMap ../collections/Set ../engine/Container ../engine/Bitmap ./LayerView2D ./TileQueue".split(" "),function(h,l,c,
f,b,a,e,k,g,m,n,d,q){var y=l("esri-mobile");l=d.createSubclass({declaredClass:"esri.views.2d.layers.TiledLayerView2D",constructor:function(a){this.container=new p;this._viewHdl=h.pausable(this,"view-change",function(){this.needUpdate()}.bind(this));this._viewWtch=this.watch("suspended, view.stationary",function(){!this.suspended&&(!y||y&&this.view.stationary)?(this.needUpdate(),this._viewHdl.resume()):this._viewHdl.pause()}.bind(this))},initialize:function(){this.then(this.setup.bind(this))},destroy:function(){this._viewWtch.remove();
this._viewWtch=null;this._viewHdl.remove();this._viewHdl=null;this._updatingDependenciesWatcher.forEach(function(a){a.remove()})},_tCol:null,_rtCol:null,setup:function(){var a=this.layer;this.tileInfoView=new b({tileInfo:a.tileInfo,fullExtent:a.fullExtent});this._rtCol=this._tCol=new u;var c=[];a.tileMap&&(this._rtCol=new s({tileInfoView:this.tileInfoView,tileMap:a.tileMap,tiles:this._tCol}),c.push(this._rtCol));this._loadingCol=new w({loader:this.createLoader(),tileInfoView:this.tileInfoView,layer:this.layer,
tiles:this._rtCol,view:this.view});c.push(this._loadingCol);this.container.set({tileInfoView:this.tileInfoView,tiles:this._loadingCol,state:this.view.state});var d=function(){this.updating=this._rtCol.updating||this._loadingCol.updating}.bind(this);this._updatingDependenciesWatcher=c.map(function(a){return a.watch("updating",d,!0)})},update:function(){if(!this.suspended){var a=this.tileInfoView.getTileSpans(this.view.state);this._tCol.tileSpans=a}},createLoader:function(){return new f({queue:new q({tileInfo:this.layer.tileInfo,
state:this.view.state})})}});var p=m.createSubclass({declaredClass:"TileContainer",properties:{tileInfoView:{},tiles:{},state:{}},constructor:function(){this.levels={}},_hdl:null,_tilesSetter:function(a){var b=this._hdl;this._get("tiles")!==a&&(b&&(this.removeAllChildren(),b.remove(),b=null),a&&(b=a.on("change",this._colChange.bind(this)),this._tilesAdded(a.toArray())),this._hld=b,this._set("tiles",a))},_tilesAdded:function(a){var b,c;b=0;for(c=a.length;b<c;b++){var d=a[b].tile,f=a[b].data,g=d.coords[2],
h=this.levels[g],k=this.tileInfoView.getTileOrigin(e.create(),d.coords);h||(this.levels[g]=h=new m,h.coords=this.state.center,h.resolution=d.lodInfo.resolution,this.addChild(h));d.bitmap=new n({coords:k,source:f});h.addChild(d.bitmap)}},_tilesRemoved:function(a){var b,c,d,e;b=0;for(c=a.length;b<c;b++)if(d=a[b].tile,(e=this.levels[d.coords[2]])&&d.bitmap)e.removeChild(d.bitmap),0===e.numChildren&&(this.removeChild(e),delete this.levels[d.level])},_colChange:function(a){0<a.added.length&&this._tilesAdded(a.added);
0<a.removed.length&&this._tilesRemoved(a.removed)}}),u=g.createSubclass({declaredClass:"TileSet",_tileSpansSetter:function(b){(!b||0===b.length)&&this.removeAll();var c=this.keys(),d={},e=[],f=[],g,h,k,l,p,m,q,n,u,s;k=0;for(s=b.length;k<s;k++){g=b[k];h=g.lodInfo;m=g.row;q=h.z;l=g.colFrom;for(u=g.colTo;l<=u;l++)n=h.getWorldForX(l),p=h.normalizeX(l),g=a.getId(p,m,q,n),this.contains(g)?d[g]=this.getItem(g):(d[g]=new a([p,m,q,n],h),e.push(d[g]))}k=0;for(s=c.length;k<s;k++)d[c[k]]||f.push(c[k]);this.addMany(e);
this.removeMany(f)}}),s=k.createSubclass({declaredClass:"TileMapTilesCollection",properties:{updating:!1,tileInfoView:{},tileMap:{},tiles:{}},constructor:function(){this._loading=new g;this._tileMapCallback=this._tileMapCallback.bind(this)},_hdl:null,_tilesSetter:function(a){var b=this._hdl;this._get("tiles")!==a&&(b&&(this.removeAll(),b.remove(),b=null),a&&(b=a.on("change",this._colChange.bind(this)),this._tilesAdded(a.toArray())),this._hld=b,this._set("tiles",a))},_tileMapCallback:function(b,c){this._loading.contains(c)&&
(this._loading.remove(c),this.updating=this._loading.length,b!==c&&(b=new a([b.col,b.row,b.level,0],this.tileInfoView.getInfoForZoom(b.level)),b.world=c.world),this.add(b.id,b))},_tilesAdded:function(a){var b,c,d;b=0;for(c=a.length;b<c;b++)d=a[b],!this._loading.contains(d)&&!this.contains(d)&&(this._loading.add(d),this.updating=this._loading.length,this.tileMap.getTile(d,this._tileMapCallback))},_tilesRemoved:function(a){this._loading.removeMany(a);this.removeMany(a)},_colChange:function(a){0<a.added.length&&
this._tilesAdded(a.added);0<a.removed.length&&this._tilesRemoved(a.removed)}}),w=c.createSubclass({declaredClass:"TileLoader",properties:{updating:!1,loader:{},tileInfoView:{},layer:{},tiles:{},view:{}},constructor:function(){this._tileLoadHandler=this._tileLoadHandler.bind(this);this._tileErrorHandler=this._tileErrorHandler.bind(this);this._loadingList=[];this._removingList=[]},destroy:function(){this._viewHdl.remove();this._viewHdl=null},initialize:function(){this._viewHdl=this.view.watch("stationary",
function(a){if(a&&!this._loadingList.length&&(!this.tiles._loading||!this.tiles._loading.length))a=this._removingList.map(function(a){return this.find(function(b){return a===b.tile})}.bind(this)),this.removeMany(a),this._removingList.length=0,this.updating=this._loadingList.length}.bind(this))},_hdl:null,_tilesSetter:function(a){var b=this._hdl;this._get("tiles")!==a&&(b&&(this.removeAll(),b.remove(),b=null),a&&(this._tilesAdded(a.toArray()),b=a.on("change",this._colChange.bind(this))),this._hld=
b,this._set("tiles",a))},_tilesAdded:function(a){var b,c,d;b=0;for(c=a.length;b<c;b++)d=a[b],this._loadingList.push(d),this.updating=!0,this.loader.load({id:d.id,url:this.layer.getTileUrl(d.level,d.row,d.col),tile:d,loadCallback:this._tileLoadHandler,errorCallback:this._tileErrorHandler})},_tilesRemoved:function(a){var b,c,d,e,f,g=this._loadingList;b=0;for(c=a.length;b<c;b++)if(f=a[b],f.bitmap)this._removingList.push(f);else{d=0;for(e=g.length;d<e;d++)if(g[d]===f){g.splice(d,1);break}this.loader.cancel(f.id);
this._removeIntersectingTiles(f)}this.updating=g.length},_colChange:function(a){0<a.added.length&&this._tilesAdded(a.added);0<a.removed.length&&this._tilesRemoved(a.removed)},_tileLoadHandler:function(a){var b=a.request.tile,c=this._loadingList,d;this.add({tile:b,data:a.data});a=0;for(d=c.length;a<d;a++)if(c[a]===b){c.splice(a,1);break}this.view.stationary&&!c.length&&(!this.tiles._loading||!this.tiles._loading.length)?(b=this._removingList.map(function(a){return this.find(function(b){return a===
b.tile})}.bind(this)),this.removeMany(b),this._removingList.length=0):this._removeIntersectingTiles(b);this.updating=c.length},_removeIntersectingTiles:function(a){var b=this._loadingList,c=this._removingList,d,e,f,g=!1;for(e=c.length-1;0<=e;e--)if(d=c[e],a.intersects(d)){for(f=b.length-1;0<=f;f--)d.intersects(b[f])&&(g=!0);g||(c.splice(e,1),this.removeAt(this.findIndex(function(a){return a.tile===d})))}},_tileErrorHandler:function(a){}});return l})},"esri/views/2d/ResourceLoader":function(){define(["../../core/declare",
"dojo/_base/lang","dojo/_base/array"],function(h,l,c){var f=h(null,{constructor:function(){this._requestIds={};this._queue=[]},add:function(a,b){this.contains(a)||(this._requestIds[a]=b,this._queue.push(b))},contains:function(a){return null!=this._requestIds[a]},get:function(a){for(var b=[],c;!this.isEmpty()&&b.length<a;)c=this._queue.pop(),delete this._requestIds[c.id],b.push(c);return b},remove:function(a){if(!this.contains(a))return null;var b=this._requestIds[a];this._queue.splice(c.indexOf(this._queue,
b),1);delete this._requestIds[a];return b},isEmpty:function(){return 0===this._queue.length}}),b=h(null,{constructor:function(a){a=l.mixin({loaders:{},contentType:"img",activeRequests:{},numActiveRequests:0,maxActiveRequests:10},a||{});l.mixin(this,a);this._requestLoadHandler=this._requestLoadHandler.bind(this);this._requestErrorHandler=this._requestErrorHandler.bind(this);this.queue||(this.queue=new f)},paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1;this._next()},load:function(a){var b=
a.id;!this.activeRequests[b]&&!this.queue.contains(b)&&(this.queue.add(b,a),this._next());return b},cancel:function(a){this.queue.contains(a)?(a=this.queue.remove(a),this._requestErrorHandler({request:a,canceled:!0})):this.activeRequests[a]&&this.activeRequests[a].cancel()},dispose:function(a){var b=this.getLoader(a.contentType||this.contentType);b&&b.dispose&&b.dispose(a.data)},registerLoader:function(a,b){l.isArray(a)?c.forEach(a,function(a){this.registerLoader(a,b)}):this.loaders[a.toLowerCase()]=
b},getLoader:function(a){a=a.toLowerCase();var c=b.getLoader(a);a=this.loaders[a];return!a&&!c?null:a||c},_next:function(){this.paused||(this.queue.isEmpty()?0===this.numActiveRequests&&(this.running=!1):this.numActiveRequests<this.maxActiveRequests&&this._loadRequests(this.queue.get(this.maxActiveRequests-this.numActiveRequests)))},_loadRequests:function(a){var b,c,f=a.length;for(c=0;c<f;c++)b=a[c],this._loadRequest(b)},_loadRequest:function(a){var b=a.contentType||this.contentType,c=this.getLoader(b);
this.numActiveRequests++;b?c?(b=c.load(a,this._requestLoadHandler,this._requestErrorHandler))&&(this.activeRequests[a.id]=b):(a.error="No loader for contentType:"+b,this._requestErrorHandler({request:a})):(a.error="contentType not set",this._requestErrorHandler({request:a}))},_requestLoadHandler:function(a){this.numActiveRequests--;this.activeRequests[a.request.id]&&delete this.activeRequests[a.request.id];a.canceled?a.request.errorCallback.call(this,a):a.request.loadCallback.call(this,a);this._next()},
_requestErrorHandler:function(a){this.activeRequests[a.request.id]&&(this.numActiveRequests--,delete this.activeRequests[a.request.id]);a.request.errorCallback.call(null,a);this._next()}});b.loaders={};b.registerLoader=function(a,e){l.isArray(a)?c.forEach(a,function(a){b.registerLoader(a,e)}):b.loaders[a.toLowerCase()]=e};b.getLoader=function(a){a=a.toLowerCase();return void 0===b.loaders[a]?void 0:b.loaders[a]};b.registerLoader("img",{load:function(a,b,c){var f=document.createElement("img");f.setAttribute("alt",
"");f.onload=function(c){f.onload=f.onerror=null;c.canceled||b.call(this,{request:a,data:f})};f.onerror=function(b){f.onload=f.onerror=null;c.call(this,{request:a,error:b})};f.src=a.url;return{cancel:function(){f.onload=f.onerror=null;c.call(this,{request:a,canceled:!0})}}}});return b})},"esri/views/2d/TileInfoView":function(){define(["../../core/declare","../../core/Accessoire","./LODInfo"],function(h,l,c){var f=Math.max,b=Math.min,a=Math.floor,e=Math.ceil,k=function(a,b,c,e){this.lodInfo=a;this.row=
b;this.colFrom=c;this.colTo=e},g=function(a,b,c,e,f,g,h,k){this.x=a;this.ymin=b;this.ymax=c;this.invM=e;this.leftAdjust=f;this.rightAdjust=g;this.leftBound=h;this.rightBound=k};g.prototype.incrRow=function(){this.x+=this.invM};g.prototype.getLeftCol=function(){return f(this.x+this.leftAdjust,this.leftBound)};g.prototype.getRightCol=function(){return b(this.x+this.rightAdjust,this.rightBound)};g.create=function(b,c){var f;b[1]>c[1]&&(f=b,b=c,c=f);f=b[0];var h=b[1],k=c[0],l=c[1],m=k-f,n=l-h,n=0!==n?
m/n:0,t=(e(h)-h)*n,z=(a(h)-h)*n;return new g(f,a(h),e(l),n,0>m?t:z,0>m?z:t,0>m?k:f,0>m?f:k)};var m=[[0,0],[0,0],[0,0],[0,0]],n=h([l],{normalizeCtorArgs:function(a){var b=a.tileInfo,c=b.lods,e=a.constraints||{};if(c&&c.length){var f=e.minZoom,g=e.maxZoom,h=e.minScale,e=e.maxScale,k=-1,l=-1,m=!1,n=!1,v;for(v=0;v<c.length;v++)!m&&(0<h&&h>=c[v].scale)&&(k=c[v].level,m=!0),!n&&(0<e&&e>=c[v].scale)&&(l=0<v?c[v-1].level:-1,n=!0);null==f&&(f=null==h?c[0].level:k);null==g&&(g=null==e?c[c.length-1].level:l)}return{tileInfo:b,
fullExtent:a.fullExtent,constraints:{minZoom:f,maxZoom:g}}},getDefaults:function(a){return{wrap:a.tileInfo.spatialReference.isWrappable}},initialize:function(){var a=this.tileInfo,b=this.fullExtent,e=this.dpi/a.dpi,f=this.constraints||{minZoom:-Infinity,maxZoom:Infinity},g=f.minZoom,h=f.maxZoom,f=a.lods;this._infoByZoom={};this._infoByScale={};this.zooms=[];this.scales=[];f=f.map(function(a){a=a.clone();a.scale*=e;return a}).filter(function(a){return a.level>=g&&a.level<=h}).sort(function(a,b){return b.scale-
a.scale});this.lodInfos=f.map(function(e){return new c(a,e,b)});f.forEach(function(a,b){this._infoByZoom[a.level]=this.lodInfos[b];this._infoByScale[a.scale]=this.lodInfos[b];this.zooms[b]=a.level;this.scales[b]=a.scale},this);this.lods=f;g=this.zooms[0];h=this.zooms[this.zooms.length-1];this.constraints={minZoom:g,maxZoom:h,minScale:this._infoByZoom[g].scale,maxScale:this._infoByZoom[h].scale};this.wrap=this.wrap&&a.spatialReference.isWrappable},_infoByZoom:null,_infoByScale:null,constraints:null,
dpi:96,lods:null,scales:null,wrap:!1,zooms:null,getZoomForScale:function(a){var b=this.lods,c=null,e=null,f=0,g=b.length-1;for(f;f<g;f++){c=b[f];e=b[f+1];if(c.scale<=a)return c.level;if(e.scale===a)return e.level;if(c.scale>a&&e.scale<a)return e.level-(a-e.scale)/(c.scale-e.scale)}},getScaleForZoom:function(a){var b=this.lods,c=null,e=null,f=0,g=b.length-1;for(f;f<g;f++){c=b[f];e=b[f+1];if(c.level<=a)return c.scale;if(e.level===a)return e.scale;if(c.level>a&&e.level<a)return e.scale-(a-e.level)/(c.level-
e.level)}},getInfoForZoom:function(a){return this._infoByZoom[a]},getInfoForScale:function(a){return this._infoByScale[a]},getTileOrigin:function(a,b){var c=this._infoByZoom[b[2]];return!c?null:c.getTileOrigin(a,b)},getTileSpans:function(c){var e=this._getClosestInfoForScale(c.scale),h=this.wrap,l;l=Infinity;var n=-Infinity,s,w,r,t,z=[],x,v=[];m[0][0]=m[0][1]=m[1][1]=m[3][0]=0;m[1][0]=m[2][0]=c.size[0];m[2][1]=m[3][1]=c.size[1];x=m.map(function(a){c.toMap(a,a);a[0]=e.toGridCol(a[0]);a[1]=e.toGridRow(a[1]);
return a});t=3;for(r=0;4>r;r++)x[r][1]!==x[t][1]&&(t=g.create(x[r],x[t]),l=b(t.ymin,l),n=f(t.ymax,n),void 0===z[t.ymin]&&(z[t.ymin]=[]),z[t.ymin].push(t)),t=r;if(null==l||null==n||100<n-l)return[];for(x=[];l<n;){null!=z[l]&&(x=x.concat(z[l]));s=Infinity;w=-Infinity;for(r=x.length-1;0<=r;r--)t=x[r],s=b(s,t.getLeftCol()),w=f(w,t.getRightCol());s=a(s);w=a(w);if(l>=e.start[1]&&l<=e.end[1])if(h)if(e.size[0]<e.worldSize[0]){r=a(s/e.worldSize[0]);for(t=a(w/e.worldSize[0]);r<=t;r++)v.push(new k(e,l,f(e.getWorldStartCol(r),
s),b(e.getWorldEndCol(r),w)))}else v.push(new k(e,l,s,w));else s>e.end[0]||w<e.start[0]||(s=f(s,e.start[0]),w=b(w,e.end[0]),v.push(new k(e,l,s,w)));l+=1;for(r=x.length-1;0<=r;r--)t=x[r],t.ymax>=l?t.incrRow():x.splice(r,1)}return v},clone:function(){return new n(this.tileInfo?this.tileInfo.clone():null)},_getClosestInfoForScale:function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,e,f){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0],this));return this._infoByScale[a]}});return n})},
"esri/views/2d/LODInfo":function(){define(["./math/vec2","./Tile"],function(h,l){var c=function(c,b,a){this.z=b.level;this.scale=b.scale;var e=c.spatialReference._getInfo(),k=h.fromValues(c.origin.x,c.origin.y),g=h.fromValues(c.size[0]*b.resolution,c.size[1]*b.resolution),l=h.fromValues(-Infinity,-Infinity),n=h.fromValues(Infinity,Infinity),d=h.fromValues(Infinity,Infinity);a&&(h.set(l,Math.max(0,Math.floor((a.xmin-k[0])/g[0])),Math.max(0,Math.floor((k[1]-a.ymax)/g[1]))),h.set(n,Math.max(0,Math.floor((a.xmax-
k[0])/g[0])),Math.max(0,Math.floor((k[1]-a.ymin)/g[1]))),h.set(d,n[0]-l[0]+1,n[1]-l[1]+1));this.origin=k;this.norm=g;this.start=l;this.end=n;this.size=d;this.resolution=b.resolution;e?(this.worldSize=h.set(h.create(),Math.ceil(Math.round(2*e.origin[1]/b.resolution)/c.size[0]),d[1]),this.worldStart=h.set(h.create(),Math.floor((e.origin[0]-k[0])/g[0]),l[1]),this.worldEnd=h.set(h.create(),this.worldSize[0]-this.worldStart[0]-1,n[1]),this.wrap=!0):(this.worldStart=l,this.wldEnd=n,this.worldSize=d,this.wrap=
!1)};c.prototype={normalizeX:function(c){if(!this.wrap)return c;var b=this.worldSize[0];return 0>c?b-1-Math.abs((c+1)%b):c%b},getXForWorld:function(c,b){return!this.wrap?c:this.worldSize[0]*b+c},getWorldForX:function(c){return!this.wrap?c:Math.floor(c/this.worldSize[0])},getWorldStartCol:function(c){return c*this.worldSize[0]+this.start[0]},getWorldEndCol:function(c){return c*this.worldSize[0]+this.start[0]+this.size[0]-1},toGridCol:function(c){return(c-this.origin[0])/this.norm[0]},toGridRow:function(c){return(this.origin[1]-
c)/this.norm[1]},getTileOrigin:function(c,b){var a=this.origin,e=this.norm;return h.set(c,a[0]+this.getXForWorld(b[0],b[3])*e[0],a[1]-b[1]*e[1])},getIntersectingTile:function(c){var b=this.resolution,a=c.lodInfo.resolution;if(c.coords[2]<this.z)return null;b=[Math.floor(c.coords[0]*a/b+0.01),Math.floor(c.row*a/b+0.01),this.z,0];b[3]=this.getXForWorld(b[0],c.world);return new l(b,this)}};return c})},"esri/views/2d/Tile":function(){define([],function(){var h=function(l,c){this.coords=l;this.id=h.getId(l);
this.lodInfo=c};h.prototype={clone:function(){return new h(this.coords,this.lodInfo)},intersects:function(h){var c=this.coords,f=h.coords;if(c[2]===f[2])return c[3]===f[3]&&c[1]===f[1];f=c[2]<f[2]?c:f;h=(f===c?this:h).lodInfo.getIntersectingTile(f===c?h:this).coords;return f[2]===h[2]&&f[1]===h[1]&&f[3]===h[3]}};Object.defineProperties(h.prototype,{level:{get:function(){return this.coords[2]}},row:{get:function(){return this.coords[1]}},col:{get:function(){return this.coords[0]}},world:{get:function(){return this.coords[3]},
set:function(l){var c=this.coords;c[3]=l;c[0]=this.lodInfo.getXForWorld(c[0],l);this.id=h.getId(c)}}});h.getId=function(h,c,f,b){return(Array.isArray(h)?h:null!=b?[h,c,f,b]:[h,c,f]).join("/")};return h})},"esri/views/2d/collections/ReferenceMap":function(){define(["../../../core/Collection"],function(h){return h.createSubclass({constructor:function(){this._itemById={};this._itemToKeys={};this._keyToItem={}},add:function(h,c){var f=this.hash(h),b=this.hash(c),a=this._itemToKeys[b];c=this._itemById[b]?
this._itemById[b]:c;this._keyToItem[f]=c;a||(this._itemById[b]=c,this._itemToKeys[b]=a=[],this.getInherited(arguments).call(this,c));a.push(f)},remove:function(h){return this.removeMany([h])},removeMany:function(h){if(!h||!h.length)return null;var c,f,b,a,e,k=[];for(c=h.length-1;0<=c;c--)if(f=this.hash(h[c]),b=this.getItem(f))delete this._keyToItem[f],a=this.hash(b),e=this._itemToKeys[a],e.splice(e.indexOf(f),1),e.length||(delete this._itemToKeys[a],delete this._itemById[a],k.push(b));this.getInherited(arguments).call(this,
k);return k},getItem:function(h){return this._keyToItem[this.hash(h)]},contains:function(h){return null!=this.getItem(h)},hash:function(h){return h&&h.id?h.id:h}})})},"esri/views/2d/collections/Set":function(){define(["../../../core/Collection"],function(h){return h.createSubclass({constructor:function(){this._index={}},add:function(h){if(!this.contains(h)){var c=this.hash(h);this._index[c]=h;this.inherited(arguments)}},addMany:function(h){var c,f,b;for(c=h.length-1;0<=c;c--)f=h[c],b=this.hash(f),
this.contains(b)?h.splice(c,1):this._index[b]=f;return this.getInherited(arguments).call(this,h)},remove:function(h){var c=this.hash(h);this.contains(c)?(h=this.getItem(c),delete this._index[c],this.getInherited(arguments).call(this,h)):h=null;return h},removeMany:function(h){if(!h||!h.length)return null;var c,f;h=h.slice(0);for(c=h.length-1;0<=c;c--)f=this.hash(h[c]),this.contains(f)?(h[c]=this.getItem(f),delete this._index[f]):h.splice(c,1);return this.getInherited(arguments).call(this,h)},getItem:function(h){return this._index[this.hash(h)]},
contains:function(h){return!!this.getItem(h)},removeAll:function(){this._index={};this.inherited(arguments)},keys:function(){var h=this._index,c=[],f;for(f in h)h.hasOwnProperty(f)&&c.push(f);return c},hash:function(h){return h&&h.id?h.id:h}})})},"esri/views/2d/engine/Bitmap":function(){define(["./DisplayObject"],function(h){return h.createSubclass({declaredClass:"esri.views.2d.engine.Bitmap",className:"esri-bitmap",source:null,_sourceSetter:function(h){var c=this._get("source");h!==c&&(h.className=
this.className,this.surface=h,this.requestRender(),this._set("source",h))}})})},"esri/views/2d/layers/TileQueue":function(){define(["../../../core/declare","dojo/_base/lang"],function(h,l){var c=function(){this.requests=[]};return h(null,{constructor:function(c){l.mixin(this,c);this._scales=[];this._scaleBins={};this._levelToScale={};c.tileInfo.lods.forEach(function(b){this._levelToScale[b.level]=b.scale},this);this._requestIds={}},_minScale:0,_maxScale:-1,_scales:null,_scaleBins:null,_levelToScale:null,
_requestIds:null,add:function(f,b){if(!this.contains(f)){var a=this._levelToScale[b.tile.level];this._maxScale<this._minScale?this._minScale=this._maxScale=a:(a<this._minScale&&(this._minScale=a),a>this._maxScale&&(this._maxScale=a));var e=this._scaleBins[a];e||(this._scales.push(a),this._scales.sort(this._sortNumbers),e=this._scaleBins[a]=new c);e.requests.push(b);this._requestIds[f]=b}},get:function(c){var b=[],a=this.state.scale,e=this.state.x,h=this.state.y,g=this._scales,l=this.tileInfo,n,d,
q;for(null==c&&(c=1);b.length<c&&this._minScale<=this._maxScale;){q=this._scaleBins[a];if(!q){if(a<this._minScale)a=this._minScale;else if(a>this._maxScale)a=this._maxScale;else{n=1;for(d=g.length;n<d;n++)a<g[n]&&(a=a-g[n-1]<g[n]-a?g[n-1]:g[n])}q=this._scaleBins[a]}d=1/a/l.size[1];n=1/a/l.size[0];for(q.requests.sort(this._sortRequests((e-l.origin.x)*n,(l.origin.y-h)*d));b.length<c&&0<q.requests.length;)b.push(this._remove(q,a,q.requests[0]))}return b},contains:function(c){return void 0!==this._requestIds[c]},
remove:function(c){c=this._requestIds[c];var b,a;c&&(b=this._levelToScale[c.tile.level],a=this._scaleBins[b],this._remove(a,b,c));return c},isEmpty:function(){return this._minScale>this._maxScale},_remove:function(c,b,a){c.requests.splice(c.requests.indexOf(a),1);c.requests.length||(this._scales.splice(this._scales.indexOf(b),1),delete this._scaleBins[b],this._scales.sort(),0<this._scales.length?(this._minScale=this._scales[0],this._maxScale=this._scales[this._scales.length-1]):(this._minScale=0,
this._maxScale=-1));delete this._requestIds[a.id];return a},_sortNumbers:function(c,b){return c-b},_sortRequests:function(c,b){return function(a,e){a=a.tile;e=e.tile;return Math.sqrt((c-a.c)*(c-a.c)+(b-a.row)*(b-a.row))-Math.sqrt((c-e.c)*(c-e.c)+(b-e.row)*(b-e.row))}}})})},"*noref":1}});
define("../core/declare dojo/_base/lang dojo/_base/kernel dojo/promise/all ../core/Collection ../core/Scheduler ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ./Vue ./ViewAnimation ./inputs/GestureManager ./2d/AnimationManager ./2d/PaddedViewState ./2d/viewpointUtils ./2d/MapViewConstraints ./2d/layers/GraphicsView2D ./2d/handlers/Navigation ./ui/2d/DefaultUI2D ./ui/ZoomBox ./2d/engine/Stage ../core/accessorSupport/get ../core/watchUtils".split(" "),function(h,l,c,f,b,a,e,k,g,m,n,d,
q,y,p,u,s,w,r,t,z,x,v){x=x.get;return h([m],{declaredClass:"esri.views.MapView",classMetadata:{properties:{constraints:{type:u},center:{type:e,copy:function(a,b){a.x=b.x;a.y=b.y;a.spatialReference=b.spatialReference},dependsOn:["content.center"]},extent:{type:k,copy:function(a,b){a.xmin=b.xmin;a.ymin=b.ymin;a.xmax=b.xmax;a.ymax=b.ymax;a.spatialReference=b.spatialReference},dependsOn:["content.extent"]},initialExtentRequired:{dependsOn:["map.initialViewProperties.viewpoint"],getter:function(){return this.get("map.initialViewProperties.viewpoint")?
!(!this._proxyProps||!this._proxyProps.center||void 0!==this._proxyProps.scale||this.initialExtent):this._proxyProps?!(this._proxyProps.extent||this._proxyProps.viewpoint||this._proxyProps.center&&this._proxyProps.scale||this._proxyProps.zoom):!this.initialExtent}},rotation:{dependsOn:["content.rotation"]},scale:{dependsOn:["content.scale"]},spatialReference:{dependsOn:["map.initialViewProperties.spatialReference"]},state:{},tileInfo:{dependsOn:["map.initialViewProperties.viewpoint","map.layers",
"map.basemap"]},ui:{type:r},viewpoint:{copy:p.copy,dependsOn:["content.viewpoint"]},zoom:{dependsOn:["content.scale"]}}},constructor:function(){this._proxyProps={};this._pendingUpdates=new b;this._updateTask=a.addFrameTask({update:function(){this._pendingUpdates.drain(function(a){a._commitUpdate()});this._pendingUpdates.length||this._updateTask.pause()}.bind(this)});this._updateTask.pause();this._handles.add([this.on("resize",this._resizeHandler.bind(this))]);var c=this.notifyChange.bind(this,"tileInfo");
v.on(this,"map.basemap.baseLayers","change",c,c,c);v.on(this,"map.layers","change",c,c,c);v.whenFalse(this,"ready",function(){this.layerViewManager.empty();this.stage&&this.stage.removeAllChildren()}.bind(this))},getDefaults:function(){return l.mixin(this.inherited(arguments),{constraints:{},padding:{top:0,right:0,bottom:0,left:0}})},initialize:function(){this._graphicsView=new s({view:this,graphics:this.graphics})},destroy:function(){this._graphicsView.destroy()},_pendingUpdates:null,_graphicsView:null,
_zoomBox:null,className:"esriMapView",resizeAlign:"center",animation:null,_animationSetter:function(a,b){b&&b.stop();return a&&!a.isFulfilled()?(a.then(function(){this.animation=null}.bind(this),function(){this.animation=null}.bind(this),function(a){this.state.viewpoint=a}.bind(this)),a):null},center:null,_centerGetter:function(a){if(this._proxyProps)return this._proxyProps.center;a||(a=new e);var b=this.content.center,c=this.content.spatialReference;a.x=b[0];a.y=b[1];a.spatialReference=c;return a},
_centerSetter:function(a){if(null!=a)if(this._proxyProps)this._proxyProps.center=a,null!=this._proxyProps.center&&null!=this._proxyProps.scale&&(this.initialExtentRequired=!1);else{var b=this.viewpoint;p.centerAt(b,b,a);this.viewpoint=b}},constraints:null,_constraintsSetter:function(a,b){b&&(this._handles.remove("constraints"),b.view=null);a&&(this._ready&&(a.view=this,this.state.viewpoint=a.constrain(this.content.viewpoint,null,this)),this._handles.add(a.on("update",function(){this._ready&&this.state&&
(this.state.viewpoint=a.constrain(this.content.viewpoint,null,this))}.bind(this)),"constraints"));return a},extent:null,_extentGetter:function(a){if(this._proxyProps)return this._proxyProps.extent;a||(a=new k);var b=this.content.extent;a.xmin=b.xmin;a.ymin=b.ymin;a.xmax=b.xmax;a.ymax=b.ymax;a.spatialReference=b.spatialReference;return a},_extentSetter:function(a){if(null!=a)if(this._proxyProps)this._proxyProps.extent=a,this.initialExtentRequired=!1;else{var b=this.viewpoint;p.setExtent(b,b,a,this.size,
{constraints:this.constraints});this.viewpoint=b}},_paddingGetter:function(){return this._proxyProps?this._proxyProps.padding:this.state.padding},_paddingSetter:function(a){a=l.mixin({top:0,right:0,bottom:0,left:0},a);if(this._proxyProps)return this._proxyProps.padding=a;this.state.padding=a;return this.state.padding},rotation:0,_rotationGetter:function(){return this._proxyProps?this._proxyProps.rotation:this.content.rotation},_rotationSetter:function(a){if(null!=a)if(this._proxyProps)this._proxyProps.rotation=
a;else{var b=this.viewpoint;p.rotateTo(b,b,a);this.viewpoint=b}},scale:0,_scaleGetter:function(){return this._proxyProps?this._proxyProps.scale:this.content.scale},_scaleSetter:function(a){if(null!=a)if(this._proxyProps)this._proxyProps.scale=a,null!=this._proxyProps.center&&null!=this._proxyProps.scale&&(this.initialExtentRequired=!1);else{var b=this.viewpoint;p.scaleTo(b,b,a);this.viewpoint=b}},_surfaceSetter:function(b,c){if(c===b)return c;c&&(this.stage.destroy(),this._zoomBox.destroy(),this._zoomBox=
null,this.gestureManager.destroy(),this.gestureManager=null);if(b){this.stage=new z({container:b,scheduler:a.instance});this.gestureManager=new d({view:this,surface:b,inputOptions:{mouseModifiers:!0}});var e=new w({view:this});this.addHandler(e);this._zoomBox=new t({view:this})}return b},_tileInfoGetter:function(){return x(this,"map.basemap.baseLayers.0.tileInfo")||x(this,"map.layers.0.tileInfo")},type:"2d",viewpoint:null,_viewpointGetter:function(a){var b=this._proxyProps?this._proxyProps.viewpoint:
this.content.viewpoint;return!b?b:!a?b.clone():p.copy(a,b)},_viewpointSetter:function(a){null!=a&&(this._proxyProps?(this._proxyProps.viewpoint=a,this.initialExtentRequired=!1):(this.constraints.constrain(a,this.content.viewpoint,this),this.state.viewpoint=a))},zoom:-1,_zoomGetter:function(){return this._proxyProps?this._proxyProps.zoom:this.constraints.scaleToZoom(this.scale)},_zoomSetter:function(a){if(null!=a){if(this._proxyProps)return this._proxyProps.zoom=a,this.initialExtentRequired=!1,a;if(!this.constraints.effectiveLODs)return null;
var b=this.viewpoint;p.scaleTo(b,b,this.constraints.zoomToScale(a));this.viewpoint=b}},goTo:function(a,b){var c=this.content;b=l.mixin({animate:!0},b,{spatialReference:this.spatialReference||null,size:c?c.size:this.size,currentViewpoint:c?c.viewpoint:this.viewpoint,constraints:this.constraints,snapToZoom:this.constraints.snapToZoom});return p.createAsync(a,b).then(function(a){if(b.animate){var c=null;if(!this.ready||!this.animationManager)return this.viewpoint=a,c=new n({target:a}),c.finish(),c;this.constraints.constrain(a,
this.viewpoint,this);return c=this.animation=this.animationManager.animateTo(a,this.viewpoint,b)}this.viewpoint=a}.bind(this))},animateTo:function(a,b){c.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0");return this.goTo(a,b)},hitTest:function(a,b){if(!this.ready)return null;var c;c=null!=a&&a.x?a:{x:a,y:b};var d=this.toMap(c),e=[this._graphicsView].concat(this.allLayerViews.toArray());return f(e.map(function(c){return!c.hitTest?null:c.hitTest(a,b)})).then(function(a){return{screenPoint:c,
results:a.filter(function(a){return a}).map(function(a){return{mapPoint:d,graphic:a}})}})},toMap:function(a,b,c){if(!this.ready)return null;a&&null!=a.x&&(c=b,b=a.y,a=a.x);var d=[0,0];this.state.toMap(d,[a,b]);c=c||new e;c.x=d[0];c.y=d[1];c.spatialReference=this.spatialReference;return c},toScreen:function(a,b,c,d){if(!this.ready)return null;a&&null!=a.x&&(d=b,b=a.y,a=a.x);d=c||d||new g;a=[a,b];this.state.toScreen(a,a);d.x=a[0];d.y=a[1];return d},pixelSizeAt:function(a,b){if(!this.ready)return NaN;
a&&null!=a.x&&(b=a.y,a=a.x);return this.content.pixelSizeAt([a,b])},scheduleLayerViewUpdate:function(a){this._pendingUpdates.add(a);this.ready&&this._updateTask.resume()},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")},_readyGetter:function(a){var b=this.inherited(arguments);if(!!b===!!a)return a;this._ready=b;if(!b&&a)return this.layerViewManager.empty(),this._viewsChangeHandler({added:[],removed:this.allLayerViews.toArray(),
moved:[]}),this._proxyProps={viewpoint:this.viewpoint,padding:this.padding},b;this.constraints.view=this;var c=this._proxyProps,d=this.get("map.initialViewProperties.viewpoint"),d=p.create(d&&!c.center&&!c.extent?{viewpoint:d}:c,{spatialReference:this.spatialReference,size:this.size,constraints:this.constraints,extent:this.initialExtent}),c=new y({padding:c.padding,size:this.size,viewpoint:d});this._proxyProps=null;this.initialExtentRequired=!0;this.animationManager=new q;this.state=c;this.content=
c.content;this._handles.remove("allLayerViews");this._viewsChangeHandler({added:this.allLayerViews.toArray(),removed:[],moved:[]});this._handles.add(this.allLayerViews.on("change",this._viewsChangeHandler.bind(this)),"allLayerViews");this.stage.state=c;this.stage.run();this._pendingUpdates.length&&this._updateTask.resume();return b},_viewsChangeHandler:function(a){var b=this.allLayerViews.filter(function(a){return!a.layerViews}),c=a.added,d=a.removed;a=a.moved;var e,f;e=0;for(f=d.length;e<f;e++)this.stage.removeChild(d[e].container);
e=0;for(f=c.length;e<f;e++)c[e].container&&this.stage.addChildAt(c[e].container,b.indexOf(c[e]));e=0;for(f=a.length;e<f;e++)this.stage.setChildIndex(a[e].container,b.indexOf(a[e]));var g=function(){this.updating=b.some(function(a){return a.updating})}.bind(this);this._handles.remove("layerViewsUpdating");this._handles.add(b.map(function(a){return a.watch("updating",g)}),"layerViewsUpdating")},_resizeHandler:function(a){var b=this.state;if(b){var c=this.content.viewpoint,d=this.content.size.concat();
b.size=[a.width,a.height];p.resize(c,c,d,this.content.size,this.resizeAlign);c=this.constraints.constrain(c,null,this);this.state.viewpoint=c}}})});