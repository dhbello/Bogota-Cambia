// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.1/esri/copyright.txt for details.
//>>built
define("require exports ./Texture ./ModelContentType ../../../webgl/Texture ../../../webgl/enums".split(" "),function(p,q,l,h,m,r){var k=function(){function a(a){this.textTextures={};this.id=l.idGen.gen(a)}a.prototype.getId=function(){return this.id};a.prototype.dispose=function(){};a.prototype.deferredLoading=function(){return!1};a.prototype.getWidth=function(){return 512};a.prototype.getHeight=function(){return 512};a.prototype.initializeThroughRender=function(n,f){var b=a._create2Dcanvas(),c=b.getContext("2d");
c.save();c.clearRect(0,0,512,512);f.wrapMode=33071;f.samplingMode=9729;f.flipped=!0;for(var d in this.textTextures){var e=this.textTextures[d];e.textTexture.renderText(1,e.placement.width,e.placement.height,c,e.placement.atlasOffX,e.placement.atlasOffY)}b=new m(n,f,b);c.restore();return b};a.prototype.setUnloadFunc=function(a){this._unloadFunc=a};a.prototype.unload=function(){null!=this._unloadFunc&&(this._unloadFunc(this.id),this._unloadFunc=null)};a._create2Dcanvas=function(){a._textCanvas2D||(a._textCanvas2D=
document.createElement("canvas"),a._textCanvas2D.setAttribute("id","canvas2d"),a._textCanvas2D.setAttribute("width",(512).toString()),a._textCanvas2D.setAttribute("height",(512).toString()),a._textCanvas2D.setAttribute("style","display:none"));return a._textCanvas2D};return a}();return function(){function a(a,f){this._textureAtlasSubtextures=[];this._curLineHeight=this._curY=this._curX=0;this._idHint=a;this._stage=f}a.prototype.dispose=function(){for(var a=0;a<this._textureAtlasSubtextures.length;a++)this._stage.remove(h.TEXTURE,
this._textureAtlasSubtextures[a].getId());this._textureAtlasSubtextures=[]};a.prototype.addTextTexture=function(a){for(var f=JSON.stringify(a.getParams())+"_"+a.getString(),b=0;b<this._textureAtlasSubtextures.length;b++){var c=this._textureAtlasSubtextures[b].textTextures[f];if(null!=c)return c.placement}var d=null;0===this._textureAtlasSubtextures.length&&(d=new k(this._idHint),this._textureAtlasSubtextures.push(d));var b=a.getTextWidth(),c=a.getTextHeight(),e,g;this._curLineHeight=Math.max(this._curLineHeight,
c);512>this._curX+b&&512>this._curY+this._curLineHeight||(512>this._curY+this._curLineHeight+c?(this._curX=0,this._curY+=this._curLineHeight):(d=new k(this._idHint),this._textureAtlasSubtextures.push(d),this._curY=this._curX=0),this._curLineHeight=c);e=this._curX;g=this._curY;this._curX+=b;null!=d&&this._stage.add(h.TEXTURE,d);d=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];b={uvMinMax:[e/512,1-(g+c)/512,(e+b)/512,1-g/512],atlasOffX:e,atlasOffY:g,width:b,height:c,texture:d};
d.textTextures[f]={placement:b,textTexture:a};return b};return a}()});