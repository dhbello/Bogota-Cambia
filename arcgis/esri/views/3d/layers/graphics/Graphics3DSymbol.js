// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.1/esri/copyright.txt for details.
//>>built
define(["../../../../core/declare","../../support/PromiseLightweight","./Graphics3DSymbolLayerFactory","./Graphics3DGraphic"],function(m,n,p,q){return m(n.Promise,{constructor:function(a,e,b){this.symbol=a;a=a.symbolLayers;b&&(a=b.concat(a));b=a.length;this.childGraphics3DSymbols=Array(a.length);this.childGraphics3DSymbolPromises=Array(a.length);for(var d=e.layerOrder,c=0,f=0,k=!1,l=function(a,b){b&&(this.childGraphics3DSymbols[a]=b,f++);c--;!this.isRejected()&&(k&&1>c)&&(0<f?this.resolve():this.reject())},
g=0;g<b;g++){var h=a.getItemAt(g);if(!1!==h.enabled&&(e.layerOrder=d+(1-(1+g)/b),e.layerOrderDelta=1/b,h=p.make(h,e,h._ignoreDrivers)))c++,this.childGraphics3DSymbolPromises[g]=h,h.then(l.bind(this,g,h),l.bind(this,g,null))}e.layerOrder=d;k=!0;!this.isRejected()&&1>c&&(0<f?this.resolve():this.reject())},createGraphics3DGraphic:function(a,e,b){for(var d=Array(this.childGraphics3DSymbols.length),c=0;c<this.childGraphics3DSymbols.length;c++){var f=this.childGraphics3DSymbols[c];f&&(d[c]=f.createGraphics3DGraphic(a,
e))}return new q(a,b||this,d)},layerPropertyChanged:function(a,e){for(var b=this.childGraphics3DSymbols.length,d=0;d<b;d++){var c=this.childGraphics3DSymbols[d];if(c&&!c.layerPropertyChanged(a,e,d))return!1}return!0},setDrawOrder:function(a,e){for(var b=this.childGraphics3DSymbols.length,d=1/b,c=0;c<b;c++){var f=this.childGraphics3DSymbols[c];f&&f.setDrawOrder(a+(1-(1+c)/b),d,e)}},destroy:function(){this.isFulfilled()||this.reject();for(var a=0;a<this.childGraphics3DSymbolPromises.length;a++)this.childGraphics3DSymbolPromises[a]&&
this.childGraphics3DSymbolPromises[a].destroy()}})});