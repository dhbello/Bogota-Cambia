// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.1/esri/copyright.txt for details.
//>>built
require({cache:{"esri/geometry/ScreenPoint":function(){define(["./Point"],function(q){return q.createSubclass({declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/webscene/Environment":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./Lighting".split(" "),function(q,n,k,f,c,b,a){return function(e){function h(b){e.call(this,b);this.lighting=new a}k(h,e);h.prototype.clone=
function(){return new h({lighting:a.prototype.clone.call(this.lighting)})};h.sanitizeJSON=function(b){return{lighting:b.lighting?a.sanitizeJSON(b.lighting):(new a).toJSON()}};f([b.property({type:a,json:{writable:!0}})],h.prototype,"lighting",void 0);return h=f([b.subclass("esri.webscene.Environment")],h)}(b.declared(c))})},"esri/webscene/Lighting":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(q,n,k,f,c,b){return function(a){function e(b){a.call(this,b);this.date=null;this.directShadowsEnabled=!1;this.displayUTCOffset=null}k(e,a);e.prototype.readDate=function(a,b){return null!=b.datetime&&new Date(b.datetime)||null};e.prototype.writeDate=function(a,b){null!=a&&(b.datetime=a.getTime())};e.prototype.readDirectShadowsEnabled=function(a,b){return!!b.directShadows};e.prototype.writedirectShadowsEnabled=function(a,b){a&&(b.directShadows=!0)};e.prototype.writeDisplayUTCOffset=function(a,
b){null!=a&&(b.displayUTCOffset=a)};e.prototype.clone=function(){return new e({date:null!=this.date?new Date(this.date.getTime()):null,directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null})};e.sanitizeJSON=function(a){var b={datetime:a.datetime};void 0!==a.directShadows&&(b.directShadows=!!a.directShadows);void 0!==a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset);return b};f([b.property({type:Date})],e.prototype,"date",void 0);
f([b.read("date",["datetime"])],e.prototype,"readDate",null);f([b.write("date")],e.prototype,"writeDate",null);f([b.property({type:Boolean})],e.prototype,"directShadowsEnabled",void 0);f([b.read("directShadowsEnabled",["directShadows"])],e.prototype,"readDirectShadowsEnabled",null);f([b.write("directShadowsEnabled")],e.prototype,"writedirectShadowsEnabled",null);f([b.property({type:Number,json:{writable:!0}})],e.prototype,"displayUTCOffset",void 0);f([b.write("displayUTCOffset")],e.prototype,"writeDisplayUTCOffset",
null);return e=f([b.subclass("esri.webscene.Lighting")],e)}(b.declared(c))})},"esri/views/3d/environment/SceneViewEnvironment":function(){define(["dojo/_base/lang","../../../webscene/Environment","../../../webscene/Lighting","./SceneViewLighting","./SceneViewAtmosphere"],function(q,n,k,f,c){var b=n.createSubclass({declaredClass:"esri.views.3d.environment.SceneViewEnvironment",properties:{atmosphere:{type:c,json:{readable:!1}},atmosphereEnabled:{value:!0,json:{readable:!1}},starsEnabled:{value:!0,
json:{readable:!1}},lighting:{set:function(a){if(a)if(this.lighting)null!=a.date&&(this.lighting.date=a.date),null!=a.displayUTCOffset&&(this.lighting.displayUTCOffset=a.displayUTCOffset),this.lighting.directShadowsEnabled=a.directShadowsEnabled,null!=a.ambientOcclusionEnabled&&(this.lighting.ambientOcclusionEnabled=a.ambientOcclusionEnabled),null!=a.cameraTrackingEnabled&&(this.lighting.cameraTrackingEnabled=a.cameraTrackingEnabled);else if(a instanceof f)this._set("lighting",a);else if(a instanceof
k){var b={directShadowsEnabled:a.directShadowsEnabled};null!=a.date&&(b.date=a.date);null!=a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset);this._set("lighting",new f(b))}else this._set("lighting",new f(a));else this.lighting||this._set("lighting",new f)}}},getDefaults:function(){return q.mixin(this.inherited(arguments),{atmosphere:{}})},atmosphere:null,atmosphereEnabled:!0,starsEnabled:!0,clone:function(){return new b({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),
atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled})}});return b})},"esri/views/3d/environment/SceneViewLighting":function(){define(["../../../core/Evented","../../../webscene/Lighting"],function(q,n){var k=new Date("March 15, 2015 12:00:00 UTC"),f=new Date,c={target:null,date:null},b={target:null,timezoneOffset:0};return n.createSubclass([q],{declaredClass:"esri.views.3d.environment.SceneViewLighting",properties:{cameraTrackingEnabled:{value:!0},ambientOcclusionEnabled:{value:!1},
date:{cast:function(a){return a},set:function(a){null!=a&&(this._set("date",new Date(a)),a!==k&&a!==this._autoUpdateDate&&(this.positionTimezoneInfo.autoUpdated=!1),c.target=this,f.setTime(this._get("date").getTime()),c.date=f,this.emit("date-will-change",c))}}},constructor:function(){this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};this._autoUpdateDate=null},getDefaults:function(){return{date:k}},_calculateTimezoneOffset:function(a){return Math.round(a.hours+a.minutes/60+a.seconds/
3600)},autoUpdate:function(a,e){var h=this._calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=e.hours;this.positionTimezoneInfo.minutes=e.minutes;this.positionTimezoneInfo.seconds=e.seconds;this.positionTimezoneInfo.autoUpdated=!0;if(null!=a){var g=this.date&&this.date.getTime();this.date=this._autoUpdateDate=a;this._autoUpdateDate=null}var d=this._calculateTimezoneOffset(this.positionTimezoneInfo);h!==d&&(b.target=this,b.timezoneOffset=d,this.emit("timezone-will-change",
b));if(null!=a)return g!==a.getTime()}})})},"esri/views/3d/environment/SceneViewAtmosphere":function(){define(["../../../core/Accessor"],function(q){return q.createSubclass({properties:{quality:{}},quality:"low",_qualitySetter:function(n){-1!==["low","high"].indexOf(n)&&this._set("quality",n)},clone:function(){return new this.constructor({quality:this.quality})}})})},"esri/views/3d/environment/SceneViewEnvironmentManager":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../geometry/SpatialReference ../support/sunUtils ../support/earthUtils ./EnvironmentRenderer".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m){var l=new Date,p={hours:0,minutes:0,seconds:0},s=[0.5773502691896258,-0.5773502691896258,0.5773502691896258];q=q([n,k],{declaredClass:"esri.views.3d.environment.SceneViewEnvironmentManager",referencePointUpdateDelay:200,referencePointUpdateInterval:3E3,referencePointUpdateDistThreshold:1E6,properties:{updating:{dependsOn:["noReferencePositionQueries"],readOnly:!0,get:function(){return!this.noReferencePositionQueries&&(!!this._referencePosUpdateQuery||!!this._referencePosMapCoordsRequested)}},
noReferencePositionQueries:{},view:{},_environmentRenderer:{}},constructor:function(){this._viewHandles=new b;this._environmentRenderer=null;this._viewConnected=this._trackingEnabled=this._preserveAbsoluteDateTime=!1;this._referencePosResetPreserveAbsoluteTime=null;this._resetReferencePosition()},destroy:function(){this._viewHandles.destroy();this.disposeRendering()},disposeRendering:function(){this._environmentRenderer&&(this._environmentRenderer.destroy(),this._environmentRenderer=null);this._resetReferencePosition(!0)},
updateReadyChange:function(d){d&&!this._viewConnected?(this._viewConnected=!0,this.connectView(this.view)):!d&&this._viewConnected&&(this._viewConnected=!1,this.disconnectView(this.view))},connectView:function(d){this._environmentRenderer=new m({view:d});this._viewHandles.add([c.on(this.view,"environment.lighting","date-will-change",this._lightingDateHandler.bind(this)),this.view.watch("interacting,stationary",this._interactingStationaryHandler.bind(this)),this.view.watch("environment.lighting.directShadowsEnabled,environment.lighting.ambientOcclusionEnabled",
this._updateRenderParamsHandler.bind(this)),this.view.watch("spatialReference",this._spatialReferenceHandler.bind(this)),c.init(this.view,"viewingMode",this._viewingModeHandler.bind(this)),c.init(this.view,"environment.lighting.cameraTrackingEnabled",this._updateCameraTracking.bind(this)),this.watch("noReferencePositionQueries",this._cameraHandler.bind(this,null))]);this._updateRenderParamsHandler();this._updateLightParams();this._cameraHandler()},_updateCameraTracking:function(d){if(this._trackingEnabled=
d)d=c.on(this,"view.navigation","currentViewChanged",this._cameraHandler.bind(this,null),this._cameraHandler.bind(this,null),null,!0),this._viewHandles.add(d,"camera");else{if(d=this.get("view.environment.lighting"))d.positionTimezoneInfo.autoUpdated=!1;this._viewHandles.remove("camera")}},disconnectView:function(d){this.disposeRendering();this._viewHandles.removeAll()},_lightingDateHandler:function(a){if(a=a.date){var b=this.view.environment.lighting;if(!b.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=
!0;var e=this.view.spatialReference;if(!e.isWGS84&&!e.isWebMercator&&(e=this.view.camera.position,!this._referencePosMapCoords||!this._referencePosMapCoords.equals(e))){this._requestReferencePositionUpdate(e);return}this._preupdateTracking(a);this._referencePosWGS84&&(e=d.positionToTimezone(this._referencePosWGS84,p),b.autoUpdate(null,e))}this._updateLightParams(a)}},_preupdateTracking:function(d){!this._trackingEnabled&&this.get("view.environment.lighting.cameraTrackingEnabled")&&this._cameraHandler(d)},
_cameraHandler:function(d){var a=this.view.camera;if(a){var b=this.view.spatialReference;b.isWGS84||b.isWebMercator?this._cameraHandlerGlobal(a,d):this._cameraHandlerLocal(a,d)}},_cameraHandlerGlobal:function(d,b){var g=d.position;this._referencePosWGS84||(this._referencePosWGS84=new a({spatialReference:h.WGS84}));g.spatialReference.isWebMercator?e.webMercatorToGeographic(g,!1,this._referencePosWGS84):(this._referencePosWGS84.x=g.x,this._referencePosWGS84.y=g.y);this._referencePosWGS84.z=g.z;this._autoUpdateTimezone(g,
b)||this._updateLightParams(b)},_cameraHandlerLocal:function(d,a){var b=d.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(b))&&this._requestReferencePositionUpdate(b,!0);this.view.mapCoordsHelper&&this._referencePosWGS84&&(this._referencePosWGS84.z=b.z*this.view.mapCoordsHelper.unitInMeters,this._referencePosChanged())},_interactingStationaryHandler:function(){!this.view.interacting&&this.view.stationary&&this._executePendingReferencePositionUpdate()},
_updateLightParams:function(d){var a=this.view.environment.lighting;d=d||a.date;var a=this.view._stage,b;this._referencePosWGS84?(b=g.computeColorAndIntensity(d,this._referencePosWGS84),g.computeDirection(d,this._referencePosWGS84,this.view.viewingMode,b.diffuse.direction)):b={diffuse:{color:[1,1,1],intensity:0.5,direction:s},ambient:{color:[1,1,1],intensity:0.5}};a.setDirectionalLight(b.diffuse);a.setAmbientLight(b.ambient);this._updateRenderParamsHandler()},_autoUpdateTimezone:function(a,b){if(!this.view.get("environment.lighting.cameraTrackingEnabled"))return!1;
l.setTime((b||this.view.environment.lighting.date).getTime());var e=d.positionToTimezone(a,p),h=this.view.environment.lighting.positionTimezoneInfo;if(h.autoUpdated){if(h.hours===e.hours&&h.minutes===e.minutes&&h.seconds===e.seconds)return!1}else h=e;var g=l.getUTCHours()-(e.hours-h.hours),c=l.getUTCMinutes()-(e.minutes-h.minutes),h=l.getUTCSeconds()-(e.seconds-h.seconds);l.setUTCHours(g);l.setUTCMinutes(c);l.setUTCSeconds(h);return b?!1:this.view.environment.lighting.autoUpdate(l,e)},_updateRenderParamsHandler:function(){var d=
this.view._stage,a=!0;this._referencePosWGS84&&(a=g.computeShadowsEnabled(this._referencePosWGS84,this.view.viewingMode));d&&d.setRenderParams({shadowMap:this.view.environment.lighting.directShadowsEnabled&&a,ssao:this.view.environment.lighting.ambientOcclusionEnabled})},_spatialReferenceHandler:function(){this._resetReferencePosition()},_viewingModeHandler:function(d){this._resetReferencePosition()},_resetReferencePosition:function(d){this._cancelReferencePosUpdates();this._referencePosWGS84=this._referencePosResetPreserveAbsoluteTime=
this._referencePosMapCoordsRequested=this._referencePosMapCoords=null;d||this.notifyChange("updating")},_requestReferencePositionUpdate:function(d,a){if(this.view.mapCoordsHelper.canProject()&&!this.noReferencePositionQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(d):this._referencePosMapCoordsRequested=d.clone(),this._referencePosResetPreserveAbsoluteTime=!!a,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&!this.view.interacting&&this.view.stationary)){var b=
this,e=this._referencePosUpdateQuery=f.after(this.referencePointUpdateDelay).then(function(){if(b._referencePosUpdateQuery===e)return b._doReferencePositionUpdateQuery(function(){return b._referencePosUpdateQuery!==e})}).always(function(){b._referencePosUpdateQuery===e&&(b._referencePosUpdateQuery=null,b._referencePosUpdateTimer||b._executePendingReferencePositionUpdate(),b.notifyChange("updating"))}),h=this._referencePosUpdateTimer=f.after(this.referencePointUpdateInterval).then(function(){b._referencePosUpdateTimer===
h&&(b._referencePosUpdateTimer=null,b._referencePosUpdateQuery||b._executePendingReferencePositionUpdate())});this.notifyChange("updating")}},_doReferencePositionUpdateQuery:function(d){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1);this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone();this._referencePosMapCoordsRequested=this._referencePosResetPreserveAbsoluteTime=
null;return this.view.mapCoordsHelper.toGeographic(this._referencePosMapCoords).then(function(b){if(!d()&&!isNaN(b[0])&&!isNaN(b[1])){var e=this._referencePosMapCoords.z*this.view.mapCoordsHelper.unitInMeters;this._referencePosWGS84?(this._referencePosWGS84.x=b[0],this._referencePosWGS84.y=b[1],this._referencePosWGS84.z=e):this._referencePosWGS84=new a({x:b[0],y:b[1],z:e,spatialReference:h.WGS84});this._referencePosChanged()}}.bind(this))},_executePendingReferencePositionUpdate:function(){var d=this._referencePosMapCoordsRequested;
d&&this._requestReferencePositionUpdate(d,this._referencePosResetPreserveAbsoluteTime)},_referencePosChanged:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84)||this._updateLightParams()},_exceedsReferencePosDistThreshold:function(d){return this._referencePosMapCoords?(d=this._referencePosMapCoords.distance(d),this.view.mapCoordsHelper&&(d*=this.view.mapCoordsHelper.unitInMeters),d>this.referencePointUpdateDistThreshold):!0},_cancelReferencePosUpdates:function(){this._referencePosUpdateTimer=
this._referencePosUpdateQuery=null}});q.FIXED_LIGHT_DIRECTION=s;return q})},"esri/views/3d/support/sunUtils":function(){define(["./mathUtils","../lib/glMatrix","../lib/SunCalc"],function(q,n,k){var f=n.vec3d,c=n.mat4d,b=q.lerp,a=c.identity(),e={azimuth:0,altitude:0};n={local:{altitude:2E3,ambientAtNight:0.2,ambientAtNoon:0.75,ambientAtTwilight:0.5,diffuseAtNoon:0.25,diffuseAtTwilight:0.5},global:{altitude:2E4,ambient:0.5,diffuse:0.5},planarDirection:{localAltitude:1E5,globalAltitude:1E6,globalAngles:{azimuth:Math.PI/
2,altitude:Math.PI/2}}};var h={ambient:{color:f.create(),intensity:0},diffuse:{color:f.create(),intensity:0,direction:f.create()}},g={settings:n,computeDirection:function(d,b,h,s){s||(s=f.create());var r=c.identity(a);if("global"===h)k.getPosition(d,0,0,e),f.set3(0,0,-1,s),c.rotateX(r,-e.azimuth),c.rotateY(r,-e.altitude);else{var t=g.settings.planarDirection;h=t.globalAngles;t=(b.z-t.localAltitude)/(t.globalAltitude-t.localAltitude);t=q.clamp(t,0,1);1>t?(k.getPosition(d,b.y,b.x,e),e.azimuth=(1-t)*
e.azimuth+t*h.azimuth,e.altitude=(1-t)*e.altitude+t*h.altitude):(e.azimuth=h.azimuth,e.altitude=h.altitude);f.set3(0,-1,0,s);c.rotateZ(r,-e.azimuth);c.rotateX(r,-e.altitude)}c.multiplyVec3(r,s);return s},computeShadowsEnabled:function(d,b){return"global"===b?!0:d.z<g.settings.planarDirection.localAltitude},computeColorAndIntensity:function(a,e){var p,c,r,t=e.z;c=g.settings;f.set3(1,1,1,h.ambient.color);h.ambient.intensity=c.global.ambient;f.set3(1,1,1,h.diffuse.color);h.diffuse.intensity=c.global.diffuse;
t=(t-c.local.altitude)/(c.global.altitude-c.local.altitude);t=q.clamp(t,0,1);if(1>t){r=k.getTimes(a,e.y,e.x);c=a.valueOf();var u,v;r.polarException===k.POLAR_EXCEPTION.MIDNIGHT_SUN?(u=c-36E5*(a.getHours()+48)-6E4*a.getMinutes(),v=u+432E6):r.polarException===k.POLAR_EXCEPTION.POLAR_NIGHT?(u=c-2,v=c-1):(u=r.sunrise.valueOf(),v=r.sunset.valueOf());var C=v-u;r=u+C/2;var y=C/4;p=r-y;var y=r+y,x=0.06*C,C=u-x/2;u+=x/2;var B=v-x/2,z=v+x/2;v=g.settings.local;var A=[0.01,v.ambientAtNight],w=[0.8,0.8,1],D=[0.01,
0.01,0.01],E=[v.diffuseAtTwilight,v.ambientAtTwilight],H=[1,0.75,0.75],G=[0.8,0.8,1],I=[0.9*v.diffuseAtNoon,v.ambientAtNoon],O=[1,0.98,0.98],n=[0.98,0.98,1],F=[v.diffuseAtNoon,v.ambientAtNoon],K=[1,1,1],T=[1,1,1];v=[0,0];var R=[0,0],x=[0,0];c<C||c>z?(v=A,R=D,x=w):c<u?(x=u-C,v=d(c-C,x,A,E),R=d(c-C,x,D,H),x=d(c-C,x,w,G)):c<p?(x=p-u,v=d(c-u,x,E,I),R=d(c-u,x,H,O),x=d(c-u,x,G,n)):c<r?(x=r-p,v=d(c-p,x,I,F),R=d(c-p,x,O,K),x=d(c-p,x,n,T)):c<y?(x=y-r,v=d(c-r,x,F,I),R=d(c-r,x,K,O),x=d(c-r,x,T,n)):c<B?(x=B-
y,v=d(c-y,x,I,E),R=d(c-y,x,O,H),x=d(c-y,x,n,G)):c<z&&(x=z-B,v=d(c-B,x,E,A),R=d(c-B,x,H,D),x=d(c-B,x,G,w));c=v[0];r=R;p=v[1];f.lerp(x,h.ambient.color,t,h.ambient.color);h.ambient.intensity=b(p,h.ambient.intensity,t);f.lerp(r,h.diffuse.color,t,h.diffuse.color);h.diffuse.intensity=b(c,h.diffuse.intensity,t)}return h}},d=function(d,b,a,e){for(var h=[],g=0;g<a.length;g++)h[g]=(e[g]-a[g])*d/b+a[g];return h};return g})},"esri/views/3d/lib/SunCalc":function(){define([],function(){function q(d){return new Date((d+
0.5-p)*l)}function n(d,e){return h(b(e)*a(t)+a(e)*b(t)*b(d))}function k(d,h){var p=m*(357.5291+0.98560028*d),r=m*(1.9148*b(p)+0.02*b(2*p)+3E-4*b(3*p)),p=p+r+102.9372*m+c;h||(h={dec:0,ra:0});h.dec=n(p,0);h.ra=g(b(p)*a(t)-e(0)*b(t),a(p));return h}function f(d){var h=m*(134.963+13.064993*d),c=m*(93.272+13.22935*d);d=m*(218.316+13.176396*d)+6.289*m*b(h);c=5.128*m*b(c);h=385001-20905*a(h);return{ra:g(b(d)*a(t)-e(c)*b(t),a(d)),dec:n(d,c),dist:h}}var c=Math.PI,b=Math.sin,a=Math.cos,e=Math.tan,h=Math.asin,
g=Math.atan2,d=Math.acos,m=c/180,l=864E5,p=2440588,s=2451545,r={dec:0,ra:0},t=23.4397*m,u={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(d,c,f,t){f=m*-f;c*=m;var u=d.valueOf()/l-0.5+p-s;d=k(u,r);f=m*(280.16+360.9856235*u)-f-d.ra;t||(t={azimuth:0,altitude:0});t.azimuth=g(b(f),a(f)*b(c)-e(d.dec)*a(c));t.altitude=h(b(c)*b(d.dec)+a(c)*a(d.dec)*a(f));return t}},v=[[-0.83,"sunrise","sunset"]];u.addTime=function(d,a,b){v.push([d,a,b])};var C=9E-4;u.getTimes=function(e,h,g){function r(e){e=
d((b(e)-b(t)*b(G))/(a(t)*a(G)));return s+(C+(e+f)/(2*c)+k)+0.0053*b(E)-0.0069*b(2*H)}var f=m*-g,t=m*h,k=Math.round(e.valueOf()/l-0.5+p-s-C-f/(2*c));e=C+(0+f)/(2*c)+k;var E=m*(357.5291+0.98560028*e);h=m*(1.9148*b(E)+0.02*b(2*E)+3E-4*b(3*E));var H=E+h+102.9372*m+c,G=n(H,0);e=s+e+0.0053*b(E)-0.0069*b(2*H);h={solarNoon:q(e),nadir:q(e-0.5),polarException:u.POLAR_EXCEPTION.NORMAL};var I,O,J,F;g=0;for(I=v.length;g<I;g+=1)O=v[g],J=r(O[0]*m),F=e-(J-e),h[O[1]]=q(F),h[O[2]]=q(J);h.polarException=function(d){d=
(b(d)-b(t)*b(G))/(a(t)*a(G));return-1>d?u.POLAR_EXCEPTION.MIDNIGHT_SUN:1<d?u.POLAR_EXCEPTION.POLAR_NIGHT:u.POLAR_EXCEPTION.NORMAL}(v[0][0]*m);return h};u.getMoonPosition=function(d,c,r){r=m*-r;c*=m;var t=d.valueOf()/l-0.5+p-s;d=f(t);r=m*(280.16+360.9856235*t)-r-d.ra;t=h(b(c)*b(d.dec)+a(c)*a(d.dec)*a(r));t+=0.017*m/e(t+10.26*m/(t+5.1*m));return{azimuth:g(b(r),a(r)*b(c)-e(d.dec)*a(c)),altitude:t,distance:d.dist}};u.getMoonFraction=function(e){var h=e.valueOf()/l-0.5+p-s;e=k(h);h=f(h);e=d(b(e.dec)*b(h.dec)+
a(e.dec)*a(h.dec)*a(e.ra-h.ra));e=g(149598E3*b(e),h.dist-149598E3*a(e));return(1+a(e))/2};return u})},"esri/views/3d/support/earthUtils":function(){define(["dojo/_base/lang","./mathUtils","../../../geometry/Point","../../../geometry/SpatialReference","../../../geometry/support/webMercatorUtils"],function(q,n,k,f,c){var b=6378137,a=Math.PI*b,e=new k(0,0,f.WGS84),h={earthRadius:b,halfEarthCircumference:a,earthCircumference:2*a,metersPerDegree:a/180,getGreatCircleDistance:function(a,d,e,h){void 0===
e&&(void 0===h&&q.isObject(a)&&q.isObject(d))&&(e=d.get("longitude"),h=d.get("latitude"),d=a.get("latitude"),a=a.get("longitude"));d=n.deg2rad(d);h=n.deg2rad(h);a=n.deg2rad(a);e=n.deg2rad(e);a-=e;e=Math.sin((d-h)/2);a=Math.sin(a/2);d=2*n.asin(Math.sqrt(e*e+Math.cos(d)*Math.cos(h)*a*a))*b;return d=Math.round(1E4*d)/1E4},getGreatCircleSpanAt:function(a,d,b){var e=d.spatialReference,h=new k(d.x,a.y,e),c=new k(b.x,a.y,e);d=new k(a.x,d.y,e);a=new k(a.x,b.y,e);return{lon:this.getGreatCircleDistance(h,c),
lat:this.getGreatCircleDistance(d,a)}},getLonDeltaForDistance:function(a,d,e){a=e/b;d=n.deg2rad(d);a=Math.sin(a/2);d=Math.cos(d);d=2*n.asin(Math.sqrt(a*a/(d*d)));return n.rad2deg(d)},getLatDeltaForDistance:function(a,d,e){return n.rad2deg(e/b)},getLatLonDeltaForDistance:function(a,d,b){return{lat:this.getLatDeltaForDistance(a,d,b),lon:this.getLonDeltaForDistance(a,d,b)}},getMaxCameraAltitude:function(a){a=n.deg2rad(a/2);return(1-Math.sin(a))*b/Math.sin(a)},getViewExtentDistance:function(a,d){var e=
n.deg2rad(d/2),e=(a+b)*Math.cos(e)-Math.sqrt(Math.pow(Math.cos(e)*(a+b),2)-a*a-2*a*b);return 2*n.acos((Math.pow(a+b,2)+Math.pow(b,2)-Math.pow(e,2))/(2*(a+b)*b))*b},computeCarthesianDistance:function(a,d){function e(d){var a=n.deg2rad(d.get("latitude")),h=n.deg2rad(d.get("longitude")),c=Math.cos(a);d=b+(d.z||0);return[Math.cos(h)*c*d,Math.sin(a)*d,-Math.sin(h)*c*d]}var h=e(a),c=e(d),h=[c[0]-h[0],c[1]-h[1],c[2]-h[2]];return Math.sqrt(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])},longitudeToTimezone:function(a,d){var b=
a/15;d||(b=Math.round(b));return b},positionToTimezone:function(a,d){a.spatialReference.wkid!==f.WGS84.wkid?c.webMercatorToGeographic(a,!1,e):(e.x=a.x,e.y=a.y);e.z=a.z;d||(d={hours:0,minutes:0,seconds:0});d.hours=h.longitudeToTimezone(e.x,!0);var b=d.hours%1;d.hours-=b;d.minutes=60*b;b=d.minutes%1;d.minutes-=b;d.seconds=Math.round(60*b);return d}};return h})},"esri/views/3d/environment/EnvironmentRenderer":function(){define("../../../core/watchUtils ../support/ExternalRenderer ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars ../webgl-engine/lib/RenderSlot".split(" "),
function(q,n,k,f,c,b,a){return n.createSubclass({declaredClass:"esri.views.3d.environment.EnvironmentRenderer",properties:{view:{},viewingMode:{dependsOn:["view.viewingMode"],get:function(){return this.get("view.viewingMode")||"global"}},atmosphereQuality:{dependsOn:["view.environment.atmosphereEnabled","view.environment.atmosphere.quality"],get:function(){return this.get("view.environment.atmosphereEnabled")?this.get("view.environment.atmosphere.quality")||"none":"none"}},starsEnabled:{dependsOn:["view.environment.starsEnabled"],
get:function(){return this.get("view.environment.starsEnabled")||!1}},transparent:{dependsOn:["view.basemapTerrain.opacity","view.basemapTerrain.wireframe"],get:function(){var a=this.get("view.basemapTerrain");return a&&a._renderer.isTransparent()}},_atmosphere:{},_stars:{},needsDepthMap:{dependsOn:["_stars.needsDepthMap","_atmosphere.needsDepthMap"],get:function(){return this._atmosphere&&this._atmosphere.needsDepthMap||this._stars&&this._stars.needsDepthMap}},needsRender:{dependsOn:["_stars.needsRender",
"_atmosphere.needsRender"],get:function(){return!(!this._needsRender&&!(this._atmosphere&&this._atmosphere.needsRender||this._stars&&this._stars.needsRender))}}},constructor:function(){this._STANDARD_SLOT=a.BACKGROUND;this._SPECIAL_SLOT=a.POSTPROCESSING_ATMOSPHERE;this._slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];this._stars=this._atmosphere=this._atmosphereReadyPromise=this._AtmosphereClass=null;this._needsRender=!0;this.notifyChange("needsRender")},initialize:function(){this.view._stage.addExternalRenderer(this._slots,
this);this._basemapTerrainHandle=q.when(this.view,"basemapTerrain",this._updateBasemapTerrain.bind(this))},destroy:function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null);this._stars&&(this._stars.destroy(),this._stars=null);this._basemapTerrainHandle&&this._basemapTerrainHandle.remove();this.view&&(this.view._stage.removeExternalRenderer(this),this.view=null)},setup:function(a){this.watch("viewingMode,atmosphereQuality,transparent,visible",this._updateAtmosphere.bind(this));
this._updateAtmosphere();this.watch("starsEnabled,transparent,visible",this._updateStars.bind(this));this._updateStars();this.watch("view.basemapTerrain.loaded",function(){this._needsRender=!0;this.notifyChange("needsRender")}.bind(this))},resetNeedsRender:function(){this._atmosphere&&(this._atmosphere.resetNeedsRender?this._atmosphere.resetNeedsRender():this._atmosphere.didRender&&(this._atmosphere.needsRender=!1,this._atmosphere.didRender=!1));this._stars&&(this._stars.resetNeedsRender?this._stars.resetNeedsRender():
this._stars.didRender&&(this._stars.needsRender=!1,this._stars.didRender=!1));this.didRender&&(this.didRender=this._needsRender=!1,this.notifyChange("needsRender"))},render:function(a){if(!this.get("view.basemapTerrain.loaded")&&"global"===this.viewingMode)return!1;if(!this._stars&&!this._atmosphere)return!0;this._stars&&this._stars.render(a);this._atmosphere&&this._atmosphere.render(a);return this._stars&&this._stars.didRender||this._atmosphere&&this._atmosphere.didRender},_updateStars:function(){var a=
this._getAtmosphereSlot();this.starsEnabled&&!this._stars?(this._stars=new b({view:this.view,slot:a}),this._stars.initializeRenderContext(this.renderContext)):!this.starsEnabled&&this._stars?(this._stars.destroy(),this._stars=null):this._stars&&(this._stars.slot=a);this._needsRender=!0;this.notifyChange("needsRender")},_updateAtmosphere:function(){var a=this._getAtmosphereSlot();this._atmosphere&&(this._atmosphere.slot=a);if(this._updateAtmosphereClass(this.renderContext)){this._needsRender=!0;this.notifyChange("needsRender");
var b=function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null)}.bind(this);if(this._AtmosphereClass){this._atmosphereReadyPromise&&(this._atmosphereReadyPromise.cancel(),this._atmosphereReadyPromise=null);var c=new this._AtmosphereClass({view:this.view,slot:a});c.initializeRenderContext(this.renderContext);this._atmosphere?this._atmosphereReadyPromise=c.then(function(){b();this._atmosphereReadyPromise=null;this._atmosphere=c}.bind(this)):this._atmosphere=c;c.then(function(){this._updateBasemapTerrain()}.bind(this))}else b(),
this._updateBasemapTerrain()}},_updateAtmosphereClass:function(a){var b=this._AtmosphereClass;"none"===this.atmosphereQuality?this._AtmosphereClass=null:"high"===this.atmosphereQuality&&!this.transparent&&f.isSupported(a)?this._AtmosphereClass="local"===this.viewingMode?k:f:this._AtmosphereClass="local"===this.viewingMode?k:c;return this._AtmosphereClass!==b},_getAtmosphereSlot:function(){return this.transparent&&"global"===this.viewingMode?this._SPECIAL_SLOT:this._STANDARD_SLOT},_updateBasemapTerrain:function(){var a=
this.get("view.basemapTerrain");a&&(a.velvetOverground=!!(this._AtmosphereClass&&this._AtmosphereClass!==f))}})})},"esri/views/3d/support/ExternalRenderer":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Promise dojo/Deferred dojo/aspect dojo/_base/lang".split(" "),function(q,n,k,f,c,b){return q([n,k],{"-chains-":b.mixin(n._meta.chains,{setup:"after",initializeRenderContext:"after",uninitializeRenderContext:"before"}),properties:{gl:{readOnly:!0,get:function(){return this._gl}},
needsRender:{value:!0},visible:{value:!0},needsDepthMap:{value:!1}},constructor:function(){this.didRender=!1;this.renderContext=null;this.watch("visible",function(){this.needsRender=!0}.bind(this));this._contextDfd=new f},initialize:function(){this.addResolvingPromise(this._contextDfd.promise);c.around(this,"render",function(a){return function(){return this.isRejected()?this.didRender=!0:!this.isResolved()?!1:!this.visible||a.apply(this,arguments)?this.didRender=!0:!1}.bind(this)}.bind(this));this.then(function(){this.destroyed||
this.setup(this.renderContext)}.bind(this))},needsRender:!0,visible:!0,needsDepthMap:!1,initializeRenderContext:function(a){this.renderContext=a;this._contextDfd.resolve()},uninitializeRenderContext:function(a){},setup:function(a){},render:function(a){return!1}})})},"esri/views/3d/environment/PanoramicAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s){var r=f.vec2d,t=f.vec3d,u=f.mat4d,v=e.VertexAttrConstants,C=u.create();return k.createSubclass({declaredClass:"esri.views.3d.environment.PanoramicAtmosphere",properties:{view:{},needsRender:{value:!1},needsDepthMap:{value:!1},slot:{value:d.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:r.create(),silCircleCenter:t.create(),silCircleV1:t.create(),silCircleV2:t.create()};this._textureRep=this._texture=
null;this.slot=d.BACKGROUND},initialize:function(){this._textureDfd=new n;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(d){this._textureRep=new h({SimpleAtmosphere:new a(m,
"SimpleAtmosphere",{wrapClamp:!0})},d.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),d.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var d=this._createGeometryData(),b=this.renderContext.rctx;this._renderer=new c(d,p.Pos3,null,b);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(q);this._program=new l(b,
a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,s.Default3D,["PANORAMIC"])},render:function(a){if(a.slot!==this.slot||a.pass!==g.MATERIAL||!this._textureRep.getIsLoaded("SimpleAtmosphere"))return!1;var d=this.renderContext.rctx,b=d.gl,e=this._program;d.bindProgram(e);d.bindTexture(this._texture);e.setUniform1i("tex",0);e.setUniformMatrix4fv("proj",a.camera.projectionMatrix);u.toRotationMat(a.camera.viewMatrix,C);e.setUniformMatrix4fv("view",C);e.setUniform4f("color",1,1,1,
1);e.setUniform3fv("lightDirection",a.lightingData.direction);d.setFaceCullingEnabled(!0);d.setDepthFunction(b.LEQUAL);d.setBlendingEnabled(!0);d.setDepthWriteEnabled(!1);this._renderer.render(this._program);d.setDepthWriteEnabled(!0);d.setBlendingEnabled(!1);d.setDepthFunction(b.LESS);d.setFaceCullingEnabled(!1);return!0},_createGeometryData:function(){for(var a=b.createPolySphereGeometry(1,2),d=a.getFaces(),e=d[0].indices[v.POSITION],h=0;h<e.length;h+=3){var c=e[h];e[h]=e[h+2];e[h+2]=c}a=a.getVertexAttr();
e=a[v.NORMAL].data;for(h=0;h<e.length;h++)e[h]=-e[h];return{faces:d[0],vertexAttr:a}}})})},"esri/views/3d/webgl-engine/lib/GeometryRenderer":function(){define("require exports ../materials/internal/MaterialUtil ./DefaultVertexAttributeLocations ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums".split(" "),function(q,n,k,f,c,b,a,e){return function(){function e(h,d,m,l){this._drawMode=4;this._layout=d;var p=h.faces;this._count=p.indices[p.positionKey].length;
p=new Float32Array(this._count*a.getStride(d)/4);m?m(h,void 0,void 0,null,d,p,0):k.fillInterleaved(h,void 0,void 0,null,d,p,0);this._rctx=l;this._vao=new c(l,f.Default3D,{geometry:d},{geometry:b.createVertex(l,35044,p)})}e.prototype.enablePointRendering=function(a){this._drawMode=a?0:4};e.prototype.render=function(b){var d=this._rctx;d.bindVAO(this._vao);a.assertCompatibleVertexAttributeLocations(this._vao,b);d.drawArrays(this._drawMode,0,this._count)};return e}()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define(["../../lib/IdGen",
"../../lib/gl-matrix","../../parts/Model","../../lib/Util","../../../../webgl/Util"],function(q,n,k,f,c){var b=n.vec3d,a=n.mat4d,e=n.mat4,h=f.VertexAttrConstants,g={};g.__Material_idGen=new q;g.__GLMaterial_id=0;g.IDENTITY=a.identity();g.fill=function(a,d,b,e,h,c){if(void 0===h||3!==c)for(h=0;h<c;++h)b[e+h]=a[d+h];else{var p=a[d],r=a[d+1];a=a[d+2];b[e]=h[0]*p+h[4]*r+h[8]*a+h[12];b[e+1]=h[1]*p+h[5]*r+h[9]*a+h[13];b[e+2]=h[2]*p+h[6]*r+h[10]*a+h[14]}return c};var d=function(a,d,b,e,h,c){for(var p=a.length,
r=0;r<p;++r){for(var g=b*a[r],s=0;s<b;++s)e[h+s]=d[g+s];h+=c}};g.fillInterleaved=function(a,b,e,p,r,g,s,l){for(var m=c.getStride(r)/4,f=0;f<r.length;f++){var t=r[f],u=s+t.offset/4,t=t.name;if(!(null!=l&&null==l[t])){var v;switch(t){case "uv0":v=a.vertexAttr[t];null!=v&&d(a.faces.indices[t],v.data,v.size,g,u,m);break;case "region":v=a.vertexAttr[t];var t=a.faces.indices[t],k=v.data,F=v.size;v=g;var K=m;v=new Uint16Array(v.buffer);for(var u=2*u,K=2*K,n=t.length,R=0;R<n;++R){var q=F*t[R],S;for(S=0;S<
F;++S)v[u+S]=k[q+S];u+=K}break;case "color":v=a.vertexAttr[t];if(p&&p.color){t=a.faces.indices[t];k=v.data;F=p.color;v=v.size;K=g;n=m;K=new Uint8Array(K.buffer);u*=4;n*=4;R=t.length;for(q=0;q<R;++q){S=v*t[q];var ba;for(ba=0;ba<v;++ba)K[u+ba]=k[S+ba]*F[ba];4>ba&&(K[u+3]=255*F[3]);u+=n}}else{t=a.faces.indices[t];k=v.data;F=v.size;v=g;K=m;v=new Uint8Array(v.buffer);u*=4;K*=4;n=t.length;for(R=0;R<n;++R){q=F*t[R];for(S=0;S<F;++S)v[u+S]=k[q+S];4>S&&(v[u+3]=255);u+=K}}break;default:if(v=a.vertexAttr[t],
F=t===h.POSITION?b:t===h.NORMAL?e:void 0,void 0!==F&&3===v.size){t=a.faces.indices[t];k=v.data;v=g;K=m;n=t.length;for(R=0;R<n;++R)ba=3*t[R],q=k[ba],S=k[ba+1],ba=k[ba+2],v[u]=F[0]*q+F[4]*S+F[8]*ba+F[12],v[u+1]=F[1]*q+F[5]*S+F[9]*ba+F[13],v[u+2]=F[2]*q+F[6]*S+F[10]*ba+F[14],u+=K}else d(a.faces.indices[t],v.data,v.size,g,u,m)}}}};g.triangleVertexArrayToWireframeLines=function(a,d,b,e){for(b=Math.floor(b/3)-1;0<=b;b--){var h=d+3*b*e,c=d+6*b*e+5*e;this.fill(a,h,a,c,null,e);c-=e;this.fill(a,h+e,a,c,null,
e);c-=e;this.fill(a,h+e,a,c,null,e);c-=e;this.fill(a,h+2*e,a,c,null,e);c-=e;this.fill(a,h+2*e,a,c,null,e);c-=e;this.fill(a,h,a,c,null,e)}};var m=b.create(),l=b.create(),p=b.create(),s=b.create(),r=function(a,d,e,h,c){var g=a.getCenter();b.project(g,d,e,m);var g=b.dist2(m,g),t=a.getBSRadius();if(g<t*t){var g=a.getPrimitiveIndices(),t=a.getIndices(),f=a.getPosition(),u=g?g.length:t.length/3;if(1E4<u&&(a=a.getChildren(),void 0!==a)){for(g=0;8>g;++g)void 0!==a[g]&&r(a[g],d,e,h,c);return}a=f.size;var f=
f.data,v=d[0],k=d[1];d=d[2];var I=e[0]-v,O=e[1]-k;e=e[2]-d;for(var n=0;n<u;++n){var F=g?g[n]:n,K=a*t[3*F],q=a*t[3*F+1],R=a*t[3*F+2],da=f[K],S=f[K+1],K=f[K+2],ba=f[q],aa=f[q+1],q=f[q+2],$=f[R],Z=f[R+1],R=f[R+2],M=ba-da,V=aa-S,L=q-K,U=$-da,N=Z-S,Q=R-K,P=O*Q-N*e,X=e*U-Q*I,ca=I*N-U*O,Y=M*P+V*X+L*ca;if(!(Y>-h&&Y<h)){var Y=1/Y,fa=v-da,ea=k-S,ia=d-K,P=Y*(fa*P+ea*X+ia*ca);0>P||1<P||(X=ea*L-V*ia,L=ia*M-L*fa,M=fa*V-M*ea,V=Y*(I*X+O*L+e*M),0>V||1<P+V||(U=Y*(U*X+N*L+Q*M),0<=U&&(N=l,Q=p,Y=s,b.set3(da,S,K,N),b.set3(ba,
aa,q,Q),b.set3($,Z,R,Y),b.subtract(Q,N,Q),b.subtract(Y,N,Y),b.normalize(b.cross(Q,Y,N)),c(U,N,F))))}}}};g.intersectTriangleGeometry=function(a,d,b,e,h,c,p,g,s,l,m){f.assert("triangle"===a.getData().getFaces()[d].type);r(a.getBoundingInfo(d),p,g,l,m)};g.basicMaterialConstructor=function(a,d){var b=!0,e=0,h=g.__Material_idGen.gen(d);a.getId=function(){return h};var c;a.getParentStage=function(){return c};a.addParentStage=function(a){f.assert(void 0===c,"Material can only be added to a single Stage");
c=a};a.removeParentStage=function(a){c=void 0};a.setVisible=function(d){b!==d&&(b=d,a.notifyDirty("matChanged"))};a.isVisible=function(){return b};a.notifyDirty=function(d){c&&c.notifyDirty(k.ContentType.MATERIAL,a,d)};a.setRenderPriority=function(a){e=a;this.notifyDirty("matChanged")};a.getRenderPriority=function(){return e}};var t=g.aquireIfNotUndefined=function(a,d,b,e){return void 0===a?void 0:b.aquire(a,d,e)},u=g.releaseIfNotUndefined=function(a,d){void 0!==a&&d.release(a)},v=e.create();g.bindView=
function(a,d,b){e.translate(d,a,v);b.setUniformMatrix4fv("view",v)};g.bindCamPos=function(a,d,b){b.setUniform3f("camPos",d[3]-a[0],d[7]-a[1],d[11]-a[2])};g.basicGLMaterialConstructor=function(a,d){var b=g.__GLMaterial_id++;a.getId=function(){return b};a.getMaterialId=function(){return d.getId()};a.isVisible=function(){return d.isVisible()};a.getRenderPriority=function(){return d.getRenderPriority()}};g.singleTextureGLMaterialConstructor=function(a,d,b,e){var h=t(b.textureId,b.initTexture,d,e);a.updateTexture=
function(a){b.textureId!==a&&(u(b.textureId,d),b.textureId=a,h=t(b.textureId,b.initTexture,d,e))};a.renderTexture=function(a){var e=d.getTexture(b.textureId);e&&e.renderGl&&e.renderGl(h.getGLTexture(),a)};a.bindTexture=function(a,d){void 0!==h&&(d.setUniform1i("tex",0),a.bindTexture(h.getGLTexture()))};a.bindTextureSize=function(a,d){if(void 0!==h){var b=h.getGLTexture();d.setUniform2f("texSize",b.descriptor.width,b.descriptor.height)}};a.dispose=function(){u(b.textureId,d)}};g.multiTextureGLMaterialConstructor=
function(a,d,b,e){for(var h=e.length,c=Array(h),p=0;p<h;p++)c[p]=t(b[e[p][0]],b[e[p][1]],d);a.updateTextures=function(a){for(var p=0;p<h;p++){var r=b[e[p][0]],g=a[e[p][0]];r!==g&&(u(r,d),b[e[p][0]]=g,c[p]=t(g,b[e[p][1]],d))}};a.bindTextures=function(a,d){for(var b=0;b<h;b++)void 0!==c[b]&&(d.setUniform1i(e[b][2],b),a.bindTexture(c[b].getGLTexture(),b));a.setActiveTexture(0)};a.bindOneTexture=function(a,d,b){d.setUniform1i(e[b][2],b);a.bindTexture(c[b].getGLTexture(),b);a.setActiveTexture(0)};a.disposeTextures=
function(){for(var a=0;a<h;a++)u(b[e[a][0]],d)}};return g})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(q,n){return function(){function k(){this.id2count={}}k.prototype.gen=function(f){null==f&&(f="a");var c=this.id2count[f];if(null==c)return this.id2count[f]=0,f;for(;;){var b=f+"_"+c++;if(null==this.id2count[b])return this.id2count[f]=c,this.id2count[b]=0,b}};return k}()})},"esri/views/3d/webgl-engine/parts/Model":function(){define("require exports dojo/string ../lib/lights ../lib/ModelContentType ../lib/ModelDirtySet ../lib/RenderGeometry ../lib/Util ../lib/gl-matrix".split(" "),
function(q,n,k,f,c,b,a,e,h){var g=e.assert,d=e.verify,m=h.vec3d,l=h.mat4d,p=e.logWithBase;return function(){function e(){this.dirtySet=new b(this);this.ambientLight=new f.AmbientLight([1,1,1],0.3);this.directionalLight=new f.DirectionalLight([1,1,1],0.7,m.normalize([1,1,1]));this._uniqueName2idx={};this._uniqueIdx=0;this._id2origin={};this._modelListeners=[];this.content={};for(var a in c)this.content[c[a]]={}}e.prototype.getAll=function(a){a=this.content[a];g(void 0!==a);return a};e.prototype.get=
function(a,d){return this.getAll(a)[d]};e.prototype.add=function(a,d){var b=this.content[a];g(void 0!==b);var e=d.getId();g(null==b[e],"Model/Stage already contains object to be added");b[e]=d;a===c.LAYER&&this.notifyDirty(a,d,"layerAdded");this._notifyContentAdded(a,d)};e.prototype.remove=function(a,d){var b=this.content[a];g(void 0!==b);var e=b[d];g(void 0!==e,"Model/Stage doesn't contain object to be removed");delete b[d];a===c.TEXTURE&&e.unload();a===c.LAYER&&this.notifyDirty(a,e,"layerRemoved");
this._notifyContentRemoved(a,e);return e};e.prototype.getDirtySet=function(){return this.dirtySet};e.prototype.notifyDirty=function(a,d,b,e){this.dirtySet.handleUpdate(d,b,e)};e.prototype.getAmbientLight=function(){return this.ambientLight};e.prototype.setAmbientLight=function(a){this.ambientLight.set(a)};e.prototype.getDirectionalLight=function(){return this.directionalLight};e.prototype.setDirectionalLight=function(a){this.directionalLight.set(a)};e.prototype.getSelection=function(){return this.selection};
e.prototype.setSelection=function(a,d){this.selection=a;this.selectionFaceRange=d};e.prototype.getSelectionFaceRange=function(){return this.selectionFaceRange};e.prototype.getOrigin=function(a,d,b){void 0===b&&(b=10);var e=0;d=d*b/1E4;1<d&&(e=Math.ceil(p(d,2)));d=1E4*Math.pow(2,e);b=Math.round(a[0]/d);var h=Math.round(a[1]/d);a=Math.round(a[2]/d);var e=e+"_"+b+"_"+h+"_"+a,c=this._id2origin[e];null==c&&(c={vec3:m.createFrom(b*d,h*d,a*d),id:e},this._id2origin[e]=c);return c};e.prototype.getGeometryRenderGeometries=
function(d,b,e){for(var h=d.getId(),c=b.geometry,p=c.getData(),g=!!c.singleUse,s=p.getFaces(),m=p.getVertexAttr(),p=p.getId(),f=b.materials,k=b.instanceParameters,D=d.getCombinedTransformation(b),E=l.maxScale(D),H=b.origin,G=d.getVisibleIndexRanges(b),I=0,O=c.getNumGroups();I<O;++I){var n=c.getBoundingInfo(I),F=b.getId()+"#"+I,K=this._uniqueName2idx[F];null==K&&(K=this._uniqueIdx++,this._uniqueName2idx[F]=K);var q={},R;for(R in s[I].indices)q[R]=m[R];n=new a({faces:s[I],vertexAttr:q,id:p+"#"+I},n,
f[I],D,E,d.getCastShadow(),g,h,F,K,I);n.origin=H||this.getOrigin(n.center,n.bsRadius);n.displayedIndexRange=G?G[I]:null;n.instanceParameters=k?b.instanceParameters[I]:null;e.push(n)}};e.prototype.formatDebugInfo=function(a){var d=[];if(a){d[0]="\x3ctable\x3e";for(var b in c)a=c[b],d[0]+="\x3ctr\x3e\x3ctd\x3e"+a+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Object.keys(this.getAll(a)).length+"\x3c/td\x3e\x3c/tr\x3e";d[0]+="\x3c/table\x3e";d[1]=this.dirtySet.formatDebugInfo(!0)}else{d[0]="";
for(b in c)a=c[b],d[0]+=k.pad(String(Object.keys(this.getAll(a)).length),6," ")+" "+a+", ";d[1]=this.dirtySet.formatDebugInfo(!1)}return d};e.prototype.validateContent=function(){var a=this.getAll(c.OBJECT),d;for(d in a)this.validateObject(a[d]);a=this.getAll(c.LAYER);for(name in a)this.validateLayer(a[name]);a=this.getAll(c.MATERIAL);for(name in a)this.validateMaterial(a[name])};e.prototype.validateObject=function(a){a=a.geometryRecords;for(var b=0;b<a.length;++b){var e=a[b];g(null!=this.get(c.GEOMETRY,
e.geometry.id));var h=e.geometry.numGroups;g(h<=e.materials.length,"object materials do not match geometry groups");d(h===e.materials.length,"object materials do not match geometry groups");for(var p=0;p<h;++p)g(null!=this.get(c.MATERIAL,e.materials[p].getId()))}};e.prototype.validateLayer=function(a){a=a.getObjects();for(var d=0;d<a.length;++d){var b=this.get(c.OBJECT,a[d].getId());g(null!=b)}};e.prototype.validateMaterial=function(a){a=a.getAllTextureIds();for(var d=0;d<a.length;++d){var b=this.get(c.TEXTURE,
a[d]);g(null!=b)}};e.prototype.addModelListener=function(a){g(-1===this._modelListeners.indexOf(a));this._modelListeners.push(a)};e.prototype.removeModelListener=function(a){a=this._modelListeners.indexOf(a);g(-1!==a);this._modelListeners.splice(a,a)};e.prototype._notifyContentAdded=function(a,d){this._modelListeners.forEach(function(b){b.contentAdded&&b.contentAdded(a,d)})};e.prototype._notifyContentRemoved=function(a,d){this._modelListeners.forEach(function(b){b.contentRemoved&&b.contentRemoved(a,
d)})};e.ContentType=c;return e}()})},"esri/views/3d/webgl-engine/lib/lights":function(){define(["require","exports"],function(q,n){var k=function(){function f(c,b){this.color=c;this.intensity=b}f.prototype.set=function(c){void 0!==c.color&&(this.color=c.color);void 0!==c.intensity&&(this.intensity=c.intensity)};return f}();n.AmbientLight=k;k=function(){function f(c,b,a){this.color=c;this.intensity=b;this.direction=a}f.prototype.set=function(c){void 0!==c.color&&(this.color=c.color);void 0!==c.intensity&&
(this.intensity=c.intensity);void 0!==c.direction&&(this.direction=c.direction)};return f}();n.DirectionalLight=k})},"esri/views/3d/webgl-engine/lib/ModelContentType":function(){define(["require","exports"],function(q,n){return function(){function k(){}k.LAYER="layers";k.OBJECT="objects";k.GEOMETRY="geometries";k.MATERIAL="materials";k.TEXTURE="textures";return k}()})},"esri/views/3d/webgl-engine/lib/ModelDirtySet":function(){define(["require","exports","./ModelContentType","./ModelDirtyTypesTs",
"./Util"],function(q,n,k,f,c){var b=c.objectEmpty,a=c.assert;return function(){function e(a){this._residentGeomRecords={};this._dirtyGeomRecords={};this._dirtyMaterials={};this._model=a}e.prototype._getResidentGeometryRecords=function(){return this._residentGeomRecords};e.prototype._getDirtyGeometryRecords=function(){return this._dirtyGeomRecords};e.prototype.getDirtyMaterials=function(){return b(this._dirtyMaterials)?null:this._dirtyMaterials};e.prototype.clearDirtyMaterials=function(){this._dirtyMaterials=
{}};e.prototype.hasDirtyGeometryRecords=function(){for(var a in this._dirtyGeomRecords)for(var e in this._dirtyGeomRecords[a]){var d=this._dirtyGeomRecords[a][e];if(d&&!b(d))return!0}return!1};e.prototype.handleUpdate=function(b,e,d){a(this[e],"ModelDirtySet doesn't know how to process "+e);return this[e](b,d)};e.prototype.getAddRemoveUpdateList=function(a){return this.getAddRemoveUpdateListFilteredByLayers(Object.keys(this._dirtyGeomRecords),a)};e.prototype.getAddRemoveUpdateListFilteredByLayers=
function(b,e){for(var d=[],c=[],l=[],p=0;p<b.length;p++){var s=b[p];if(s in this._dirtyGeomRecords)for(var r in this._dirtyGeomRecords[s]){var f=this._dirtyGeomRecords[s][r];if(f){var u=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,s,r),v;for(v in f){var C=f[v],y=C[0],x=C[1],C=C[2],B=x&2&&C&1;if(x&4||B){var z=u[v];z?c.push.apply(c,z[1]):4===x&&a(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove");e&&z&&delete u[v]}if(x&1||B){var z=[y,[]],A=this._model.get(k.OBJECT,
r);this._model.getGeometryRenderGeometries(A,y,z[1]);d.push.apply(d,z[1]);e&&(u[v]=z)}if(x&2&&!B)if(z=u[v],A=this._model.get(k.OBJECT,r),z){x=z[1];B=x.length;if(C&2)for(var z=A.getVisibleIndexRanges(y),w=0;w<B;w++){var D=x[w];D.displayedIndexRange=z?z[D.componentIdx]:void 0}if(C&16)for(w=0;w<B;w++)D=x[w],A.getCombinedTransformation(y,D.transformation),D.updateTransformation(D.transformation);for(w=0;w<B;w++)D=x[w],l.push({renderGeometry:D,updateType:C})}else a(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}}}e&&
delete this._dirtyGeomRecords[s]}return[d,c,l]};e.prototype.getResidentRenderGeometries=function(){return this.getResidentRenderGeometriesFilteredByLayers(Object.keys(this._residentGeomRecords))};e.prototype.getResidentRenderGeometriesFilteredByLayers=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];if(e in this._residentGeomRecords)for(var c in this._residentGeomRecords[e]){var p=this._residentGeomRecords[e][c];if(p)for(var s in p)b.push.apply(b,p[s][1])}}return b};e.prototype.hideFaceRange=
function(a,b,d){d=d||this._getParentLayerId(a);this._updateOrCreateDirtyRecord(a,b,d,2,0,0,2,5,2)};e.prototype.unhideAllFaceRange=function(a,b){for(var d=0;d<a.getGeometryRecords().length;d++)this._updateOrCreateDirtyRecord(a,a.getGeometryRecords()[d],b,2,0,0,2,5,2)};e.prototype.vertexAttrsUpdated=function(a,b,d){this._updateOrCreateDirtyRecord(a,b,d,2,0,0,2,5,4)};e.prototype.colorAttrsUpdated=function(a,b,d){this._updateOrCreateDirtyRecord(a,b,d,2,0,0,2,5,8)};e.prototype.matChanged=function(a){this._dirtyMaterials[a.getId()]=
!0};e.prototype.layerAdded=function(a){for(var b=a.getObjects(),d=0;d<b.length;d++)this.layObjectAdded(a,b[d])};e.prototype.layerRemoved=function(a){for(var b=a.getObjects(),d=0;d<b.length;d++)this.layObjectRemoved(a,b[d])};e.prototype.layObjectAdded=function(a,b){for(var d=a.getId(),e=b.getGeometryRecords(),c=0;c<e.length;c++)this.objGeometryAdded(b,e[c],d)};e.prototype.layObjectRemoved=function(a,b){for(var d=a.getId(),e=b.getGeometryRecords(),c=0;c<e.length;c++)this.objGeometryRemoved(b,e[c],d)};
e.prototype.layObjectReplaced=function(a,b){this.layObjectRemoved(a,b[0]);this.layObjectAdded(a,b[1])};e.prototype.objDirty=function(a,b){b=b||this._getParentLayerId(a);var d=a.getId(),d=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,d),e;for(e in d)this._updateOrCreateDirtyRecord(a,d[e][0],b,2,0,2,0,5,1)};e.prototype.objTransformation=function(a,b){b=b||this._getParentLayerId(a);var d=a.getId(),d=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,d),e;for(e in d)this._updateOrCreateDirtyRecord(a,
d[e][0],b,2,0,0,2,5,16)};e.prototype.objGeometryAdded=function(a,b,d){this._updateOrCreateDirtyRecord(a,b,d,1,4,0,0,0)};e.prototype.objGeometryRemoved=function(a,b,d){this._updateOrCreateDirtyRecord(a,b,d,4,1,2,0,0)};e.prototype.objGeometryReplaced=function(a,b){this.objGeometryRemoved(a,b[0]);this.objGeometryAdded(a,b[1])};e.prototype.objGeometryTransformation=function(a,b){this.objGeometryReplaced(a,b)};e.prototype._updateOrCreateDirtyRecord=function(b,e,d,c,l,p,s,r,f){d=d||this._getParentLayerId(b);
var u=b.getId();b=e.getId();d=this._createObjectRecordObjIfNonexistent(this._dirtyGeomRecords,d,u);(u=d[b])?(e=u[1],e&l?delete d[b]:e&p?(u[1]=c,u[2]=f):e&s?u[2]|=f:e&r||a(!1,"ModelDirtySet.objGeometryAdded: inconsistent state")):d[b]=[e,c,f]};e.prototype._createObjectRecordObjIfNonexistent=function(a,b,d){a[b]||(a[b]={});a[b][d]||(a[b][d]={});return a[b][d]};e.prototype._getParentLayerId=function(a){return a.parentLayer.id};e.prototype.formatDebugInfo=function(a){var b=["ADD","UPD",void 0,"REM"];
if(a)return"";a="";for(var d in this._dirtyGeomRecords)for(var e in this._dirtyGeomRecords[d]){var c=this._dirtyGeomRecords[d][e];if(c){0<a.length&&(a+="\n");a+=d+"."+e;var p=[],s;for(s in c){var r=c[s][1];p[r]||(p[r]=[]);p[r].push(c[s][0].geometry.id)}for(c=0;c<p.length;c++)if(p[c]){a+=" "+b[c-1]+": ";for(r=0;r<p[c].length;r++)a+=p[c][r]+", "}}}return a};return e}()})},"esri/views/3d/webgl-engine/lib/ModelDirtyTypesTs":function(){define(["require","exports"],function(q,n){})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define(["require",
"exports","./gl-matrix"],function(q,n,k){var f=k.vec3d,c=k.mat4d;return function(){function b(a,b,h,c,d,m,l,p,s,r,t){this.data=a;this.boundingInfo=b;this.material=h;this.origin=null;this.center=f.create();this.bsRadius=0;this.transformation=null;c&&this.updateTransformation(c,d);this.castShadow=m;this.singleUse=l;this.name=p;this.uniqueName=s;this.idx=r;this.canBeMerged=!0;this.componentIdx=t;this.instanceParameters=this.displayedIndexRange=void 0}b.prototype.updateTransformation=function(a,b){b=
b||c.maxScale(a);this.transformation=a;c.multiplyVec3(a,this.boundingInfo.getCenter(),this.center);this.bsRadius=this.boundingInfo.getBSRadius()*b};return b}()})},"esri/views/webgl/Util":function(){define(["require","exports"],function(q,n){return function(){function k(){}k.vertexCount=function(f,c){return f.vertexBuffers[c].size/k.getStride(f.layout[c])};k.getStride=function(f){return f[0].stride};k.assertCompatibleVertexAttributeLocations=function(f,c){var b=f.locations===c.locations;b||console.error("VertexAttributeLocations are incompatible");
return b};k.hasAttribute=function(f,c){for(var b=0;b<f.length;b++)if(f[b].name===c)return!0;return!1};k.findAttribute=function(f,c){for(var b=0;b<f.length;b++)if(f[b].name===c)return f[b];return null};k.copyFramebufferToTexture=function(f,c,b,a,e){void 0===e&&(e=0);var h=f.getBoundFramebufferObject(),g=f.getBoundTexture(0);f.bindFramebuffer(c);f.bindTexture(b,0);f.gl.copyTexImage2D(f.gl.TEXTURE_2D,e,b.descriptor.pixelFormat,a[0],a[1],a[2],a[3],0);f.gl.flush();f.bindFramebuffer(h);f.bindTexture(g,
0)};return k}()})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require","exports"],function(q,n){n.Default3D={position:0,normal:1,uv0:2,color:3,instanceColor:3,size:4,auxpos1:5,auxpos2:6,region:7,model:8,modelNormal:12}})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(q,n){return function(){function k(f,c,b,a,e){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=
!1;this._context=f;this._layout=b;this._buffers=a;this._locations=c;e&&(this._indexBuffer=e);this._id=k._nextId++}Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"indexBuffer",{get:function(){return this._indexBuffer},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});k.prototype.dispose=function(f){void 0===f&&(f=!0);var c=this._context.extensions.vao;c&&this._glName&&(c.deleteVertexArrayOES(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(f){for(var b in this._buffers)this._buffers[b].dispose(),
delete this._buffers[b];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}};k.prototype.initialize=function(){if(!this._initialized){var f=this._context.extensions.vao;if(f){var c=f.createVertexArrayOES();f.bindVertexArrayOES(c);this._bindLayout();f.bindVertexArrayOES(null);this._glName=c}this._initialized=!0}};k.prototype.bind=function(){this.initialize();var f=this._context.extensions.vao;f?f.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())};
k.prototype._bindLayout=function(){var f=this._buffers,c=this._context.extensions.vao,b=this._layout,a=this._indexBuffer;f||console.error("Vertex buffer dictionary is empty!");var e=this._context.gl,h,g,d=0,m;for(m in f){(h=f[m])||console.error("Vertex buffer is uninitialized!");(g=b[m])||console.error("Vertex element descriptor is empty!");this._context.bindBuffer(h);for(d=0;d<g.length;++d){h=g[d];var l=this._locations[h.name];void 0===l&&console.error("There is no location for vertex attribute '"+
h.name+" defined.");if(4>=h.count){if(e.enableVertexAttribArray(l),e.vertexAttribPointer(l,h.count,h.type,h.normalized,h.stride,h.offset),h.divisor&&0<h.divisor){var p=this._context.extensions.angleInstancedArrays;p&&p.vertexAttribDivisorANGLE(l,h.divisor)}}else if(16===h.count&&5126===h.type)for(var s=0;4>s;s++)e.enableVertexAttribArray(l+s),e.vertexAttribPointer(l+s,4,h.type,h.normalized,h.stride,h.offset+16*s),h.divisor&&0<h.divisor&&(p=this._context.extensions.angleInstancedArrays)&&p.vertexAttribDivisorANGLE(l+
s,h.divisor);else console.error("Unsupported vertex attribute element count: "+h.count)}}a&&(c?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a.glName):this._context.bindBuffer(a))};k.prototype.unbind=function(){this.initialize();var f=this._context.extensions.vao;f?f.bindVertexArrayOES(null):this._unbindLayout()};k.prototype._unbindLayout=function(){var f=this._buffers,c=this._layout,b=this._locations,a=this._context;f||console.error("Vertex buffer dictionary is empty!");var e=a.gl,h,g,d,m=0,l=0,p;for(p in f){(h=
f[p])||console.error("Vertex buffer is uninitialized!");g=c[p];m=0;for(l=g.length;m<l;++m)d=g[m],e.disableVertexAttribArray(b[d.name]);a.unbindBuffer(h.bufferType)}(f=this._indexBuffer)&&a.unbindBuffer(f.bufferType)};k._nextId=0;return k}()})},"esri/views/webgl/BufferObject":function(){define(["require","exports"],function(q,n){return function(){function k(f,c,b,a){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=f;this._bufferType=
c;this._usage=b;this._id=k._nextId++;this._glName=this._context.gl.createBuffer();a&&this.setData(a)}k.createIndex=function(f,c,b){return new k(f,34963,c,b)};k.createVertex=function(f,c,b){return new k(f,34962,c,b)};Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"size",{get:function(){return this._size},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?
4*this._size:2*this._size},enumerable:!0,configurable:!0});k.prototype.dispose=function(){this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null)};k.prototype.setData=function(f){if(f){if("number"===typeof f)0>f&&console.error("Buffer size cannot be negative!"),this._size=f;else{var c=f.byteLength;f instanceof Uint16Array&&(c/=2,this._indexType=5123);f instanceof Uint32Array&&(c/=4,this._indexType=5125);this._size=c}c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);
this._context.gl.bufferData(this._bufferType,f,this._usage);this._context.bindVAO(c)}};k.prototype.setSubData=function(f,c,b,a){void 0===c&&(c=0);void 0===b&&(b=0);if(f){(0>c||c>=this._size)&&console.error("offset is out of range!");var e=c,h=b,g=a,d=f.byteLength;f instanceof Uint16Array&&(d/=2,e*=2,h*=2,g*=2);f instanceof Uint32Array&&(d/=4,e*=4,h*=4,g*=2);void 0===a&&(a=d-1);b>=a&&console.error("end must be bigger than start!");c+b-a>this._size&&console.error("An attempt to write beyond the end of the buffer!");
c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,e,(f instanceof ArrayBuffer?f:f.buffer).slice(h,g));this._context.bindVAO(c)}};k._nextId=0;return k}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(q,n){n.BASE_TEXTURE_UNIT=33984})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define(["./GeometryData","./BufferVectorMath","./Util","./gl-matrix"],function(q,n,k,f){function c(b,
d,e,h,c){if(Math.abs(a.dot(d,b))>c)return!1;a.cross(b,d,e);a.normalize(e);a.cross(e,b,h);a.normalize(h);return!0}function b(a,b,d,e,h,g,l){return c(a,b,h,g,l)||c(a,d,h,g,l)||c(a,e,h,g,l)}var a=f.vec3,e=f.vec3d,h=k.VertexAttrConstants,g=n.Vec3Compact,d=e.create(),m=e.create(),l={createSphereGeometry:function(b,d,e,c,g,l,m){b=b||50;c=void 0!==c?c:-Math.PI;g=void 0!==g?g:2*Math.PI;l=void 0!==l?l:0.5*-Math.PI;m=void 0!==m?m:Math.PI;var f=Math.max(3,Math.floor(d)||8),x=Math.max(2,Math.floor(e)||6),B=(f+
1)*(x+1);e=new Float32Array(3*B);d=new Float32Array(3*B);var B=new Float32Array(2*B),z,A,w=[],D=a.create(),E=0;for(A=0;A<=x;A++){var H=[],G=A/x,I=l+G*m,n=Math.cos(I);for(z=0;z<=f;z++){var J=z/f,F=c+J*g,K=Math.cos(F)*n*b,T=Math.sin(I)*b,F=-Math.sin(F)*n*b;e[3*E]=K;e[3*E+1]=T;e[3*E+2]=F;a.set3(K,T,F,D);a.normalize(D);d[3*E]=D[0];d[3*E+1]=D[1];d[3*E+2]=D[2];B[2*E]=J;B[2*E+1]=G;H.push(E);++E}w.push(H)}b=new Uint32Array(3*2*f*(x-1));for(A=E=0;A<x;A++)for(z=0;z<f;z++)c=w[A][z],g=w[A][z+1],l=w[A+1][z+1],
m=w[A+1][z],0===A?(b[E++]=c,b[E++]=l,b[E++]=m):A===x-1?(b[E++]=c,b[E++]=g,b[E++]=l):(b[E++]=c,b[E++]=g,b[E++]=l,b[E++]=l,b[E++]=m,b[E++]=c);k.assert(E===b.length);f={};f[h.POSITION]=b;f[h.NORMAL]=b;f[h.UV0]=b;x={};x[h.POSITION]={size:3,data:e};x[h.NORMAL]={size:3,data:d};x[h.UV0]={size:2,data:B};return new q([{type:"triangle",indices:f,positionKey:h.POSITION}],x)},createPolySphereGeometry:function(a,b,d){function e(d,b){d>b&&(d=b+(b=d,0));var c=d.toString()+"."+b.toString();if(m[c])return m[c];var h=
l.length;l.length+=3;g.add(l,3*d,l,3*b,l,h);g.scale(l,h,a/g.length(l,h));h/=3;return m[c]=h}var c=a,l;d?(l=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],c=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(d=c*(1+Math.sqrt(5))/2,l=[-c,d,0,c,d,0,-c,-d,0,c,-d,0,0,-c,d,0,c,d,0,-c,-d,0,c,-d,d,0,-c,d,0,c,-d,0,-c,-d,0,c],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(d=0;d<l.length;d+=3)g.scale(l,d,a/g.length(l,d));
var m={};for(d=0;d<b;d++){for(var f=c.length,x=Array(4*f),B=0;B<f;B+=3){var z=c[B],A=c[B+1],k=c[B+2],D=e(z,A),E=e(A,k),H=e(k,z),G=4*B;x[G]=z;x[G+1]=D;x[G+2]=H;x[G+3]=A;x[G+4]=E;x[G+5]=D;x[G+6]=k;x[G+7]=H;x[G+8]=E;x[G+9]=D;x[G+10]=E;x[G+11]=H}c=x;m={}}b=new Float32Array(l);for(d=0;d<b;d+=3)g.normalize(b,d);l=new Float32Array(l);d={};d[h.POSITION]=c;d[h.NORMAL]=c;c={};c[h.POSITION]={size:3,data:l};c[h.NORMAL]={size:3,data:b};return new q([{type:"triangle",indices:d,positionKey:h.POSITION}],c)},createPointGeometry:function(a,
d,b,e,c,g,l){var m=new Float32Array(3);m[0]=d?d[0]:0;m[1]=d?d[1]:0;m[2]=d?d[2]:0;d=new Float32Array(3);d[0]=a?a[0]:0;d[1]=a?a[1]:0;d[2]=a?a[2]:1;if(null==l)a=new Float32Array(2),a[0]=0,a[1]=0;else{a=new Float32Array(l.length);for(var f=0;f<l.length;f++)a[f]=l[f]}l=new Uint8Array(4);l[0]=b?255*b[0]:255;l[1]=b?255*b[1]:255;l[2]=b?255*b[2]:255;l[3]=b&&3<b.length?255*b[3]:255;b=new Float32Array(2);b[0]=null!=e&&2==e.length?e[0]:1;b[1]=null!=e&&2==e.length?e[1]:1;if(null!=g){var k=new Float32Array(4);
k[0]=g[0];k[1]=g[1];k[2]=g[2];k[3]=g[3]}f=new Uint32Array(1);f[0]=0;e={};e[h.POSITION]=f;e[h.NORMAL]=f;e[h.UV0]=f;e[h.COLOR]=f;e[h.SIZE]=f;null!=g&&(e[h.AUXPOS1]=f);f={};f[h.POSITION]={size:3,data:m};f[h.NORMAL]={size:3,data:d};f[h.UV0]={size:a.length,data:a};f[h.COLOR]={size:4,data:l};f[h.SIZE]={size:2,data:b};null!=g&&(f[h.AUXPOS1]={size:4,data:k});g=[{type:"point",indices:e,positionKey:h.POSITION}];return c?{faces:g[0],vertexAttr:f,id:q.getNewId().toString()}:new q(g,f)},createPointArrayGeometry:function(a,
d){for(var b=new Float32Array(3*a.length),e=new Float32Array(d?3*a.length:3),c=new Uint32Array(a.length),g=new Uint32Array(a.length),l=0;l<a.length;l++)b[3*l]=a[l][0],b[3*l+1]=a[l][1],b[3*l+2]=a[l][2],d&&(e[3*l]=d[l][0],e[3*l+1]=d[l][1],e[3*l+2]=d[l][2]),c[l]=l,g[l]=0;d||(e[0]=0,e[1]=1,e[2]=0);l=new Float32Array(2);l[0]=0;l[1]=0;var m={};m[h.POSITION]=c;m[h.NORMAL]=d?c:g;m[h.UV0]=g;c={};c[h.POSITION]={size:3,data:b};c[h.NORMAL]={size:3,data:e};c[h.UV0]={size:2,data:l};return new q([{type:"point",
indices:m,positionKey:h.POSITION}],c)},createTriangleGeometry:function(){var a=new Float32Array(9);a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=100;a[6]=100;a[7]=0;a[8]=0;var d=new Uint32Array(3);d[0]=0;d[1]=1;d[2]=2;var b=new Float32Array(3);b[0]=0;b[1]=1;b[2]=0;var e=new Uint32Array(3);e[0]=0;e[1]=0;e[2]=0;var c=new Float32Array(2);c[0]=0;c[1]=0;var g=new Uint32Array(3);g[0]=0;g[1]=0;g[2]=0;var l={};l[h.POSITION]=d;l[h.NORMAL]=e;l[h.UV0]=g;d={};d[h.POSITION]={size:3,data:a};d[h.NORMAL]={size:3,data:b};
d[h.UV0]={size:2,data:c};return new q([{type:"triangle",indices:l,positionKey:h.POSITION}],d)},createSquareGeometry:function(a,d){var b,e,c=new Float32Array(12);if(a)for(b=0;4>b;b++)for(e=0;3>e;e++)c[3*b+e]=a[b][e];else c[0]=-1,c[1]=-1,c[2]=0,c[3]=1,c[4]=-1,c[5]=0,c[6]=1,c[7]=1,c[8]=0,c[9]=-1,c[10]=1,c[11]=0;var g=new Uint32Array(6);g[0]=0;g[1]=1;g[2]=2;g[3]=2;g[4]=3;g[5]=0;e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=1;var l=new Uint32Array(6);for(b=0;6>b;b++)l[b]=0;b=new Float32Array(8);b[0]=0;b[1]=
0;b[2]=1;b[3]=0;b[4]=1;b[5]=1;b[6]=0;b[7]=1;var m=new Uint8Array(4);m[0]=255;m[1]=255;m[2]=255;m[3]=255;var f={};f[h.POSITION]=g;f[h.NORMAL]=l;f[h.UV0]=g;f[h.COLOR]=l;g={};g[h.POSITION]={size:3,data:c};g[h.NORMAL]={size:3,data:e};g[h.UV0]={size:2,data:b};g[h.COLOR]={size:4,data:m};c=[{type:"triangle",indices:f,positionKey:h.POSITION}];return d?{faces:c[0],vertexAttr:g,id:q.getNewId().toString()}:new q(c,g)},createBoxGeometry:function(){var a,b,d=[[-0.5,-0.5,0.5],[0.5,-0.5,0.5],[0.5,0.5,0.5],[-0.5,
0.5,0.5],[-0.5,-0.5,-0.5],[0.5,-0.5,-0.5],[0.5,0.5,-0.5],[-0.5,0.5,-0.5]],e=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],c=[0,0,1,0,1,1,0,1],g=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],l=Array(36);for(a=0;6>a;a++)for(b=0;6>b;b++)l[6*a+b]=a;var m=Array(36);for(a=0;6>a;a++)m[6*a+0]=0,m[6*a+1]=1,m[6*a+2]=2,m[6*a+3]=2,m[6*a+4]=3,m[6*a+5]=0;return function(a){var b;Array.isArray(a)||(a=[a,a,a]);var p=new Float32Array(24);for(b=0;8>b;b++)p[3*b]=d[b][0]*a[0],p[3*b+1]=d[b][1]*
a[1],p[3*b+2]=d[b][2]*a[2];a={};a[h.POSITION]=new Uint8Array(g);a[h.NORMAL]=new Uint8Array(l);a[h.UV0]=new Uint8Array(m);b={};b[h.POSITION]={size:3,data:p};b[h.NORMAL]={size:3,data:new Float32Array(e)};b[h.UV0]={size:2,data:new Float32Array(c)};return new q([{type:"triangle",indices:a,positionKey:h.POSITION}],b)}}(),createDiamondGeometry:function(){var a=[[-0.5,0,-0.5],[0.5,0,-0.5],[0.5,0,0.5],[-0.5,0,0.5],[0,-0.5,0],[0,0.5,0]],b=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],d=[5,1,0,
5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],e=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];return function(c){var g;Array.isArray(c)||(c=[c,c,c]);var l=new Float32Array(18);for(g=0;6>g;g++)l[3*g]=a[g][0]*c[0],l[3*g+1]=a[g][1]*c[1],l[3*g+2]=a[g][2]*c[2];c={};c[h.POSITION]=new Uint8Array(d);c[h.NORMAL]=new Uint8Array(e);g={};g[h.POSITION]={size:3,data:l};g[h.NORMAL]={size:3,data:new Float32Array(b)};return new q([{type:"triangle",indices:c,positionKey:h.POSITION}],g)}}(),createTetrahedronGeometry:function(){var b=
a.createFrom(-0.5,0,-0.5),d=a.createFrom(0.5,0,-0.5),e=a.createFrom(0,0,0.5),c=a.createFrom(0,0.5,0),g=a.create(),l=a.create(),m=a.create(),f=a.create(),x=a.create();a.subtract(b,c,g);a.subtract(b,d,l);a.cross(g,l,m);a.normalize(m,m);a.subtract(d,c,g);a.subtract(d,e,l);a.cross(g,l,f);a.normalize(f,f);a.subtract(e,c,g);a.subtract(e,b,l);a.cross(g,l,x);a.normalize(x,x);var k=[b,d,e,c],z=[0,-1,0,m[0],m[1],m[2],f[0],f[1],f[2],x[0],x[1],x[2]],A=[0,1,2,3,1,0,3,2,1,3,0,2],w=[0,0,0,1,1,1,2,2,2,3,3,3];return function(a){var b;
Array.isArray(a)||(a=[a,a,a]);var d=new Float32Array(12);for(b=0;4>b;b++)d[3*b]=k[b][0]*a[0],d[3*b+1]=k[b][1]*a[1],d[3*b+2]=k[b][2]*a[2];a={};a[h.POSITION]=new Uint8Array(A);a[h.NORMAL]=new Uint8Array(w);b={};b[h.POSITION]={size:3,data:d};b[h.NORMAL]={size:3,data:new Float32Array(z)};return new q([{type:"triangle",indices:a,positionKey:h.POSITION}],b)}}(),createConeGeometry:function(b,d,e,c){var g=0,l=a.createFrom(0,g,0),m=a.createFrom(0,g+b,0),f=a.createFrom(0,-1,0),x=a.createFrom(0,1,0);c&&(g=b,
m=a.createFrom(0,0,0),l=a.createFrom(0,g,0),f=a.createFrom(0,1,0),x=a.createFrom(0,-1,0));var l=[m,l],f=[f,x],x=e+2,k=0,m=Math.sqrt(b*b+d*d);if(c)for(c=e-1;0<=c;c--)k=c*(2*Math.PI/e),z=a.createFrom(Math.cos(k)*d,g,Math.sin(k)*d),l.push(z),k=a.createFrom(b*Math.cos(k)/m,-d/m,b*Math.sin(k)/m),f.push(k);else for(c=0;c<e;c++){var k=c*(2*Math.PI/e),z=a.createFrom(Math.cos(k)*d,g,Math.sin(k)*d);l.push(z);k=a.createFrom(b*Math.cos(k)/m,d/m,b*Math.sin(k)/m);f.push(k)}b=new Uint32Array(6*(e+2));e=new Uint32Array(6*
(e+2));g=d=0;for(c=3;c<l.length;c++)b[d++]=1,b[d++]=c-1,b[d++]=c,e[g++]=0,e[g++]=0,e[g++]=0;b[d++]=l.length-1;b[d++]=2;b[d++]=1;e[g++]=0;e[g++]=0;e[g++]=0;for(c=3;c<l.length;c++)b[d++]=c,b[d++]=c-1,b[d++]=0,e[g++]=c,e[g++]=c-1,e[g++]=1;b[d++]=0;b[d++]=2;b[d++]=l.length-1;e[g++]=1;e[g++]=2;e[g++]=f.length-1;g=1;Array.isArray(g)||(g=[g,g,g]);d=new Float32Array(3*x);for(c=0;c<x;c++)d[3*c]=l[c][0]*g[0],d[3*c+1]=l[c][1]*g[1],d[3*c+2]=l[c][2]*g[2];l=new Float32Array(3*x);for(c=0;c<x;c++)l[3*c]=f[c][0],
l[3*c+1]=f[c][1],l[3*c+2]=f[c][2];f={};f[h.POSITION]=b;f[h.NORMAL]=e;x={};x[h.POSITION]={size:3,data:d};x[h.NORMAL]={size:3,data:l};return new q([{type:"triangle",indices:f,positionKey:h.POSITION}],x)},createCylinderGeometry:function(b,d,e,c,g,l){c||(c=a.createFrom(1,0,0));g||(g=a.createFrom(0,0,0));l=void 0===l?!0:l;var m=a.create();a.normalize(c,m);c=a.create();a.scale(m,Math.abs(b),c);var f=a.create();a.scale(c,-0.5,f);a.add(f,g);var x=a.createFrom(0,1,0);Math.abs(0.2>1-a.dot(m,x))&&a.set3(0,0,
1,x);var k=a.create();a.cross(m,x,k);a.normalize(k);a.cross(k,m,x);var z=2*e+(l?2:0),A=e+(l?2:0);g=new Float32Array(3*z);b=new Float32Array(3*A);var w=new Float32Array(2*z),D=new Uint32Array(3*e*(l?4:2)),E=new Float32Array(3*e*(l?4:2));l&&(g[3*(z-2)+0]=f[0],g[3*(z-2)+1]=f[1],g[3*(z-2)+2]=f[2],w[2*(z-2)]=0,w[2*(z-2)+1]=0,g[3*(z-1)+0]=g[3*(z-2)+0]+c[0],g[3*(z-1)+1]=g[3*(z-2)+1]+c[1],g[3*(z-1)+2]=g[3*(z-2)+2]+c[2],w[2*(z-1)]=1,w[2*(z-1)+1]=1,b[3*(A-2)+0]=-m[0],b[3*(A-2)+1]=-m[1],b[3*(A-2)+2]=-m[2],b[3*
(A-1)+0]=m[0],b[3*(A-1)+1]=m[1],b[3*(A-1)+2]=m[2]);for(var H,G=0,I=a.create(),n=a.create(),m=0;m<e;m++){H=m*(2*Math.PI/e);a.scale(x,Math.sin(H),I);a.scale(k,Math.cos(H),n);a.add(I,n);b[3*m+0]=I[0];b[3*m+1]=I[1];b[3*m+2]=I[2];a.scale(I,d);a.add(I,f);g[3*m+0]=I[0];g[3*m+1]=I[1];g[3*m+2]=I[2];w[2*m+0]=m/e;w[2*m+1]=0;g[3*(m+e)+0]=g[3*m+0]+c[0];g[3*(m+e)+1]=g[3*m+1]+c[1];g[3*(m+e)+2]=g[3*m+2]+c[2];w[2*(m+e)+0]=m/e;w[2*m+1]=1;H=(m+1)%e;var J=function(a,b,d){D[a]=b;E[a]=d};l&&(J(G++,z-2,A-2),J(G++,m,A-2),
J(G++,H,A-2));J(G++,m,m);J(G++,m+e,m);J(G++,H,H);J(G++,H,H);J(G++,m+e,m);J(G++,H+e,H);l&&(J(G++,m+e,A-1),J(G++,z-1,A-1),J(G++,H+e,A-1))}d={};d[h.POSITION]=D;d[h.NORMAL]=E;d[h.UV0]=D;e={};e[h.POSITION]={size:3,data:g};e[h.NORMAL]={size:3,data:b};e[h.UV0]={size:2,data:w};return new q([{type:"triangle",indices:d,positionKey:h.POSITION}],e)},createTubeGeometry:function(a,b,d,e,c){d=d||10;e=null!=e?e:!0;k.assert(1<a.length);for(var h=[],g=[],m=0;m<d;m++){h.push([0,-m-1,-((m+1)%d)-1]);var f=2*(m/d)*Math.PI;
g.push([Math.cos(f)*b,Math.sin(f)*b])}return l.createPathExtrusionGeometry(g,a,[[0,0,0]],h,e,c)},createSquareTubeGeometry:function(a,b,d){d=d||!0;k.assert(1<a.length);b*=Math.SQRT2;return l.createPathExtrusionGeometry([[b,b],[-b,b],[-b,-b],[b,-b]],a,[],[[-1,-2,-3],[-3,-4,-1]],d,[[0,1],[-1,0],[0,-1],[1,0]])},createPathExtrusionGeometry:function(d,e,c,g,l,m,f){var k,x=d.length,B=new Float32Array(3*e.length*x+(6*c.length||0)),z=new Float32Array(e.length*x+(2*c.length||0)),A=new Float32Array(3*e.length*
x+(c?6:0)),w=0,D=0,E=0,H=65535<B.length/3?Uint32Array:Uint16Array,G=6*(e.length-1)*x+6*g.length,I=new H(G),H=new H(G),n=G=0,J=a.create(),F=a.create(),K=a.create(),T=a.create(),R=a.create(),da=a.create(),S=a.create(),ba=a.create(),aa=a.create(),$=a.create(),Z=a.create(),M=a.create();a.set3(0,1,0,M);a.subtract(e[1],e[0],F);a.normalize(F);l?(a.add(e[0],m,Z),a.normalize(Z,K)):a.set3(0,0,1,K);b(F,K,M,M,da,K,0.99619469809);a.set(K,T);for(k=0;k<c.length;k++)a.scale(da,c[k][0],aa),a.scale(K,c[k][2],Z),a.add(aa,
Z),a.add(aa,e[0]),B[w++]=aa[0],B[w++]=aa[1],B[w++]=aa[2],z[E++]=0;A[D++]=-F[0];A[D++]=-F[1];A[D++]=-F[2];for(k=0;k<g.length;k++)I[G++]=0<g[k][0]?g[k][0]:-g[k][0]-1+c.length,I[G++]=0<g[k][1]?g[k][1]:-g[k][1]-1+c.length,I[G++]=0<g[k][2]?g[k][2]:-g[k][2]-1+c.length,H[n++]=0,H[n++]=0,H[n++]=0;var V=c.length;k=c.length-1;for(var L,U=0;U<e.length;U++){L=!1;0<U&&(l?(a.add(e[U],m,Z),a.normalize(Z,K)):a.set3(0,0,1,K),a.set(F,J),a.set(J,Z),U<e.length-1?(a.subtract(e[U+1],e[U],F),a.normalize(F),a.add(Z,F)):
L=!0,b(Z,K,T,M,da,K,0.99619469809),a.set(K,T));f&&(b(F,K,T,M,ba,S,0.99619469809),a.set(S,R));for(var N=0;N<x;N++)if(a.scale(da,d[N][0],aa),a.scale(K,d[N][1],Z),a.add(aa,Z),f?(a.scale(ba,f[N][0],$),a.scale(S,f[N][1],Z),a.add($,Z),a.normalize($),a.scale($,-1)):a.normalize(aa,$),A[D++]=$[0],A[D++]=$[1],A[D++]=$[2],a.add(aa,e[U]),B[w++]=aa[0],B[w++]=aa[1],B[w++]=aa[2],z[E++]=d[N][1],!L){var Q=(N+1)%x;I[G++]=V+N;I[G++]=V+x+N;I[G++]=V+Q;I[G++]=V+Q;I[G++]=V+x+N;I[G++]=V+x+Q;if(f)for(Q=0;6>Q;Q++)H[n++]=V-
k+N;else for(Q=0;6>Q;Q++)H[n++]=I[G-6+Q]-k}V+=x}L=e[e.length-1];for(k=0;k<c.length;k++)a.scale(da,c[k][0],aa),a.scale(K,c[k][1],Z),a.add(aa,Z),a.add(aa,L),B[w++]=aa[0],B[w++]=aa[1],B[w++]=aa[2],z[E++]=0;d=D/3;A[D++]=F[0];A[D++]=F[1];A[D++]=F[2];x=V-x;for(k=0;k<g.length;k++)I[G++]=0<=g[k][0]?V+g[k][0]:-g[k][0]-1+x,I[G++]=0<=g[k][2]?V+g[k][2]:-g[k][2]-1+x,I[G++]=0<=g[k][1]?V+g[k][1]:-g[k][1]-1+x,H[n++]=d,H[n++]=d,H[n++]=d;g={};g[h.POSITION]=I;g[h.NORMAL]=H;I={};I[h.POSITION]={size:3,data:B};I.zOffset=
{size:1,data:z};I[h.NORMAL]={size:3,data:A};return new q([{type:"triangle",indices:g,positionKey:h.POSITION}],I)},createPolylineGeometry:function(a,b){k.assert(1<a.length,"createPolylineGeometry(): polyline needs at least 2 points");k.assert(3===a[0].length,"createPolylineGeometry(): malformed vertex");for(var d=new Float32Array(3*a.length),e=new Uint32Array(2*(a.length-1)),c=0,g=0,l=0;l<a.length;l++){for(var m=0;3>m;m++)d[c++]=a[l][m];0<l&&(e[g++]=l-1,e[g++]=l)}g={};c={};g[h.POSITION]=e;c[h.POSITION]=
{size:3,data:d};d=[{type:"line",indices:g,positionKey:h.POSITION}];return b?{faces:d[0],vertexAttr:c,id:q.getNewId().toString()}:new q(d,c)},addVertexColors:function(a,b,d){var e,c,g;if(d){var l={};d=a.getVertexAttr();for(g in d)l[g]=d[g];a=a.getFaces();d=Array(a.length);for(c=0;c<a.length;c++){e={};for(g in a[c].indices)e[g]=a[c].indices[g];d[c]={type:a[c].type,indices:e,positionKey:a[c].positionKey}}a=new q(d,l)}b=b||[1,1,1,1];g=new Uint8Array(4);g[0]=255*b[0];g[1]=255*b[1];g[2]=255*b[2];g[3]=255*
(3<b.length?b[3]:1);a.getVertexAttr()[h.COLOR]={size:4,data:g};d=a.getFaces();for(c=0;c<d.length;c++)b=d[c],e=new Uint32Array(b.indices[b.positionKey].length),b.indices[h.COLOR]=e;return a},addNormals:function(a){var b=a.getVertexAttr();a=a.getFaces();for(var c=n.Vec3Compact.subtract,h=a.map(function(a){return a.indices.position.length/3}).reduce(function(a,b){return a+b}),h=new Float32Array(3*h),g=b.position.data,l=0,f=0;f<a.length;f++){for(var k=a[f].indices.position,x=new Uint32Array(k.length),
B=0;B<k.length;B+=3){c(g,3*k[B],g,3*k[B+2],m,0);c(g,3*k[B],g,3*k[B+1],d,0);e.cross(d,m);e.normalize(d);var z=l/3;h[l++]=d[0];h[l++]=d[1];h[l++]=d[2];x[B]=z;x[B+1]=z;x[B+2]=z}a[f].indices.normal=x}b.normal={size:3,data:h}},cgToGIS:function(a){var b=a.getVertexAttr();a=b.position.data;var b=b.normal.data,d,e;if(b)for(d=0;d<b.length;d+=3)e=b[d+1],b[d+1]=-b[d+2],b[d+2]=e;if(a)for(d=0;d<a.length;d+=3)e=a[d+1],a[d+1]=-a[d+2],a[d+2]=e}};return l})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require",
"exports"],function(q,n){return function(){function k(f,c){this.id=k.getNewId();this.faces=f;this.vertexAttributes=c}k.prototype.estimateGpuMemoryUsage=function(){for(var f=0,c=0;c<this.faces.length;c++){var b=3;this.faces[c].indices.normal&&(b+=3);this.faces[c].indices.uv0&&(b+=2);this.faces[c].indices.color&&b++;f+=4*this.faces[c].indices.position.length*b}return f};k.prototype.getId=function(){return this.id};k.prototype.getFaces=function(){return this.faces};k.prototype.getVertexAttr=function(){return this.vertexAttributes};
k.getNewId=function(){return k._id++};k._id=0;k.AxisOrder={CG:0,GIS:1};return k}()})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(q,n){(function(k){k.length=function(f,c){var b=f[c],a=f[c+1],e=f[c+2];return Math.sqrt(b*b+a*a+e*e)};k.normalize=function(f,c){var b=f[c],a=f[c+1],e=f[c+2],b=1/Math.sqrt(b*b+a*a+e*e);f[c]*=b;f[c+1]*=b;f[c+2]*=b};k.scale=function(f,c,b){f[c]*=b;f[c+1]*=b;f[c+2]*=b};k.add=function(f,c,b,a,e,h){void 0===h&&(h=c);e=e||
f;e[h]=f[c]+b[a];e[h+1]=f[c+1]+b[a+1];e[h+2]=f[c+2]+b[a+2]};k.subtract=function(f,c,b,a,e,h){void 0===h&&(h=c);e=e||f;e[h]=f[c]-b[a];e[h+1]=f[c+1]-b[a+1];e[h+2]=f[c+2]-b[a+2]}})(n.Vec3Compact||(n.Vec3Compact={}))})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ./IdGen ./Util ./DDSUtil ./gl-matrix ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p){function s(a,b,d,c,h,g,l){l=!1!==l;var m=new Image;m.onerror=function(){g(null);m.onerror=void 0;m.onload=void 0};m.onload=function(){f.assert(1<=m.width&&1<=m.height);d.samplingMode=l?9987:9729;d.hasMipmap=l;if(!f.isPowerOfTwo(m.width)||!f.isPowerOfTwo(m.height))var b=r(a,m,d,c,h);else d.width=m.width,d.height=m.height,b=new e(a,d,m);a.bindTexture(b);g(b);m.onerror=void 0;m.onload=void 0};m.src=b}function r(b,c,m,s,r){var k=f.nextHighestPowerOfTwo(c.width),z=
f.nextHighestPowerOfTwo(c.height);f.assert(k!==c.width||z!==c.height);m.width=k;m.height=z;var A=new e(b,m),w=a.createWithAttachments(b,A,{colorTarget:0,depthStencilTarget:0});c=new e(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,maxAnisotropy:8},c);b.bindFramebuffer(w);void 0===r&&(r=b.getViewport(),r=[r.x,r.y,r.width,r.height]);b.setViewport(0,0,k,z);s=s.get("texOnly");k=t.identity();b.bindProgram(s);s.setUniformMatrix4fv("model",k);s.setUniformMatrix4fv("view",
k);s.setUniformMatrix4fv("proj",k);s.setUniform4fv("color",new Float32Array([1,1,1,1]));s.setUniform1i("tex",0);s=new g(b,p.Default3D,{geometry:l.Pos3Tex},{geometry:d.createVertex(b,35044,f.createQuadVertexUvBuffer())});b.bindTexture(c,0);b.bindVAO(s);b.setDepthTestEnabled(!1);b.setBlendingEnabled(!1);b.drawArrays(5,0,h.vertexCount(s,"geometry"));b.setDepthTestEnabled(!0);b.bindFramebuffer(null);b.setViewport(r[0],r[1],r[2],r[3]);s.dispose(!0);c.dispose();b.bindFramebuffer(null);w.detachColorTexture();
w.dispose();m.hasMipmap&&A.generateMipmap();return A}var t=b.mat4d;return function(){function a(b,d,e){this.data=b;this.id=a.idGen.gen(d);this.unloadFunc=void 0;this.params=e||{};this.params.wrapClamp=this.params.wrapClamp||!1;this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.estimatedTexMemRequiredMB=a.estimateTexMemRequiredMB(this.data,this.params)}a.estimateTexMemRequiredMB=function(a,b){return null==a?0:a instanceof ArrayBuffer||a instanceof
Uint8Array?a.byteLength/1E6:4*1.3*b.width*b.height/1E6};a.prototype.getId=function(){return this.id};a.prototype.getEstimatedTexMemRequiredMB=function(){return this.estimatedTexMemRequiredMB};a.prototype.dispose=function(){this.data=void 0};a.prototype.deferredLoading=function(){return"string"===typeof this.data};a.prototype.getWidth=function(){return this.params.width};a.prototype.getHeight=function(){return this.params.height};a.prototype.initializeThroughUpload=function(b,d,h,g,l){var m=this.data;
d.flipped=!this.params.noUnpackFlip;d.samplingMode=this.params.mipmap?9987:9729;d.hasMipmap=this.params.mipmap;if("string"===typeof m)s(b,m,d,h,g,l,this.params.mipmap);else if(m instanceof Image||m instanceof ImageData||m instanceof HTMLCanvasElement)this.params.width=m.width,this.params.height=m.height,(this.params.mipmap||!this.params.wrapClamp)&&(!f.isPowerOfTwo(m.width)||!f.isPowerOfTwo(m.height))?d=r(b,m,d,h,g):(d.width=m.width,d.height=m.height,d=new e(b,d,m)),b.bindTexture(d),l(d);else if(m instanceof
ArrayBuffer&&this.params.encoding===a.DDS_ENCODING)d=c.createDDSTexture(b,d,m,this.params.mipmap),b.bindTexture(d),l(d);else if(m instanceof Uint8Array&&this.params.encoding===a.DDS_ENCODING)d=c.createDDSTexture(b,d,m.buffer,this.params.mipmap),b.bindTexture(d),l(d);else if(m instanceof Uint8Array)f.assert(0<this.params.width&&0<this.params.height),d.pixelFormat=1===this.params.components?6409:6408,d.width=this.params.width,d.height=this.params.height,d=new e(b,d,m),b.bindTexture(d),l(d);else if(null!==
m)throw console.warn("Unsupported image data"),Error("Unsupported image data");this.data=void 0};a.prototype.setUnloadFunc=function(a){this.unloadFunc=a};a.prototype.unload=function(){void 0!==this.unloadFunc&&(this.unloadFunc(this.id),this.unloadFunc=void 0)};a.idGen=new k;a.DDS_ENCODING="image/vnd-ms.dds";return a}()})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports","../../../webgl/Texture","../../../webgl/enums"],function(q,n,k,f){function c(a){return a.charCodeAt(0)+
(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var b=c("DXT1"),a=c("DXT3"),e=c("DXT5");n.createDDSTexture=function(c,g,d,m){var l=new Int32Array(d,0,31);if(542327876!==l[0])return console.error("Invalid magic number in DDS header"),null;if(!(l[20]&4))return console.error("Unsupported format, must contain a FourCC code"),null;var p=l[21],f;switch(p){case b:p=8;f=33776;break;case a:p=16;f=33778;break;case e:p=16;f=33779;break;default:return console.error("Unsupported FourCC code:",
String.fromCharCode(p&255,p>>8&255,p>>16&255,p>>24&255)),null}var r=1;l[2]&131072&&!1!==m&&(r=Math.max(1,l[7]));m=l[4];var t=l[3],u=l[1]+4,v,C;g.samplingMode=1<r?9987:9729;g.hasMipmap=1<r;g.width=l[4];g.height=l[3];g=new k(c,g);c.bindTexture(g);for(l=0;;++l){l<r&&(C=Math.floor((m+3)/4)*Math.floor((t+3)/4)*p,v=new Uint8Array(d,u,C));c.gl.compressedTexImage2D(c.gl.TEXTURE_2D,l,f,m,t,0,v);u+=C;if(1===m&&1===t||1===r)break;m=Math.max(1,m>>1);t=Math.max(1,t>>1)}return g}})},"esri/views/webgl/Texture":function(){define(["require",
"exports"],function(q,n){return function(){function k(f,c,b){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=f;this._desc={pixelFormat:c.pixelFormat,dataType:c.dataType,target:c.target?c.target:3553,samplingMode:c.samplingMode?c.samplingMode:9729,wrapMode:c.wrapMode?c.wrapMode:10497,maxAnisotropy:c.maxAnisotropy,flipped:void 0!==c.flipped?c.flipped:!1,hasMipmap:void 0!==c.hasMipmap?c.hasMipmap:!1,level:void 0!==c.level?c.level:
0,unpackAlignment:c.unpackAlignment?c.unpackAlignment:4,width:c.width,height:c.height};this._id=++k._nextId;this.setData(b)}Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});k.prototype.dispose=function(){this._context&&this._glName&&
(this._context.gl.deleteTexture(this._glName),this._glName=null)};k.prototype.resize=function(f,c){var b=this._desc;b.width===f&&b.height===c||(b.width=f,b.height=c,this.setData(null))};k.prototype.setData=function(f){var c=this._context.gl;this._glName||(this._glName=c.createTexture());void 0===f&&(f=null);null===f&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var a=this._desc;k._validateTexture(a);
c.pixelStorei(c.UNPACK_ALIGNMENT,a.unpackAlignment);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,a.flipped?1:0);f instanceof ImageData||f instanceof HTMLImageElement||f instanceof HTMLCanvasElement||f instanceof HTMLVideoElement?(a.width&&a.height&&console.assert(f.width===a.width&&f.height===a.height),c.texImage2D(c.TEXTURE_2D,a.level,a.pixelFormat,a.pixelFormat,a.dataType,f),void 0===this._desc.width&&(this._desc.width=f.width),void 0===this._desc.height&&(this._desc.height=f.height)):((null==a.width||null==
a.height)&&console.error("Width and height must be specified!"),c.texImage2D(c.TEXTURE_2D,a.level,a.pixelFormat,a.width,a.height,0,a.pixelFormat,a.dataType,f));a.hasMipmap&&this.generateMipmap();k._applySamplingMode(c,this._desc);k._applyWrapMode(c,this._desc);k._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(b,0)};k.prototype.updateData=function(f,c,b,a,e,h){h||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
var g=this._context.gl,d=this._desc;this._context.bindTexture(this);(0>c||0>b||a>d.width||e>d.height||c+a>d.width||b+e>d.height)&&console.error("An attempt to update out of bounds of the texture!");h instanceof ImageData||h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement?(console.assert(h.width===a&&h.height===e),g.texSubImage2D(g.TEXTURE_2D,f,c,b,d.pixelFormat,d.dataType,h)):g.texSubImage2D(g.TEXTURE_2D,f,c,b,a,e,d.pixelFormat,d.dataType,h)};k.prototype.generateMipmap=
function(){var f=this._desc;f.hasMipmap||(f.hasMipmap=!0,k._validateTexture(f));9729===f.samplingMode?(this._samplingModeDirty=!0,f.samplingMode=9985):9728===f.samplingMode&&(this._samplingModeDirty=!0,f.samplingMode=9984);f=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=this._context.gl;c.generateMipmap(c.TEXTURE_2D);this._context.bindTexture(f,0)};k.prototype.setSamplingMode=function(f){f!==this._desc.samplingMode&&(this._desc.samplingMode=f,k._validateTexture(this._desc),
this._samplingModeDirty=!0)};k.prototype.setWrapMode=function(f){f!==this._desc.wrapMode&&(this._desc.wrapMode=f,k._validateTexture(this._desc),this._wrapModeDirty=!0)};k.prototype.applyChanges=function(){var f=this._context.gl,c=this._desc;this._samplingModeDirty&&(k._applySamplingMode(f,c),this._samplingModeDirty=!1);this._wrapModeDirty&&(k._applyWrapMode(f,c),this._wrapModeDirty=!1)};k._isPowerOfTwo=function(f){return 0===(f&f-1)};k._validateTexture=function(f){(0>f.width||0>f.height)&&console.error("Negative dimension parameters are not allowed!");
if(!k._isPowerOfTwo(f.width)||!k._isPowerOfTwo(f.height))33071!==f.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),f.hasMipmap&&console.error("Mipmapping requires power-of-two textures!")};k._applySamplingMode=function(f,c){var b=c.samplingMode;if(9985===b||9987===b)b=9729;else if(9984===b||9986===b)b=9728;f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,b);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,c.samplingMode)};k._applyWrapMode=function(f,
c){f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,c.wrapMode);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,c.wrapMode)};k._applyAnisotropicFilteringParameters=function(f,c){if(null!=c.maxAnisotropy){var b=f.extensions.textureFilterAnisotropic;if(b){var a=f.gl;a.texParameterf(a.TEXTURE_2D,b.TEXTURE_MAX_ANISOTROPY_EXT,c.maxAnisotropy)}}};k._nextId=0;return k}()})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","./Texture"],function(q,n,k){return function(){function f(c,
b,a,e){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=c;this._desc={colorTarget:b.colorTarget,depthStencilTarget:b.depthStencilTarget,width:b.width,height:b.height,multisampled:b.multisampled};this._id=f._nextId++;a&&(c=void 0,a instanceof k?(this._colorAttachment=a,c=a.descriptor):(c=a,this._colorAttachment=new k(this._context,c)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),
f._validateTextureDimensions(c,this._desc));e&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),a=void 0,e instanceof k?(this._depthStencilTexture=e,a=this._depthStencilTexture.descriptor):(a=e,this._depthStencilTexture=new k(this._context,a)),f._validateTextureDimensions(a,this._desc))}f.create=function(c,b){return new f(c,b)};f.createWithAttachments=function(c,b,a,
e){return new f(c,a,b,e)};Object.defineProperty(f.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof k?this._colorAttachment:null},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});f.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),
this._context.gl.deleteFramebuffer(this._glName),this._glName=null)};f.prototype.attachColorTexture=function(c){if(c){f._validateTextureDimensions(c.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,c.glName,0)}this._colorAttachment=c}};f.prototype.detachColorTexture=function(){var c=void 0;if(this._colorAttachment instanceof k){c=this._colorAttachment;
if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;this._context.gl.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)}this._colorAttachment=null}return c};f.prototype.attachDepthStencilTexture=function(c){if(c){var b=c.descriptor;34041!==b.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==b.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.extensions.depthTexture||
console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");f._validateTextureDimensions(b,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,c.glName,0));this._depthStencilTexture=c}};f.prototype.detachDepthStencilTexture=
function(){var c=this._depthStencilTexture;if(c&&this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;this._context.gl.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return c};f.prototype.copyToTexture=function(c,b,a,e,h,g,d){(0>c||0>b||0>h||0>g)&&console.error("Offsets cannot be negative!");(0>=a||0>=e)&&console.error("Copy width and height must be greater than zero!");var m=this._desc,l=d.descriptor;3553!==
d.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(c+a>m.width||b+e>m.height||h+a>l.width||g+e>l.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");m=this._context;m.bindTexture(d);m.bindFramebuffer(this);m.gl.copyTexSubImage2D(3553,0,h,g,c,b,a,e)};f.prototype.readPixels=function(c,b,a,e,h,g,d){(0>=a||0>=e)&&console.error("Copy width and height must be greater than zero!");d||console.error("Target memory is not initialized!");
this._context.bindFramebuffer(this);this._context.gl.readPixels(c,b,a,e,h,g,d)};f.prototype.resize=function(c,b){var a=this._desc;if(!(a.width===c&&a.height===b))if(this._initialized)a.width=c,a.height=b,this._colorAttachment instanceof k?(e=this._colorAttachment,a=e.descriptor,a.width=c,a.height=b,this._colorAttachment=new k(this._context,a),f._validateTextureDimensions(e.descriptor,this._desc)):this._colorAttachment=null,null!=this._depthStencilTexture&&(a=this._depthStencilTexture.descriptor,a.width=
c,a.height=b,this._depthStencilTexture=new k(this._context,a)),this._initialized=!1;else{a.width=c;a.height=b;if(this._colorAttachment instanceof k){var e=this._colorAttachment;e.resize(c,b)}this._depthStencilTexture&&this._depthStencilTexture.resize(c,b)}};f.prototype.initialize=function(){if(this._initialized)return!1;var c=this._context.gl,b=c.createFramebuffer(),a=this._desc;c.bindFramebuffer(c.FRAMEBUFFER,b);if(!this._colorAttachment)if(0===a.colorTarget)this._colorAttachment=new k(this._context,
{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a.width,height:a.height});else{var e=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);c.renderbufferStorage(c.RENDERBUFFER,c.RGBA4,a.width,a.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,e);this._colorAttachment=e}this._colorAttachment instanceof k&&c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this._colorAttachment.glName,0);switch(a.depthStencilTarget){case 1:case 3:e=
c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);var h=1===a.depthStencilTarget?c.DEPTH_ATTACHMENT:c.DEPTH_STENCIL_ATTACHMENT;c.renderbufferStorage(c.RENDERBUFFER,1===a.depthStencilTarget?c.DEPTH_COMPONENT16:c.DEPTH_STENCIL,a.width,a.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,h,c.RENDERBUFFER,e);this._depthAttachment=e;break;case 2:e=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);c.renderbufferStorage(c.RENDERBUFFER,c.STENCIL_INDEX8,a.width,a.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.STENCIL_ATTACHMENT,c.RENDERBUFFER,e);this._stencilAttachment=e;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new k(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:a.width,height:a.height})),c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,
c.TEXTURE_2D,this._depthStencilTexture.glName,0)}c.checkFramebufferStatus(c.FRAMEBUFFER)!==c.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=b;return this._initialized=!0};f.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof k){var c=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)}c.dispose()}else this._colorAttachment instanceof
WebGLRenderbuffer&&(c=this._colorAttachment,b=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(c));this._colorAttachment=null};f.prototype._disposeDepthStencilAttachments=function(){var c=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,1===this._desc.depthStencilTarget?
b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,null)}c.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,null)),c.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,
c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};f._validateTextureDimensions=function(c,b){console.assert(0<=c.width&&0<=c.height);3553!==c.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==b.width&&0<=b.width&&void 0!==b.height&&0<=b.height?(b.width!==c.width||b.height!==c.height)&&console.error("Color attachment texture must match the framebuffer's!"):(b.width=c.width,b.height=
c.height)};f._nextId=0;return f}()})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require","exports"],function(q,n){n.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];n.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];n.Pos3Color=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,
normalized:!1}];n.Pos3Norm=[{name:"position",count:3,type:5126,offset:0,stride:24,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:24,normalized:!1}];n.Pos3NormTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];n.Pos3NormCol=[{name:"position",count:3,type:5126,offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,
offset:12,stride:28,normalized:!1},{name:"color",count:4,type:5121,offset:24,stride:28,normalized:!1}];n.Pos3NormTexCol=[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:36,normalized:!1}];n.Pos3NormTexRegion=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,
type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:40,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:40,normalized:!1}];n.Pos3NormTexRegionCol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"color",count:4,type:5121,
offset:40,stride:44,normalized:!1}];n.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];n.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];n.Model=[{name:"model",count:16,type:5126,offset:0,stride:128,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:128,normalized:!1,divisor:1}];n.ModelCol=[{name:"model",count:16,type:5126,offset:0,stride:144,normalized:!1,
divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:144,normalized:!1,divisor:1},{name:"instanceColor",count:4,type:5126,offset:128,stride:144,normalized:!1,divisor:1}]})},"esri/views/3d/webgl-engine/lib/GLTextureRep":function(){define(["require","exports","./Util","../../../webgl/Texture","../../../webgl/enums"],function(q,n,k,f,c){var b=function(){function a(a){this._glTexture=null;this._refCount=0;this._glTexture=a}a.prototype.incRefCnt=function(){++this._refCount};a.prototype.decRefCnt=
function(){--this._refCount;k.assert(0<=this._refCount)};a.prototype.getRefCnt=function(){return this._refCount};a.prototype.setGLTexture=function(a){this._glTexture=a};a.prototype.getGLTexture=function(){return this._glTexture};return a}();return function(){function a(a,b,c,d){this.NUM_PARALLEL=8;this.textures=a;this._programRepository=b;this.getViewportToRestore=c;this._rctx=d;this.NUM_PARALLEL=8;this.id2textureRef={};this.loading={};this._queue=[];this.listeners=[];this.maxMaxAnisotropy=(this.afExt=
d.extensions.textureFilterAnisotropic)?d.parameters.maxMaxAnisotropy:1;this.maxAnisotropy=Math.min(8,this.maxMaxAnisotropy);this._needsRender=!0;this._fallbackTextureData=new Uint8Array(256);this._fallbackTextureTransparentData=new Uint8Array(256);a=0;for(b=this._fallbackTextureData.length;a<b;++a)this._fallbackTextureData[a]=255,this._fallbackTextureTransparentData[a]=0!==(a+1)%4?255:0;this._fallbackTextureDesc={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:8,height:8,maxAnisotropy:8}}
a.prototype.resetNeedsRender=function(){this._needsRender=!1};a.prototype.needsRender=function(){return this._needsRender};a.prototype.aquire=function(a,c,g,d){var m=this,l=this.id2textureRef[a];if(null==l){c=this.textures[a];k.assert(void 0!==c);c.setUnloadFunc(this._unload.bind(this));g=!0===g;var p=this._createGLTextureDescription(c),l=new b(g?new f(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData):new f(this._rctx,this._fallbackTextureDesc,this._fallbackTextureData));
k.assert(null==this.id2textureRef[a]);this.id2textureRef[a]=l;c.initializeThroughRender?(a=c.initializeThroughRender(this._rctx,p),l.setGLTexture(a),d&&d(l)):c.deferredLoading()?this.getLoadingCount()<this.NUM_PARALLEL?this._loadImage(a,p,d):this._queue.push([a,p,d]):c.initializeThroughUpload(this._rctx,p,this._programRepository,this.getViewportToRestore(),function(a){l.setGLTexture(a);m._needsRender=!0;d&&d(l)});this._needsRender=!0}l.incRefCnt();return l};a.prototype.release=function(a){a=this.id2textureRef[a];
void 0!==a&&(a.decRefCnt(),k.assert(0<=a.getRefCnt()))};a.prototype.getLoadingCount=function(){return Object.keys(this.loading).length};a.prototype.getIsLoaded=function(a){if(null==this.id2textureRef[a]||void 0!==this.loading[a])return!1;for(var b=0,c=this._queue.length;b<c;++b)if(this._queue[b][0]===a)return!1;return!0};a.prototype.addTextureListener=function(a){k.assert(-1===this.listeners.indexOf(a));this.listeners.push(a)};a.prototype.removeTextureListener=function(a){a=this.listeners.indexOf(a);
k.assert(-1!==a);this.listeners.splice(a,1)};a.prototype.getTexture=function(a){return this.textures[a]};a.prototype.getMaxAnisotropy=function(){return this.maxAnisotropy};a.prototype._unload=function(a){var b=this.id2textureRef[a];void 0!==b&&(b.getGLTexture().dispose(),delete this.id2textureRef[a])};a.prototype._createGLTextureDescription=function(a){return{target:3553,pixelFormat:6408,dataType:5121,maxAnisotropy:this.afExt&&a.params&&a.params.mipmap&&!a.params.disableAnisotropy?this.maxAnisotropy:
void 0,wrapMode:a.params&&a.params.wrapClamp?33071:void 0}};a.prototype.next=function(a){if(a in this.loading){delete this.loading[a];var b=Object.keys(this.id2textureRef),c=Object.keys(this.loading);this.listeners.forEach(function(d){d(a,b,c)});this.processQueue()}};a.prototype._loadImage=function(a,b,c){var d=this;k.assert(null==this.loading[a]);this.loading[a]=!0;var m=this.textures[a];k.assert(void 0!==m);setTimeout(function(){var l=d.id2textureRef[a];l&&l.getRefCnt()&&m.initializeThroughUpload(d._rctx,
b,d._programRepository,d.getViewportToRestore(),function(b){d.next(a);d._needsRender=!0;l&&l.getRefCnt()&&(l.setGLTexture(b),c&&c(l))})},0)};a.prototype.processQueue=function(){for(var a=[],b=0,c=this._queue.length;b<c;++b){var d=this._queue[b][0],m=this.id2textureRef[d];void 0!==m&&(0===m.getRefCnt()?(m.getGLTexture().dispose(),delete this.id2textureRef[d]):a.push(this._queue[b]))}this._queue=a;a=Math.min(this.NUM_PARALLEL-Object.keys(this.loading).length,this._queue.length);for(b=0;b<a;++b)this._loadImage(this._queue[b][0],
this._queue[b][1],this._queue[b][2]);this._queue.splice(0,a)};return a}()})},"esri/views/3d/webgl-engine/lib/RenderPass":function(){define(["require","exports"],function(q,n){var k,f=k||(k={});f[f.MATERIAL=0]="MATERIAL";f[f.MATERIAL_DEPTH=1]="MATERIAL_DEPTH";f[f.MATERIAL_NORMAL=2]="MATERIAL_NORMAL";f[f.MATERIAL_DEPTH_SHADOWMAP=3]="MATERIAL_DEPTH_SHADOWMAP";f[f.MATERIAL_HIGHLIGHT=4]="MATERIAL_HIGHLIGHT";f[f.MAX_PASS=5]="MAX_PASS";return k})},"esri/views/3d/webgl-engine/lib/RenderSlot":function(){define(["require",
"exports"],function(q,n){var k,f=k||(k={});f[f.BACKGROUND=0]="BACKGROUND";f[f.INTERNAL_MATERIAL=1]="INTERNAL_MATERIAL";f[f.STENCIL_MATERIAL=2]="STENCIL_MATERIAL";f[f.OPAQUE_TERRAIN=3]="OPAQUE_TERRAIN";f[f.OPAQUE_MATERIAL=4]="OPAQUE_MATERIAL";f[f.OPAQUE_EXTERNAL=5]="OPAQUE_EXTERNAL";f[f.TRANSPARENT_MATERIAL=6]="TRANSPARENT_MATERIAL";f[f.TRANSPARENT_EXTERNAL=7]="TRANSPARENT_EXTERNAL";f[f.TRANSPARENT_TERRAIN=8]="TRANSPARENT_TERRAIN";f[f.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS";f[f.POSTPROCESSING_HIGHLIGHT=
10]="POSTPROCESSING_HIGHLIGHT";f[f.POSTPROCESSING_ATMOSPHERE=11]="POSTPROCESSING_ATMOSPHERE";f[f.OVERLAY=12]="OVERLAY";f[f.MAX_SLOTS=13]="MAX_SLOTS";return k})},"esri/views/3d/environment/resources/SimpleAtmosphereTexture":function(){define([],function(){return"data:image/png;base64,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"})},
"esri/views/webgl/Program":function(){define(["require","exports"],function(q,n){return function(){function k(f,c,b,a,e){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines=void 0;this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};f||console.error("RenderingContext isn't initialized!");
0===c.length&&console.error("Shaders source should not be empty!");this._context=f;this._vertexShaderSource=c;this._fragmentShaderSource=b;this._defines=e;this._id=k._nextId++;this._locations=a}Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"locations",{get:function(){return this._locations},enumerable:!0,
configurable:!0});k.prototype.dispose=function(){var f=this._context.gl;this._vShader&&(f.deleteShader(this._vShader),this._vShader=null);this._fShader&&(f.deleteShader(this._fShader),this._fShader=null);this._glName&&(f.deleteProgram(this._glName),this._glName=null)};k.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);(!this._vShader||!this._fShader)&&console.error("Error loading shaders!");var f=this._context.gl,c=
f.createProgram();f.attachShader(c,this._vShader);f.attachShader(c,this._fShader);for(var b in this._locations)f.bindAttribLocation(c,this._locations[b],b);f.linkProgram(c);f.getProgramParameter(c,f.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+f.getProgramParameter(c,f.VALIDATE_STATUS)+", gl error ["+f.getError()+"]infoLog: "+f.getProgramInfoLog(c));this._glName=c;this._initialized=!0}};k.prototype.getUniformLocation=function(f){this.initialize();void 0===this._nameToUniformLocation[f]&&
(this._nameToUniformLocation[f]=this._context.gl.getUniformLocation(this._glName,f));return this._nameToUniformLocation[f]};k.prototype.hasUniform=function(f){return null!==this.getUniformLocation(f)};k.prototype.getAttribLocation=function(f){this.initialize();void 0===this._nameToAttribLocation[f]&&(this._nameToAttribLocation[f]=this._context.gl.getAttribLocation(this._glName,f));return this._nameToAttribLocation[f]};k.prototype.setUniform1i=function(f,c){var b=this._nameToUniform1[f];if(void 0===
b||c!==b)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(f),c),this._nameToUniform1[f]=c};k.prototype.setUniform1f=function(f,c){var b=this._nameToUniform1[f];if(void 0===b||c!==b)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(f),c),this._nameToUniform1[f]=c};k.prototype.setUniform2f=function(f,c,b){var a=this._nameToUniform2[f];if(void 0===a||c!==a[0]||b!==a[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(f),
c,b),void 0===a?this._nameToUniform2[f]=new Float32Array([c,b]):(a[0]=c,a[1]=b)};k.prototype.setUniform2fv=function(f,c){0!==c.length%2&&console.error("Value array must have even number of elements!");var b=this._nameToUniform2[f];if(void 0===b||!k._arraysEqual(c,b))this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(f),c),void 0===b?this._nameToUniform2[f]=new Float32Array(c):b.set(c)};k.prototype.setUniform3f=function(f,c,b,a){var e=this._nameToUniform3[f];if(void 0===
e||c!==e[0]||b!==e[1]||a!==e[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(f),c,b,a),void 0===e?this._nameToUniform3[f]=new Float32Array([c,b,a]):(e[0]=c,e[1]=b,e[2]=a)};k.prototype.setUniform3fv=function(f,c){0!==c.length%3&&console.error("Value array must contain sets of three values!");var b=this._nameToUniform3[f];if(void 0===b||!k._arraysEqual(c,b))this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(f),c),void 0===b?this._nameToUniform3[f]=
new Float32Array(c):b.set(c)};k.prototype.setUniform4f=function(f,c,b,a,e){var h=this._nameToUniform4[f];if(void 0===h||c!==h[0]||b!==h[1]||a!==h[2]||e!==h[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(f),c,b,a,e),void 0===h?this._nameToUniform4[f]=new Float32Array([c,b,a,e]):(h[0]=c,h[1]=b,h[2]=a,h[3]=e)};k.prototype.setUniform4fv=function(f,c){0!==c.length%4&&console.error("Value array must contain sets of four values!");var b=this._nameToUniform4[f];if(void 0===
b||!k._arraysEqual(c,b))this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(f),c),void 0===b?this._nameToUniform4[f]=new Float32Array(c):b.set(c)};k.prototype.setUniformMatrix3fv=function(f,c,b){void 0===b&&(b=!1);0!==c.length%9&&console.error("Matrix array must contain sets ot 9 elements!");var a=this._nameToUniformMatrix3[f];if(void 0===a||(9===a.length?!k._matrix3Equal(a,c):!k._arraysEqual(c,a)))this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(f),
b,c),void 0===a?this._nameToUniformMatrix3[f]=new Float32Array(c):a.set(c)};k.prototype.setUniformMatrix4fv=function(f,c,b){void 0===b&&(b=!1);0!==c.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var a=this._nameToUniformMatrix4[f];if(void 0===a||(16===a.length?!k._matrix4Equal(a,c):!k._arraysEqual(c,a)))this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(f),b,c),void 0===a?this._nameToUniformMatrix4[f]=new Float32Array(c):a.set(c)};
k._padToThree=function(f){var c=f.toString();1E3>f&&(c=("  "+f).slice(-3));return c};k.prototype._addLineNumbers=function(f){var c=2;return f.replace(/\n/g,function(){return"\n"+k._padToThree(c++)+":"})};k.prototype._loadShader=function(f){var c=35633===f?this._vertexShaderSource:this._fragmentShaderSource;if(void 0!==this._defines){var b="";if(Array.isArray(this._defines))for(var a=0,e=this._defines;a<e.length;a++)var h=e[a],b=b+("#define "+h+"\n");else for(h in this._defines)b+="#define "+h+"\n";
c=b+c}b=this._context.gl;f=b.createShader(f);b.shaderSource(f,c);b.compileShader(f);b.getShaderParameter(f,b.COMPILE_STATUS)||(console.error(b.getShaderInfoLog(f)),console.error(this._addLineNumbers(c)));return f};k._matrix4Equal=function(f,c){(16!==f.length||16!==c.length)&&console.error("Matrix object must contain 16 elements!");return f[0]===c[0]&&f[1]===c[1]&&f[2]===c[2]&&f[3]===c[3]&&f[4]===c[4]&&f[5]===c[5]&&f[6]===c[6]&&f[7]===c[7]&&f[8]===c[8]&&f[9]===c[9]&&f[10]===c[10]&&f[11]===c[11]&&f[12]===
c[12]&&f[13]===c[13]&&f[14]===c[14]&&f[15]===c[15]};k._matrix3Equal=function(f,c){(9!==f.length||9!==c.length)&&console.error("Matrix object must contain 16 elements!");return f[0]===c[0]&&f[1]===c[1]&&f[2]===c[2]&&f[3]===c[3]&&f[4]===c[4]&&f[5]===c[5]&&f[6]===c[6]&&f[7]===c[7]&&f[8]===c[8]};k._arraysEqual=function(f,c){if(f.length!==c.length)return!1;for(var b=0;b<f.length;++b)if(f[b]!==c[b])return!1;return!0};k._nextId=0;return k}()})},"esri/views/3d/environment/RealisticAtmosphere":function(){define("dojo/text!./materials/RealisticAtmosphereMaterial.xml ../../../core/watchUtils ../../../core/HandleRegistry ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/OffscreenRenderingHelper ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p){var s=d.earthRadius,r=c.vec3d,t=c.vec2d,u=c.vec4d;c=0.02*Math.PI;d=0.0040*Math.PI;var v=r.createFrom(1/Math.pow(0.65,4),1/Math.pow(0.57,4),1/Math.pow(0.475,4)),C=r.create(v);r.scale(C,c);r.add(C,r.createFrom(d,d,d));var y=1.5*((1- -0.99999*-0.99999)/(2+-0.99999*-0.99999));f=f.createSubclass({declaredClass:"esri.views.3d.environment.RealisticAtmosphere",properties:{view:{},planar:{value:!1,set:function(a){a=!!a;a!==this.planar&&this._update();this._set("planar",
a)}},needsRender:{value:!1},needsDepthMap:{value:!1}},constructor:function(){this._handles=new k;this._lowerElevationBoundRadius=0;this._earthRadius=s;this._renderer=this._skyPlanarProgram=this._skyProgram=this._hazePlanarProgram=this._hazeProgram=null;this._renderData={texDepth:t.create(),v3CameraPos:r.create(),v3CameraUp:r.create(),v3CameraRight:r.create(),v3CameraDir:r.create(),v3CameraCenter:r.create(),halfSizeNearPlane:t.create(),v2CameraCenterOffset:t.create(),v4SphereComp:u.create(),v4AtmosParams1:u.create(),
v4AtmosParams2:u.create(),v4AtmosParams3:u.create(),v3InvWavelength:v,v3InvWavelengthScaled:C,v4Radii:u.create(),fScale:0,fScaleDepth:0.25,fLowerAlphaBlendBound:0,fScaleOverScaleDepth:0,fOneOverScaleDepth:0,fScaleDepthBlue:0.05,fOneOverScaleDepthBlue:20,fScaleOverScaleDepthBlue:0,g:-0.99999,g2:-0.99999*-0.99999,fMiePhaseCoefficients:y,showTest:0,nearFar:t.create()};this._updateRadius(s);this._hazeSlot=h.POSTPROCESSING_ATMOSPHERE;this._skySlot=h.BACKGROUND},destroy:function(){this._handles&&(this._handles.destroy(),
this._handles=null);this._hazeProgram&&(this._hazeProgram.dispose(),this._hazeProgram=null);this._hazePlanarProgram&&(this._hazePlanarProgram.dispose(),this._hazePlanarProgram=null);this._skyProgram&&(this._skyProgram.dispose(),this._skyProgram=null);this._skyPlanarProgram&&(this._skyPlanarProgram.dispose(),this._skyPlanarProgram=null)},setup:function(d){var e=a.createSquareGeometry(),c={faces:e.getFaces()[0],vertexAttr:e.getVertexAttr()},e=this.renderContext.rctx;this._renderer=new b(c,l.Pos3Tex,
null,e);var h=this._update.bind(this);this._handles.add(n.on(this,"view.navigation","currentViewChanged",function(a){h(a.camera)},function(){h()},null,!0));var c=this._updateElevation.bind(this),g=this._updateVisibleElevationBounds.bind(this);this._handles.add(n.on(this,"view.basemapTerrain","elevation-change",c,c));this._handles.add(n.on(this,"view.basemapTerrain","elevation-bounds-change",g,g));d.shaderSnippets.fsRealisticAtmosphere||d.shaderSnippets._parse(q);this._hazeProgram=new m(e,d.shaderSnippets.vsRealisticAtmosphere,
d.shaderSnippets.fsRealisticAtmosphere,p.Default3D,["HAZE"]);this._skyProgram=new m(e,d.shaderSnippets.vsRealisticAtmosphere,d.shaderSnippets.fsRealisticAtmosphere,p.Default3D);this._hazePlanarProgram=new m(e,d.shaderSnippets.vsRealisticAtmosphere,d.shaderSnippets.fsRealisticAtmosphere,p.Default3D,["HAZE","PLANAR"]);this._skyPlanarProgram=new m(e,d.shaderSnippets.vsRealisticAtmosphere,d.shaderSnippets.fsRealisticAtmosphere,p.Default3D,["PLANAR"])},render:function(a){if((a.slot==this._hazeSlot||a.slot==
this._skySlot)&&a.pass==e.MATERIAL&&!(a.slot==this._hazeSlot&&a.options.earlyOcclusionPixelDraw)){var b,d=this.renderContext.rctx,c=d.gl,h=a.offscreenRenderingHelper,g=!1;if(a.slot==this._hazeSlot){b=this.planar?this._hazePlanarProgram:this._hazeProgram;d.bindProgram(b);d.setBlendFunctionSeparate(c.ONE,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);h.detachDepthTextureFromBuffer();var g=!0,l=h.getDepthTexture();d.bindTexture(l,0);b.setUniform1i("tDepth",0);b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp)}a.slot==
this._skySlot&&(b=this.planar?this._skyPlanarProgram:this._skyProgram,d.bindProgram(b),d.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA),b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp),b.setUniform4fv("v4AtmosParams3",this._renderData.v4AtmosParams3));b.setUniform3fv("v3InvWavelength",this._renderData.v3InvWavelength);b.setUniform3fv("v3InvWavelengthScaled",this._renderData.v3InvWavelengthScaled);b.setUniform3fv("v3LightDir",a.lightingData.direction);
b.setUniform3fv("v3CameraPos",this._renderData.v3CameraPos);b.setUniform3fv("v3CameraUp",this._renderData.v3CameraUp);b.setUniform3fv("v3CameraRight",this._renderData.v3CameraRight);b.setUniform3fv("v3CameraDir",this._renderData.v3CameraDir);b.setUniform2fv("nearFar",this._renderData.nearFar);b.setUniform2fv("halfSizeNearPlane",this._renderData.halfSizeNearPlane);b.setUniform2fv("v2CameraCenterOffset",this._renderData.v2CameraCenterOffset);b.setUniform4fv("v4Radii",this._renderData.v4Radii);b.setUniform4fv("v4AtmosParams1",
this._renderData.v4AtmosParams1);b.setUniform4fv("v4AtmosParams2",this._renderData.v4AtmosParams2);b.setUniform1f("showTest",this._renderData.showTest);d.setDepthTestEnabled(!1);d.setBlendingEnabled(!0);this._renderer.render(b);d.setBlendingEnabled(!1);d.setDepthTestEnabled(!0);d.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);g&&h.restoreDepthTextureToBuffer();return!0}},_setEnableTestImage:function(a){this._renderData.showTest=a?1:0;this.needsRender=!0},_adjustRadiusForTesselation:function(a){var b=
Math.PI/Math.pow(2,4)/16;return a*Math.cos(b)},_normalizeRadius:function(a){a=this._adjustRadiusForTesselation(a);return Math.max(s-1E4,Math.min(a,s))},_updateElevation:function(){if(this.get("view.basemapTerrain.ready")){var a=this._adjustRadiusForTesselation(s+this.view.basemapTerrain.rootTiles[0].elevationBounds[0]);a!==this._lowerElevationBoundRadius&&(this._lowerElevationBoundRadius=a,this._earthRadius=-1,this._updateVisibleElevationBounds())}},_updateVisibleElevationBounds:function(){var a=
this._adjustRadiusForTesselation(s+this.view.basemapTerrain.getElevationBounds()[0]);return 0>this._earthRadius||a<this._earthRadius?this._updateRadius(a):!1},_updateRadius:function(a){this._earthRadius=a;var b=a*a,d=10.25*(a/10),e=d*d,c=1/(d-a),h=c/0.25,g=c/0.05,l=0.3*(d-a)+a,m=1/(d-l),p=this._renderData;u.set4(c,0.25,h,4,p.v4AtmosParams1);u.set4(-0.99999,0.05,g,20,p.v4AtmosParams2);u.set4(-0.99999*-0.99999,y,l,m,p.v4AtmosParams3);u.set4(a,b,d,e,p.v4Radii);p.fScale=c;p.fLowerAlphaBlendBound=l;p.fScaleOverScaleDepth=
h;p.fScaleOverScaleDepthBlue=g;this._update();return!0},_update:function(a){if(a=a||this.get("view.navigation.currentCamera")){r.negate(a.viewForward,this._renderData.v3CameraDir);r.set(a.viewUp,this._renderData.v3CameraUp);r.set(a.viewRight,this._renderData.v3CameraRight);if(this.planar){var b=this.view.renderCoordsHelper;this._renderData.fCameraHeight=b.getAltitude(a.eye)/b.unitInMeters+s}else this._renderData.fCameraHeight=r.length(a.eye);this._renderData.fCameraHeight2=this._renderData.fCameraHeight*
this._renderData.fCameraHeight;this._renderData.fC=this._renderData.fCameraHeight2-this._renderData.v4Radii[3];this._renderData.fCSur=this._renderData.fCameraHeight2-this._renderData.v4Radii[1];this._renderData.v4SphereComp=u.createFrom(this._renderData.fCameraHeight,this._renderData.fCameraHeight2,this._renderData.fC,this._renderData.fCSur);r.set(a.eye,this._renderData.v3CameraPos);r.set(a.center,this._renderData.v3CameraCenter);t.set2(Math.tan(a.fovX/2)/(a.width/a.fullWidth),Math.tan(a.fovY/2)/
(a.height/a.fullHeight),this._renderData.halfSizeNearPlane);t.set2((a.padding[3]+a.width/2)/a.fullWidth-0.5,(a.padding[2]+a.height/2)/a.fullHeight-0.5,this._renderData.v2CameraCenterOffset);t.set2(a.near,a.far,this._renderData.nearFar);this.needsRender=!0}}});f.isSupported=function(a){return g.supportsDepthTexture(a.rctx.extensions)};return f})},"esri/views/3d/webgl-engine/lib/OffscreenRenderingHelper":function(){define("require exports ./Util dojo/text!../materials/internal/offscreen.xml ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m){return function(){function g(a,b){this._enabled=!1;this.height=this.width=0;this._programRep=a;this._rctx=b;this.height=this.width=null}g.prototype.enable=function(){if(!this.getEnableState()){var a=this._rctx;this._enabled=!0;this.framebuffer=c.createWithAttachments(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:a.extensions.depthTexture?4:3});this.quadVAO=this.createQuadVAO(a)}};
g.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this.framebuffer.dispose(),this.quadVAO.dispose(!0),this._depthStencilTextureCached=this.quadVAO=this.framebuffer=null)};g.prototype.createQuadVAO=function(e){var c=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1]);return new b(e,m.Default3D,{geometry:d.Pos2Tex},{geometry:a.createVertex(e,35044,c)})};g.prototype.setEnableState=function(a){a?this.enable():this.disable()};g.prototype.getEnableState=function(){return this._enabled};
g.prototype.getColorTexture=function(){return this.framebuffer.colorTexture};g.prototype.getDepthTexture=function(){return g.supportsDepthTexture(this._rctx.extensions)?this.framebuffer.depthStencilTexture||this._depthStencilTextureCached:null};g.supportsDepthTexture=function(a){return!!a.depthTexture};g.prototype.initializeFrame=function(a){k.assert(this.getEnableState());var b=this._rctx,d=b.gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.framebuffer.resize(this.width,this.height);b.bindFramebuffer(this.framebuffer);
b.setStencilWriteMask(255);b.setClearStencil(0);b.setClearColor(0,0,0,1);b.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT)};g.prototype.bindFramebuffer=function(){this._rctx.bindFramebuffer(this.framebuffer)};g.prototype.getFramebuffer=function(){return this.framebuffer};g.prototype.detachDepthTextureFromBuffer=function(){this._depthStencilTextureCached=this.framebuffer.depthStencilTexture;this.framebuffer.detachDepthStencilTexture()};g.prototype.restoreDepthTextureToBuffer=function(){this.framebuffer.attachDepthStencilTexture(this._depthStencilTextureCached);
this._depthStencilTextureCached=null};g.prototype.drawQuad=function(a){k.assert(this.getEnableState());a=this._rctx;var b=a.gl,d=this._programRep.get("offscreenProgram");a.bindFramebuffer();a.setDepthTestEnabled(!1);a.clear(b.COLOR_BUFFER_BIT);a.bindProgram(d);d.setUniform1i("tex",1);a.bindTexture(this.framebuffer.colorTexture,1);a.bindVAO(this.quadVAO);a.drawArrays(5,0,h.vertexCount(this.quadVAO,"geometry"));a.setDepthTestEnabled(!0)};g.loadShaders=function(a,b,d,c){a._parse(f);a=new e(c,a.vsOffscreenRenderer,
a.fsOffscreenRenderer,m.Default3D);d.add("offscreenProgram",a)};return g}()})},"esri/views/3d/environment/SimpleAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s){var r=l.earthRadius,t=c.vec3d,u=c.vec2d,v=c.mat4d,C=e.VertexAttrConstants,y=(r-1E4)/r,x=(r+3E5)/r,B=-1E4/3E5,z=1-B;return f.createSubclass({declaredClass:"esri.views.3d.environment.SimpleAtmosphere",properties:{view:{},needsRender:{value:!1},needsDepthMap:{value:!0},slot:{value:d.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:u.create(),silCircleCenter:t.create(),silCircleV1:t.create(),silCircleV2:t.create()};
this._textureRep=this._texture=null},initialize:function(){this._textureDfd=new n;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&
(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(b){this._textureRep=new h({SimpleAtmosphere:new a(m,"SimpleAtmosphere",{wrapClamp:!0})},b.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),b.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var d=this._createRibbonGeometryData();this._renderer=
new b(d,[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}],null,a.rctx);this._currentViewChangedHandle=k.on(this,"view.navigation","currentViewChanged",function(a){this._update(a.camera)}.bind(this),function(){this._update(this.get("view.navigation.currentCamera"))}.bind(this),null,!0);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(q);this._program=new p(a.rctx,a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,s.Default3D)},render:function(a){if(a.slot!==
this.slot||a.pass!==g.MATERIAL)return!1;var b=this.renderContext.rctx,d=b.gl,e=this._program;b.bindProgram(e);e.setUniform4f("color",1,1,1,1);e.setUniformMatrix4fv("proj",a.camera.projectionMatrix);e.setUniformMatrix4fv("view",a.camera.viewMatrix);e.setUniform3fv("silCircleCenter",this._renderData.silCircleCenter);e.setUniform3fv("silCircleV1",this._renderData.silCircleV1);e.setUniform3fv("silCircleV2",this._renderData.silCircleV2);e.setUniform2fv("texV",this._renderData.texV);b.bindTexture(this._texture,
0);e.setUniform1i("tex",0);e.setUniform3fv("lightDirection",a.lightingData.direction);b.setDepthFunction(d.LEQUAL);b.setBlendingEnabled(!0);b.setDepthWriteEnabled(!1);this._renderer.render(e);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(d.LESS);return!0},_update:function(a){var b=t.create(),d=t.create(),c=t.create(),g=this.view.renderCoordsHelper.getAltitude(a.eye);t.scale(a.eye,(r+50)/t.length(a.eye),c);this._computeSilhouetteCircle(c,a.center,a.up,r);t.add(this._renderData.silCircleCenter,
this._renderData.silCircleV2,b);t.scale(b,x,d);var c=this._computeScreenRimWidth(c,a.up,b,d),h=0,l=1,m=1;50>g?(h=0.001953125,l=0.1015625):500>g?(m=(g-50)/450,h=0.001953125*(1-m)+0.001953125*m,l=0.1015625*(1-m)+0.21875*m):5E3>g?(m=(g-500)/4500,h=0.001953125*(1-m)+0.001953125*m,l=0.21875*(1-m)+0.51171875*m):5E4>g&&(m=(g-5E3)/45E3,h=0.001953125*(1-m)+0.001953125*m,l=0.51171875*(1-m)+0.4140625*m);g=B+h*z;m=B+c*l*z;50<t.length(a.eye)-r&&(this._computeSilhouetteCircle(a.eye,a.center,a.up,r),t.add(this._renderData.silCircleCenter,
this._renderData.silCircleV2,b),t.scale(b,x,d),a=this._computeScreenRimWidth(a.eye,a.up,b,d),a=e.clamp((a-1.5)/(c-1.5),0,1),g=B+a*h*z,m=B+e.lerp(1,c*l,a)*z);u.set2(g,m,this._renderData.texV);this.needsRender=!0},_computeSilhouetteCircle:function(a,b,d,e){var c=t.length(a),g=Math.sqrt(c*c-e*e),g=e*g/c;e=Math.sqrt(e*e-g*g);var h=this._renderData.silCircleV1,m=this._renderData.silCircleV2;t.scale(a,e/c,this._renderData.silCircleCenter);t.cross(a,b,h);1>t.length2(h)&&t.cross(a,d,h);t.scale(h,g/t.length(h));
t.cross(h,a,m);t.scale(m,g/t.length(m));return g},_computeScreenRimWidth:function(a,b,d,c){var g=v.create();v.lookAt(a,d,b,g);a=this.view.navigation.currentCamera;e.project(d,g,a.projectionMatrix,a.viewport);e.project(c,g,a.projectionMatrix,a.viewport);return t.dist(d,c)/a.height},_createRibbonGeometryData:function(){for(var a=new Float32Array(768),b=new Uint32Array(768),d=0;128>d;d++){var e=6*d;a[e+0]=d;a[e+1]=y;a[e+2]=0;a[e+3]=d;a[e+4]=x;a[e+5]=1;var c=2*d,g=127===d?0:c+2;b[e+0]=c;b[e+1]=c+1;b[e+
2]=g+1;b[e+3]=g+1;b[e+4]=g;b[e+5]=c}d={};d[C.POSITION]=b;b={};b[C.POSITION]={size:3,data:a};return{faces:{type:"triangle",indices:d,positionKey:C.POSITION},vertexAttr:b}}})})},"esri/views/3d/environment/Stars":function(){define("dojo/text!./materials/StarMaterial.xml require ../../../request ../../../core/watchUtils ../../../core/promiseUtils ../lib/glMatrix ../support/ExternalRenderer ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s){var r=b.mat4d;b=b.mat3d;var t=h.VertexAttrConstants,u="9bb2ff;9eb5ff;aabfff;bbccff;ccd8ff ;dae2ff;e4e9ff;eeefff;f8f6ff;fff9fb;fff5ef;fff1e5;ffeddb;ffe9d2;ffe6ca;ffe3c3;ffe0bb;ffddb4;ffdaad;ffd6a5;ffd29c;ffcc8f;ffc178;ffa94b;ff7b00".split(";"),v=b.toMat4(b.createFrom(1,0,0,0,0.9174771405229186,0.39778850739794974,0,-0.39778850739794974,0.9174771405229186)),C=b.toMat4(b.createFrom(1,0,0,0,0.9174771405229186,-0.39778850739794974,0,0.39778850739794974,0.9174771405229186)),
y=null;return a.createSubclass({properties:{view:{},numBinaryFloats:{value:2},numBinaryUInt8:{value:1},bytesPerStar:{value:9},needsRender:{value:!1},needsDepthMap:{value:!1},slot:{value:m.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={model:r.identity()};this.slot=m.BACKGROUND;this._vertexBufferLayout=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:20,normalized:!1},
{name:"size",count:1,type:5126,offset:16,stride:20,normalized:!1}]},initialize:function(){this._loadDataPromise=this._loadBrightStarCatalogue();this.addResolvingPromise(this._loadDataPromise)},destroy:function(){this._loadDataPromise.isFulfilled()||this._loadDataPromise.cancel("Atmosphere has been removed.");this._dateHandle&&(this._dateHandle.remove(),this._dateHandle=null);this._program&&(this._program.dispose(),this._program=null)},setup:function(a){this._numStars=this._starData.byteLength/this.bytesPerStar;
var b=new Float32Array(this._starData,0,this._numStars*this.numBinaryFloats),d=new Uint8Array(this._starData,4*this._numStars*this.numBinaryFloats,this._numStars*this.numBinaryUInt8),b=this._createStarGeometryData(b,d);this._renderer=new e(b,this._vertexBufferLayout,this._fillInterleaved,a.rctx);this._renderer.enablePointRendering(!0);this._dateHandle=f.init(this,"view.environment.lighting.date",this._update.bind(this));a.shaderSnippets.vertexShaderStar||a.shaderSnippets._parse(q);this._program=new l(a.rctx,
a.shaderSnippets.vertexShaderStar,a.shaderSnippets.fragmentShaderStar,p.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==d.MATERIAL)return!1;var b=this.renderContext.rctx,e=b.gl,c=this._program;b.bindProgram(c);c.setUniformMatrix4fv("view",a.camera.viewMatrix);c.setUniformMatrix4fv("proj",a.camera.projectionMatrix);c.setUniform4fv("viewport",a.camera.fullViewport);c.setUniformMatrix4fv("model",this._renderData.model);b.setDepthFunction(e.LEQUAL);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(e.SRC_ALPHA,
e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);b.setDepthWriteEnabled(!1);this._renderer.render(c);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(e.LESS);return!0},_fillInterleaved:function(a,b,d,e,c,h,m){var l=s.getStride(c);d=l/4;var p=g.fill,f=a.faces.indices[t.POSITION],r=a.vertexAttr[t.POSITION].data;e=m+s.findAttribute(c,"position").offset/4;for(var k=0;k<f.length;++k){var u=3*f[k];p(r,u,h,e,b,3);e+=d}b=a.faces.indices[t.COLOR];f=a.vertexAttr[t.COLOR].data;e=m+s.findAttribute(c,
"color").offset;r=new Uint8Array(h.buffer);for(k=0;k<b.length;++k)u=4*b[k],p(f,u,r,e,null,4),e+=l;l=a.faces.indices[t.SIZE];a=a.vertexAttr[t.SIZE].data;e=m+s.findAttribute(c,"size").offset/4;for(k=0;k<l.length;++k)h[e]=a[l[k]],e+=d},_computeDayDuration:function(a){var b=new Date(a.getFullYear(),0,1,11,58,56),d=new Date(a.getFullYear()+1,0,1,11,58,55);return(a-b)/(d-b)},_update:function(a){if(a){var b=a.getHours()/12,d=a.getMinutes()/60*(2/24),e=a.getSeconds()/60*(2/1440),b=(b+d+e-0.9972222)%2;a=2*
this._computeDayDuration(a);d=r.create(C);r.rotateZ(d,-a*Math.PI);r.multiply(v,d,d);r.rotateZ(d,-b*Math.PI);this._renderData.model=d;this.needsRender=!0}},_hexToRGB:function(a){return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]},_unpackUint8Attributes:function(a){return 192<=a?[2.9,a-192]:160<=a?[2.5,a-160]:128<=a?[2,a-128]:96<=a?[1.5,a-96]:64<=a?[1,a-64]:32<=a?[0.7,a-32]:[0.4,a]},_createStarGeometryData:function(a,b){for(var d=new Float32Array(3*this._numStars),
e=new Uint8Array(4*this._numStars),c=new Float32Array(this._numStars),g=new Uint32Array(this._numStars),h=0;h<this._numStars;h++){var m=2*h,l=3*h,p=4*h,f=a[m+0],m=a[m+1];d[l+0]=-Math.cos(f)*Math.sin(m);d[l+1]=-Math.sin(f)*Math.sin(m);d[l+2]=-Math.cos(m);l=this._unpackUint8Attributes(b[h]);f=this._hexToRGB(u[l[1]]);e[p+0]=255*f[0];e[p+1]=255*f[1];e[p+2]=255*f[2];e[p+3]=255;c[h]=l[0];g[h]=h}h={};h[t.POSITION]=g;h[t.NORMAL]=g;h[t.UV0]=g;h[t.COLOR]=g;h[t.SIZE]=g;g={};g[t.POSITION]={size:3,data:d};g[t.COLOR]=
{size:4,data:e};g[t.SIZE]={size:1,data:c};return{faces:{type:"point",indices:h,positionKey:t.POSITION},vertexAttr:g}},_loadBrightStarCatalogue:function(){return y?(this._starData=y,c.resolve()):k(n.toUrl("./resources/stars.wsv"),{responseType:"array-buffer",failOk:!0}).then(function(a){if(a=a.data)this._starData=y=a;else throw Error("no data received");}.bind(this)).otherwise(function(a){console.error("Failed to load star data:",a);throw a;})}})})},"esri/views/3d/constraints/SceneViewConstraints":function(){define(["../../../core/Accessor",
"./SceneViewAltitudeConstraint","./SceneViewClipDistanceConstraint","./SceneViewTiltConstraint","./SceneViewCollisionConstraint"],function(q,n,k,f,c){return q.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewConstraints",properties:{tilt:f,altitude:n,clipDistance:k,collision:c},getDefaults:function(b){var a={};b.tilt||(a.tilt={});b.altitude||(a.altitude={});b.clipDistance||(a.clipDistance={});b.collision||(a.collision={});return a},scale:function(b){this.tilt.scale(b);this.altitude.scale(b);
this.clipDistance.scale(b)}})})},"esri/views/3d/constraints/SceneViewAltitudeConstraint":function(){define(["../../../core/Accessor","../support/earthUtils"],function(q,n){var k=4*n.earthRadius,f=q.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewAltitudeConstraint",properties:{mode:{value:"auto"},min:{value:-Infinity,set:function(c){this._set("min",c);this._get("max")<c&&this._set("max",c);this.mode="manual"}},max:{value:k,set:function(c){this._set("max",c);this._get("min")>c&&
this._set("min",c);this.mode="manual"}}},autoUpdate:function(c,b){"auto"===this.mode&&(this._get("min")!==c&&this._set("min",c),this._get("max")!==b&&this._set("max",b))},scale:function(c){this._set("max",this._get("max")*c);this._set("min",this._get("min")*c)}});f.MIN_DEFAULT=-Infinity;f.MAX_DEFAULT=k;return f})},"esri/views/3d/constraints/SceneViewClipDistanceConstraint":function(){define(["../../../core/Accessor"],function(q){return q.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewClipDistanceConstraint",
properties:{near:{value:0,cast:function(n){return Math.max(1E-8,n)},set:function(n){this._set("near",n);n>=this._get("far")&&(this.far=n+1E-9);this.mode="manual"}},far:{value:0,cast:function(n){return Math.max(1E-8,n)},set:function(n){this._set("far",n);n<=this._near&&(this.near=n-1E-9);this.mode="manual"}},mode:{value:"auto"}},autoUpdate:function(n,k){"auto"===this.mode&&(this._get("near")!==n&&this._set("near",n),this._get("far")!==k&&this._set("far",k))},scale:function(n){this._set("near",this._get("near")*
n);this._set("far",this._get("far")*n)}})})},"esri/views/3d/constraints/SceneViewTiltConstraint":function(){define(["../../../core/Accessor","../support/mathUtils"],function(q,n){var k=q.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewTiltConstraint",properties:{mode:{value:"auto"},max:{value:0.5,cast:function(f){return n.clamp(f,0.5,179.5)},set:function(f){this._set("max",f);this.mode="manual"}}},autoUpdate:function(f){"auto"===this.mode&&this._get("max")!==f&&this._set("max",
f)},scale:function(f){}});k.MAX_DEFAULT=0.5;k.MIN_DEFAULT=179.5;return k})},"esri/views/3d/constraints/SceneViewCollisionConstraint":function(){define(["../../../core/Accessor"],function(q){return q.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewCollisionConstraint",properties:{enabled:!0}})})},"esri/views/3d/support/cameraUtils":function(){define("dojo/_base/lang ../../../geometry/SpatialReference ../../../config ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../Camera ../lib/glMatrix ./mathUtils ./earthUtils ./projectionUtils ./cameraUtilsPlanar ./cameraUtilsSpherical".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m){function l(a,b){return"global"===a.viewingMode?m[b]:d[b]}function p(a,d,c){var h=a.renderSpatialReference,m=C.set(d.viewForward,A),m=u(a,d.eye,m,d.up,w);a=a.spatialReference||n.WGS84;g.vectorToVector(d.eye,h,B,a)||(a=n.WGS84,g.vectorToVector(d.eye,h,B,a));return c?(c.position.x=B[0],c.position.y=B[1],c.position.z=B[2],c.position.spatialReference=a,c.heading=m.heading,c.tilt=m.tilt,c.fov=e.rad2deg(d.fov),c):new b(new f(B,a),m.heading,m.tilt,e.rad2deg(d.fov))}function s(a,
b,d){var c=a.navigation.currentCamera,g=c.fovX,c=c.width/2;"global"===a.viewingMode&&null!=d&&(b*=Math.cos(e.deg2rad(d)));b/=a.renderCoordsHelper.unitInMeters;return c/(k.screenDPI*y/b)/Math.tan(g/2)}function r(a,b,d){var c=a.navigation.currentCamera;b*=Math.tan(c.fovX/2);c=k.screenDPI*y/(c.width/2/b);"global"===a.viewingMode&&(c/=Math.cos(e.deg2rad(d)));return c*=a.renderCoordsHelper.unitInMeters}function t(a,d,e,c,h,m){var l=a.renderSpatialReference;d=v(a,c.heading,c.tilt,d,e,h);a=g.vectorToPoint(d.eye,
l,a.spatialReference||n.WGS84);if(!a)return null;if(!m)return new b(a,d.heading,d.tilt,c.fov);m.position=a;m.heading=d.heading;m.tilt=d.tilt;m.fov=c.fov;return m}function u(a,b,d,e,c){return l(a,"directionToHeadingTilt")(b,d,e,c)}function v(a,b,d,e,c,h){var m=C.create(),p=a.renderSpatialReference;if(e&&e instanceof f){var s=e;g.pointToVector(s,m,a.renderSpatialReference);null==s.z&&("global"===a.viewingMode?a._pickRay([0,0,0],m):a._pickRay([m[0],m[1]-1,m[2]],m),null!=a.basemapTerrain&&(s=a.basemapTerrain.getElevation(s),
null!=s&&a.renderCoordsHelper.setAltitude(s,m)))}else e?C.set(e,m):C.set(a.navigation.currentCamera.center,m);if(!e||!(e instanceof f))e=g.vectorToPoint(m,p,a.spatialReference||n.WGS84);c=Math.max(c,a.navigation.minPoiDist);p=d;d=c;if(s=!h||!h.noReset)var r=e,s=a.engineToScreen(a.navigation.currentCamera.center),t=a.toScreen(r),r=s.x-t.x,s=s.y-t.y,s=Math.sqrt(r*r+s*s),r=Math.max(a.width,a.height),s=s>x*r;s?(b=0,p=a.navigation.constraints.tilt.min(d)):(p=l(a,"eyeTiltToLookAtTilt")(m,d,p),p=a.navigation.constraints.tilt.apply(p,
d),p=l(a,"lookAtTiltToEyeTilt")(m,d,p));b=l(a,"eyeForCenterWithHeadingTilt")(m,c,b,p);b.center=m;if((!h||!h.noReset)&&"global"===a.viewingMode)if(m=a.renderCoordsHelper.fromRenderCoords(b.eye,D,a.spatialReference)?a.basemapTerrain&&(a.basemapTerrain.getElevation(D)||0)>D.z-1:!1,m)return m=a.navigation.constraints.tilt.min(c),v(a,0,m,e,c,q.mixin({noReset:!0},h));return b}var C=a.vec3d,y=39.37,x=5,B=C.create(),z=C.create(),A=C.create(),w={heading:0,tilt:0},D=new f,E=new e.Cyclical(-2.0037508342788905E7,
2.0037508342788905E7);return{externalToInternal:function(a,b){var d=a.renderSpatialReference,c=l(a,"headingTiltToDirectionUp"),h=C.create();return g.pointToVector(b.position,h,d)?(d=c(h,b.heading,b.tilt),C.add(d.direction,h),h=a.navigation.getCameraIntersectTerrain(h,d.direction,d.up),h.fov=e.deg2rad(b.fov),h):null},internalToExternal:p,scaleToDistance:s,distanceToScale:r,fromExtent:function(a,d,e,m,l){m instanceof b&&(l=m,m={});var p="global"===a.viewingMode,s=a.renderSpatialReference,r=a.spatialReference||
n.WGS84,t=n.WebMercator,k=d.spatialReference||t,z,x=0;null!=d.zmax&&null!=d.zmin&&(z=(d.zmax+d.zmin)/2,x=d.zmax-d.zmin);if(p){var p=new f(d.xmin,d.ymin,k),u=new f(d.xmax,d.ymax,k),p=c.project(p,t),u=c.project(u,t);if(null===p||null===u)return;d=new f(E.center(p.x,u.x),(u.y+p.y)/2,t);null!=z&&(d.z=z);k=h.getGreatCircleSpanAt(d,p,u);t=k.lon;k=k.lat;E.diff(p.x,u.x)>E.range/2&&(t+=h.halfEarthCircumference);t=Math.min(t,h.halfEarthCircumference);k=Math.min(k,h.halfEarthCircumference)}else c.canProject(d,
r)&&(d=c.project(d,r)),t=d.xmax-d.xmin,k=d.ymax-d.ymin,d=new f({x:d.xmin+0.5*t,y:d.ymin+0.5*k,z:z,spatialReference:r});u=a.navigation.currentCamera;z=1/Math.tan(u.fovX/2);p=1/Math.tan(u.fovY/2);u=1/Math.tan(u.fov/2);x=Math.max(0.5*t*z,0.5*k*p,0.5*x*u)/1;e=v(a,e.heading,e.tilt,d,x,m);s=g.vectorToPoint(e.eye,s,r);if(!s)return null;l||(l=new b);l.position=s;l.heading=e.heading;l.tilt=e.tilt;l.fov=a.camera.fov;return l},toExtent:function(a,b,e,c,l){var f=a.renderSpatialReference;b||(e||(e=a.navigation.currentCamera),
b=p(a,e,l));if(e)l=g.vectorToPoint(e.center,f,a.spatialReference||n.WGS84),b=e.distance;else{l=a.toMap(a.screenCenter);if(!l)return null;b=h.computeCarthesianDistance(b.position,l)}e||(e=a.navigation.currentCamera);f=Math.tan(e.fovX/2);e=Math.tan(e.fovY/2);f=1*2*b*f;e=1*2*b*e;return"global"===a.viewingMode?m.toExtent(a,l,f,e,c):d.toExtent(a,l,f,e,c)},fromCenterScale:function(a,b,d,e,c,h){d=s(a,d,b.latitude);return t(a,b,d,e,c,h)},fromCenterDistance:t,directionToHeadingTilt:u,eyeHeadingTiltForCenterPointAtDistance:v,
scaleToZoom:function(a,b){var d=a.get("basemapTerrain.tilingScheme");return d?d.levelAtScale(b):void 0},zoomToScale:function(a,b){var d=a.get("basemapTerrain.tilingScheme");return d?d.scaleAtLevel(b):void 0},computeScale:function(a,b,d){var e=a.renderSpatialReference;b||(b=a.navigation.currentCamera);var c;c=n.WGS84;b.center?(g.vectorToVector(b.center,e,z,c),c=z[1],b=b.distance):(c=b.position.latitude,g.pointToVector(b.position,B,e),g.pointToVector(d,z,e),b=C.dist(B,z));return r(a,b,c)}}})},"esri/views/3d/support/projectionUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),
function(q,n,k,f,c,b){var a=c.vec3d,e=c.mat4d,h=b.Vec3Compact,g=a.create(),d=a.create(),m=a.create(),l=k.deg2rad(1),p=k.rad2deg(1),s=new q({wkt:'      GEOCCS["Spherical geocentric",        DATUM["Not specified",          SPHEROID["Sphere",'+f.earthRadius+',0]],        PRIMEM["Greenwich",0.0,          AUTHORITY["EPSG","8901"]],        UNIT["m",1.0],        AXIS["Geocentric X",OTHER],        AXIS["Geocentric Y",EAST],        AXIS["Geocentric Z",NORTH]      ]    '}),r=f.earthRadius,t=function(a){return a===
s?1:a.isWGS84?2:a.isWebMercator?3:0};q=function(a,b,d,e){d[e++]=a[b++];d[e++]=a[b++];d[e]=a[b]};var u=function(a,b,d,e){var c=0.4999999*Math.PI,h=l*a[b+1],h=k.clamp(h,-c,c),c=Math.sin(h);d[e++]=l*a[b]*r;d[e++]=r/2*Math.log((1+c)/(1-c));d[e]=a[b+2]},v=function(a,b,d,e){var c=r+a[b+2],h=l*a[b+1];a=l*a[b];b=Math.cos(h);d[e++]=Math.cos(a)*b*c;d[e++]=Math.sin(a)*b*c;d[e]=Math.sin(h)*c},C=[void 0,v,q,u],y=[void 0,function(a,b,d,e){var c=h.length(a,b),g=k.asin(a[b+2]/c),m=Math.cos(g);a=(0<a[b+1]?1:-1)*k.acos(a[b]/
(m*c));d[e++]=p*a;d[e++]=p*g;d[e]=c-r},q,function(a,b,d,e){d[e++]=p*(a[b++]/r);d[e++]=p*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/r)));d[e]=a[b]}];return{SphericalRenderSpatialReference:s,vectorToVector:function(b,d,e,c){2===b.length?(g[0]=b[0],g[1]=b[1],g[2]=0,b=g):b===e&&(a.set(b,g),b=g);return this.bufferToBuffer(b,d,0,e,c,0,1)},pointToVector:function(a,b,d){g[0]=a.x;g[1]=a.y;g[2]=a.z||0;return this.bufferToBuffer(g,a.spatialReference,0,b,d,0,1)},vectorToPoint:function(a,b,d,e){"esri.SpatialReference"===
d.declaredClass?(e=d,d=new n({spatialReference:e})):e=e||d.spatialReference;return this.bufferToBuffer(a,b,0,g,e,0,1)?(d.x=g[0],d.y=g[1],d.z=g[2],d.spatialReference=e,d):null},xyzToVector:function(a,b,d,e,c,h){g[0]=a;g[1]=b;g[2]=d;return this.bufferToBuffer(g,e,0,c,h,0,1)},bufferToBuffer:function(a,b,e,c,h,g,m){m=m||1;var l=t(b),p=t(h);m=e+3*m;if(l===p&&(0!==l||b.equals(h))){if(c!==a||e!==g)for(;e<m;e++,g++)c[g]=a[e]}else if(0<l&&0<p)if(2!==p)if(h=C[p],2!==l)for(l=y[l];e<m;e+=3,g+=3)l(a,e,d,0,b.wkid),
h(d,0,c,g);else for(;e<m;e+=3,g+=3)h(a,e,c,g);else for(l=y[l];e<m;e+=3,g+=3)l(a,e,c,g,b.wkid);else return!1;return!0},computeLinearTransformation:function(a,b,c,h){var g=t(a),p=t(h);if(g===p&&(0!==g||a.equals(h)))return e.identity(c),e.translate(c,b),!0;if(1===p){if(h=y[g])return h(b,0,d,0,a.wkid),v(d,0,m,0),h=l*d[0],b=l*d[1],a=Math.sin(h),h=Math.cos(h),g=Math.sin(b),b=Math.cos(b),c[0]=-a,c[4]=-g*h,c[8]=b*h,c[12]=m[0],c[1]=h,c[5]=-g*a,c[9]=b*a,c[13]=m[1],c[2]=0,c[6]=b,c[10]=g,c[14]=m[2],c[3]=0,c[7]=
0,c[11]=0,c[15]=1,!0}else if(3===p&&(2===g||1===g))return y[g](b,0,d,0,a.wkid),a=l*d[1],u(d,0,m,0),e.identity(c),e.translate(c,m),a=1/Math.cos(a),e.scale(c,[a,a,1]),!0;return!1},mbsToMbs:function(a,b,e,c){var h=t(b),g=t(c);if(h===g&&(0!==h||b.equals(c)))return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],!0;if(1===g){if(c=y[h])return c(a,0,d,0,b.wkid),v(d,0,e,0),e[3]=a[3],!0}else if(3===g&&(2===h||1===h))return y[h](a,0,d,0,b.wkid),b=l*d[1],b=Math.abs(b)+Math.asin(a[3]/(r+a[2])),u(d,0,e,0),b>0.9999*Math.PI?
e[3]=Number.MAX_VALUE:(b=1/Math.cos(b),e[3]=b*a[3]),!0;return!1},extentToBoundingBox:function(a,b,d){if(null==a)return!1;var e;g[0]=null!=a.xmin?a.xmin:0;g[1]=null!=a.ymin?a.ymin:0;g[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(g,a.spatialReference,0,b,d,0,1);g[0]=null!=a.xmax?a.xmax:0;g[1]=null!=a.ymax?a.ymax:0;g[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(g,a.spatialReference,0,b,d,3,1);null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.zmin&&(b[2]=-Infinity);null==a.xmax&&
(b[3]=Infinity);null==a.ymax&&(b[4]=Infinity);null==a.zmax&&(b[5]=Infinity);return e},extentToBoundingRect:function(a,b,d){if(null==a)return!1;var e;g[0]=null!=a.xmin?a.xmin:0;g[1]=null!=a.ymin?a.ymin:0;g[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(g,a.spatialReference,0,g,d,0,1);b[0]=g[0];b[1]=g[1];g[0]=null!=a.xmax?a.xmax:0;g[1]=null!=a.ymax?a.ymax:0;g[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(g,a.spatialReference,0,g,d,0,1);b[2]=g[0];b[3]=g[1];null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&
(b[1]=-Infinity);null==a.xmax&&(b[2]=Infinity);null==a.ymax&&(b[3]=Infinity);return e},webMercator:{x2lon:function(a){return a/r},y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/r))},lon2x:function(a){return a*r},lat2y:function(a){a=Math.sin(a);return r/2*Math.log((1+a)/(1-a))}}}})},"esri/views/3d/support/cameraUtilsPlanar":function(){define(["../../../geometry/Extent","./mathUtils","./projectionUtils","../lib/glMatrix","./cameraUtilsInternal"],function(q,n,k,f,c){function b(a,b,c){a=
e.create();var l=e.create();h.identity(m);h.rotateZ(m,-n.deg2rad(b));h.rotateX(m,n.deg2rad(c));h.multiplyVec3(m,d,a);e.scale(a,-1);h.multiplyVec3(m,g,l);return{direction:a,up:l}}var a={headingTiltToDirectionUp:b,directionToHeadingTilt:function(a,b,e,h){return c.directionToHeadingTilt(b,e,h,d,g)},eyeForCenterWithHeadingTilt:function(a,d,c,h){var g=b(a,c,h);a=e.add(e.scale(g.direction,-d,e.create()),a);return{up:g.up,eye:a,heading:c,tilt:h}},lookAtTiltToEyeTilt:function(a,b,d){return n.rad2deg(d)},
eyeTiltToLookAtTilt:function(a,b,d){return n.deg2rad(d)},toExtent:function(a,b,d,e,c){var h=a.renderSpatialReference;a=a.map&&a.spatialReference||b.spatialReference;k.pointToVector(b,l,h);k.pointToVector(b,p,h);l[0]-=d/2;p[0]+=d/2;l[1]-=e/2;p[1]+=e/2;k.vectorToVector(l,h,l,a);k.vectorToVector(p,h,p,a);c?(c.xmin=l[0],c.ymin=l[1],c.xmax=p[0],c.ymax=p[1],c.spatialReference=a):c=new q(l[0],l[1],p[0],p[1],a);return c}},e=f.vec3d,h=f.mat4d,g=e.createFrom(0,1,0),d=e.createFrom(0,0,1),m=h.create(),l=e.create(),
p=e.create();return a})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["./mathUtils","../lib/glMatrix"],function(q,n){var k=n.vec3d,f=k.create(),c=k.create();return{directionToHeadingTilt:function(b,a,e,h,g){var d=f;k.normalize(b,d);var m=Math.abs(k.dot(d,h));0.99<m&&(m=Math.abs(k.dot(a,h)),0.99>m?k.set(a,d):d=null);a=0;d&&(k.scale(h,k.dot(h,d),c),k.subtract(d,c),a=k.dot(d,g)/(k.length(d)*k.length(g)),k.cross(d,g,c),a=(0<k.dot(c,h)?1:-1)*q.rad2deg(q.acos(a)));b=q.rad2deg(q.acos(-k.dot(h,
b)/k.length(b)));return e?(e.heading=a,e.tilt=b,e):{heading:a,tilt:b}}}})},"esri/views/3d/support/cameraUtilsSpherical":function(){define("../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ./mathUtils ./earthUtils ../lib/glMatrix ./cameraUtilsInternal".split(" "),function(q,n,k,f,c,b,a){function e(a,b,d){var e=m.create(),c=m.create();m.cross(a,p,u);0===m.dot(u,u)&&m.cross(a,s,u);l.identity(t);l.rotate(t,-f.deg2rad(b),a);l.rotate(t,-f.deg2rad(d),
u);m.cross(u,a,c);m.normalize(c);l.multiplyVec3(t,c);m.normalize(a,e);l.multiplyVec3(t,m.negate(e));return{direction:e,up:c}}function h(a){var b=a[1];a[1]=-a[2];a[2]=b}function g(a,b){var d=e(b,a.heading,a.tilt);a.up=d.up;return a}var d={headingTiltToDirectionUp:e,directionToHeadingTilt:function(b,d,e,c){var h=u,g=v;m.normalize(b,h);m.cross(h,p,v);0===m.dot(v,v)&&m.cross(h,s,v);m.cross(v,h,g);return a.directionToHeadingTilt(d,e,c,h,g)},eyeForCenterWithHeadingTilt:function(a,b,d,e){var c={eye:m.create(),
tilt:e,heading:d},l=u;l[0]=a[0];l[1]=a[2];l[2]=-a[1];d=f.deg2rad(d);var p=f.deg2rad(e);e=Math.sin(d);d=Math.cos(d);var s=Math.sin(p),r=Math.cos(p),t=m.length(l);if(1E-8>Math.abs(p))p=b+t;else var k=t/s,v=f.asin(b/k),p=k*Math.sin(Math.PI-p-v);var k=s*b,r=r*b,n=d*k,v=p-r,J=v*v,F=b*b*s*s,s=d*d*F,F=e*e*F,K=l[1]*v,q=s*(s+J-l[1]*l[1]);if(0>q)return m.scale(l,p/t,c.eye),c.tilt=0,c;var R=Math.sqrt(q),q=s+J,K=0<d?-R+K:R+K;if(1E-8>Math.abs(q))return 1E-8>t?(c.eye[0]=0,c.eye[1]=0,c.eye[2]=b):m.scale(l,p/t,c.eye),
c.tilt=0,h(c.eye),g(c,a);c.eye[1]=K/q;b=c.eye[1]*c.eye[1];q=n*c.eye[1];n=1-b;K=Math.sqrt(n);b=s*b+F-2*q*K*v+n*J;if(1E-8>Math.abs(b))return m.scale(l,p/t,c.eye),c.tilt=0,h(c.eye),g(c,a);c.eye[0]=(n*(p*l[0]-r*l[0])-k*K*(l[0]*c.eye[1]*d+l[2]*e))/b;c.eye[2]=(n*(p*l[2]-r*l[2])-k*K*(l[2]*c.eye[1]*d-l[0]*e))/b;m.scale(c.eye,p);h(c.eye);return g(c,a)},lookAtTiltToEyeTilt:function(a,b,d){a=m.length(a);a=Math.sqrt(b*b+a*a-2*b*a*Math.cos(Math.PI-d));b=f.asin(b/(a/Math.sin(d)));return f.rad2deg(d-b)},eyeTiltToLookAtTilt:function(a,
b,d){d=f.deg2rad(d);a=m.length(a);return f.asin(b/(a/Math.sin(d)))+d},toExtent:function(a,b,d,e,h){var g,m=b.latitude;b=b.longitude;g=c.getLonDeltaForDistance(b,m,d)/2;d=b-g;b+=g;g=f.deg2rad(m);m=c.earthRadius;g=(1+Math.sin(g))/(1-Math.sin(g));var l=g+1,p=Math.tan(e/m/2),l=l*p;g=1.5*Math.PI-2*Math.atan(0.5*(l+Math.sqrt(4*g+l*l)));e=g+e/m;m=function(a){var b=Math.PI/2;a=f.cyclical2PI.normalize(a,-b);a>b&&(a=Math.PI-a);return a};g=m(g);e=m(e);e<g&&(m=e,e=g,g=m);g=Math.max(f.rad2deg(g),-90);e=Math.min(f.rad2deg(e),
90);b=r.monotonic(d,b);180<b-d&&(m=(b-d-180)/2,d+=m,b-=m);h?(h.xmin=d,h.ymin=g,h.xmax=b,h.ymax=e,h.spatialReference=q.WGS84):h=new n(d,g,b,e,q.WGS84);a.spatialReference&&a.spatialReference.isWebMercator&&k.geographicToWebMercator(h,!1,h);return h}},m=b.vec3d,l=b.mat4d,p=m.createFrom(0,0,1),s=m.normalize(m.createFrom(1,1,1)),r=new f.Cyclical(-180,180),t=l.create(),u=m.create(),v=m.create();return d})},"esri/views/3d/support/viewpointUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Geometry ../../../geometry/Point ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ../../../core/Error ../../../core/promiseUtils ../../../Camera ../../../Viewpoint ../../../Graphic ../lib/glMatrix ./mathUtils ./projectionUtils ./cameraUtils ./aaBoundingBox ./aaBoundingRect ./intersectionUtils".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t){function u(a){return 360-m.cyclicalDeg.normalize(a)}function v(a){return m.cyclicalDeg.normalize(360-a)}function C(a,b,d){if(!b)return null;var h=a.spatialReference||q.WGS84,g;if(b.camera){g=b.get("camera.position.spatialReference");if(!c.canProject(g,h))return null;b=b.camera.clone();g.equals(h)||(a=c.project(b.position,h),a.z=b.position.z,b.position=a);return b}if((g=b.get("targetGeometry.spatialReference"))&&!c.canProject(g,h))return null;var m=a.navigation.currentCamera;
g=p.internalToExternal(a,m);var f={noReset:!1};null!=b.rotation&&(g.heading=u(b.rotation),f.noReset=!0);null!=d&&(g.tilt=d);if(b.targetGeometry instanceof k){var s=b.targetGeometry;d=b.targetGeometry.clone();b=null!=b.scale?p.scaleToDistance(a,b.scale,s.latitude):m.distance;b=p.eyeHeadingTiltForCenterPointAtDistance(a,g.heading,g.tilt,d,b,f);a=l.vectorToPoint(b.eye,a.renderSpatialReference,h);return new e(a,b.heading,b.tilt,g.fov)}return p.fromExtent(a,b.targetGeometry.extent,g,f)}function y(a,b,
d,e){var c=d.scale;null==c&&null!=d.zoom&&(c=p.zoomToScale(a,d.zoom));null==c&&null!=d.distance&&(b=b.center||b,c=p.distanceToScale(a,d.distance,b.latitude));null==c&&e&&(c="function"===typeof e?e():e);return c}function x(a,b,d,e,c){if(!(b&&d.position||b&&d.direction||d.position&&d.direction))return!1;var g=a.spatialReference||q.WGS84,h=a.renderSpatialReference,m=d.direction;b&&d.position&&(m=null);d.position&&l.pointToVector(d.position,R,h);b&&l.pointToVector(b,da,h);if(m){var f=new k(d.position||
b);f.x+=m[0];f.y+=m[1];2<m.length&&(f.z+=m[2]);l.pointToVector(f,S,h);F.subtract(S,d.position?R:da)}d.position&&m?(c.camera.position=new k(d.position),p.directionToHeadingTilt(a,R,S,e.up,c.camera),F.add(R,S,da),a.navigation.getCenterIntersectTerrain(R,da,da),c.targetGeometry=l.vectorToPoint(da,h,g),c.scale=p.distanceToScale(a,F.dist(R,da),c.targetGeometry.latitude)):b&&m?(c.targetGeometry=new k(b),c.scale=y(a,c.targetGeometry,d,function(){return p.computeScale(a,e)}),b=p.scaleToDistance(a,c.scale,
b.latitude),F.scale(S,b/F.length(S),R),F.add(R,da),c.camera.position=l.vectorToPoint(R,h,g),p.directionToHeadingTilt(a,R,S,e.up,c.camera)):(c.targetGeometry=new k(b),c.camera.position=new k(d.position),F.subtract(da,R,S),p.directionToHeadingTilt(a,R,S,e.up,c.camera),c.scale=p.distanceToScale(a,F.dist(R,da),c.targetGeometry.latitude));c.rotation=v(c.camera.heading);return!0}function B(a,b){var d=!1;null!=b.heading?(a.heading=b.heading,d=!0):null!=b.rotation&&(a.heading=u(b.rotation),d=!0);null!=b.tilt&&
(a.tilt=b.tilt,d=!0);null!=b.fov&&(a.fov=b.fov);return d}function z(a,b,d){var e=a.spatialReference||q.WGS84;b=b||p.externalToInternal(a,d.camera);d.targetGeometry=l.vectorToPoint(b.center,a.renderSpatialReference,e);d.scale=p.computeScale(a,b);d.rotation=v(d.camera.heading);return d}function A(a,b,d){if(b){var e=[];if(!b.hasZ&&a.basemapTerrain){var c;c=b.isInstanceOf(k)?b:b.centroid||b.center;aa[2]=c?a.basemapTerrain.getElevation(c)||0:0}U[b.declaredClass](b,function(a){e.push(a[0],a[1],a[2])},aa);
var h=e.length/3;if(0!==h&&(c=Array(e.length),l.bufferToBuffer(e,b.spatialReference,0,c,a.spatialReference,0,h))){b.hasZ&&(d.hasZ=!0);for(a=0;a<c.length;a+=3)b.hasZ?(aa[0]=c[a+0],aa[1]=c[a+1],aa[2]=c[a+2]):(aa[0]=c[a+0],aa[1]=c[a+1]),s.expand(d.boundingBox,aa)}}}function w(a,b,d){return a.whenViewForGraphic(b).then(function(a){if(a&&a.whenGraphicBounds)return a.whenGraphicBounds(b)}).then(function(a){s.expand(d.boundingBox,a);isFinite(a[2])&&(d.hasZ=!0)}).otherwise(function(){A(a,b.geometry,d)})}
function D(b,d,e){if(Array.isArray(d)&&2===d.length&&"number"===typeof d[0]&&"number"===typeof d[1])L.x=d[0],L.y=d[1],L.z=void 0,L.spatialReference=q.WGS84,A(b,L,e);else{if(d&&d.forEach){var c=a.resolve();d.forEach(function(a){c=c.then(function(){return D(b,a,e)})});return c}if(d instanceof n)A(b,d,e);else if(d instanceof g)return w(b,d,e)}return a.resolve()}function E(a,b,d,e){if(b.camera)return H(a,d,b.camera,e);e.scale=b.scale;e.rotation=b.rotation;e.targetGeometry=b.targetGeometry?b.targetGeometry.clone():
null;e.camera=null;null!=d.heading?e.rotation=v(d.heading):null!=d.rotation&&(e.rotation=d.rotation);b=y(a,e.targetGeometry,d);null!=b&&(e.scale=b);e.camera=C(a,e,d.tilt);return e}function H(a,b,d,e){e.camera=d.clone();e.camera.fov=a.camera.fov;b=a.spatialReference;d=e.camera.position.spatialReference;if(!c.canProject(d,b))return null;d.equals(b)||(b=c.project(e.camera.position,b),b.z=e.camera.position.z,e.camera.position=b);return z(a,null,e)}function G(a,b,d,e){if(!d)return null;e.targetGeometry=
d.clone();var c=a.navigation.getCameraIntersectTerrain();if(x(a,e.targetGeometry,b,c,e))return e;p.internalToExternal(a,c,e.camera);var h={noReset:!1};B(e.camera,b)&&(h.noReset=!0);e.scale=y(a,e.targetGeometry,b);null==e.scale&&(l.pointToVector(d,aa,a.renderSpatialReference),t.frustumPoint(c.frustumPlanes,aa)?e.scale=p.distanceToScale(a,F.dist(c.eye,aa),d.latitude):e.scale=p.computeScale(a,c));return!p.fromCenterScale(a,e.targetGeometry,e.scale,e.camera,h,e.camera)?null:e}function I(a,b,d,e){e.targetGeometry=
d.clone();var c=a.navigation.getCameraIntersectTerrain();p.internalToExternal(a,c,e.camera);c={noReset:!1};B(e.camera,b)&&(c.noReset=!0);return!p.fromExtent(a,d,e.camera,c,e.camera)?null:e}function O(a,b){if(!b||!a.spatialReference)return null;var d={};if(null==b.declaredClass&&!Array.isArray(b)){for(var e in b)d[e]=b[e];b.center&&!d.target&&(d.target=b.center)}else d.target=b;return d}function J(b){b&&(b.rotation=v(b.camera.heading));return a.resolve(b)}var F=d.vec3d,K=d.mat3d,T=d.mat4d,R=F.create(),
da=F.create(),S=F.create(),ba={heading:0,tilt:0},aa=F.create(),$=T.create(),Z=K.create(),M=s.create(),V=r.create(),L=new k;d=function(a,b,d){for(var e=a.hasZ,c=0;c<a.rings.length;c++)for(var h=a.rings[c],g=0;g<h.length;g++)d[0]=h[g][0],d[1]=h[g][1],e&&(d[2]=h[g][2]),b(d)};var U={"esri.geometry.Point":function(a,b,d){d[0]=a.x;d[1]=a.y;a.hasZ&&(d[2]=a.z);b(d)},"esri.geometry.Polygon":d,"esri.geometry.Circle":d,"esri.geometry.Polyline":function(a,b,d){for(var e=a.hasZ,c=0;c<a.paths.length;c++)for(var h=
a.paths[c],g=0;g<h.length;g++)d[0]=h[g][0],d[1]=h[g][1],e&&(d[2]=h[g][2]),b(d)},"esri.geometry.Multipoint":function(a,b,d){var e=a.points;a=a.hasZ;for(var c=0;c<e.length;c++)d[0]=e[c][0],d[1]=e[c][1],a&&(d[2]=e[c][2]),b(d)},"esri.geometry.Extent":function(a,b,d){a.hasZ?(b(F.set3(a.xmin,a.ymin,a.zmin,d)),b(F.set3(a.xmax,a.ymin,a.zmin,d)),b(F.set3(a.xmin,a.ymax,a.zmin,d)),b(F.set3(a.xmax,a.ymax,a.zmin,d)),b(F.set3(a.xmin,a.ymin,a.zmax,d)),b(F.set3(a.xmax,a.ymin,a.zmax,d)),b(F.set3(a.xmin,a.ymax,a.zmax,
d)),b(F.set3(a.xmax,a.ymax,a.zmax,d))):(b(F.set3(a.xmin,a.ymin,d[2],d)),b(F.set3(a.xmax,a.ymin,d[2],d)),b(F.set3(a.xmin,a.ymax,d[2],d)),b(F.set3(a.xmax,a.ymax,d[2],d)))}},N={create:function(d,c){var g=O(d,c);if(!g)return a.reject(new b("viewpointutils-create:no-target","Missing target for creating viewpoint"));var m=new h({camera:new e({fov:d.camera.fov})}),t=null!=g.scale||null!=g.zoom||null!=g.distance;if(g.target instanceof h)return J(E(d,g.target,g,m));if(g.target instanceof e)return J(H(d,g,
g.target,m));if(g.target instanceof f){var v=g.target.xmin===g.target.xmax||g.target.ymin===g.target.ymax;return t||v?J(G(d,g,g.target.center,m)):J(I(d,g,g.target,m))}var A={boundingBox:s.create(s.NEGATIVE_INFINITY),spatialReference:d.spatialReference,hasZ:!1};return D(d,g.target,A).then(function(){if(isFinite(A.boundingBox[0])){s.center(A.boundingBox,aa);L.x=aa[0];L.y=aa[1];L.z=aa[2];L.spatialReference=d.spatialReference;var a;!isFinite(L.z)||!A.hasZ?(L.z=void 0,a=r.isPoint(s.toRect(A.boundingBox,
V))):a=s.isPoint(A.boundingBox);if(t||a)return G(d,g,L,m);var b=L,e=A.boundingBox,c=N.DEFAULT_FRAME_COVERAGE;m.targetGeometry=b.clone();a=d.navigation.getCameraIntersectTerrain();var h=0;b.hasZ?h=b.z:d.basemapTerrain&&(h=d.basemapTerrain.getElevation(b));F.set3(b.x,b.y,h,aa);l.computeLinearTransformation(d.spatialReference,aa,$,d.renderSpatialReference);T.toMat3($,Z);K.transpose(Z);s.set(M,s.NEGATIVE_INFINITY);for(var b=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],f=0;f<b.length;f++){var v=
b[f],w=e[v[2]];isFinite(w)||(w=h);F.set3(e[v[0]],e[v[1]],w,aa);l.vectorToVector(aa,d.spatialReference,aa,d.renderSpatialReference);s.expand(M,K.multiplyVec3(Z,aa))}e=s.width(M);h=s.height(M);b=s.depth(M);v=1/Math.tan(a.fovX/2);f=1/Math.tan(a.fovY/2);v=0.5*Math.sqrt(e*e+b*b)*Math.max(f,v)+0.5*h;e=0.5*h*f+0.5*Math.max(e,b);c=Math.max(v,e)/c;p.internalToExternal(d,a,m.camera);a={noReset:!1};B(m.camera,g)&&(a.noReset=!0);m.scale=p.distanceToScale(d,c,m.targetGeometry.latitude);a=p.fromCenterScale(d,m.targetGeometry,
m.scale,m.camera,a,m.camera)?m:null;return a}a=d.navigation.getCameraIntersectTerrain();x(d,null,g,a,m)?a=m:g.position?(F.set(a.viewForward,S),p.directionToHeadingTilt(d,a.eye,S,a.up,ba),m.camera.position=new k(g.position),a=m.camera,c=ba.heading,e=g.heading,null==e&&null!=g.rotation&&(e=u(g.rotation)),null==e&&c&&(e="function"===typeof c?c():c),a.heading=e,a=m.camera,c=ba.tilt,c=null!=g.tilt?g.tilt:null!=c?"function"===typeof c?c():c:void 0,a.tilt=c,a=z(d,null,m)):(a=l.vectorToPoint(a.center,d.renderSpatialReference,
L,d.spatialReference),a=G(d,g,a,m));return a}).then(function(a){return J(a)})},rotationToHeading:u,headingToRotation:v,toCamera:C,fromCamera:function(a,b,d){d||(d=new h);d.camera=b.clone();return z(a,null,d)},fromInternalCamera:function(a,b,d){d||(d=new h({camera:new e}));p.internalToExternal(a,b,d.camera);return z(a,b,d)},DEFAULT_FRAME_COVERAGE:0.66};return N})},"esri/views/3d/support/aaBoundingBox":function(){define(["require","exports","./aaBoundingRect"],function(q,n,k){function f(a){return a[0]>=
a[3]?0:a[3]-a[0]}function c(a){return a[1]>=a[4]?0:a[4]-a[1]}function b(a){return a[2]>=a[5]?0:a[5]-a[2]}function a(a){return 6===a.length}n.create=function(a){void 0===a&&(a=n.ZERO);return[a[0],a[1],a[2],a[3],a[4],a[5]]};n.fromExtent=function(a){return[a.xmin,a.ymin,a.zmin,a.xmax,a.ymax,a.zmax]};n.expand=function(b,c,g){void 0===g&&(g=b);var d=c.declaredClass;"esri.geometry.Extent"===d?(g[0]=Math.min(b[0],c.xmin),g[1]=Math.min(b[1],c.ymin),g[3]=Math.max(b[3],c.xmax),g[4]=Math.max(b[4],c.ymax),c.hasZ&&
(g[2]=Math.min(b[2],c.zmin),g[5]=Math.max(b[5],c.zmax))):"esri.geometry.Point"===d?(g[0]=Math.min(b[0],c.x),g[1]=Math.min(b[1],c.y),g[3]=Math.max(b[3],c.x),g[4]=Math.max(b[4],c.y),c.hasZ&&(g[2]=Math.min(b[2],c.z),g[5]=Math.min(b[5],c.z))):a(c)?(g[0]=Math.min(b[0],c[0]),g[1]=Math.min(b[1],c[1]),g[2]=Math.min(b[2],c[2]),g[3]=Math.max(b[3],c[3]),g[4]=Math.max(b[4],c[4]),g[5]=Math.max(b[5],c[5])):k.is(c)?(g[0]=Math.min(b[0],c[0]),g[1]=Math.min(b[1],c[1]),g[3]=Math.max(b[3],c[2]),g[4]=Math.max(b[4],c[3])):
Array.isArray(c)&&(2===c.length?(g[0]=Math.min(b[0],c[0]),g[1]=Math.min(b[1],c[1]),g[3]=Math.max(b[3],c[0]),g[4]=Math.max(b[4],c[1])):3===c.length&&(g[0]=Math.min(b[0],c[0]),g[1]=Math.min(b[1],c[1]),g[2]=Math.min(b[2],c[2]),g[3]=Math.max(b[3],c[0]),g[4]=Math.max(b[4],c[1]),g[5]=Math.max(b[5],c[2])));return g};n.allFinite=function(a){for(var b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};n.width=f;n.depth=c;n.height=b;n.center=function(a,h){void 0===h&&(h=[0,0,0]);h[0]=a[0]+f(a)/2;h[1]=a[1]+c(a)/
2;h[2]=a[2]+b(a)/2;return h};n.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};n.containsWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[2]>=a[2]-c&&b[0]<=a[3]+c&&b[1]<=a[4]+c&&b[2]<=a[5]+c};n.offset=function(a,b,c,d,m){void 0===m&&(m=a);m[0]=a[0]+b;m[1]=a[1]+c;m[2]=a[2]+d;m[3]=a[3]+b;m[4]=a[4]+c;m[5]=a[5]+d;return m};n.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c[2]=b[2];c!==a&&(c[3]=a[3],c[4]=a[4],c[5]=a[5]);
return c};n.setMax=function(a,b,c){void 0===c&&(c=a);c[3]=b[0];c[4]=b[1];c[5]=b[2];c!==a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);return a};n.set=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};n.toRect=function(a,b){b||(b=k.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];return b};n.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[3]=b[2];a[4]=b[3];return a};n.is=a;n.isPoint=function(a){return 0===f(a)&&0===c(a)&&0===b(a)};n.equals=function(b,c,g){if(null==b||null==c)return b===
c;if(!a(b)||!a(c))return!1;if(g)for(var d=0;d<b.length;d++){if(!g(b[d],c[d]))return!1}else for(d=0;d<b.length;d++)if(b[d]!==c[d])return!1;return!0};n.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];n.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];n.ZERO=[0,0,0,0,0,0]})},"esri/views/3d/support/aaBoundingRect":function(){define(["require","exports"],function(q,n){function k(b){return b[0]>=b[2]?0:b[2]-b[0]}function f(b){return b[1]>=b[3]?0:
b[3]-b[1]}function c(b){return 4===b.length}n.create=function(b){void 0===b&&(b=n.ZERO);return[b[0],b[1],b[2],b[3]]};n.fromExtent=function(b){return[b.xmin,b.ymin,b.xmax,b.ymax]};n.expand=function(b,a,e){void 0===e&&(e=b);var h=a.declaredClass;if("esri.geometry.Extent"===h)e[0]=Math.min(b[0],a.xmin),e[1]=Math.min(b[1],a.ymin),e[2]=Math.max(b[2],a.xmax),e[3]=Math.max(b[3],a.ymax);else if("esri.geometry.Point"===h)e[0]=Math.min(b[0],a.x),e[1]=Math.min(b[1],a.y),e[2]=Math.max(b[2],a.x),e[3]=Math.max(b[3],
a.y);else if(c(a))e[0]=Math.min(b[0],a[0]),e[1]=Math.min(b[1],a[1]),e[2]=Math.max(b[2],a[2]),e[3]=Math.max(b[3],a[3]);else if(Array.isArray(a)&&(2===a.length||3===a.length))e[0]=Math.min(b[0],a[0]),e[1]=Math.min(b[1],a[1]),e[2]=Math.max(b[2],a[0]),e[3]=Math.max(b[3],a[1]);return e};n.allFinite=function(b){for(var a=0;4>a;a++)if(!isFinite(b[a]))return!1;return!0};n.width=k;n.height=f;n.center=function(b,a){void 0===a&&(a=[0,0]);a[0]=b[0]+k(b)/2;a[1]=b[1]+f(b)/2;return a};n.contains=function(b,a){return a[0]>=
b[0]&&a[1]>=b[1]&&a[0]<=b[2]&&a[1]<=b[3]};n.containsWithMargin=function(b,a,c){return a[0]>=b[0]-c&&a[1]>=b[1]-c&&a[0]<=b[2]+c&&a[1]<=b[3]+c};n.offset=function(b,a,c,h){void 0===h&&(h=b);h[0]=b[0]+a;h[1]=b[1]+c;h[2]=b[2]+a;h[3]=b[3]+c;return h};n.setMin=function(b,a,c){void 0===c&&(c=b);c[0]=a[0];c[1]=a[1];c!==b&&(c[2]=b[2],c[3]=b[3]);return c};n.setMax=function(b,a,c){void 0===c&&(c=b);c[2]=a[0];c[3]=a[1];c!==b&&(c[0]=b[0],c[1]=b[1]);return b};n.set=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=
a[3];return b};n.is=c;n.isPoint=function(b){return(0===k(b)||!isFinite(b[0]))&&(0===f(b)||!isFinite(b[1]))};n.equals=function(b,a,e){if(null==b||null==a)return b===a;if(!c(b)||!c(a))return!1;if(e)for(var h=0;h<b.length;h++){if(!e(b[h],a[h]))return!1}else for(h=0;h<b.length;h++)if(b[h]!==a[h])return!1;return!0};n.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];n.ZERO=[0,0,0,0]})},"esri/views/3d/support/intersectionUtils":function(){define(["../lib/glMatrix"],function(q){function n(a,b,c,
g){g.clip[0]=0;g.clip[1]=c?g.len:Number.MAX_VALUE;for(c=0;c<a.length;c++){var d;var m=a[c],l=b;d=g;var p=f.dot(m,d.dir),m=-f.dot(l,m)-m[3];0>m&&0<=p?d=!1:-1E-6<p&&1E-6>p?d=!0:(0>m||0>p)&&!(0>m&&0>p)?d=!0:(m/=p,0<p?m<d.clip[1]&&(d.clip[1]=m):m>d.clip[0]&&(d.clip[0]=m),d=d.clip[0]<=d.clip[1]);if(!d)return!1}return!0}function k(a,b,h,g){a?(h&&g&&(c.len=f.dist(b,h)),f.set(a,c.dir)):g?(c.len=f.dist(b,h),f.scale(f.subtract(h,b,c.dir),1/c.len)):f.normalize(f.subtract(h,b,c.dir));return c}var f=q.vec3d;q=
q.vec2d;var c={dir:f.create(),len:0,clip:q.create()},b={planeSphere:function(a,b,c){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]<c},frustumSphere:function(a,c,h){for(var g=0;6>g;g++)if(!b.planeSphere(a[g],c,h))return!1;return!0},frustumRay:function(a,b,c,g){c=k(g,b,c,!1);return n(a,b,null,c)},frustumPoint:function(a,b){for(var c=0;6>c;c++)if(0>-f.dot(b,a[c])-a[c][3])return!1;return!0},frustumLineSegment:function(a,b,c,g){g=k(g,b,c,!0);return n(a,b,c,g)}};return b})},"esri/views/3d/webgl-engine/Stage":function(){define("require exports ./parts/Model ./parts/View ./lib/Selector ./lib/Camera ./lib/gl-matrix ./lib/Util ./lib/ModelContentType".split(" "),
function(q,n,k,f,c,b,a,e,h){q=a.vec2d;n=a.vec2;var g=a.vec3d;a=function(){function a(b,d){this._intersectTolerance=c.DEFAULT_TOLERANCE;this._viewContent=[];this._externalIntersectionHandlers=[];this.onSelectionChange=function(){};this.onGeometryPicked=function(){};this.container=b;this.model=new k;this.view=new f(b,this,this.model.getDirtySet(),d);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())}a.prototype.setNeedsRender=function(){this.view.setNeedsRender()};a.prototype.dispose=
function(){this.view.dispose();this.model=this.view=null};a.prototype.setSelectionObject=function(a,b,d){this.model.setSelection(a,d);this.view.setSelectionObject(void 0!==a?a.getId():void 0,d);if(!b)this.onSelectionChange(a,d)};a.prototype.getSelectionObject=function(){return this.model.getSelection()};a.prototype.frame=function(a,d){void 0===d&&(d=0);var c=Math.max(1E-6,a.getBSRadius());d=Math.max(2,d+2);var e=c*d,c=this.getCamera(),h=g.create(c.viewForward),e=1.5*e/Math.tan(c.fov);g.scale(h,-e);
g.set(a.getCenter(),c.center);g.add(c.center,h,c.eye);c=new b(c.eye,c.center,c.up);this.setCamera(c)};a.prototype.beginMod=function(){a.DebugSettings.fineGrainedContentValidation&&this.model.validateContent()};a.prototype.endMod=function(b){void 0===b&&(b=!1);a.DebugSettings.fineGrainedContentValidation&&!b&&this.model.validateContent()};a.prototype.add=function(a,b){this.model.add(a,b);"function"===typeof b.addParentStage&&b.addParentStage(this)};a.prototype.remove=function(a,b){var d=this.model.remove(a,
b);"function"===typeof d.removeParentStage&&d.removeParentStage(this);return d};a.prototype.notifyDirty=function(a,b,d,c){this.model.notifyDirty(a,b,d,c)};a.prototype.processDirty=function(){var b=this.model.getDirtySet(),d=b.getDirtyMaterials();if(b.hasDirtyGeometryRecords()||d){a.DebugSettings.endFrameContentValidation&&this.model.validateContent();a.DebugSettings.logDirtySet&&console.log("Dirty set: "+this.model.getDirtySet().formatDebugInfo(!1));var c=b.getAddRemoveUpdateListFilteredByLayers(this._viewContent,
!0);(0<c[0].length+c[1].length+c[2].length||d)&&this.view.modify(c[0],c[1],c[2],d);a.DebugSettings.logDirtySet&&(console.log("RGs add: "+c[0].map(function(a){return a.uniqueName})),console.log("RGs remove: "+c[1].map(function(a){return a.uniqueName})));b.getAddRemoveUpdateList(!0);b.clearDirtyMaterials();this.view.setNeedsRender()}};a.prototype.processDirtyLayer=function(a){var b=this.model.getDirtySet(),d=b.getDirtyMaterials();a=b.getAddRemoveUpdateListFilteredByLayers([a],!0);(0<a[0].length+a[1].length+
a[2].length||d)&&this.view.modify(a[0],a[1],a[2],d);b.clearDirtyMaterials()};a.prototype.get=function(a,b){return this.model.get(a,b)};a.prototype.getAll=function(a){return this.model.getAll(a)};a.prototype.addTextureListener=function(a){this.view.addTextureListener(a)};a.prototype.removeTextureListener=function(a){this.view.removeTextureListener(a)};a.prototype.getContainer=function(){return this.container};a.prototype.getCamera=function(){return this.view.getCamera()};a.prototype.setCamera=function(a){this.view.setCamera(a)};
a.prototype.getViewParams=function(a){return this.view.getViewParams(a)};a.prototype.setViewParams=function(a){this.view.setViewParams(a)};a.prototype.getLayers=function(){return this.model.getAll(h.LAYER)};a.prototype.getAmbientLight=function(){return this.model.getAmbientLight()};a.prototype.getDirectionalLight=function(){return this.model.getDirectionalLight()};a.prototype.setAmbientLight=function(a){this.model.setAmbientLight(a);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};
a.prototype.setDirectionalLight=function(a){this.model.setDirectionalLight(a);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};a.prototype.getCanvas=function(){return this.view.getCanvas()};a.prototype.setRenderParams=function(a){this.view.setRenderParams(a)};a.prototype.getRenderParams=function(){return this.view.getRenderParams()};a.prototype.has=function(a){return this.view.has(a)};a.prototype.getViewContent=function(){return this._viewContent.slice(0)};a.prototype.setViewContent=
function(a){var b=e.array2object(this._viewContent),d=e.array2object(a),c=e.subtractObjects(d,b),b=e.subtractObjects(b,d);this.processDirty();d=this.model.getDirtySet();c=d.getResidentRenderGeometriesFilteredByLayers(e.object2array(c));b=d.getResidentRenderGeometriesFilteredByLayers(e.object2array(b));this.view.modify(c,b,[]);this._viewContent=a.slice(0)};a.prototype.addToViewContent=function(a){for(var b=[],d=0;d<a.length;d++)-1===this._viewContent.indexOf(a[d])&&b.push(a[d]);0<a.length&&(this.processDirty(),
a=this.model.getDirtySet().getResidentRenderGeometriesFilteredByLayers(b),this.view.modify(a,[],[]),this._viewContent.push.apply(this._viewContent,b))};a.prototype.removeFromViewContent=function(a){this.processDirty();for(var b=this.model.getDirtySet(),d=this._viewContent,c=[],e=0;e<a.length;e++){var g=d.indexOf(a[e]);-1<g&&(d[g]=d[d.length-1],d.pop(),c.push(a[e]))}a=b.getResidentRenderGeometriesFilteredByLayers(c);this.view.modify([],a,[])};a.prototype.getViewFrustumObjects=function(){return this.view.getFrustumObjects()};
a.prototype.getLocalOrigin=function(a,b,d){return this.model.getOrigin(a,b,d)};a.prototype.addModelListener=function(a){return this.model.addModelListener(a)};a.prototype.removeModelListener=function(a){this.model.removeModelListener(a)};a.prototype.getFrameTask=function(){return this.view.getFrameTask()};a.prototype.requestScreenCapture=function(a,b){this.view.requestScreenCapture(a,b)};a.prototype.getAllTexturesLoaded=function(){return this.view.getAllTexturesLoaded()};a.prototype.getTextureLoaded=
function(a){return this.view.getTextureLoaded(a)};a.prototype.addExternalRenderer=function(a,b){"function"===typeof b.intersect&&this._externalIntersectionHandlers.push(b);return this.view.addExternalRenderer(a,b)};a.prototype.removeExternalRenderer=function(a){var b=this._externalIntersectionHandlers.indexOf(a);-1<b&&this._externalIntersectionHandlers.splice(b,1);return this.view.removeExternalRenderer(a)};a.prototype.getContentDebugStrings=function(a){return this.model.formatDebugInfo(a)};a.prototype.getRenderStats=
function(){return this.view.getCombinedStats()};a.prototype.getRenderStatString=function(a){var b=this.getRenderStats(),d="";if(a){var d=d+"\x3ctable\x3e",c;for(c in b)d+="\x3ctr\x3e\x3ctd\x3e"+c+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Math.round(b[c])+"\x3c/td\x3e\x3c/tr\x3e";d+="\x3c/table\x3e"}else for(c in b)d+=c+": "+b[c]+"\n";return d};a.prototype.pick=function(a,b,d,c){var e=g.create(),h=g.create();this.view.getPickRay(a,e,h);return this.pickRay(e,h,a,a,b,d,c)};a.prototype.pickRayWithBeginPoint=
function(a,b,d,c,e){this.view.pickRayWithBeginPoint(a,b,d,c,e)};a.prototype.pickRay=function(a,b,e,g,h,f,s){g=this.view.getCamera();e||(e=d,g.projectPoint(b,e));var r;if(h){r=Array(h.length);for(var A=0;A<r.length;A++)r[A]=this.model.get(k.ContentType.LAYER,h[A])}else{r=[];h=this.getViewContent();for(var w=this.model.getAll(k.ContentType.LAYER),A=0;A<h.length;A++){var D=w[h[A]];D&&"VISIBLE"===D.getState()&&r.push(D)}}s?s.init(r,a,b,e,g,this._intersectTolerance,f):s=new c(r,a,b,e,g,this._intersectTolerance,
f);for(A=0;A<this._externalIntersectionHandlers.length;A++)this._externalIntersectionHandlers[A].intersect(s,a,b,e);if(s.getHudResults().length){A=s.getHudResults();A.sort(function(a,b){return b.dist-a.dist});b=A[A.length-1];e=m;g.projectPoint(b.center,e);e[0]=Math.round(e[0]);e[1]=Math.round(e[1]);f=l;this.view.getPickRay(e,a,f);p.init(r,a,f,e,g,this._intersectTolerance,!1);for(A=0;A<this._externalIntersectionHandlers.length;A++)this._externalIntersectionHandlers[A].intersect(p,a,f,e);if(null==p.getMinResult().dist||
b.dist<=p.getMinResult().dist)s.getMinResult().set(b.object,b.name,b.dist,b.normal,b.priority),s.getMinResult().setIntersector("stage")}return s};a.prototype.getIntersectTolerance=function(){return this._intersectTolerance};a.prototype.setIntersectTolerance=function(a){void 0===a&&(a=1E-5);this._intersectTolerance=a};a.prototype.select=function(a){var b=this.pick(a,null,!0,s).getMinResult(),d=b.object;this.onGeometryPicked(d,a,b);if(d&&(a=d.getParentLayer(),d===this.model.getSelection()||a&&"PICKABLE"!==
a.getInteraction()))b=d.getFaceRangeFromTriangleNr(b.triangleNr),null==b||null!=this.model.getSelectionFaceRange()&&(JSON.stringify(b),JSON.stringify(this.model.getSelectionFaceRange()))};a.prototype.getTextureGraphicsRenderer=function(){return this.view.getTextureGraphicsRenderer()};a.prototype.debugHideFaceRange=function(a,b){var d=this.getAll("objects")[a];d.hideFaceRange(d.getGeometryRecords()[0],[d.getMetadata().faceRanges[b]])};a.prototype.debugHideAllFaceRange=function(a){a=this.getAll("objects")[a];
for(var b in a.getMetadata().faceRanges)a.hideFaceRange(a.getGeometryRecords()[0],[a.getMetadata().faceRanges[b]])};a.prototype.debugUnhideFaceRange=function(a,b){this.getAll("objects")[a].unhideAllFaceRange()};a.DebugSettings={fineGrainedContentValidation:!1,endFrameContentValidation:!1,logDirtySet:!1};a.ModelContentType=h;return a}();var d=q.create(),m=n.create(),l=g.create(),p=new c,s=new c;s.mode="select";return a})},"esri/views/3d/webgl-engine/parts/View":function(){define("require exports ../lib/GLTextureRep ../lib/GLMaterialRep ../lib/ShaderSnippets ../lib/GLSLShaderRep ../lib/TextureRenderer ../lib/Util ../lib/gl-matrix ../lib/webgl-utils ./Model ./Viewport ../materials/repository ../lib/SSAOHelperObscurance ../lib/HighlightHelper ../lib/OffscreenRenderingHelper ../lib/tracer ../../../webgl/RenderingContext ../lib/ProgramRepository".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v){var C=h.vec3d,y=h.vec4d;q=function(){function h(b,c,e,g){var l=this;this._backgroundColor=y.createFrom(1,1,1,1);this._lightDirection=C.createFrom(0,1,0);this._didRender=!1;this._idleSuspend=this._needsRender=!0;this._shouldRender=!1;this._screenCaptureQueue=[];this._container=b;this._stage=c;this._initializeContext(g);this._initializeShaders();this._textureRep=new k(c.getAll(d.ContentType.TEXTURE),this._programRepository,function(){return l._viewport.getCamera().viewport},
this._rctx);this._materialRep=new f(this._textureRep,this._programRepository);this._viewport=new m(this._programRepository,this._materialRep,this._textureRep,this._rctx);this._initializeViewportCamera();this._textureRenderer=new a(this._rctx,this._canvas,this._programRepository,this._materialRep,this._textureRep,e);this._initializeFrameTask()}h.prototype._initializeFrameTask=function(){var a=this;this._frameTask={preRender:function(){t.begin();a._stage.processDirty();a.needsRender()?(a._shouldRender=
!0,a._viewport.getCamera().setGLViewport(a._rctx),a._rctx.setClearColor.apply(a._rctx,a._backgroundColor),a._rctx.clear(16640)):a._shouldRender=!1},render:function(){a._shouldRender&&(a._didRender=!0,a._viewport.render(a._lightDirection,null))},postRender:function(){t.end()},update:function(){a._performScreenCaptures();a.resetNeedsRender()}}};h.prototype._initializeViewportCamera=function(){var a=this._container.getBoundingClientRect(),b=this._viewport.getCamera();b.viewport[2]=a.width;b.viewport[3]=
a.height;this._viewport.setCamera(b)};h.prototype._initializeContext=function(a){this._canvas=a.canvas;this._canvas||(this._canvas=document.createElement("canvas"));this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var b=g.setupWebGL(this._canvas,{alpha:a.alpha||!1,antialias:!1,depth:!0,stencil:null==a.stencil?!0:a.stencil});this._gl=t.instrumentContext(b[0]);this._rctx=new u(b[0],{disabledExtensions:a.deactivatedWebGLExtensions});this._container.appendChild(this._canvas)};
h.prototype._initializeShaders=function(){this._shaderSnippets=new c;this._shaderRep=new b;this._programRepository=new v;l.initializeShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);s.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);p.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);r.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx)};h.prototype.dispose=function(){this._viewport.dispose();
this._viewport=null;this._textureRenderer.dispose();this._textureRenderer=null;this._programRepository.dispose();this._programRepository=null;this._container.contains(this._canvas)&&this._container.removeChild(this._canvas);this._gl=this._canvas=this._container=null};h.prototype.getCombinedStats=function(){return this._viewport.getCombinedStats()};h.prototype.setNeedsRender=function(){this._didRender=!1;this._needsRender=!0};h.prototype.resetNeedsRender=function(){this._didRender&&(this._didRender=
this._needsRender=!1);this._viewport.resetNeedsRender();this._textureRep.resetNeedsRender()};h.prototype.needsRender=function(){return this._needsRender||!this._idleSuspend||this._viewport.needsRender()||this._textureRep.needsRender()};h.prototype.getFrameTask=function(){return this._frameTask};h.prototype.setLights=function(a,b){C.set(b.direction,this._lightDirection);y.set4(a.color[0],a.color[1],a.color[2],a.intensity,x.ambient);y.set4(b.color[0],b.color[1],b.color[2],b.intensity,x.diffuse);y.set4(b.color[0],
b.color[1],b.color[2],Math.min(b.intensity+a.intensity,1),x.specular);C.set(b.direction,x.direction);this._viewport.setLightingData(x);this._needsRender=!0};h.prototype.getViewParams=function(a){var b=this._viewport.getViewParams(a);if(!a||a.backgroundColor)b.backgroundColor=this._backgroundColor;return b};h.prototype.setViewParams=function(a){this._needsRender=!0;a.backgroundColor&&(this._backgroundColor=a.backgroundColor);this._viewport.setViewParams(a)};h.prototype.setRenderParams=function(a){this._needsRender=
!0;void 0!==a.idleSuspend&&(this._idleSuspend=!!a.idleSuspend);this._viewport.setRenderParams(a)};h.prototype.getRenderParams=function(){var a=this._viewport.getRenderParams();a.anisotropicFiltering=this._textureRep.getMaxAnisotropy();a.idleSuspend=this._idleSuspend;return a};h.prototype.has=function(a){return"s3tc"===a?!!this._rctx.extensions.compressedTextureS3TC:"standardDerivatives"===a?!!this._rctx.extensions.standardDerivatives:"shaderTextureLOD"===a?!!this._rctx.extensions.shaderTextureLOD:
!1};h.prototype.getFrustumObjects=function(){return this._viewport.getFrustumObjects()};h.prototype.modify=function(a,b,d,c){this._viewport.modify(a,b,d,c)};h.prototype.setSelectionObject=function(a,b){this._viewport.setSelectionObject(a,b)};h.prototype.setCamera=function(a){this._viewport.setCamera(a)};h.prototype.getCamera=function(){return this._viewport.getCamera()};h.prototype.getPickRay=function(a,b,d){this._viewport.getPickRay(a,b,d)};h.prototype.pickRayWithBeginPoint=function(a,b,d,c,e){this._viewport.pickRayWithBeginPoint(a,
b,d,c,e)};h.prototype.getCanvas=function(){return this._canvas};h.prototype.getTextureGraphicsRenderer=function(){return this._textureRenderer};h.prototype.requestScreenCapture=function(a,b){this._screenCaptureQueue.push({settings:a||{},callback:b});this._needsRender=!0};h.prototype.getAllTexturesLoaded=function(){return 0===this._textureRep.getLoadingCount()};h.prototype.getTextureLoaded=function(a){return this._textureRep.getIsLoaded(a)};h.prototype.addTextureListener=function(a){this._textureRep.addTextureListener(a)};
h.prototype.removeTextureListener=function(a){this._textureRep.removeTextureListener(a)};h.prototype.addExternalRenderer=function(a,b){return this._viewport.addExternalRenderer(a,b)?(b.initializeRenderContext({rctx:this._rctx,gl:this._rctx.gl,shaderSnippets:this._shaderSnippets,shaderRep:this._shaderRep,programRep:this._programRepository,textureRep:this._textureRep}),!0):!1};h.prototype.removeExternalRenderer=function(a){return this._viewport.removeExternalRenderer(a)?(a.uninitializeRenderContext({rctx:this._rctx,
gl:this._rctx.gl}),!0):!1};h.prototype._performScreenCaptures=function(){if(0!==this._screenCaptureQueue.length){for(var a=0;a<this._screenCaptureQueue.length;a++){var b=this._screenCaptureQueue[a],d=0,c=0,g=this._canvas.width,h=this._canvas.height,m=this._canvas.width,l=this._canvas.height;if(m=b.settings.area)d=m.x,c=m.y,g=m.width,h=m.height;void 0!==b.settings.width&&void 0!==b.settings.height?(m=b.settings.width/b.settings.height,h*m<g?(m*=h,d+=Math.floor((g-m)/2),g=Math.floor(m)):(m=g/m,c+=Math.floor((h-
m)/2),h=Math.floor(m)),m=b.settings.width,l=b.settings.height):(m=g,l=h);var p=this._canvas;if(0!==d||0!==c||g!==this._canvas.width||h!==this._canvas.height||m!==this._canvas.width||l!==this._canvas.height){this._resizeCanvas||(this._resizeCanvas=document.createElement("canvas"));this._resizeCanvas.width=m;this._resizeCanvas.height=l;var p=this._resizeCanvas.getContext("2d"),f=new Uint8Array(4*g*h);this._gl.readPixels(d,this._canvas.height-(c+h),g,h,6408,5121,f);d=p.getImageData(0,0,m,l);e.resampleHermite(f,
g,h,d.data,m,l,!0);p.putImageData(d,0,0);p=this._resizeCanvas}g={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"}[b.settings.format?b.settings.format.toLowerCase():"png"];h=1;void 0!==b.settings.quality&&(h=b.settings.quality/100);g=p.toDataURL(g,h);b.callback({dataURL:g,x:0,y:0,width:m,height:l})}this._screenCaptureQueue=[]}};return h}();var x={ambient:y.create(),diffuse:y.create(),specular:y.create(),direction:C.create()};return q})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define(["require",
"exports","./Util"],function(q,n,k){var f=function(){function c(b){this.refCnt=0;this.glMaterial=b}c.prototype.incRefCnt=function(){++this.refCnt};c.prototype.decRefCnt=function(){--this.refCnt;k.assert(0<=this.refCnt)};c.prototype.getRefCnt=function(){return this.refCnt};c.prototype.getGLMaterial=function(){return this.glMaterial};return c}();return function(){function c(b,a){this.textureRep=b;this.programRep=a;this.id2glMaterialRef={}}c.prototype.aquire=function(b){return this.aquireExt(b,"color")};
c.prototype.aquireDepthShadowMap=function(b){return this.aquireExt(b,"depthShadowMap")};c.prototype.aquireDepth=function(b){return this.aquireExt(b,"depth")};c.prototype.aquireNormal=function(b){return this.aquireExt(b,"normal")};c.prototype.aquireHighlight=function(b){return this.aquireExt(b,"highlight")};c.prototype.aquireExt=function(b,a){var c;c=b.getId()+"_"+a;var h=this.id2glMaterialRef[c],g;null==h?(g=(h=b.getGLMaterials()[a])?new h(b,this.programRep,this.textureRep):void 0,h=new f(g),this.id2glMaterialRef[c]=
h):g=h.getGLMaterial();h.incRefCnt();g&&this.increaseProgramReferences(g);return g};c.prototype.release=function(b){this.releaseExt(b,"color")};c.prototype.releaseDepth=function(b){this.releaseExt(b,"depth")};c.prototype.releaseNormal=function(b){this.releaseExt(b,"normal")};c.prototype.releaseDepthShadowMap=function(b){this.releaseExt(b,"depthShadowMap")};c.prototype.releaseHighlight=function(b){this.releaseExt(b,"highlight")};c.prototype.releaseExt=function(b,a){var c=b+"_"+a,h=this.id2glMaterialRef[c];
h.decRefCnt();if(0===h.getRefCnt()){if(h=h.getGLMaterial())this.decreaseProgramReferences(h),void 0!==h.dispose&&h.dispose();delete this.id2glMaterialRef[c]}};c.prototype.updateMaterialParameters=function(b){var a=this.id2glMaterialRef[b+"_color"];a&&a.getGLMaterial()&&this.updateParamsForMat(a.getGLMaterial());(a=this.id2glMaterialRef[b+"_depth"])&&a.getGLMaterial()&&this.updateParamsForMat(a.getGLMaterial());(b=this.id2glMaterialRef[b+"_normal"])&&b.getGLMaterial()&&this.updateParamsForMat(b.getGLMaterial())};
c.prototype.updateParamsForMat=function(b){b.updateParameters&&b.updateParameters()};c.prototype.increaseProgramReferences=function(b){if(b.getAllPrograms){b=b.getAllPrograms();for(var a=0;a<b.length;a++)this.programRep.increaseRefCount(b[a])}else this.programRep.increaseRefCount(b.getProgram())};c.prototype.decreaseProgramReferences=function(b){if(b.getAllPrograms){b=b.getAllPrograms();for(var a=0;a<b.length;a++)this.programRep.decreaseRefCount(b[a])}else this.programRep.decreaseRefCount(b.getProgram())};
return c}()})},"esri/views/3d/webgl-engine/lib/ShaderSnippets":function(){define(["require","exports","./Util","dojox/xml/parser"],function(q,n,k,f){return function(){function c(){var b=k.VertexAttrConstants,a;for(a in b)this[b[a]]=k.VertexAttrConstants[a]}c.prototype._parse=function(b){b=f.parse(b).getElementsByTagName("snippet");for(var a=/\$[a-zA-Z0-9]+[ \t]*/,c=/[\$\s]+/g,h=0;h<b.length;h++){var g=b[h].getAttribute("name");k.assert(null==this[g]);for(var d=b[h].textContent,m=void 0;null!==(m=
d.match(a));){var l=this[m[0].replace(c,"")];k.assert(void 0!==l);d=d.replace(m[0],l)}this[g]=d}};return c}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(q){q.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(n,k){var f=q.doc,c;k=k||"text/xml";if(n&&q.trim(n)&&"DOMParser"in q.global){c=(new DOMParser).parseFromString(n,k);f=c.documentElement;if("parsererror"==f.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==
f.namespaceURI){var b=f.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0];b&&(b=b.firstChild.data);throw Error("Error parsing text "+f.firstChild.data+" \n"+b);}return c}if("ActiveXObject"in q.global){f=function(a){return"MSXML"+a+".DOMDocument"};f=["Microsoft.XMLDOM",f(6),f(4),f(3),f(2)];q.some(f,function(a){try{c=new ActiveXObject(a)}catch(b){return!1}return!0});if(n&&c&&(c.async=!1,c.loadXML(n),f=c.parseError,0!==f.errorCode))throw Error("Line: "+f.line+
"\nCol: "+f.linepos+"\nReason: "+f.reason+"\nError Code: "+f.errorCode+"\nSource: "+f.srcText);if(c)return c}else if(f.implementation&&f.implementation.createDocument){if(n&&q.trim(n)&&f.createElement){b=f.createElement("xml");b.innerHTML=n;var a=f.implementation.createDocument("foo","",null);q.forEach(b.childNodes,function(b){a.importNode(b,!0)});return a}return f.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(n,k){if(1<arguments.length)return dojox.xml.parser.replaceChildren(n,
(n.ownerDocument||q.doc).createTextNode(k)),k;if(void 0!==n.textContent)return n.textContent;var f="";n&&q.forEach(n.childNodes,function(c){switch(c.nodeType){case 1:case 5:f+=dojox.xml.parser.textContent(c);break;case 3:case 2:case 4:f+=c.nodeValue}});return f};dojox.xml.parser.replaceChildren=function(n,k){var f=[];q.isIE&&q.forEach(n.childNodes,function(c){f.push(c)});dojox.xml.parser.removeChildren(n);q.forEach(f,q.destroy);q.isArray(k)?q.forEach(k,function(c){n.appendChild(c)}):n.appendChild(k)};
dojox.xml.parser.removeChildren=function(n){for(var k=n.childNodes.length;n.hasChildNodes();)n.removeChild(n.firstChild);return k};dojox.xml.parser.innerXML=function(n){return n.innerXML?n.innerXML:n.xml?n.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(n):null};return dojox.xml.parser})},"esri/views/3d/webgl-engine/lib/GLSLShaderRep":function(){define(["require","exports","./Util"],function(q,n,k){return function(){function f(){this.shaders={}}f.prototype.add=function(c,
b){k.assert(null==this.shaders[c]);this.shaders[c]=b};f.prototype.get=function(c){k.assert(void 0!==this.shaders[c]);return this.shaders[c]};return f}()})},"esri/views/3d/webgl-engine/lib/TextureRenderer":function(){define("require exports ./Renderer ./Camera ./Util ./gl-matrix ../materials/internal/TexOnlyGLMaterial ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s){var r=b.vec3d,t=b.vec4d,u=b.mat4d;q=function(){function b(a,d,c,e,g,h){this._acquiredTextures={};this._clearColor=t.createFrom(0,0,0,0);this._id2origin={};this._rctx=a;this._canvas=d;this._programRep=c;this._materialRep=e;this._textureRep=g;this._modelDirtySet=h;this._renderer=new k(c,e,g,this._rctx,!0);this._renderer.setLightingData({ambient:[1,1,1,1],diffuse:[0,0,0,0],specular:[0,0,0,0],direction:[0,-1,0]})}b.prototype.dispose=function(){for(var a in this._acquiredTextures)this._acquiredTextures[a].fbo.dispose(),
this._textureRep.release(a);this._acquiredTextures=null;this._renderer.dispose();this._renderer=null};b.prototype.addRenderGeometries=function(a){var b=this;a.forEach(function(a){null==a.origin&&(a.origin=b.getOrigin(a.center,a.bsRadius))});this._renderer.modify(a,[])};b.prototype.removeRenderGeometries=function(a){this._renderer.modify([],a)};b.prototype.updateRenderGeometries=function(a,b){var d=a.map(function(a){return{renderGeometry:a,updateType:b}});this._renderer.modify([],[],d,{})};b.prototype.updateRenderOrder=
function(a){0<Object.keys(a).length&&this._renderer.modifyRenderOrder(a)};b.prototype.setBackgroundColor=function(a){this._clearColor=a};b.prototype.isEmpty=function(){return this._renderer.isEmpty()};b.prototype.processDirtyMaterials=function(){var a=this._modelDirtySet.getDirtyMaterials();a&&this._renderer.modify([],[],[],a);this._modelDirtySet.clearDirtyMaterials()};b.prototype.draw=function(a,b){this.processDirtyMaterials();var d=a.id.toString(),c,e=this._rctx,g=e.gl;if(this._acquiredTextures[d])c=
this._acquiredTextures[d].fbo;else{var m=this._textureRep.aquire(d).getGLTexture();c=h.createWithAttachments(this._rctx,m,{colorTarget:0,depthStencilTarget:0});m=Object.keys(this._acquiredTextures).length;this._acquiredTextures[d]={texture:a,fbo:c,idx:m}}var m=b.width,l=b.height;if(c.width!==m||c.height!==l)c.resize(m,l),c.colorTexture.setSamplingMode(9729);x.near=1;x.far=1E4;e.bindFramebuffer(c);e.setDepthTestEnabled(!1);e.setBlendFunctionSeparate(770,771,1,771);e.setClearColor.apply(e,this._clearColor);
e.clear(g.COLOR_BUFFER_BIT);this._renderer.setPixelRatio(b.pixelRatio||1);for(g=0;g<b.views.length;g++)c=b.views[g],x.viewport=c.viewport,u.ortho(0,c.extent[2]-c.extent[0],0,c.extent[3]-c.extent[1],x.near,x.far,x.projectionMatrix),u.identity(x.viewMatrix),u.translate(x.viewMatrix,[-c.extent[0],-c.extent[1],0]),x.setGLViewport(this._rctx),v&&this._drawTestTexture(m,l,C[this._acquiredTextures[d].idx%C.length]),this._renderer.render(x,y);e.setDepthTestEnabled(!0);e.setBlendFunctionSeparate(770,771,1,
771);e.bindFramebuffer(null);e.setViewport(0,0,this._canvas.width,this._canvas.height)};b.prototype._drawTestTexture=function(b,c,h){var l=this._rctx,f=l.gl;if(!this._testPatternMat){for(var r=new Uint8Array(4*b*c),t=0,k=0;k<c;k++)for(var v=0;v<b;v++){var x=Math.floor(v/10),F=Math.floor(k/10);2>x||2>F||10*x>b-20||10*F>c-20?(r[t++]=255,r[t++]=255,r[t++]=255,r[t++]=255):(r[t++]=255,r[t++]=255,r[t++]=255,x&1&&F&1?r[t++]=v&1^k&1?0:255:r[t++]=x&1^F&1?0:128)}b=new e(l,{target:3553,pixelFormat:6408,dataType:5121,
samplingMode:9728,width:b,height:c},r);this._testPatternMat=new a(this._programRep,b,[1,1,1,1],!0,f.ALWAYS);this._testPatternBindParams={proj:u.identity(),view:u.identity(),nearFar:[-1,1],origin:[0,0,0]};f=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);this._quadVAO=new g(l,s.Default3D,{geometry:p.Pos3Tex},{geometry:d.createVertex(l,35044,f)})}this._testPatternMat.setColor([h[0],h[1],h[2],1]);this._testPatternMat.bind(l,this._testPatternBindParams);this._testPatternMat.bindView(l,
this._testPatternBindParams);l.bindVAO(this._quadVAO);l.drawArrays(5,0,m.vertexCount(this._quadVAO,"geometry"));this._testPatternMat.release(l)};b.prototype.getOrigin=function(a,b){var d=0,e=10*b/1E4;1<e&&(d=Math.ceil(c.logWithBase(e,2)));var e=1E4*Math.pow(2,d),g=Math.round(a[0]/e),h=Math.round(a[1]/e),m=Math.round(a[2]/e),d=d+"_"+g+"_"+h+"_"+m,l=this._id2origin[d];null==l&&(l={vec3:r.createFrom(g*e,h*e,m*e),id:d},this._id2origin[d]=l);return l};return b}();var v=!1,C=[[1,0.5,0.5],[0.5,0.5,1],[0.5,
1,0.5]],y={get:function(){return!0}},x=new f;return q})},"esri/views/3d/webgl-engine/lib/Renderer":function(){define("require exports ./IntervalUtilities ./ModelDirtyTypesTs ./Float32ArrayList ./InstanceBufferData ./Lighting ../materials/internal/SimpleGLMaterial ../materials/internal/TexOnlyGLMaterial ./LinearDepthTextureHelper ./NormalTextureHelper ./HighlightTextureHelper ./RenderPass ./RenderSlot ./RenderContext ./ExternalRendererContainer ./StencilRenderingHelper ./BitSet ./Util ./gl-matrix ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ./FxaaRenderPass ./SmaaRenderPass ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A,w,D,E,H){var G=v.assert,I=v.array2object,O=v.objectEmpty,J=v.getFirstObjectValue,F=v.setMatrixTranslation3;q=C.vec2d;n=C.vec3d;var K=C.vec4d,T=C.mat4d,R=v.VertexAttrConstants,da=T.identity();v=n.create();var S=1535,ba={proj:da,view:da,nearFar:[-1,1],origin:v};v=function(){function f(b,c,h,l,p){this._lighting=new a;this._mat2dataMerged={};this._mat2dataInstanced={};this._renderOrder=[];this._externalRenderers=new r;this._renderContext=new s;
this._framesRendered=0;this._isRendering=!1;this._pixelRatio=1;this._threshold=S;this._needsRender=!0;this._stats=new aa;this.ssaoEnabled=!1;this.renderOptions={antialiasing:"smaa",earlyOcclusionPixelDraw:!1};this._programRep=b;this._materialRep=c;this._textureRep=h;this._orderedRendering=p;this._rctx=l;c=l.gl;this._fxaaPass=new A(l);this._smaaPass=new w(l);this._selectionMaterial=new e(b,K.createFrom(0.1,0.2,0.9,0.4),c.EQUAL);this._selectionMaterialLines=new e(b,K.createFrom(0.1,0.2,0.9,0.4),c.EQUAL,
c.LINES);this._renderContext.lightingData=this._lighting.get();l.setDepthTestEnabled(!0);l.setFaceCullingEnabled(!0);l.setBlendingEnabled(!1);l.setBlendFunctionSeparate(770,771,1,771);this._bindParameters={view:null,proj:null,viewInvTransp:null,nearFar:null,lightingData:null,viewport:null,framebufferTex:null,shadowMap:null,origin:null,pixelRatio:null,instanceParameters:null,depthFBO:null,normalFBO:null,extensions:{angleInstancedArrays:l.extensions.angleInstancedArrays}};this._linearDepthTextureHelper=
new g(l);this._normalTextureHelper=new d(l);this._highlightTextureHelper=new m(l);this._stencilRenderingHelper=new t(l);this._initializeFramebufferTexture();this._initializeIeTextureFix()}f.prototype._initializeQuadVAO=function(){if(!this._quadVAO){var a=this._rctx,b=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);this._quadVAO=new x(a,H.Default3D,{geometry:E.Pos3Tex},{geometry:B.createVertex(a,35044,b)})}};f.prototype._initializeFramebufferTexture=function(){var a=this._rctx.gl,a=
this._rctx.contextAttributes.alpha?a.RGBA:a.RGB,b=new y(this._rctx,{target:3553,pixelFormat:a,dataType:5121,samplingMode:9728,wrapMode:33071,width:4,height:4});this._framebuffer={format:a,texture:b,copied:!1}};f.prototype._initializeIeTextureFix=function(){if(6408===this._framebuffer.format){for(var a=new Uint8Array(64),b=0;64>b;b++)a[b]=255;this._ieFixTexture=new y(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:4,height:4});this._ieFixMaterial=new h(this._programRep,
this._ieFixTexture,K.createFrom(1,1,1,1),!0,519)}};f.prototype.dispose=function(){for(var a in this._mat2dataMerged){this._releaseMaterials(a);var b=this._mat2dataMerged[a],d;for(d in b.origin2data)b.origin2data[d].vao.dispose(!0)}this._mat2dataMerged=null;for(a in this._mat2dataInstanced)for(d in this._releaseMaterials(a),b=this._mat2dataInstanced[a],b.origin2data)b.origin2data[d].vao.dispose(!0);this._mat2dataInstanced=null;this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null);this._ieFixTexture&&
(this._ieFixTexture.dispose(),this._ieFixTexture=null);this._framebuffer.texture.dispose();this._framebuffer.texture=null;this._linearDepthTextureHelper.getEnableState()&&this._linearDepthTextureHelper.disable();this._normalTextureHelper.getEnableState()&&this._normalTextureHelper.disable();this._highlightTextureHelper.getEnableState()&&this._highlightTextureHelper.setEnableState(!1);this._stencilRenderingHelper.getEnableState()&&this._stencilRenderingHelper.setEnableState(!1)};f.prototype.setLightingData=
function(a){this._lighting.set(a);this._needsRender=!0};f.prototype.getLightingData=function(){return this._lighting.get()};f.prototype.setPixelRatio=function(a){this._pixelRatio=a;this._needsRender=!0};f.prototype.getPixelRatio=function(){return this._pixelRatio};f.prototype.addExternalRenderer=function(a,b){this._externalRenderers.addRenderer(a,b);return!0};f.prototype.removeExternalRenderer=function(a){this._externalRenderers.removeRenderer(a);return!0};f.prototype.getExternalRenderers=function(){return this._externalRenderers};
f.prototype.resetNeedsRender=function(){this._needsRender=!1;this._externalRenderers.resetNeedsRender()};f.prototype.needsRender=function(){return this._needsRender||this._externalRenderers.needsRender()};f.prototype.getCombinedStats=function(){this._stats.VBOallocatedSize=0;this._stats.VBOoptimalSize=0;this._stats.VBOusedSize=0;for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],d;for(d in b.origin2data){var c=b.origin2data[d];this._stats.VBOallocatedSize+=c.buffer.getArray().length;
this._stats.VBOusedSize+=c.buffer.getSize();this._stats.VBOoptimalSize+=c.optimalCount}}for(a in this._mat2dataMerged)for(d in b=this._mat2dataMerged[a],b.origin2data)c=b.origin2data[d],this._stats.VBOallocatedSize+=c.buffer.getArray().length,this._stats.VBOusedSize+=c.buffer.getSize(),this._stats.VBOoptimalSize+=c.optimalCount;this._stats.VBOallocatedSize*=0.00390625;this._stats.VBOusedSize*=0.00390625;this._stats.VBOoptimalSize*=0.00390625;return this._stats};f.prototype.setSelectionObject=function(a,
b){a?(Array.isArray(a)?this._selectionIndices=this._name2indices(I(a)):this._selectionIndices=this._name2indices(I([a])),this._selectionFaceIndexRange=void 0,null!=b&&1===b.length&&(this._selectionFaceIndexRange=[[3*b[0][0],3*b[0][1]]])):this._selectionFaceIndexRange=this._selectionIndices=void 0;this._needsRender=!0};f.prototype.renderGeometrySlots=function(a){this._externalRenderers.render(p.INTERNAL_MATERIAL,a);this._renderInternalSlot(p.STENCIL_MATERIAL,a);this._externalRenderers.render(p.OPAQUE_TERRAIN,
a);this._renderInternalSlot(p.OPAQUE_MATERIAL,a);this._externalRenderers.render(p.OPAQUE_EXTERNAL,a);this._renderInternalSlot(p.TRANSPARENT_MATERIAL,a);this.renderOptions.earlyOcclusionPixelDraw&&this._renderInternalSlot(p.OCCLUSION_PIXELS,this._renderContext);this._externalRenderers.render(p.TRANSPARENT_EXTERNAL,a);this._externalRenderers.render(p.TRANSPARENT_TERRAIN,a)};f.prototype._renderHighlights=function(a,b,d,c){var e=!!c&&c.getEnableState()&&void 0!==this._selectionIndices;this._highlightTextureHelper.setEnableState(e);
e&&(this._highlightTextureHelper.setupFBOs(a),this._highlightTextureHelper.prepareHighlightPass(),this.renderGeometryPass(l.MATERIAL_HIGHLIGHT,a,b,this._selectionIndices,this._selectionFaceIndexRange),this._rctx.clear(this._rctx.gl.DEPTH_BUFFER_BIT),this._renderInternalSlot(p.OVERLAY,this._renderContext),this._highlightTextureHelper.finish(d),b=this._highlightTextureHelper.getHighlightFBO(),c.render(a,d,b))};f.prototype._renderUnordered=function(a,b,d,c,e,g,h){var m=this._rctx;this._isRendering=!0;
this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(a.projectionMatrix);this._renderContext.pass=l.MATERIAL;this._renderContext.camera=a;this._renderContext.shadowMap=d;this._renderContext.ssaoHelper=c;this._renderContext.offscreenRenderingHelper=g;this._renderContext.stencilRenderingHelper=this._stencilRenderingHelper;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.highlight=
this._highlightTextureHelper.getHighlightFBO();this._renderContext.visibleContent=b;this._renderContext.filterContent=null;this._renderContext.filterFaceRange=null;this._renderContext.options=this.renderOptions;g.setEnableState(!0);g.initializeFrame(a);this._externalRenderers.render(p.BACKGROUND,this._renderContext);this.renderGeometrySlots(this._renderContext);this._externalRenderers.render(p.POSTPROCESSING_ATMOSPHERE,this._renderContext);switch(this.renderOptions.antialiasing){case "none":d=a.viewport;
d=T.ortho(d[0],d[2],d[1],d[3],-1,1);g.drawQuad(d);this._fxaaPass.disable();this._smaaPass.disable();break;case "fxaa":this._smaaPass.disable();this._fxaaPass.render({colorTexture:g.getColorTexture()},null);break;case "smaa":this._fxaaPass.disable(),this._smaaPass.render({colorTexture:g.getColorTexture()},null)}this.renderOptions.earlyOcclusionPixelDraw||(g.bindFramebuffer(),this._renderInternalSlot(p.OCCLUSION_PIXELS,this._renderContext));m.bindFramebuffer(null);this._renderContext.framebufferTex=
g.getColorTexture();this._renderInternalSlot(p.OVERLAY,this._renderContext);this._renderHighlights(a,b,e,h);this._ieFixMaterial&&!e&&(m.setBlendFunctionSeparate(0,1,1,0),this._ieFixMaterial.bind(m,ba),this._ieFixMaterial.bindView(m,ba),this._initializeQuadVAO(),m.bindVAO(this._quadVAO),m.drawArrays(5,0,z.vertexCount(this._quadVAO,"geometry")),this._ieFixMaterial.release(m),m.setBlendFunctionSeparate(770,771,1,771));this._framesRendered++;this._isRendering=!1};f.prototype._renderOrdered=function(a,
b){var d=this._rctx;this._isRendering=!0;this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(a.projectionMatrix);this._bindParameters.view=a.viewMatrix;this._bindParameters.proj=a.projectionMatrix;this._bindParameters.viewInvTransp=a.viewInverseTransposeMatrix;Z[0]=a.near;Z[1]=a.far;this._bindParameters.nearFar=Z;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=a.fullViewport;this._bindParameters.framebufferTex=this._framebuffer.texture;this._bindParameters.pixelRatio=
this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();this._bindParameters.normalFBO=this._normalTextureHelper.getNormalFBO();for(var c=!0,e=0;e<this._renderOrder.length;e++){var g=this._renderOrder[e][1];if(g.instanced){var h=g.instanced,m=h[l.MATERIAL];if(m&&(!m.isVisible||m.isVisible()))this._renderInternalInstanced(h,m,this._bindParameters,Infinity,b,null,null,!1),c=!0}if(g.merged&&(h=g.merged,(m=h[l.MATERIAL])&&
(!m.isVisible||m.isVisible())))c&&(c=m.getProgram(),d.bindProgram(c),c.setUniformMatrix4fv("model",da),c.hasUniform("modelNormal")&&c.setUniformMatrix4fv("modelNormal",da),c=!1),this._renderInternalMerged(h,m,this._bindParameters,Infinity)}this._framesRendered++;this._isRendering=!1};f.prototype.render=function(a,b,d,c,e,g,h){this._orderedRendering?this._renderOrdered(a,b):this._renderUnordered(a,b,d,c,e,h,g)};f.prototype.renderAuxiliaryBuffers=function(a,b,d,c,e,g,h){h=this.ssaoEnabled||this._externalRenderers.needsDepthMap();
this._linearDepthTextureHelper.setEnableState(h);h&&(this._linearDepthTextureHelper.setupFBOs(a),this._linearDepthTextureHelper.prepareDepthPass(),this.renderGeometryPass(l.MATERIAL_DEPTH,a,b,void 0,void 0,d,c),this._linearDepthTextureHelper.finish(g));this._normalTextureHelper.setEnableState(this.ssaoEnabled);this.ssaoEnabled&&(this._normalTextureHelper.setupFBOs(a),this._normalTextureHelper.prepareNormalPass(),this.renderGeometryPass(l.MATERIAL_NORMAL,a,b,void 0,void 0,d,c),this._normalTextureHelper.finish(g));
this.ssaoEnabled&&c.computeSSAO(a,g,e,this._linearDepthTextureHelper.getDepthFBO(),this._normalTextureHelper.getNormalFBO());c.bindAll(this._programRep)};f.prototype.renderGeometryPass=function(a,b,d,c,e,g,h){this._isRendering=!0;this._updateGlobalUniforms(b.projectionMatrix);this._renderContext.pass=a;this._renderContext.camera=b;this._renderContext.shadowMap=g;this._renderContext.ssaoHelper=h;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();
this._renderContext.visibleContent=d;this._renderContext.filterContent=c;this._renderContext.filterFaceRange=e;this._renderContext.rctx=this._rctx;this.renderGeometrySlots(this._renderContext);this._isRendering=!1};f.prototype.renderSelection=function(a){this._isRendering=!0;for(var b=0;b<p.MAX_SLOTS;++b)this._renderInternalSlot(b,a);this._isRendering=!1};f.prototype._renderInternalSlot=function(a,b){this._bindParameters.view=b.camera.viewMatrix;this._bindParameters.proj=b.camera.projectionMatrix;
this._bindParameters.viewInvTransp=b.camera.viewInverseTransposeMatrix;this._bindParameters.cameraAboveGround=b.camera.aboveGround;Z[0]=b.camera.near;Z[1]=b.camera.far;this._bindParameters.nearFar=Z;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=b.camera.fullViewport;this._bindParameters.framebufferTex=this._renderContext.offscreenRenderingHelper?this._renderContext.offscreenRenderingHelper.getColorTexture():this._framebuffer.texture;this._bindParameters.shadowMap=
b.shadowMap;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();for(var d in this._mat2dataInstanced){var c=this._mat2dataInstanced[d],e=c[b.pass];e&&(e.beginSlot(a)&&(!e.isVisible||e.isVisible()))&&this._renderInternalInstanced(c,e,this._bindParameters,a,b.visibleContent,b.filterContent,b.filterFaceRange,!1)}if(b.filterContent)for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],
(e=c[b.pass])&&(e.beginSlot(a)&&(!e.isVisible||e.isVisible()))&&this._renderInternalInstanced(c,e,this._bindParameters,a,null,b.filterContent,b.filterFaceRange,!0);else{for(var c=this._programRep.getProgramsUsingUniform("model"),e=this._programRep.getProgramsUsingUniform("modelNormal"),g=0;g<c.length;g++){var h=c[g];h.setUniformMatrix4fv("model",da);-1<e.indexOf(h)&&h.setUniformMatrix4fv("modelNormal",da)}for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],(e=c[b.pass])&&(e.beginSlot(a)&&(!e.isVisible||
e.isVisible()))&&this._renderInternalMerged(c,e,this._bindParameters,a)}this._stencilRenderingHelper.getEnableState()&&a===p.STENCIL_MATERIAL&&this._stencilRenderingHelper.prepareStencilDisabledPass()};f.prototype._renderInternalInstanced=function(a,b,d,c,e,g,h,m){var l=this._rctx,f=l.gl,s=!1,r=b.getDrawMode(l),t=this._bindParameters.extensions.angleInstancedArrays,k;for(k in a.origin2data){var u=a.origin2data[k];d.origin=u.origin;c===p.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),
this._stencilRenderingHelper.prepareStencilWritePass());var v=!1;if(b.instanced)for(var x in u.perGeometryDataInfo){var F=u.perGeometryDataInfo[x];s||(b.bind(l,d),s=!0);l.bindVAO(F.vao);var G=b.getProgram();z.assertCompatibleVertexAttributeLocations(F.vao,G);v||(b.bindView(l,d),v=!0);var G=F.to-F.from,C=F.refCount;r===f.TRIANGLES&&(this._stats.trianglesRendered+=C*G/3);t.drawArraysInstancedANGLE(r,F.from,G,C);this._stats.drawCallsAngleInstanced++;this._stats.instancesDrawnAngle+=C}else{var F=u.instances,
w;for(w in F){var G=F[w],C=G.idx,A=G.displayedIndexRange;h&&(A=h);if(!(A&&0===A.length)&&!(e&&!e.get(C)||g&&!g.get(C)))s||(b.bind(l,d),s=!0),v||(l.bindVAO(u.vao),b.bindView(l,d),v=!0),m||b.bindInstance(l,G),this._stats.drawCallsInstanced++,r===f.TRIANGLES&&(this._stats.trianglesRendered+=(G.to-G.from)/3),A?this._drawArraysFaceRange(A,G.from,r):l.drawArrays(r,G.from,G.to-G.from)}}}l.bindVAO(null);s&&b.release(l,d)};f.prototype._drawArraysFaceRange=function(a,b,d){for(var c=this._rctx,e=0;e<a.length;e++){var g=
a[e];c.drawArrays(d,g[0]+b,g[1]-g[0]+1)}this._stats.drawCallsFragmented+=a.length-1};f.prototype._renderInternalMerged=function(a,b,d,c){var e=this._rctx,g=e.gl,h=!1,m;for(m in a.origin2data){var l=a.origin2data[m];d.origin=l.origin;c===p.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());if(!(l.displayedIndexRange&&0===l.displayedIndexRange.length)){h||(b.bind(e,d),h=!0);var f=b.getProgram();e.bindVAO(l.vao);z.assertCompatibleVertexAttributeLocations(l.vao,
f);b.bindView(e,d);this._stats.drawCallsMerged++;f=b.getDrawMode(e);f===g.TRIANGLES&&(this._stats.trianglesRendered+=l.vao.vertexBuffers.geometry.size/3);l.displayedIndexRange?this._drawArraysFaceRange(l.displayedIndexRange,0,f):e.drawArrays(f,0,z.vertexCount(l.vao,"geometry"))}}h&&b.release(e,d)};f.prototype._updateGlobalUniforms=function(a){for(var b=this._programRep.getProgramsUsingUniform("proj"),d=0;d<b.length;d++)b[d].setUniformMatrix4fv("proj",a);if(this._lighting){b=this._programRep.getProgramsUsingUniform("lightDirection");
for(d=0;d<b.length;d++)this._lighting.setUniforms(b[d])}};f.prototype.print=function(){var a=Object.keys(this._mat2dataMerged).length,b=Object.keys(this._mat2dataInstanced).length;console.log("number of materials (merged/instanced): "+a+"/"+b);var a=0,d;for(d in this._mat2dataMerged){var b=this._mat2dataMerged[d],c;for(c in b.origin2data)a+=Object.keys(b.origin2data[c].instances).length}var e=0;for(d in this._mat2dataInstanced)for(c in b=this._mat2dataInstanced[d],b.origin2data)e+=Object.keys(b.origin2data[c].instances).length;
console.log("number of instances (merged/instanced): "+a+"/"+e)};f.prototype.isEmpty=function(){for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],d;for(d in b.origin2data)if(!O(b.origin2data[d].instances))return!1}for(a in this._mat2dataMerged)for(d in b=this._mat2dataMerged[a],b.origin2data)if(!O(b.origin2data[d].instances))return!1;return!0};f.prototype.modify=function(a,b,d,c){this._isRendering&&console.warn("Renderer.modify called while rendering");var e=[],g=[];this._mergedOrInstanced(a,
e,g);a=[];var h=[];this._mergedOrInstanced(b,a,h);b={};d&&this._performUpdates(d,b);d=[];this._modifyMerged(e,a,d,b);this._modifyInstanced(g,h,d);this._updateMergedFaceranges(b);this._releaseMaterials(d);this._modifyMaterials(c);this._needsRender=!0};f.prototype._isInstanced=function(a){var b=!1,d=J(a.data.faces.indices).length,b=(b=(b=b||!1===a.material.canBeMerged)||a.material.instanced)||a.material.isBackdrop;return a.singleUse?b:b=b||d>this._threshold};f.prototype._mergedOrInstanced=function(a,
b,d){for(var c=0;c<a.length;++c)1>J(a[c].data.faces.indices).length||(this._isInstanced(a[c])?d.push(a[c]):b.push(a[c]))};f.prototype._performUpdates=function(a,b){for(var d=0;d<a.length;d++){var c=a[d],e=c.renderGeometry,g=this._isInstanced(e),c=c.updateType;c&2&&this._updateFaceranges(e,g,b);c&4||!g&&c&16?this._updateVertexAttributes(e,g):g&&c&16?this._updateInstanceTransformation(e,g):c&8&&this._updateColorAttributes(e)}};f.prototype._updateFaceranges=function(a,b,d){var c=a.material.getId(),e=
a.origin.id,g=(b?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[e],h=g.instances[a.uniqueName];h&&(h.displayedIndexRange=a.displayedIndexRange,b||(d[this._modifiedMergedFacerangesKey(c,e)]=g))};f.prototype._updateMergedFaceranges=function(a){for(var b in a){var d=a[b];d.displayedIndexRange=[];var c=d.instances,e=!0,g;for(g in c){var h=c[g];h.displayedIndexRange?(d.displayedIndexRange.push.apply(d.displayedIndexRange,k.offsetIntervals(h.displayedIndexRange,h.from)),e=!1):d.displayedIndexRange.push([h.from,
h.to-1])}d.displayedIndexRange=e?null:k.mergeIntervals(d.displayedIndexRange)}};f.prototype._updateVertexAttributes=function(a,b){var d=a.material,c=d.getId(),c=(b?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[a.origin.id],e=c.instances[a.uniqueName],g,h;b||(g=a.origin.vec3,F(M,-g[0],-g[1],-g[2]),T.multiply(M,a.transformation,V),T.inverse(V,L),T.transpose(L),g=V,h=L);var m=z.getStride(d.getVertexBufferLayout()),l=m/4;G(e.from+d.getOutputAmount(J(a.data.faces.indices).length)/l===e.to,
"material VBO layout has changed");d.fillInterleaved(a.data,g,h,a.instanceParameters,c.buffer.getArray(),e.from*l);c.vao.vertexBuffers.geometry.setSubData(c.buffer.getArray(),e.from*m,e.from*m,e.to*m)};f.prototype._updateInstanceTransformation=function(a,b){var d=a.origin.vec3,c=(b?this._mat2dataInstanced:this._mat2dataMerged)[a.material.getId()].origin2data[a.origin.id],e=c.instances[a.uniqueName];F(M,-d[0],-d[1],-d[2]);T.multiply(M,a.transformation,e.transformation);T.inverse(e.transformation,e.transformationNormal);
T.transpose(e.transformationNormal,e.transformationNormal);d=c.perGeometryDataInfo[a.data.id];if(c=d.instanceBufferData){var g=c.getSlot(a.idx);c.fill(g,0,e.transformation);c.fill(g,16,e.transformationNormal);e=4*c.getOffset(g);g=z.getStride(d.vao.layout.instance);d.vao.vertexBuffers.instance.setSubData(c.getArray(),e,e,e+g)}};f.prototype._updateColorAttributes=function(a){var b=a.material,d=b.getId(),c=a.origin.id,d=(this._isInstanced(a)?this._mat2dataInstanced:this._mat2dataMerged)[d].origin2data[c],
c=d.instances[a.uniqueName],e={};e[R.COLOR]=!0;var g=z.getStride(b.getVertexBufferLayout())/4;G(c.from+b.getOutputAmount(J(a.data.faces.indices).length)/g===c.to,"material VBO layout has changed");b.fillInterleaved(a.data,void 0,void 0,a.instanceParameters,d.buffer.getArray(),c.from*g,e);d.vao.vertexBuffers.geometry.setSubData(d.buffer.getArray(),4*c.from*g,4*c.from*g,4*c.to*g)};f.prototype._modifyMerged=function(a,b,d,e){var g=this._rctx;a=this._compMat2delta(a,b,!1);for(var h in a){b=a[h];for(var m in b){var f=
b[m],p=f.optimalCount,s=f.material,r=s.getVertexBufferLayout(),t=z.getStride(r)/4,k=this._mat2dataMerged[h];if(null==k){G(0<p);var u=s.getRenderPriority(),k={origin2data:{}};k[l.MATERIAL]=this._materialRep.aquire(s);k[l.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(s);k[l.MATERIAL_NORMAL]=this._materialRep.aquireNormal(s);k[l.MATERIAL_DEPTH]=this._materialRep.aquireDepth(s);k[l.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(s);this._mat2dataMerged[h]=k;this._orderedRendering&&
this._insertIntoRenderOrder(k,u,"merged")}u=k.origin2data[m];null==u&&(G(0<p),u={instances:{},vao:new x(g,H.Default3D,{geometry:r},{geometry:B.createVertex(g,35044)}),buffer:new c(p),optimalCount:0,origin:f.origin},k.origin2data[m]=u);if(0<p){var r=u.buffer.getSize(),v=u.buffer.getArray(),k=p<f.sparseCount/2,C=u.buffer.resize(k?p:f.sparseCount),w=f.toRemove;if(k||C){for(var r=0,A=u.buffer.getArray(),k=0,y=w.length;k<y;++k)C=u.instances[w[k].uniqueName],u.optimalCount-=(C.to-C.from)*t,delete u.instances[w[k].uniqueName];
var k={},E;for(E in u.instances)C=u.instances[E],G(null==k[C.from]),k[C.from]=C;for(var D in k){var C=k[D],y=C.from*t,K=C.to*t;A.set(v.subarray(y,K),r);C.from=r/t;r+=K-y;C.to=r/t}G(r===u.optimalCount)}else{k=0;for(C=w.length;k<C;++k)v=w[k].uniqueName,G(void 0!==u.instances[v]),y=u.instances[v].from*t,K=u.instances[v].to*t,u.buffer.erase(y,K),delete u.instances[v],u.optimalCount-=K-y}F(M,-f.origin[0],-f.origin[1],-f.origin[2]);w=f.toAdd;f=!1;k=0;for(v=w.length;k<v;++k)y=w[k],K=y.data,T.multiply(M,
y.transformation,V),T.inverse(V,L),T.transpose(L),C=r,s.fillInterleaved(K,V,L,y.instanceParameters,u.buffer.getArray(),r),K=s.getOutputAmount(J(K.faces.indices).length),A=C+K,G(null==u.instances[y.uniqueName]),C=new $(y.name,C/t,A/t,y.displayedIndexRange,void 0,void 0,y.idx),y.displayedIndexRange&&(f=!0),u.instances[y.uniqueName]=C,u.optimalCount+=K,r+=K;G(u.optimalCount===p);p=new Float32Array(u.buffer.getArray().buffer,0,u.buffer.getSize());u.vao.vertexBuffers.geometry.setData(p);if(f||u.displayedIndexRange)e[this._modifiedMergedFacerangesKey(h,
m)]=u}else G(0===p),u.vao.dispose(!0),u.vao=null,delete k.origin2data[m],0===Object.keys(k.origin2data).length&&(d.push(h),delete this._mat2dataMerged[h],this._orderedRendering&&this._removeFromRenderOrder(k,"merged"))}}};f.prototype._modifyInstanced=function(a,d,e){a=this._compMat2delta(a,d,!0);d=this._rctx;for(var g in a){var h=a[g],m;for(m in h){var f=h[m];if(0===f.optimalCount)f=this._mat2dataInstanced[g],f.origin2data[m].vao.dispose(!0),delete f.origin2data[m],0===Object.keys(f.origin2data).length&&
(e.push(g),delete this._mat2dataInstanced[g],this._orderedRendering&&this._removeFromRenderOrder(f,"instanced"));else{var p=f.material,s=this._mat2dataInstanced[g];if(null==s){var r=p.getRenderPriority(),s={origin2data:{}};s[l.MATERIAL]=this._materialRep.aquire(p);s[l.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(p);s[l.MATERIAL_NORMAL]=this._materialRep.aquireNormal(p);s[l.MATERIAL_DEPTH]=this._materialRep.aquireDepth(p);s[l.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(p);
this._mat2dataInstanced[g]=s;this._orderedRendering&&this._insertIntoRenderOrder(s,r,"instanced")}var t=p.getVertexBufferLayout(),k=s[l.MATERIAL].instanced?p.getInstanceBufferLayout():void 0,u=k&&z.hasAttribute(k,"instanceColor"),v=z.getStride(t)/4,r=s.origin2data[m];null==r&&(r={instances:{},vao:new x(d,H.Default3D,{geometry:t},{geometry:B.createVertex(d,35044)}),buffer:new c(f.optimalCount),optimalCount:0,perGeometryDataInfo:{},origin:f.origin},s.origin2data[m]=r);var s=r.buffer.getSize(),C=r.buffer.getArray(),
w=f.optimalCount<f.sparseCount/2,y=r.buffer.resize(w?f.optimalCount:f.sparseCount),A;for(A in f.perGeometryDelta){var E=r.perGeometryDataInfo[A];if(E&&E.instanceBufferData){var D=f.perGeometryDelta[A].removeCount;0<D&&E.instanceBufferData.prepareFree(D)}}var K=f.toRemove;if(w||y){w=0;for(s=K.length;w<s;++w){y=K[w];delete r.instances[y.uniqueName];A=y.data.id;var n=E=r.perGeometryDataInfo[A];0===--n.refCount&&null==f.dataId2refCount[A]?(r.optimalCount-=(n.to-n.from)*v,delete r.perGeometryDataInfo[A]):
E.instanceBufferData&&E.instanceBufferData.free(y.idx)}var s=0,w=r.buffer.getArray(),y={},I;for(I in r.perGeometryDataInfo)n=r.perGeometryDataInfo[I],G(null==y[n.from]),y[n.from]=n;for(name in y)n=y[name],D=n.from*v,E=n.to*v,w.set(C.subarray(D,E),s),n.from=s/v,s+=E-D,n.to=s/v;for(name in r.instances)D=r.instances[name],D.from=r.perGeometryDataInfo[D.dataId].from,D.to=r.perGeometryDataInfo[D.dataId].to}else{w=0;for(C=K.length;w<C;++w)y=K[w],delete r.instances[y.uniqueName],A=y.data.id,E=r.perGeometryDataInfo[A],
0===--E.refCount&&null==f.dataId2refCount[A]?(D=E.from*v,E=E.to*v,r.buffer.erase(D,E),r.optimalCount-=E-D,delete r.perGeometryDataInfo[A]):E.instanceBufferData&&E.instanceBufferData.free(y.idx)}F(M,-f.origin[0],-f.origin[1],-f.origin[2]);for(A in f.perGeometryDelta)if((E=r.perGeometryDataInfo[A])&&E.instanceBufferData)w=f.perGeometryDelta[A].addCount,0<w&&E.instanceBufferData.prepareAllocate(w);C=f.toAdd;w=0;for(K=C.length;w<K;++w){y=C[w];D=y.data;A=D.id;E=r.perGeometryDataInfo[A];null==E?(p.fillInterleaved(D,
void 0,void 0,void 0,r.buffer.getArray(),s),n=p.getOutputAmount(J(D.faces.indices).length),D=s/v,s+=n,E=s/v,r.optimalCount+=n,E={refCount:1,from:D,to:E,vao:null,instanceBufferData:null},k&&(D=z.getStride(k)/4,E.vao=new x(d,H.Default3D,{geometry:t,instance:k},{geometry:r.vao.vertexBuffers.geometry,instance:B.createVertex(d,35044)}),E.instanceBufferData=new b(D,f.perGeometryDelta[A].addCount)),r.perGeometryDataInfo[A]=E):++E.refCount;G(E.from*v<=r.buffer.getSize()&&E.to*v<=r.buffer.getSize());D=T.create();
T.multiply(M,y.transformation,D);D=new $(y.name,E.from,E.to,y.displayedIndexRange,D,y.instanceParameters,y.idx,A);if(E=E.instanceBufferData)n=E.allocate(y.idx),E.fill(n,0,D.transformation),E.fill(n,16,D.transformationNormal),u&&E.fill(n,32,y.instanceParameters.color);r.instances[y.uniqueName]=D}G(r.optimalCount===f.optimalCount);p=new Float32Array(r.buffer.getArray().buffer,0,r.buffer.getSize());r.vao.vertexBuffers.geometry.setData(p);for(A in r.perGeometryDataInfo)if(t=r.perGeometryDataInfo[A],t.vao&&
(p=t.vao.vertexBuffers.instance))k=f.perGeometryDelta[A],0<k.addCount+k.removeCount&&(t=t.instanceBufferData.compact(),p.setData(t))}}}};f.prototype._compMat2delta=function(a,b,d){var c={};this._updateMat2delta(a,!0,d,c);this._updateMat2delta(b,!1,d,c);return c};f.prototype._updateMat2delta=function(a,b,d,c){for(var e=0,g=a.length;e<g;++e){var h=a[e],m=h.origin,l=h.material,f=l.getId(),p=d?this._mat2dataInstanced[f]:this._mat2dataMerged[f],p=p&&p.origin2data[m.id],s=c[f];null==s&&(s={},c[f]=s);f=
s[m.id];if(null==f){f={optimalCount:null==p?0:p.optimalCount,sparseCount:null==p?0:p.buffer.getSize(),material:l,toAdd:[],toRemove:[],perGeometryDelta:null,origin:m.vec3};if(d){var r={};if(void 0!==p)for(var t in p.perGeometryDataInfo)r[t]=p.perGeometryDataInfo[t].refCount;f.dataId2refCount=r;f.perGeometryDelta={}}s[m.id]=f}m=l.getOutputAmount(J(h.data.faces.indices).length);d?(l=h.data.id,p=f.perGeometryDelta[l],p||(p={addCount:0,removeCount:0},f.perGeometryDelta[l]=p),b?(p.addCount++,null==f.dataId2refCount[l]&&
(f.dataId2refCount[l]=0),1===++f.dataId2refCount[l]&&(f.optimalCount+=m,f.sparseCount+=m),f.toAdd.push(h)):(p.removeCount++,0===--f.dataId2refCount[l]&&(delete f.dataId2refCount[l],f.optimalCount-=m),f.toRemove.push(h))):b?(f.optimalCount+=m,f.sparseCount+=m,f.toAdd.push(h)):(f.optimalCount-=m,f.toRemove.push(h))}};f.prototype._modifiedMergedFacerangesKey=function(a,b){return a+"_"+b};f.prototype._insertIntoRenderOrder=function(a,b,d){for(var c=a[l.MATERIAL].getMaterialId(),e=this._renderOrder.length,
g=0;g<e&&this._renderOrder[g][0]>=b;){var h=this._renderOrder[g][1];if(h.id===c){G(!h[d],"matData for type already exists");h[d]=a;return}g++}c={id:c,instanced:null,merged:null};c[d]=a;this._renderOrder.splice(g,0,[b,c])};f.prototype._removeFromRenderOrder=function(a,b){for(var d=a[l.MATERIAL].getMaterialId(),c=0;this._renderOrder[c][1].id!==d;)c++;d=this._renderOrder[c][1];d[b]=null;!d.instanced&&!d.merged&&this._renderOrder.splice(c,1)};f.prototype._updateRenderOrder=function(a,b){for(var d=b.length,
c=0;c<d&&b[c][1].id!==a;)c++;if(c<d){var e=b[c][1],e=(e.merged||e.instanced)[l.MATERIAL].getRenderPriority(),g=b[c][0];if(e!==b[c][0]){b[c][0]=e;g=e>g?-1:1;for(c+=g;-1<c&&c<d&&g*b[c][0]>g*e;){var h=b[c];b[c]=b[c-g];b[c-g]=h;c+=g}}}};f.prototype._modifyMaterials=function(a){for(var b in a)this._materialRep.updateMaterialParameters(b)};f.prototype.modifyRenderOrder=function(a){if(this._orderedRendering){for(var b in a)this._updateRenderOrder(b,this._renderOrder);this._needsRender=!0}};f.prototype._releaseMaterials=
function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._materialRep.release(a[b]),this._materialRep.releaseDepthShadowMap(a[b]),this._materialRep.releaseNormal(a[b]),this._materialRep.releaseDepth(a[b]),this._materialRep.releaseHighlight(a[b]);else this._materialRep.release(a),this._materialRep.releaseDepthShadowMap(a),this._materialRep.releaseNormal(a),this._materialRep.releaseDepth(a),this._materialRep.releaseHighlight(a)};f.prototype._name2indices=function(a){for(var b=new u,d=0;2>d;++d){var c=
0===d?this._mat2dataMerged:this._mat2dataInstanced,e;for(e in c){var g=c[e].origin2data,h;for(h in g){var m=g[h].instances,l;for(l in m){var f=m[l];void 0!==a[f.name]&&b.set(f.idx)}}}}return b};return f}();var aa=function(){function a(){this.reset()}a.prototype.reset=function(){this.VBOusedSize=this.VBOoptimalSize=this.VBOallocatedSize=this.instancesDrawnAngle=this.drawCallsFragmented=this.drawCallsMerged=this.drawCallsAngleInstanced=this.drawCallsInstanced=this.trianglesRendered=0};return a}(),$=
function(){return function(a,b,d,c,e,g,h,m){this.name=a;this.from=b;this.to=d;this.displayedIndexRange=c;this.transformation=e;this.instanceParameters=g;this.idx=h;this.dataId=m;null!=e&&(this.transformationNormal=T.create(),T.set(e,this.transformationNormal),T.inverse(this.transformationNormal,this.transformationNormal),T.transpose(this.transformationNormal,this.transformationNormal))}}(),Z=q.create(),M=T.identity(),V=T.create(),L=T.create();return v})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require",
"exports"],function(q,n){return function(){function k(){}k.copyIntervals=function(f){for(var c=[],b=0;b<f.length;b++){var a=f[b];c.push([a[0],a[1]])}return c};k.convertFaceToIndexRange=function(f,c){for(var b=0;b<f.length;b++){var a=f[b];a[0]*=c;a[1]=a[1]*c+(c-1)}};k.sortIntervals=function(f){return f.sort(function(c,b){return c[0]===b[0]?c[1]>b[1]?1:c[1]<b[1]?-1:0:c[0]>b[0]?1:c[0]<b[0]?-1:0})};k.intersectIntervals=function(f,c){if(0>=f.length)return[];for(var b=[],a=0;a<f.length;a++){var e=f[a];
e[1]<c[0]||e[0]>c[1]||(e=[e[0],e[1]],e[0]<c[0]&&(e[0]=c[0]),e[1]>c[1]&&(e[1]=c[1]),b.push(e))}return b};k.mergeIntervals=function(f){if(0>=f.length)return[];var c=[];f=this.sortIntervals(f);c.push(f[0]);for(var b=1;b<f.length;b++){var a=c[c.length-1];a[1]+1<f[b][0]?c.push(f[b]):a[1]<f[b][1]&&(a[1]=f[b][1],c.pop(),c.push(a))}return c};k.invertIntervals=function(f,c){for(var b=[],a=0,e=0;e<f.length;e++){var h=f[e];h[0]>a&&b.push([a,h[0]-1]);a=h[1]+1}a<=c&&b.push([a,c]);return b};k.offsetIntervals=function(f,
c){for(var b=[],a=0;a<f.length;a++){var e=f[a];b.push([e[0]+c,e[1]+c])}return b};return k}()})},"esri/views/3d/webgl-engine/lib/Float32ArrayList":function(){define(["require","exports","./Util"],function(q,n,k){return function(){function f(c){null==c?c=16:65536>c&&(c=k.nextHighestPowerOfTwo(c));this.array=new Float32Array(c);this.size=0}f.prototype.resize=function(c,b){void 0===b&&(b=!1);this.size=c;var a,e;if(this.size>this.array.length){for(a=this.array.length||1;a<this.size;)a*=2;e=new Float32Array(a);
b&&e.set(this.array);this.array=e;return!0}if(this.size<=this.array.length/2){a=this.array.length;for(e=2*this.size;a>=e;)a/=2;e=new Float32Array(a);b&&e.set(this.array.subarray(0,a));this.array=e;return!0}return!1};f.prototype.append=function(c){var b=this.size;this.resize(this.size+c.length,!0);this.array.set(c,b)};f.prototype.erase=function(c,b){for(var a=c;a<b;++a)this.array[a]=0};f.prototype.getArray=function(){return this.array};f.prototype.getSize=function(){return this.size};return f}()})},
"esri/views/3d/webgl-engine/lib/InstanceBufferData":function(){define(["require","exports","./Util"],function(q,n,k){return function(){function f(c,b){b=null==b?4*c:k.nextHighestPowerOfTwo(b*c);this.array=new Float32Array(b);this.zeroItem=new Float32Array(c);this.endSlot=0;this.instanceDataSize=c;this.emptySlots=[];this.emptySlotsIdx=0;this.id2slot={};this.slot2id=Array(b)}f.prototype.prepareFree=function(c){this.emptySlots.length+=c};f.prototype.free=function(c){c=this.id2slot[c];null!=c&&(this.emptySlots[this.emptySlotsIdx++]=
c,this.slot2id[c]=void 0)};f.prototype.prepareAllocate=function(c){c-=this.emptySlotsIdx;0<c&&this._resizeArray((this.endSlot+c)*this.instanceDataSize)};f.prototype.allocate=function(c){var b;b=0<this.emptySlotsIdx?this.emptySlots[--this.emptySlotsIdx]:this.endSlot++;this.id2slot[c]=b;this.slot2id[b]=c;return b};f.prototype.getSlot=function(c){return this.id2slot[c]};f.prototype.getOffset=function(c){return c*this.instanceDataSize};f.prototype.getArray=function(){return this.array};f.prototype.fill=
function(c,b,a){this.array.set(a,c*this.instanceDataSize+b)};f.prototype.compact=function(){if(0<this.emptySlotsIdx){this.emptySlots.length=this.emptySlotsIdx;for(this.emptySlots.sort(function(a,b){return a-b});0<this.emptySlotsIdx&&this.emptySlots[this.emptySlotsIdx-1]===this.endSlot;)this.emptySlotsIdx--,this.endSlot--;for(;0<this.emptySlotsIdx;){this.emptySlotsIdx--;var c=this.endSlot-1,b=this.emptySlots[this.emptySlotsIdx],a=c*this.instanceDataSize,e=b*this.instanceDataSize;this.array.set(this.array.subarray(a,
a+this.instanceDataSize),e);this.array.set(this.zeroItem,a);a=this.slot2id[c];this.slot2id[c]=void 0;this.slot2id[b]=a;this.id2slot[a]=b;this.endSlot--}}this._resizeArray(this.endSlot*this.instanceDataSize);this.emptySlots.length=0;return this.array};f.prototype._resizeArray=function(c){var b;if(c>this.array.length){for(b=this.array.length||1;b<c;)b*=2;c=new Float32Array(b);c.set(this.array);this.array=c}else if(c<=this.array.length/2){b=this.array.length;for(c*=2;b>=c;)b/=2;c=new Float32Array(b);
c.set(this.array.subarray(0,b));this.array=c}};return f}()})},"esri/views/3d/webgl-engine/lib/Lighting":function(){define(["require","exports","./gl-matrix"],function(q,n,k){var f=k.vec3d,c=k.vec4d;return function(){function b(a,b,h,g){this.ambient=c.create(a);this.diffuse=c.create(b);this.specular=c.create(h);this.direction=f.create(g)}b.prototype.setUniforms=function(a){a.setUniform4fv("lightAmbient",this.ambient);a.setUniform4fv("lightDiffuse",this.diffuse);a.setUniform4fv("lightSpecular",this.specular);
a.setUniform3fv("lightDirection",this.direction)};b.prototype.set=function(a){a.ambient&&c.set(a.ambient,this.ambient);a.diffuse&&c.set(a.diffuse,this.diffuse);a.specular&&c.set(a.specular,this.specular);a.direction&&f.set(a.direction,this.direction)};b.prototype.get=function(){return{ambient:this.ambient,diffuse:this.diffuse,specular:this.specular,direction:this.direction}};return b}()})},"esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial":function(){define("require exports dojo/text!./SimpleGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e){return function(){function a(b,d,c,e){void 0===e&&(e=4);this.id=f.__GLMaterial_id++;this.program=b.get("simple");this.color=d;this.depthFunc=c;this.drawMode=e}a.prototype.getId=function(){return this.id};a.prototype.beginSlot=function(a){return a===c.INTERNAL_MATERIAL};a.prototype.getProgram=function(){return this.program};a.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",f.IDENTITY);this.program.setUniformMatrix4fv("proj",
b.proj);this.program.setUniform4fv("color",this.color);a.setBlendingEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)};a.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);a.setBlendingEnabled(!1)};a.prototype.bindView=function(a,b){f.bindView(b.origin,b.view,this.program)};a.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)};a.prototype.getDrawMode=function(a){return this.drawMode};a.loadShaders=function(a,
d,c,h){a._parse(k);a=new b(h,a.vertexShaderSimple,a.fragmentShaderSimple,e.Default3D);c.add("simple",a)};return a}()})},"esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial":function(){define("require exports dojo/text!./TexOnlyGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../lib/gl-matrix ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),function(q,n,k,f,c,b,a,e,h){var g=b.vec4d.createFrom(1,1,1,1);return function(){function b(a,
d,c,e,g){this.id=f.__GLMaterial_id++;this.program=a.get("texOnly");this.color=c;this.depthFunc=g;this.blend=e;this.texGLName=d}b.prototype.getId=function(){return this.id};b.prototype.beginSlot=function(a){return a===c.INTERNAL_MATERIAL};b.prototype.getProgram=function(){return this.program};b.prototype.setColor=function(a){this.color=a};b.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",f.IDENTITY);this.program.setUniformMatrix4fv("proj",b.proj);this.program.setUniform4fv("color",
void 0!==this.color?this.color:g);this.program.setUniform1i("tex",0);a.bindTexture(this.texGLName,0);this.blend&&a.setBlendingEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)};b.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);this.blend&&a.setBlendingEnabled(!1)};b.prototype.bindView=function(a,b){f.bindView(b.origin,b.view,this.program)};b.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)};b.prototype.getDrawMode=
function(a){return a.gl.TRIANGLES};b.loadShaders=function(b,d,c,e){b._parse(k);b=new a(e,b.vertexShaderTexOnly,b.fragmentShaderTexOnly,h.Default3D);c.add("texOnly",b)};return b}()})},"esri/views/3d/webgl-engine/lib/LinearDepthTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(q,n,k,f,c){return function(){function b(a){this._rctx=a;this._depthFBO=void 0;this.height=this.width=this.viewportToRestore=null}b.prototype.setEnableState=
function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};b.prototype.getEnableState=function(){return void 0!==this._depthFBO};b.prototype.getDepthFBO=function(){return this._depthFBO};b.prototype.enable=function(){k.assert(!this.getEnableState());this._depthFBO=f.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};b.prototype.disable=function(){k.assert(this.getEnableState());
this._depthFBO.dispose();this._depthFBO=void 0};b.prototype.setupFBOs=function(a){k.assert(this.getEnableState());this.viewportToRestore=a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};b.prototype.prepareDepthPass=function(){k.assert(this.getEnableState());var a=this._rctx,b=a.gl;this._depthFBO.resize(this.width,this.height);a.bindFramebuffer(this._depthFBO);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};b.prototype.finish=
function(a){var b=this._rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return b}()})},"esri/views/3d/webgl-engine/lib/NormalTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(q,n,k,f,c){return function(){function b(a){this.rctx=a;this.normalFBO=void 0;this.height=this.width=this.viewportToRestore=null}b.prototype.setEnableState=
function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};b.prototype.getEnableState=function(){return void 0!==this.normalFBO};b.prototype.getNormalFBO=function(){return this.normalFBO};b.prototype.enable=function(){k.assert(!this.getEnableState());this.normalFBO=f.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};b.prototype.disable=function(){k.assert(this.getEnableState());
this.normalFBO.dispose();this.normalFBO=void 0};b.prototype.setupFBOs=function(a){k.assert(this.getEnableState());this.viewportToRestore=a=a.viewport;this.width=a[2];this.height=a[3];this.rctx.setViewport(0,0,this.width,this.height)};b.prototype.prepareNormalPass=function(){k.assert(this.getEnableState());var a=this.rctx,b=a.gl;this.normalFBO.resize(this.width,this.height);a.bindFramebuffer(this.normalFBO);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};b.prototype.finish=
function(a){var b=this.rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return b}()})},"esri/views/3d/webgl-engine/lib/HighlightTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(q,n,k,f,c){return function(){function b(a){this._rctx=a;this.height=this.width=this.viewportToRestore=this.fbo2=this.fbo=null}b.prototype.setEnableState=
function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};b.prototype.getEnableState=function(){return null!==this.fbo};b.prototype.getHighlightFBO=function(){return this.fbo};b.prototype.getBlurFBO=function(){return this.fbo2};b.prototype.enable=function(){k.assert(!this.getEnableState());this.fbo=f.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};b.prototype.disable=
function(){k.assert(this.getEnableState());this.fbo.dispose();this.fbo=null};b.prototype.setupFBOs=function(a){k.assert(this.getEnableState());this.viewportToRestore=a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};b.prototype.prepareHighlightPass=function(){k.assert(this.getEnableState());var a=this._rctx,b=a.gl;this.fbo.resize(this.width,this.height);a.bindFramebuffer(this.fbo);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};
b.prototype.finish=function(a){var b=this._rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return b}()})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports","./RenderSlot","./RenderPass"],function(q,n,k,f){return function(){return function(){this.normals=this.lightingData=this.highlight=this.filterFaceRange=this.filterContent=this.depth=this.camera=this.options=this.rctx=
null;this.pass=f.MATERIAL;this.shadowMap=null;this.slot=k.BACKGROUND;this.framebufferTex=this.visibleContent=this.stencilRenderingHelper=this.offscreenRenderingHelper=this.ssaoHelper=null}}()})},"esri/views/3d/webgl-engine/lib/ExternalRendererContainer":function(){define(["require","exports","./RenderSlot"],function(q,n,k){return function(){function f(){this.renderersChanged=!1;this.renderers=[];this.slots=[];for(var c=0;c<k.MAX_SLOTS;++c)this.slots[c]=[]}f.prototype.addRenderer=function(c,b){this.renderers.push(b);
for(var a=0;a<c.length;++a)this.slots[c[a]].push(b);this.renderersChanged=!0};f.prototype.removeRenderer=function(c){this.renderers=this.renderers.filter(function(a){return a!==c});for(var b=0;b<this.slots.length;++b)this.slots[b]=this.slots[b].filter(function(a){return a!==c});this.renderersChanged=!0};f.prototype.render=function(c,b){b.slot=c;for(var a=this.slots[c],e=0;e<a.length;++e){var h=a[e];h.render(b)&&(h.didRender=!0)}};f.prototype.needsRender=function(){if(this.renderersChanged)return!0;
for(var c=0;c<this.renderers.length;++c)if(this.renderers[c].needsRender)return!0;return!1};f.prototype.needsDepthMap=function(){for(var c=0;c<this.renderers.length;++c)if(this.renderers[c].needsDepthMap)return!0;return!1};f.prototype.resetNeedsRender=function(){this.renderersChanged=!1;for(var c=0;c<this.renderers.length;++c){var b=this.renderers[c];b.resetNeedsRender?b.resetNeedsRender():b.didRender&&(b.needsRender=!1,b.didRender=!1)}};return f}()})},"esri/views/3d/webgl-engine/lib/StencilRenderingHelper":function(){define(["require",
"exports","./Util","../../../webgl/enums"],function(q,n,k,f){return function(){function c(b){this._enabled=!1;this._rctx=b}c.prototype.enable=function(){this._enabled=!0;this._rctx.setStencilTestEnabled(!0)};c.prototype.disable=function(){this._enabled=!1;this._rctx.setStencilTestEnabled(!1)};c.prototype.getIsSupported=function(){return!!this._rctx.contextAttributes.stencil};c.prototype.setEnableState=function(b){b?this.enable():this.disable()};c.prototype.getEnableState=function(){return this._enabled};
c.prototype.prepareStencilWritePass=function(){k.assert(this.getEnableState());var b=this._rctx;b.setClearStencil(0);b.setStencilFunction(519,1,255);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255)};c.prototype.prepareStencilReadPass=function(){k.assert(this.getEnableState());var b=this._rctx;b.setStencilFunction(517,1,255);b.setStencilWriteMask(0)};c.prototype.prepareStencilDisabledPass=function(){k.assert(this.getEnableState());var b=this._rctx;b.setStencilFunction(519,0,0);b.setStencilWriteMask(0)};
return c}()})},"esri/views/3d/webgl-engine/lib/BitSet":function(){define(["require","exports"],function(q,n){return function(){function k(){this.bitsPerWord=32;this.addressBitsPerWord=5;this._store=[]}k.prototype.clone=function(){var f=new k;f._store=this._store.slice();return f};k.prototype.wordIndex=function(f){return f>>this.addressBitsPerWord};k.prototype.set=function(f){return this._store[this.wordIndex(f-1)]|=1<<f-1};k.prototype.clear=function(f){return this._store[this.wordIndex(f-1)]&=255^
1<<f-1};k.prototype.clearAll=function(){for(var f=0;f<this._store.length;++f)this._store[f]=0};k.prototype.get=function(f){return 0!==(this._store[this.wordIndex(f-1)]&1<<f-1)};k.prototype.length=function(){return 0===this.wordLength()?0:this.bitsPerWord*(this.wordLength()-1)+(this._store[this.wordLength()-1].toString(2).length+1)};k.prototype.wordLength=function(){for(var f,c=this._store.length,b=f=this._store.length-1;(0>=f?0>=b:0<=b)&&0===this._store[b];0>=f?b++:b--)c--;return c};k.prototype.store=
function(){return this._store};k.prototype.cardinality=function(){for(var f=0,c=0,b=this.length();0<=b?c<=b:c>=b;0<=b?c++:c--)this.get(c)&&f++;return f};k.prototype.toString=function(){for(var f=[],c=0,b=this.length();0<=b?c<=b:c>=b;0<=b?c++:c--)this.get(c)&&f.push(""+c);return"{"+f.join(",")+"}"};k.prototype.toBinaryString=function(){var f=this,c=function(b,a,c){for(;b.length<c;)b=a+b;return b};return 0<this.wordLength()?this._store.map(function(b){return c(b.toString(2),"0",f.bitsPerWord)}).join(""):
c("","0",this.bitsPerWord)};k.prototype.or=function(f){if(this!==f){for(var c=Math.min(this.wordLength(),f.wordLength()),b=0,a=c-1;0<=a?b<=a:b>=a;0<=a?b++:b--)this._store[b]|=f.store[b];c<f.wordLength()&&(this._store=this._store.concat(f._store.slice(c,f.wordLength())));return null}};k.prototype.and=function(f){var c;if(this!==f){for(var b=c=this.wordLength(),a=f.wordLength();c<=a?b<=a:b>=a;c<=a?b++:b--)this._store[b]=0;b=0;for(c=this.wordLength();0<=c?b<=c:b>=c;0<=c?b++:b--)this._store[b]&=f.store[b];
return null}};k.prototype.andNot=function(f){for(var c=0,b=Math.min(this.wordLength(),f.wordLength())-1;0<=b?c<=b:c>=b;0<=b?c++:c--)this._store[c]&=~f.store[c];return null};k.prototype.xor=function(f){if(this!==f){for(var c=0,b=this.wordLength();0<=b?c<=b:c>=b;0<=b?c++:c--)this._store[c]^=f.store[c];return null}};return k}()})},"esri/views/3d/webgl-engine/lib/FxaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(q,n,k,f,c,b){return function(){function a(a){this.isEnabled=!1;this.vertexAttributeLocations={position:0};this.vertexBufferLayout=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}a.prototype.enable=function(){if(!this.isEnabled){var a=this.rctx;this.program=new k(a,"\n      #version 100\n      precision mediump float;\n\n      attribute vec2 position;\n\n      varying   vec2 fCoordinate;\n\n      void main() {\n        fCoordinate \x3d (position + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(position, -1, 1);\n      }",
"\n      #version 100\n      precision mediump float;\n      /**\n       * @license\n       * Copyright (c) 2011 NVIDIA Corporation. All rights reserved.\n       *\n       * TO  THE MAXIMUM  EXTENT PERMITTED  BY APPLICABLE  LAW, THIS SOFTWARE  IS PROVIDED\n       * *AS IS*  AND NVIDIA AND  ITS SUPPLIERS DISCLAIM  ALL WARRANTIES,  EITHER  EXPRESS\n       * OR IMPLIED, INCLUDING, BUT NOT LIMITED  TO, NONINFRINGEMENT,IMPLIED WARRANTIES OF\n       * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO EVENT SHALL  NVIDIA\n       * OR ITS SUPPLIERS BE  LIABLE  FOR  ANY  DIRECT, SPECIAL,  INCIDENTAL,  INDIRECT,  OR\n       * CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION,  DAMAGES FOR LOSS\n       * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY\n       * OTHER PECUNIARY LOSS) ARISING OUT OF THE  USE OF OR INABILITY  TO USE THIS SOFTWARE,\n       * EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\n       */\n\n      #define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n      #define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n      #define FXAA_SEARCH_STEPS        16\n      #define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n      #define FXAA_SUBPIX_CAP          (3.0/4.0)\n      #define FXAA_SUBPIX_TRIM         (1.0/4.0)\n      #define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n\n      uniform vec2 uRcpFrameDimension;\n      uniform sampler2D uColorTexture;\n      varying vec2 fCoordinate;\n\n      // Return the luma, the estimation of luminance from rgb inputs.\n      // This approximates luma using one FMA instruction,\n      // skipping normalization and tossing out blue.\n      // FxaaLuma() will range 0.0 to 2.963210702.\n      float FxaaLuma(vec3 rgb) {\n        return rgb.y * (0.587 / 0.299) + rgb.x;\n      }\n      vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\n        return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n      }\n      vec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\n        float x \x3d pos.x + float(off.x) * rcpFrame.x;\n        float y \x3d pos.y + float(off.y) * rcpFrame.y;\n        return texture2D(tex, vec2(x, y));\n      }\n\n      // pos is the output of FxaaVertexShader interpolated across screen.\n      // xy -\x3e actual texture position {0.0 to 1.0}\n      // rcpFrame should be a uniform equal to  {1.0/frameWidth, 1.0/frameHeight}\n      vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\n        vec3 rgbN \x3d FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\n        vec3 rgbW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\n        vec3 rgbM \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\n        vec3 rgbE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\n        vec3 rgbS \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\n        float lumaN \x3d FxaaLuma(rgbN);\n        float lumaW \x3d FxaaLuma(rgbW);\n        float lumaM \x3d FxaaLuma(rgbM);\n        float lumaE \x3d FxaaLuma(rgbE);\n        float lumaS \x3d FxaaLuma(rgbS);\n        float rangeMin \x3d min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\n        float rangeMax \x3d max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\n        float range \x3d rangeMax - rangeMin;\n        if (range \x3c max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\n          return rgbM;\n        }\n        vec3 rgbL \x3d rgbN + rgbW + rgbM + rgbE + rgbS;\n        float lumaL \x3d (lumaN + lumaW + lumaE + lumaS) * 0.25;\n        float rangeL \x3d abs(lumaL - lumaM);\n        float blendL \x3d max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\n        blendL \x3d min(FXAA_SUBPIX_CAP, blendL);\n        vec3 rgbNW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\n        vec3 rgbNE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\n        vec3 rgbSW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\n        vec3 rgbSE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\n        rgbL +\x3d (rgbNW + rgbNE + rgbSW + rgbSE);\n        rgbL *\x3d vec3(1.0/9.0);\n        float lumaNW \x3d FxaaLuma(rgbNW);\n        float lumaNE \x3d FxaaLuma(rgbNE);\n        float lumaSW \x3d FxaaLuma(rgbSW);\n        float lumaSE \x3d FxaaLuma(rgbSE);\n        float edgeVert \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\n          abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\n          abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\n        float edgeHorz \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\n          abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\n          abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\n        bool horzSpan \x3d edgeHorz \x3e\x3d edgeVert;\n        float lengthSign \x3d horzSpan ? -rcpFrame.y : -rcpFrame.x;\n        if(!horzSpan) {\n          lumaN \x3d lumaW;\n          lumaS \x3d lumaE;\n        }\n        float gradientN \x3d abs(lumaN - lumaM);\n        float gradientS \x3d abs(lumaS - lumaM);\n        lumaN \x3d (lumaN + lumaM) * 0.5;\n        lumaS \x3d (lumaS + lumaM) * 0.5;\n        if (gradientN \x3c gradientS)\n        {\n          lumaN \x3d lumaS;\n          lumaN \x3d lumaS;\n          gradientN \x3d gradientS;\n          lengthSign *\x3d -1.0;\n        }\n        vec2 posN;\n        posN.x \x3d pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\n        posN.y \x3d pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\n        gradientN *\x3d FXAA_SEARCH_THRESHOLD;\n        vec2 posP \x3d posN;\n        vec2 offNP \x3d horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\n        float lumaEndN \x3d lumaN;\n        float lumaEndP \x3d lumaN;\n        bool doneN \x3d false;\n        bool doneP \x3d false;\n        posN +\x3d offNP * vec2(-1.0, -1.0);\n        posP +\x3d offNP * vec2( 1.0,  1.0);\n        for(int i \x3d 0; i \x3c FXAA_SEARCH_STEPS; i++) {\n          if(!doneN) {\n            lumaEndN \x3d FxaaLuma(texture2D(tex, posN.xy).xyz);\n          }\n          if(!doneP) {\n            lumaEndP \x3d FxaaLuma(texture2D(tex, posP.xy).xyz);\n          }\n          doneN \x3d doneN || (abs(lumaEndN - lumaN) \x3e\x3d gradientN);\n          doneP \x3d doneP || (abs(lumaEndP - lumaN) \x3e\x3d gradientN);\n          if(doneN \x26\x26 doneP) { break; }\n          if(!doneN) {\n            posN -\x3d offNP;\n          }\n          if(!doneP) {\n            posP +\x3d offNP;\n          }\n        }\n        float dstN \x3d horzSpan ? pos.x - posN.x : pos.y - posN.y;\n        float dstP \x3d horzSpan ? posP.x - pos.x : posP.y - pos.y;\n        bool directionN \x3d dstN \x3c dstP;\n        lumaEndN \x3d directionN ? lumaEndN : lumaEndP;\n        if(((lumaM - lumaN) \x3c 0.0) \x3d\x3d ((lumaEndN - lumaN) \x3c 0.0)) {\n          lengthSign \x3d 0.0;\n        }\n        float spanLength \x3d (dstP + dstN);\n        dstN \x3d directionN ? dstN : dstP;\n        float subPixelOffset \x3d (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\n        vec3 rgbF \x3d texture2D(tex, vec2(\n          pos.x + (horzSpan ? 0.0 : subPixelOffset),\n          pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\n        return FxaaLerp3(rgbL, rgbF, blendL);\n      }\n\n      void main() {\n        vec4 color;\n        vec2 screenCoord \x3d fCoordinate;\n        // if (screenCoord.x \x3c 0.5) {\n          color.rgb \x3d FxaaPixelShader(screenCoord, uColorTexture, uRcpFrameDimension);\n        // } else if (screenCoord.x \x3c 0.501 \x26\x26 screenCoord.x \x3e 0.499) {\n        //   color.rgb \x3d vec3(1,0,0);\n        // } else {\n        //   color \x3d texture2D(uColorTexture, fCoordinate);\n        // }\n        color.a \x3d 1.0;\n        gl_FragColor \x3d color;\n      }",
this.vertexAttributeLocations);var b=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new f(a,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new c(a,34962,35044,b)});this.isEnabled=!0}};a.prototype.disable=function(){this.isEnabled&&(this.program.dispose(),this.program=null,this.vao.dispose(),this.vao=null,this.isEnabled=!1)};a.prototype.render=function(a,b){this.enable();var c=this.rctx;c.bindVAO(this.vao);c.bindFramebuffer(b);var d=0,m=0;null!=b?(d=b.descriptor.width,m=b.descriptor.height):
(d=c.gl.canvas.width,m=c.gl.canvas.height);c.bindProgram(this.program);c.bindTexture(a.colorTexture,0);this.program.setUniform1i("uColorTexture",0);this.program.setUniform2f("uRcpFrameDimension",1/d,1/m);c.setFaceCullingEnabled(!1);c.drawArrays(4,0,3)};return a}()})},"esri/views/3d/webgl-engine/lib/SmaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/enums".split(" "),
function(q,n,k,f,c,b,a,e){return function(){function e(a){this.isEnabled=!1;this.vertexAttributeLocations={vPosition:0};this.vertexBufferLayout=[{name:"vPosition",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}e.prototype.enable=function(){if(!this.isEnabled){var b=this.rctx;this.programEdgeDetect=new k(b,"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      void SMAAEdgeDetectionVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[2] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAAEdgeDetectionVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_THRESHOLD 0.05\n      #define SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR 2\n      #define SMAA_USE_COLOR_EDGE_DETECTION 0\n\n      uniform sampler2D tColor;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      vec4 SMAALumaEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        // Calculate the threshold:\n        vec2 threshold \x3d vec2(SMAA_THRESHOLD, SMAA_THRESHOLD);\n\n        // Calculate lumas:\n        vec3 weights \x3d vec3(0.2126, 0.7152, 0.0722);\n        float L \x3d dot(texture2D(colorTex, texcoord).rgb, weights);\n\n        float Lleft \x3d dot(texture2D(colorTex, offset[0].xy).rgb, weights);\n        float Ltop  \x3d dot(texture2D(colorTex, offset[0].zw).rgb, weights);\n\n        // We do the usual threshold:\n        vec4 delta;\n        delta.xy \x3d abs(L - vec2(Lleft, Ltop));\n        vec2 edges \x3d step(threshold, delta.xy);\n\n        // Then discard if there is no edge:\n        if (dot(edges, vec2(1.0, 1.0)) \x3d\x3d 0.0) discard;\n\n        // Calculate right and bottom deltas:\n        float Lright \x3d dot(texture2D(colorTex, offset[1].xy).rgb, weights);\n        float Lbottom  \x3d dot(texture2D(colorTex, offset[1].zw).rgb, weights);\n        delta.zw \x3d abs(L - vec2(Lright, Lbottom));\n\n        // Calculate the maximum delta in the direct neighborhood:\n        vec2 maxDelta \x3d max(delta.xy, delta.zw);\n\n        // Calculate left-left and top-top deltas:\n        float Lleftleft \x3d dot(texture2D(colorTex, offset[2].xy).rgb, weights);\n        float Ltoptop \x3d dot(texture2D(colorTex, offset[2].zw).rgb, weights);\n        delta.zw \x3d abs(vec2(Lleft, Ltop) - vec2(Lleftleft, Ltoptop));\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max(maxDelta.xy, delta.zw);\n        float finalDelta \x3d max(maxDelta.x, maxDelta.y);\n\n        // Local contrast adaptation:\n        edges.xy *\x3d step(finalDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy);\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        vec2 threshold \x3d vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n        // Calculate color deltas:\n        vec4 delta;\n        vec3 C \x3d texture2D( colorTex, texcoord ).rgb;\n\n        vec3 Cleft \x3d texture2D( colorTex, offset[0].xy ).rgb;\n        vec3 t \x3d abs( C - Cleft );\n        delta.x \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctop \x3d texture2D( colorTex, offset[0].zw ).rgb;\n        t \x3d abs( C - Ctop );\n        delta.y \x3d max( max( t.r, t.g ), t.b );\n\n        // We do the usual threshold:\n        vec2 edges \x3d step( threshold, delta.xy );\n\n        // Then discard if there is no edge:\n        if ( dot( edges, vec2( 1.0, 1.0 ) ) \x3d\x3d 0.0 )\n            discard;\n\n        // Calculate right and bottom deltas:\n        vec3 Cright \x3d texture2D( colorTex, offset[1].xy ).rgb;\n        t \x3d abs( C - Cright );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Cbottom  \x3d texture2D( colorTex, offset[1].zw ).rgb;\n        t \x3d abs( C - Cbottom );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the maximum delta in the direct neighborhood:\n        float maxDelta \x3d max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n        // Calculate left-left and top-top deltas:\n        vec3 Cleftleft  \x3d texture2D( colorTex, offset[2].xy ).rgb;\n        t \x3d abs( C - Cleftleft );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctoptop \x3d texture2D( colorTex, offset[2].zw ).rgb;\n        t \x3d abs( C - Ctoptop );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max( max( maxDelta, delta.z ), delta.w );\n\n        // Local contrast adaptation in action:\n        edges.xy *\x3d step( maxDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy );\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      void main() {\n        #if SMAA_USE_COLOR_EDGE_DETECTION\n          gl_FragColor \x3d SMAAColorEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #else\n          gl_FragColor \x3d SMAALumaEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #endif\n      }",
this.vertexAttributeLocations);this.programBlendWeights=new k(b,"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n        fPixCoord \x3d texcoord * uResolution.zw;\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );\n        fOffset[2] \x3d vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * uResolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAABlendingWeightCalculationVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n      #define SMAA_AREATEX_MAX_DISTANCE 16\n      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n\n      #define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * uResolution.xy, 0.0 )\n\n      uniform sampler2D tEdges;\n      uniform sampler2D tArea;\n      uniform sampler2D tSearch;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      vec2 round( vec2 x ) {\n        return sign( x ) * floor( abs( x ) + 0.5 );\n      }\n\n      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n        e.r \x3d bias + e.r * scale;\n        return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n      }\n\n      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3e end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x +\x3d 0.25 * uResolution.x;\n        texcoord.x +\x3d uResolution.x;\n        texcoord.x +\x3d 2.0 * uResolution.x;\n        texcoord.x -\x3d uResolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n        return texcoord.x;\n      }\n\n      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3c end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x -\x3d 0.25 * uResolution.x;\n        texcoord.x -\x3d uResolution.x;\n        texcoord.x -\x3d 2.0 * uResolution.x;\n        texcoord.x +\x3d uResolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n        return texcoord.x;\n      }\n\n      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3e end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y -\x3d 0.25 * uResolution.y;\n        texcoord.y -\x3d uResolution.y;\n        texcoord.y -\x3d 2.0 * uResolution.y;\n        texcoord.y +\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );\n        return texcoord.y;\n      }\n\n      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3c end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y +\x3d 0.25 * uResolution.y;\n        texcoord.y +\x3d uResolution.y;\n        texcoord.y +\x3d 2.0 * uResolution.y;\n        texcoord.y -\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );\n        return texcoord.y;\n      }\n\n      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n        vec2 texcoord \x3d float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n        texcoord \x3d SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n        texcoord.y +\x3d SMAA_AREATEX_SUBTEX_SIZE * offset;\n        return texture2D( areaTex, texcoord, 0.0 ).rg;\n      }\n\n      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n        vec4 weights \x3d vec4( 0.0, 0.0, 0.0, 0.0 );\n        vec2 e \x3d texture2D( edgesTex, texcoord ).rg;\n        if ( e.g \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.x \x3d SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n          coords.y \x3d offset[ 1 ].y;\n          d.x \x3d coords.x;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).r;\n          coords.x \x3d SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n          d.y \x3d coords.x;\n          d \x3d d * uResolution.z - pixcoord.x;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n          weights.rg \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n        }\n        if ( e.r \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.y \x3d SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n          coords.x \x3d offset[ 0 ].x;\n          d.x \x3d coords.y;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).g;\n          coords.y \x3d SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n          d.y \x3d coords.y;\n          d \x3d d * uResolution.w - pixcoord.y;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n          weights.ba \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\n          // for some reason the following lines are necessary to prevent\n          // texture lookup precision issues on some Intel integrated graphics chips\n          vec4 dbg \x3d (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);\n          weights.r +\x3d 0.00000001 * dot(vec4(0,1,0,1),dbg);\n        }\n        return weights;\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );\n      }",
this.vertexAttributeLocations);this.programBlur=new k(b,"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      void SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n\n        SMAANeighborhoodBlendingVS(fTexCoord);\n      }",
"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_DEBUG_SPLIT_VIEW 0\n\n      uniform sampler2D tBlendWeights;\n      uniform sampler2D tColor;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n        vec4 a;\n        a.xz \x3d texture2D( blendTex, texcoord ).xz;\n        a.y \x3d texture2D( blendTex, offset[ 1 ].zw ).g;\n        a.w \x3d texture2D( blendTex, offset[ 1 ].xy ).a;\n\n        if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) \x3c 1e-5 ) {\n          return texture2D( colorTex, texcoord, 0.0 );\n        } else {\n          vec2 offset;\n          offset.x \x3d a.a \x3e a.b ? a.a : -a.b;\n          offset.y \x3d a.g \x3e a.r ? -a.g : a.r;\n\n          if ( abs( offset.x ) \x3e abs( offset.y )) {\n            offset.y \x3d 0.0;\n          } else {\n            offset.x \x3d 0.0;\n          }\n\n          vec4 C \x3d texture2D( colorTex, texcoord, 0.0 );\n          texcoord +\x3d sign( offset ) * uResolution.xy;\n          vec4 Cop \x3d texture2D( colorTex, texcoord, 0.0 );\n\n          float s \x3d abs( offset.x ) \x3e abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n          //C.xyz \x3d pow(C.xyz, vec3(2.2));\n          //Cop.xyz \x3d pow(Cop.xyz, vec3(2.2));\n          vec4 mixed \x3d mix(C, Cop, s);\n          //mixed.xyz \x3d pow(mixed.xyz, vec3(1.0 / 2.2));\n\n          return mixed;\n        }\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );\n\n        #if SMAA_DEBUG_SPLIT_VIEW // split the view in the middle and display the unprocessed image on the right\n          // test stuff\n          if (fTexCoord.x \x3e 0.5) {\n            if (fTexCoord.x \x3c 0.5 + uResolution.x) {\n              gl_FragColor \x3d vec4(0, 0, 1, 1);\n            } else {\n              gl_FragColor \x3d texture2D(tColor, fTexCoord);\n            }\n          }\n        #endif // DEBUG\n      }",
this.vertexAttributeLocations);var d=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new f(b,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new c(b,34962,35044,d)});this.tmpFramebufferEdges=a.createWithAttachments(this.rctx,{target:3553,pixelFormat:6407,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.tmpFramebufferBlend=a.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,
wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.textureArea=this.loadTextureFromBase64("data:image/png;base64,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\x3d",
9729,6407);this.textureSearch=this.loadTextureFromBase64("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII\x3d",9728,6409);this.isEnabled=!0}};e.prototype.disable=function(){this.isEnabled&&(this.programEdgeDetect.dispose(),this.programEdgeDetect=null,this.programBlendWeights.dispose(),this.programBlendWeights=null,this.programBlur.dispose(),this.programBlur=null,this.vao.dispose(),
this.vao=null,this.textureArea.dispose(),this.textureArea=null,this.textureSearch.dispose(),this.textureSearch=null,this.tmpFramebufferBlend.dispose(),this.tmpFramebufferBlend=null,this.tmpFramebufferEdges.dispose(),this.tmpFramebufferEdges=null,this.isEnabled=!1)};e.prototype.render=function(a,b){this.enable();var c=this.rctx,e=0,h=0;null!=b?(e=b.descriptor.width,h=b.descriptor.height):(e=c.gl.canvas.width,h=c.gl.canvas.height);c.bindVAO(this.vao);c.setFaceCullingEnabled(!0);c.setCullFace(1029);
c.setFrontFace(2305);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!1);c.setViewport(0,0,e,h);this.tmpFramebufferEdges.resize(e,h);c.bindFramebuffer(this.tmpFramebufferEdges);c.setClearColor(0,0,0,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programEdgeDetect);c.bindTexture(a.colorTexture,0);this.programEdgeDetect.setUniform1i("tColor",0);this.programEdgeDetect.setUniform4f("uResolution",1/e,1/h,e,h);c.drawArrays(4,0,3);this.tmpFramebufferBlend.resize(e,h);c.bindFramebuffer(this.tmpFramebufferBlend);
c.setClearColor(0,0,1,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlendWeights);this.programBlendWeights.setUniform4f("uResolution",1/e,1/h,e,h);c.bindTexture(this.textureSearch,1);this.programBlendWeights.setUniform1i("tSearch",1);c.bindTexture(this.textureArea,2);this.programBlendWeights.setUniform1i("tArea",2);c.bindTexture(this.tmpFramebufferEdges.colorTexture,3);this.programBlendWeights.setUniform1i("tEdges",3);c.drawArrays(4,0,3);c.bindFramebuffer(b);c.setClearColor(0,1,0,1);
c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlur);this.programBlur.setUniform4f("uResolution",1/e,1/h,e,h);c.bindTexture(a.colorTexture,0);this.programBlur.setUniform1i("tColor",0);c.bindTexture(this.tmpFramebufferBlend.colorTexture,1);this.programBlur.setUniform1i("tBlendWeights",1);c.drawArrays(4,0,3);c.setBlendingEnabled(!0);c.setDepthTestEnabled(!0)};e.prototype.loadTextureFromBase64=function(a,d,c){var e=new Image;e.src=a;var h=new b(this.rctx,{pixelFormat:c,dataType:5121,wrapMode:33071,
samplingMode:d},e);e.onload=function(){h.resize(e.width,e.height);h.setData(e)};return h};return e}()})},"esri/views/3d/webgl-engine/lib/Camera":function(){define(["require","exports","./Util","./gl-matrix"],function(q,n,k,f){function c(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function b(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}var a=f.vec3d,e=f.vec4d,h=f.mat4d;q=function(){function f(b,d,c){this._viewUp=a.create();this._viewForward=a.create();this._viewRight=a.create();
this._viewport=e.create();this._padding=e.create();this._fov=55/180*Math.PI;this._near=0;this._far=1E3;this._viewDirty=!0;this._viewMatrix=h.create();this._projectionDirty=!0;this._projectionMatrix=h.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=null;this._frustumPlanesDirty=!0;this._frustumPlanes=[e.create(),e.create(),e.create(),e.create(),e.create(),e.create()];this._fullViewport=null;this.aboveGround=!0;this._eye=a.create(b);this._center=a.create(d);this._up=
void 0!==c?a.create(c):a.create([0,0,1]);this._padding=e.create()}Object.defineProperty(f.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,this._center)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,
this._up)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewMatrix",{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(a){h.set(a,this._viewMatrix);this._viewDirty=!1;this._frustumPlanesDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewUp",
{get:function(){this._ensureViewClean();return this._viewUp},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewRight",{get:function(){this._ensureViewClean();return this._viewRight},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"far",{get:function(){return this._far},
set:function(a){this._far!==a&&(this._far=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._frustumPlanesDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){a-=this._padding[1]+this._padding[3];this._viewport[2]!==a&&(this._viewport[2]=a,this._frustumPlanesDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return this._viewport[3]},set:function(a){a-=this._padding[0]+this._padding[2];this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=e.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"padding",{get:function(){return this._padding},set:function(a){this._padding[0]===a[0]&&this._padding[1]===a[1]&&this._padding[2]===a[2]&&this._padding[3]===a[3]||(this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],this._viewport[2]-=a[1]+a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=a[0]+a[2]-(this._padding[0]+this._padding[2]),e.set(a,
this._padding),this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,d=this.near*Math.tan(this.fovY/2),c=d*this.aspect;h.frustum(-c*(1+2*this._padding[3]/a),c*(1+2*this._padding[1]/a),-d*(1+2*this._padding[2]/b),d*(1+2*this._padding[0]/b),this.near,this.far,this._projectionMatrix);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){h.set(a,
this._projectionMatrix);this._projectionDirty=!1;this._frustumPlanesDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=a;this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fovX",{get:function(){return k.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=k.fovx2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=
!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fovY",{get:function(){return k.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=k.fovy2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"distance",{get:function(){return a.dist(this._center,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"angleOfElevation",{get:function(){a.subtract(this._center,
this._eye,g);a.normalize(g);var b=a.dot(this._center,g)/a.length(this._center);return Math.acos(k.clamp(b,-1,1))-0.5*Math.PI},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"frustumPoints",{get:function(){return this.computeFrustumPoints()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"frustumPlanes",{get:function(){this._frustumPlanesDirty&&(this._frustumPlanes=this._computeFrustumPlanes(this._frustumPlanes),this._frustumPlanesDirty=!1);return this._frustumPlanes},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=h.create()),h.inverse(this.viewMatrix,this._viewInverseTransposeMatrix),h.transpose(this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"perPixelRatio",{get:function(){return Math.tan(this.fovX/2)/this.width},enumerable:!0,configurable:!0});f.prototype.copyFrom=function(b){a.set(b._eye,this._eye);a.set(b._center,this._center);a.set(b._up,this._up);e.set(b._viewport,this._viewport);e.set(b._padding,this._padding);this._near=b._near;this._far=b._far;this._fov=b._fov;this.aboveGround=b.aboveGround;b._viewDirty?this._frustumPlanesDirty=this._viewDirty=!0:(h.set(b._viewMatrix,this._viewMatrix),a.set(b._viewRight,this._viewRight),a.set(b._viewUp,
this._viewUp),a.set(b._viewForward,this._viewForward),this._viewDirty=!1);b._projectionDirty?this._frustumPlanesDirty=this._projectionDirty=!0:(h.set(b._projectionMatrix,this._projectionMatrix),this._projectionDirty=!1);return this};f.prototype.copy=function(){var a=new f;a.copyFrom(this);return a};f.prototype.equals=function(a){return c(this._eye,a._eye)&&c(this._center,a._center)&&c(this._up,a._up)&&b(this._viewport,a._viewport)&&b(this._padding,a._padding)&&this._near===a._near&&this._far===a._far&&
this._fov===a._fov};f.prototype.almostEquals=function(b,d){var c=a.dist(this.eye,this.center)*(d||5E-4),c=c*c,e;if(e=a.dist2(b.eye,this.eye)<c){if(c=a.dist2(b.center,this.center)<c)if(c=0.0010>Math.abs(b.fov-this.fov)){var g=b.padding,h=this.padding,c=h[0]-g[0];e=h[1]-g[1];var m=h[2]-g[2],g=h[3]-g[3],c=0.5>c*c+e*e+m*m+g*g}e=c}return e};f.prototype.markViewDirty=function(){this._frustumPlanesDirty=this._viewDirty=!0};f.prototype.computePixelSizeAt=function(b){return 2*a.dist(b,this._eye)*Math.tan(this.fovX/
2)/this.width};f.prototype.computePixelSizeAtDist=function(a){return 2*a*Math.tan(this.fovX/2)/this.width};f.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))};f.prototype.copyFrustumPlanes=function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=e.create()}for(var d=this.frustumPlanes,b=0;6>b;b++)e.set(d[b],a[b]);return a};f.prototype.computeFrustumPoints=function(b){if(!b){b=Array(8);for(var d=0;8>d;++d)b[d]=a.create()}k.matrix2frustum(this.viewMatrix,
this.projectionMatrix,b);return b};f.prototype.setGLViewport=function(a){var b=this.viewport,d=this.padding;a.setViewport(b[0]-d[3],b[1]-d[2],b[2]+d[1]+d[3],b[3]+d[0]+d[2])};f.prototype.projectPoint=function(b,c,g){void 0===g&&(g=!1);e.set4(b[0],b[1],b[2],1,d);h.multiplyVec4(this.viewMatrix,d);g&&(c[2]=-d[2]);h.multiplyVec4(this.projectionMatrix,d);a.scale(d,1/Math.abs(d[3]));b=this.fullViewport;c[0]=k.lerp(0,b[0]+b[2],0.5+0.5*d[0]);c[1]=k.lerp(0,b[1]+b[3],0.5+0.5*d[1]);g||(c[2]=0.5*(d[2]+1));return c};
f.prototype.unprojectPoint=function(a,b,c){void 0===c&&(c=!1);if(c)return console.error("Camera.unprojectPoint() not yet implemented for linear Z"),null;h.multiply(this.projectionMatrix,this.viewMatrix,m);if(!h.inverse(m))return null;c=this.fullViewport;d[0]=2*(a[0]-c[0])/c[2]-1;d[1]=2*(a[1]-c[1])/c[3]-1;d[2]=2*a[2]-1;d[3]=1;h.multiplyVec4(m,d);if(0===d[3])return null;b[0]=d[0]/d[3];b[1]=d[1]/d[3];b[2]=d[2]/d[3];return b};f.prototype.computeUpOnSphere=function(){a.subtract(this.center,this.eye,l);
var b=a.length(this.center);1>b?a.set3(0,0,1,this.up):Math.abs(a.dot(l,this.center))>0.9999*a.length(l)*b||(a.cross(l,this.center,this.up),a.cross(this.up,l,this.up),a.normalize(this.up))};f.prototype._compareAndSetView=function(b,d){c(b,d)||(a.set(b,d),this._frustumPlanesDirty=this._viewDirty=!0)};f.prototype._computeFrustumPlanes=function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=e.create()}k.matrix2frustumPlanes(this.viewMatrix,this.projectionMatrix,a);return a};f.prototype._ensureViewClean=
function(){this._viewDirty&&(h.lookAt(this._eye,this._center,this._up,this._viewMatrix),a.set3(-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10],this._viewForward),a.set3(this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9],this._viewUp),a.set3(this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8],this._viewRight),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return f}();var g=a.create(),d=e.create(),m=h.create(),l=a.create();return q})},"esri/views/3d/webgl-engine/lib/webgl-utils":function(){define([],
function(){var q=function(f,c){for(var b=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=null,e=0;e<b.length;++e){try{a=f.getContext(b[e],c)}catch(h){}if(a)break}return a},n=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f,c){return window.setTimeout(f,1E3/60)}).bind(window),k=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||
window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout).bind(window);return{create3DContext:q,setupWebGL:function(f,c){function b(a){var b=f.parentNode;b&&(b.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+a+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return b('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var a=q(f,c);return!a?(b('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):
[a]},detectWebGL:function(){var f;try{f=window.WebGLRenderingContext}catch(c){f=[!1,0]}var b;try{b=q(document.createElement("canvas"))}catch(a){b=[!1,1]}return!f?[!1,0]:!b?[!1,1]:[!0,{VERSION:b.getParameter(b.VERSION),SHADING_LANGUAGE_VERSION:b.getParameter(b.SHADING_LANGUAGE_VERSION),VENDOR:b.getParameter(b.VENDOR),RENDERER:b.getParameter(b.RENDERER),EXTENSIONS:b.getSupportedExtensions(),MAX_TEXTURE_SIZE:b.getParameter(b.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:b.getParameter(b.MAX_RENDERBUFFER_SIZE),
MAX_VERTEX_TEXTURE_IMAGE_UNITS:b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]},requestAnimFrame:n,cancelAnimFrame:k}})},"esri/views/3d/webgl-engine/parts/Viewport":function(){define("require exports dojo/has ../lib/PerformanceTimer ../lib/Camera ../lib/Util ../lib/BitSet ../lib/gl-matrix ./Visualizer".split(" "),function(q,n,k,f,c,b,a,e,h){var g=e.vec3;q=e.vec4d;var d=e.mat4d,m=2E4,l=[0,0],p=d.create(),s=[q.create(),q.create(),q.create(),q.create(),q.create(),q.create()],r={get:function(a){return!0}},
t=0;return function(){function e(b,d,l,p){this._content={};this._visibleContent=new a;this._frustumCullingEnabled=!0;this._maxFarNearRatio=m;this._stats={renderGeometriesTotal:0,renderGeometriesVisible:0,visualizerRenderTimer:null,viewportRenderTimer:null};this._needsRender=!0;this._rctx=p;this._gl=p.gl;this._visualizer=new h(b,d,l,this._rctx);this._camera=new c(g.createFrom(0,100,-100),g.createFrom(0,0,0));t&&(this._stats.visualizerRenderTimer=new f(10),this._stats.viewportRenderTimer=new f(10))}
e.prototype.getCombinedStats=function(){var a={},b=this._visualizer.getCombinedStats(),d;for(d in b)a[d]=b[d];a.renderGeometriesTotal=this._stats.renderGeometriesTotal;a.renderGeometriesVisible=this._stats.renderGeometriesVisible;t&&(a.visualizerTotalRenderTime=this._stats.visualizerRenderTimer.getTotal(),a.visualizerCurrentRenderTime=this._stats.visualizerRenderTimer.getLastFiltered(),a.viewportTotalRenderTime=this._stats.viewportRenderTimer.getTotal(),a.viewportCurrentRenderTime=this._stats.viewportRenderTimer.getLastFiltered(),
a.totalNumFramesRendered=this._stats.viewportRenderTimer.getNumMeasurements());void 0!==this._gl.getUsedTextureMemory&&(a.textureMemory=this._gl.getUsedTextureMemory());void 0!==this._gl.getUsedRenderbufferMemory&&(a.renderbufferMemory=this._gl.getUsedRenderbufferMemory());void 0!==this._gl.getUsedVBOMemory&&(a.VBOMemory=this._gl.getUsedVBOMemory());if(void 0!==this._gl.getUsedTextureMemoryStats){var b=this._gl.getUsedTextureMemoryStats(),c;for(c in b)a["texMem type: "+c]=b[c]}return a};e.prototype.dispose=
function(){this._visualizer.dispose();this._visualizer=null};e.prototype.setLightingData=function(a){this._visualizer.setLightingData(a)};e.prototype.getLightingData=function(){return this._visualizer.getLightingData()};e.prototype.getViewParams=function(a){var b=this._visualizer.getViewParams(a);if(!a||a.frustumCullingEnabled)b.frustumCullingEnabled=this._frustumCullingEnabled;if(!a||a.maxFarNearRatio)b.maxFarNearRatio=this._maxFarNearRatio;return b};e.prototype.setViewParams=function(a){void 0!==
a.frustumCullingEnabled&&(this._frustumCullingEnabled=a.frustumCullingEnabled);void 0!==a.maxFarNearRatio&&(this._maxFarNearRatio=-1===a.maxFarNearRatio?m:a.maxFarNearRatio);this._visualizer.setViewParams(a);this._needsRender=!0};e.prototype.setRenderParams=function(a){this._visualizer.setRenderParams(a)};e.prototype.getRenderParams=function(){return this._visualizer.getRenderParams()};e.prototype.getFrustumObjects=function(){var a={},b;for(b in this._content)this._visibleContent.get(this._content[b].idx)&&
(a[this._content[b].name]=1);return a};e.prototype.modify=function(a,b,d,c){this._visualizer.modify(a,b,d,c);this._content=this._visualizer.getContent()};e.prototype.getContent=function(){return this._content};e.prototype.setSelectionObject=function(a,b){this._visualizer.setSelectionObject(a,b)};e.prototype.setCamera=function(a){this._camera.copyFrom(a);this._computeVisibleContentAndUpdateNearFar();this._needsRender=!0};e.prototype.getCamera=function(){return this._camera};e.prototype.getPickRay=
function(a,b,d){return this.pickRayWithBeginPoint(a,void 0,this._camera.viewMatrix,b,d)};e.prototype.pickRayWithBeginPoint=function(a,b,d,c,e){return this._visualizer.getPickRay(a,b,this._camera,d,c,e)};e.prototype.addExternalRenderer=function(a,b){return this._visualizer.addExternalRenderer(a,b)};e.prototype.removeExternalRenderer=function(a){return this._visualizer.removeExternalRenderer(a)};e.prototype.getExternalRenderers=function(){return this._visualizer.getExternalRenderers()};e.prototype.render=
function(a,b){t&&this._stats.viewportRenderTimer.start();var d=this._computeVisibleContentAndUpdateNearFar();t&&this._stats.visualizerRenderTimer.start();this._visualizer.render(this._camera,a,d,b);t&&(this._stats.visualizerRenderTimer.stop(),this._stats.viewportRenderTimer.stop())};e.prototype.resetNeedsRender=function(){this._needsRender=!1;this._visualizer.resetNeedsRender()};e.prototype.needsRender=function(){return this._needsRender||this._visualizer.needsRender()};e.prototype._computeVisibleContentAndUpdateNearFar=
function(){return this._frustumCullingEnabled||0<this._maxFarNearRatio?(l[1]=0,this._computeFrustumCullingAndNearFar(this._camera.eye,this._visibleContent,l),0<this._maxFarNearRatio&&0<l[1]&&(this._camera.far=l[1],this._camera.near=Math.max(l[0],this._camera.far/this._maxFarNearRatio)),this._visibleContent):r};e.prototype._computeFrustumCullingAndNearFar=function(a,c,e){d.perspective(this._camera.fovY,this._camera.aspect,1,10,p);b.matrix2frustumPlanes(this._camera.viewMatrix,p,s);c.clearAll();this._stats.renderGeometriesTotal=
0;this._stats.renderGeometriesVisible=0;a=-Number.MAX_VALUE;var g=-Number.MAX_VALUE,h=s[0][0],m=s[0][1],l=s[0][2],f=s[0][3],r=s[1][0],k=s[1][1],t=s[1][2],u=s[1][3],n=s[2][0],O=s[2][1],J=s[2][2],F=s[2][3],K=s[3][0],q=s[3][1],R=s[3][2],da=s[3][3],S=s[4][0],ba=s[4][1],aa=s[4][2],$=s[4][3],Z=s[5][3],M;for(M in this._content){var V=this._content[M];this._stats.renderGeometriesTotal++;if(!V.material.isBackdrop){var L=V.center,U=L[0],N=L[1],Q=L[2],L=V.bsRadius;if(h*U+m*N+l*Q+f>L)continue;if(r*U+k*N+t*Q+
u>L)continue;if(n*U+O*N+J*Q+F>L)continue;if(K*U+q*N+R*Q+da>L)continue;N=S*U+ba*N+aa*Q;U=N+L;L=-N+L;U>a&&(a=U);L>g&&(g=L)}c.set(V.idx);this._stats.renderGeometriesVisible++}c=a!==-Number.MAX_VALUE;g+=Z;0<this._stats.renderGeometriesVisible&&c&&(e[0]=0.99*Math.max(1-(a+$),2),e[1]=1.01*Math.max(10+g,e[0]+1))};return e}()})},"esri/views/3d/webgl-engine/lib/PerformanceTimer":function(){define(["require","exports","./Util"],function(q,n,k){return function(){function f(c){this._filterSampleIndex=0;this._lastTime=
NaN;this._numMeasurements=this._totalTime=0;this._filterSamples=Array(c);this.reset();this._filterSize=c}f.prototype.reset=function(){for(var c=this._filterSampleIndex=0;c<this._filterSize;c++)this._filterSamples[c]=NaN};f.prototype.start=function(){this._tsStart=k.performance.now()};f.prototype.stop=function(){this._lastTime=k.performance.now()-this._tsStart;this._totalTime+=this._lastTime;this._numMeasurements++;this._filterSize&&(this._filterSamples[this._filterSampleIndex]=this._lastTime,this._filterSampleIndex=
(this._filterSampleIndex+1)%this._filterSize);return this._lastTime};f.prototype.getLast=function(){return this._lastTime};f.prototype.getLastFiltered=function(){for(var c=0,b=0;b<this._filterSamples.length;b++)c+=this._filterSamples[b];return c/this._filterSamples.length};f.prototype.getAverage=function(){return this._totalTime/this._numMeasurements};f.prototype.getTotal=function(){return this._totalTime};f.prototype.getNumMeasurements=function(){return this._numMeasurements};return f}()})},"esri/views/3d/webgl-engine/parts/Visualizer":function(){define("require exports ../lib/Renderer ../lib/SSAOHelperObscurance ../lib/ShadowMap ../lib/NearFarCalc ../lib/Util ../lib/gl-matrix ../lib/RenderPass ../lib/HighlightHelper ../lib/OffscreenRenderingHelper".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d){var m=e.vec3d,l=e.mat4d,p=a.assert;return function(){function e(a,h,m,l){this._drawSSAOMapDebugQuad=this._drawShadowMapDebugQuad=!1;this._needsRender=!0;this._content={};this._rctx=l;this._renderer=new k(a,h,m,this._rctx,!1);this._programRep=a;this._shadowMap=new c(a,this._rctx);this._ssaoHelper=new f(a,m,this._rctx);this._nearFarCalc=new b;this._highlightHelper=new g(a,m,this._rctx);this._offscreenRenderingHelper=new d(a,this._rctx)}e.prototype.getCombinedStats=function(){return this._renderer.getCombinedStats()};
e.prototype.dispose=function(){this._renderer.dispose();this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(!1);this._shadowMap.dispose();this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(!1);this._ssaoHelper.dispose();this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!1);this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(!1)};e.prototype.setLightingData=function(a){this._renderer.setLightingData(a)};
e.prototype.getLightingData=function(){return this._renderer.getLightingData()};e.prototype.getViewParams=function(a){var b=a||{};if(!a||a.pixelRatio)b.pixelRatio=this._renderer.getPixelRatio();return b};e.prototype.setViewParams=function(a){null!=a.pixelRatio&&this._renderer.setPixelRatio(a.pixelRatio)};e.prototype.setRenderParams=function(a){void 0!==a.shadowMapResolution&&!1===this._shadowMap.getEnableState()&&this._shadowMap.setTextureResolution(a.shadowMapResolution);void 0!==a.shadowMap&&a.shadowMap!==
this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(a.shadowMap);void 0!==a.shadowMapMaxCascades&&this._shadowMap.setMaxNumCascades(a.shadowMapMaxCascades);!0!==this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!0);void 0!==a.ssao&&a.ssao!==this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(a.ssao);void 0!==a.ssaoAttenuation&&this._ssaoHelper.setAttenuation(a.ssaoAttenuation);void 0!==a.ssaoRadius&&this._ssaoHelper.setRadius(a.ssaoRadius);void 0!==
a.ssaoFilterRadius&&console.error("The property ssaoFilterRadius is no longer supported as a render parameter.");void 0!==a.ssaoSamples&&this._ssaoHelper.setSamples(a.ssaoSamples);void 0!==a.drawShadowMapDebugQuad&&(this._drawShadowMapDebugQuad=a.drawShadowMapDebugQuad);void 0!==a.drawSSAODebugQuad&&(this._drawSSAOMapDebugQuad=a.drawSSAODebugQuad);this._ssaoHelper.getEnableState()?this._renderer.ssaoEnabled=!0:this._renderer.ssaoEnabled=!1;void 0!==a.offscreenRendering&&a.offscreenRendering!==this._offscreenRenderingHelper.getEnableState()&&
this._offscreenRenderingHelper.setEnableState(a.offscreenRendering);void 0!==a.antialiasingEnabled&&(this._renderer.renderOptions.antialiasing=a.antialiasingEnabled?"smaa":"none");void 0!==a.earlyOcclusionPixelDraw&&(this._renderer.renderOptions.earlyOcclusionPixelDraw=a.earlyOcclusionPixelDraw);this._needsRender=!0};e.prototype.getRenderParams=function(){var a={};this._shadowMap.getIsSupported()&&(a.shadowMap=this._shadowMap.getEnableState(),a.shadowMapResolution=this._shadowMap.getTextureResolution(),
a.shadowMapMaxCascades=this._shadowMap.getMaxNumCascades());this._ssaoHelper.getIsSupported()&&(a.ssao=this._ssaoHelper.getEnableState(),a.ssaoAttenuation=this._ssaoHelper.getAttenuation(),a.ssaoRadius=this._ssaoHelper.getRadius(),a.ssaoFilterRadius=this._ssaoHelper.getFilterRadius(),a.ssaoSamples=this._ssaoHelper.getSamples());return a};e.prototype.modify=function(a,b,d,c){this._renderer.modify(a,b,d,c);c=0;for(var e=b.length;c<e;++c)delete this._content[b[c].uniqueName];c=0;for(b=a.length;c<b;++c)this._content[a[c].uniqueName]=
a[c];c=0;for(a=d.length;c<a;++c)p(this._content[d[c].renderGeometry.uniqueName]===d[c].renderGeometry)};e.prototype.getContent=function(){return this._content};e.prototype.getPickRay=function(a,b,d,c,e,g){m.unproject(m.createFrom(a[0],a[1],0),c,d.projectionMatrix,d.fullViewport,e);m.unproject(m.createFrom(a[0],a[1],1),c,d.projectionMatrix,d.fullViewport,g)};e.prototype.getProjectionMatrix=function(b,d,c,e,g){d=a.fovx2fovy(d,b[2],b[3]);l.perspective(180*d/Math.PI,b[2]/b[3],c,e,g)};e.prototype.setSelectionObject=
function(a,b){this._renderer.setSelectionObject(a,b)};e.prototype.addExternalRenderer=function(a,b){return this._renderer.addExternalRenderer(a,b)};e.prototype.removeExternalRenderer=function(a){return this._renderer.removeExternalRenderer(a)};e.prototype.getExternalRenderers=function(){return this._renderer.getExternalRenderers()};e.prototype.resetNeedsRender=function(){this._needsRender=!1;this._renderer.resetNeedsRender()};e.prototype.needsRender=function(){return this._needsRender||this._renderer.needsRender()};
e.prototype.render=function(a,b,d,c){var e=a.viewport,g;if(this._shadowMap.getEnableState()||this._ssaoHelper.getEnableState())g=this._nearFarCalc.calculateSceneNearFar(a,this._content,d);if(this._shadowMap.getEnableState()){this._shadowMap.prepare(a,b,this._content,d,g);b=this._shadowMap.getCascades();for(var m=0;m<b.length;++m){var f=b[m];f.camera.setGLViewport(this._rctx);this._renderer.renderGeometryPass(h.MATERIAL_DEPTH_SHADOWMAP,f.camera,d)}this._shadowMap.finish(c);a.setGLViewport(this._rctx)}this._shadowMap.bindAll(this._programRep);
this._renderer.renderAuxiliaryBuffers(a,d,this._shadowMap,this._ssaoHelper,g,c,this._offscreenRenderingHelper);this._renderer.render(a,d,this._shadowMap,this._ssaoHelper,c,this._highlightHelper,this._offscreenRenderingHelper);this._drawShadowMapDebugQuad&&this._shadowMap.getEnableState()&&(a=l.ortho(e[0],e[2],e[1],e[3],-1,1),this._shadowMap.drawDebugQuad(a));this._drawSSAOMapDebugQuad&&this._ssaoHelper.getEnableState()&&(a=l.ortho(e[0],e[2],e[1],e[3],-1,1),this._ssaoHelper.drawQuad(a))};return e}()})},
"esri/views/3d/webgl-engine/lib/SSAOHelperObscurance":function(){define("require exports ../../../../core/Logger ./Util ./gl-matrix dojo/text!../materials/internal/ssao.xml ../../../webgl/Program ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s){var r=c.vec3d,t=c.vec4d,u=k.getLogger("esri.views.3d.webgl-engine");
q=function(){function c(a,b,d){this._enabled=!1;this._BLUR_F=2;this._attenuation=0.5;this._radius=3;this._samples=16;this._viewportToRestore=t.create();this._rctx=d;this._programRep=a;this._textureRep=b;this._emptyTexture=new e(d,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:4,height:4},null)}c.prototype.dispose=function(){this._emptyTexture.dispose();this._emptyTexture=null};c.prototype.getIsSupported=function(){var a=this._rctx,b=-1!==a.parameters.versionString.indexOf("WebGL 0.93"),
d=-1!==a.parameters.versionString.indexOf("WebGL 0.94");return a.extensions.standardDerivatives&&!(b||d)};c.prototype.setEnableState=function(a){a?this.enable():this.disable()};c.prototype.getEnableState=function(){return this._enabled};c.prototype.enable=function(){var a=this;if(!this.getEnableState())if(this.getIsSupported()){this._enabled=!0;var b={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},d={colorTarget:0,depthStencilTarget:0};this._ssaoFBO=
h.createWithAttachments(this._rctx,b,d);this._blur0FBO=h.createWithAttachments(this._rctx,b,d);this._blur1FBO=h.createWithAttachments(this._rctx,b,d);var c=new Image;c.src="data:image/png;base64,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\x3d\x3d";
c.onload=function(){a._noiseTexture=new e(a._rctx,{target:3553,pixelFormat:6408,dataType:5121,hasMipmap:!0,width:z,height:z},c)}}else u.warn("SSAO is not supported for this browser or hardware")};c.prototype.getQuadVAO=function(){if(!this._quadVAO){var a=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this._quadVAO=new g(this._rctx,s.Default3D,{geometry:p.Pos2},{geometry:d.createVertex(this._rctx,35044,a)})}return this._quadVAO};c.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this._quadVAO&&
this._quadVAO.dispose(!0),this._noiseTexture&&this._noiseTexture.dispose(),this._blur1FBO.dispose(),this._blur0FBO.dispose(),this._ssaoFBO.dispose(),this._ssaoFBO=this._blur0FBO=this._blur1FBO=this._noiseTexture=this._quadVAO=null)};c.prototype.setAttenuation=function(a){this._attenuation=a};c.prototype.getAttenuation=function(){return this._attenuation};c.prototype.setRadius=function(a){this._radius=a};c.prototype.getRadius=function(){return this._radius};c.prototype.getFilterRadius=function(){return 4};
c.prototype.setSamples=function(a){this._samples=a};c.prototype.getSamples=function(){return this._samples};c.prototype.computeSSAO=function(a,b,d,c,e){if(this._noiseTexture){f.assert(this.getEnableState());d=this._rctx;var g=c.width,h=c.height,l=g/this._BLUR_F,p=h/this._BLUR_F;this._ssaoFBO.resize(g,h);this._blur0FBO.resize(l,p);this._blur1FBO.resize(l,p);l=1*g;p=1*h;d.bindFramebuffer(this._ssaoFBO);t.set(a.fullViewport,this._viewportToRestore);d.setViewport(0,0,g,h);var s=this._programRep.get(8>=
this._samples?"ssao8":16>=this._samples?"ssao16":32>=this._samples?"ssao32":"ssao64"),k=this._programRep.get("blur"),u=a.projectionMatrix;v[0]=-2/(l*u[0]);v[1]=-2/(p*u[5]);v[2]=(1-u[2])/u[0];v[3]=(1+u[6])/u[5];u=0===u[11];s.setUniform2f("rnmScale",g/z,h/z);s.setUniform3fv("pSphere",8>=this._samples?C:16>=this._samples?y:32>=this._samples?x:B);d.bindProgram(s);s.setUniform1f("numSpiralTurns",this._samples<A.length?A[this._samples]:5779);s.setUniform4fv("projInfo",new Float32Array(v));g=1/a.computePixelSizeAtDist(1);
s.setUniform1f("projScale",1*g);s.setUniform2f("screenDimensions",l,p);u?(s.setUniform2f("nearFar",a.near,a.far),s.setUniform2f("zScale",0,-1)):(s.setUniform2f("nearFar",a.near,a.far),s.setUniform2f("zScale",1,0));var w=2*this._radius,h=r.dist(a.eye,a.center),w=20*a.computePixelSizeAtDist(h),w=Math.max(0.1,w);s.setUniform1f("radius",w);s.setUniform1f("intensity",4*this._attenuation/Math.pow(w,6));s.setUniform1i("rnm",0);s.setUniform1i("normalMap",1);s.setUniform1i("depthMap",2);d.bindTexture(this._noiseTexture,
0);d.bindTexture(e.colorTexture,1);d.bindTexture(c.colorTexture,2);c=this.getQuadVAO();d.bindVAO(c);d.drawArrays(5,0,m.vertexCount(c,"geometry"));d.bindTexture(this._ssaoFBO.colorTexture,0);d.setViewport(0,0,l/this._BLUR_F,p/this._BLUR_F);d.bindFramebuffer(this._blur0FBO);k.setUniform2f("screenDimensions",l,p);k.setUniform1i("tex",0);k.setUniform1i("normalMap",1);k.setUniform1i("depthMap",2);k.setUniform2f("blurSize",0,1*this._BLUR_F/p);k.setUniform1i("radius",4);k.setUniform1f("g_BlurFalloff",0.08);
k.setUniform2f("nearFar",a.near,a.far);5E4<h&&(g=Math.max(0,g-(h-5E4)));k.setUniform1f("projScale",g);u?k.setUniform2f("zScale",0,-1):k.setUniform2f("zScale",1,0);d.drawArrays(5,0,m.vertexCount(c,"geometry"));k.setUniform2f("blurSize",1*this._BLUR_F/l,0);d.bindFramebuffer(this._blur1FBO);d.bindTexture(this._blur0FBO.colorTexture,0);d.drawArrays(5,0,m.vertexCount(c,"geometry"));d.bindFramebuffer(b);d.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])}};
c.prototype.setUniforms=function(a){var b=this.getEnableState()&&this._noiseTexture,d=this._rctx;d.bindTexture(b?this._blur1FBO.colorTexture:this._emptyTexture,6);d.setActiveTexture(0);a.setUniform1i("ssaoTex",6);b?a.setUniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.width,1/this._ssaoFBO.height):a.setUniform4f("viewportPixelSz",-1,-1,-1,-1)};c.prototype.bindAll=function(a){a=a.getProgramsUsingUniform("viewportPixelSz");for(var b=0;b<a.length;b++)this.setUniforms(a[b])};
c.prototype.drawQuad=function(a){f.assert(this.getEnableState());var b=this._programRep.get("showDepth");this._debugQuadVAO||(this._debugQuadVAO=new g(this._rctx,s.Default3D,{geometry:p.Pos2Tex},{geometry:d.createVertex(this._rctx,35044,w)}));var c=this._rctx;c.setDepthTestEnabled(!1);b.setUniformMatrix4fv("proj",new Float32Array(a));b.setUniform1i("depthTex",0);c.bindTexture(this._ssaoFBO.colorTexture,0);c.bindVAO(this._debugQuadVAO);c.drawArrays(5,0,m.vertexCount(this._debugQuadVAO,"geometry"));
c.setDepthTestEnabled(!0)};c.loadShaders=function(d,c,e,g){f.assert(null==d.samples);d.samples="samplesUNDEF";d._parse(b);c=new a(g,d.vertexShaderShowDepth,d.fragmentShaderShowDepth,s.Default3D);var h=d.createFsSSAOSrcObscurance,m=new a(g,d.vsUVQuad,h.replace("samplesUNDEF","8"),s.Default3D),l=new a(g,d.vsUVQuad,h.replace("samplesUNDEF","16"),s.Default3D),p=new a(g,d.vsUVQuad,h.replace("samplesUNDEF","32"),s.Default3D),h=new a(g,d.vsUVQuad,h.replace("samplesUNDEF","64"),s.Default3D);g=new a(g,d.vsUVQuad,
d.fsBlurEdgeAware,s.Default3D,["RADIUS "+(4).toString()]);e.add("showDepth",c);e.add("ssao8",m);e.add("ssao16",l);e.add("ssao32",p);e.add("ssao64",h);e.add("blur",g);delete d.samples};return c}();var v=t.create(),C=new Float32Array([0.186937,0,0,0.677503,0,0,-0.782832,0.128424,0.557187,0.248064,0.460317,-0.659755,0.062892,0.918659,0.312829,-0.241031,-0.814826,0.224206,-0.642866,0.132138,-0.45016,0.145727,-0.590568,-0.626141,0.005017,-0.002234,0.012668]),y=new Float32Array([0.186937,0,0,0.700542,0,
0,-0.864858,-0.481795,-0.111713,-0.624773,0.102853,-0.730153,-0.387172,0.260319,0.007229,-0.222367,-0.642631,-0.707697,-0.01336,-0.014956,0.169662,0.122575,0.1544,-0.456944,-0.177141,0.85997,-0.42346,-0.131631,0.814545,0.524355,-0.779469,0.007991,0.624833,0.308092,0.209288,0.35969,0.359331,-0.184533,-0.377458,0.192633,-0.482999,-0.065284,0.233538,0.293706,-0.055139,0.417709,-0.386701,0.442449,-0.301656,-0.836426,0.408344]),x=new Float32Array([0.837372,0,0,0.723531,-0.467287,0.034157,0.169582,-0.31169,
-0.881801,0.696236,0.455215,-0.204568,-0.304514,0.528086,0.626381,-0.053116,0.222507,0.037523,0.199755,0.311291,0.916799,-0.681552,-0.516264,0.501792,-0.37127,0.021088,0.737477,-0.029503,0.209188,-0.95298,-0.573731,0.009962,-0.154202,-0.257345,-0.905958,0.282747,0.370779,0.527867,-0.669424,-0.601758,-0.191278,-0.708243,0.271796,0.782684,0.535565,-0.006867,-0.015312,-0.017276,0.419958,0.265628,0.233036,-0.543898,0.554747,-0.174055,-0.079242,0.053475,-0.099539,0.372042,-0.339267,-0.357362,0.015781,
-0.011352,0.042707,-0.340564,-0.272507,-0.067725,0.799249,-0.127948,0.586808,0.450015,0.01965,-0.416454,-0.506524,0.323229,0.206546,-0.087316,-0.311097,0.466049,0.146374,-0.34528,-0.045904,-0.152614,-0.926686,-0.287529,-0.665726,-0.032904,0.246643,0.248703,0.637193,-0.062541,-0.073706,0.495925,-0.315143,0.05946,-0.116042,0.075586]),B=new Float32Array([0.186937,0,0,0.605726,-0.313457,-0.097616,0.003541,0.781245,0.283011,-0.225029,-0.373279,0.274442,-0.047511,0.04992,-0.226365,0.627629,-0.623617,-0.463628,
0.133094,-0.318299,0.528128,0.262035,0.100234,-0.09012,0.178335,-0.426972,-0.666048,-0.27306,-0.207352,0.05514,-0.613649,-0.063395,0.060608,-0.283391,-0.41382,-0.087565,0.136768,0.506126,0.484137,-0.593808,-0.344603,0.453164,0.675326,0.124799,-0.697865,-0.33502,0.411337,-0.09337,-0.15271,0.002908,-0.063582,0.366733,-0.699739,0.401148,-0.519536,-0.585625,-0.508413,0.106482,-0.428709,-0.260221,0.012847,-0.118806,0.016962,-0.188182,0.49945,0.452364,0.586617,0.722539,-0.23302,0.111295,0.202827,0.066695,
-0.036503,0.315842,0.896467,-0.039109,-0.270116,-0.080062,0.613435,0.508787,0.538656,-0.352275,0.566869,-0.666275,0.887876,-0.138341,-0.434135,-0.444711,0.269156,0.119506,-0.029457,-0.077316,0.754474,0.274125,-0.13876,-0.37082,-0.73268,0.332723,0.568545,-0.203992,0.878922,-0.430778,0.541154,-0.546752,0.11786,-3.93E-4,-0.083318,0.059333,-0.341406,-0.117017,-0.318568,-0.262425,-0.457913,0.848753,0.89229,-0.30157,0.322416,0.742328,0.032262,0.643827,0.048091,-0.078044,-0.49908,0.064858,0.549944,-0.796252,
-0.230688,0.88978,-0.010153,0.397241,-0.27645,0.405666,-0.46593,0.131187,-0.600166,0.333834,-0.078219,0.73837,-0.870169,-0.411658,-0.222175,-0.492421,0.741454,0.293757,-0.591244,0.389112,-0.388324,0.792346,0.578552,0.088459,-0.121858,-0.437241,-0.472535,-0.374835,0.302427,0.721264,0.057485,0.204085,-0.126575,0.510325,0.481492,-0.579888,-0.29411,-0.82136,0.156404,-0.819717,-0.042466,0.456573,0.079884,0.07019,0.179002,0.220279,0.970222,-0.088025,-0.299911,-0.234627,-0.820794,0.912112,0.243306,0.317869,
0.241336,0.161841,-0.721568,0.301135,-0.635993,-0.0939,-0.514731,-0.089673,0.850964,-0.905087,0.314604,-0.098397]),z=64,A=[1,1,1,2,3,2,5,2,3,2,3,3,5,5,3,4,7,5,5,7,9,8,5,5,7,7,7,8,5,8,11,12,7,10,13,8,11,8,7,14,11,11,13,12,13,19,17,13,11,18,19,11,11,14,17,21,15,16,17,18,13,17,11,17,19,18,25,18,19,19,29,21,19,27,31,29,21,18,17,29,31,31,23,18,25,26,25,23,19,34,19,27,21,25,39,29,17,21,27,29],w=new Float32Array([0,0,0,0,512,0,1,0,0,512,0,1,512,512,1,1]);return q})},"esri/views/3d/webgl-engine/lib/ShadowMap":function(){define("./Camera ./Util ./gl-matrix ../../../../core/Logger ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d){var m=k.vec2d,l=k.vec3d,p=k.vec4d,s=k.mat3d,r=k.mat4d,t=k.mat4,u=f.getLogger("esri.views.3d.webgl-engine");return function(f,k){function y(a,b){l.set3(a[b],a[b+3],a[b+6],oa);return oa}var x=k.gl,B,z=4096,A,w=new c(k,{target:x.TEXTURE_2D,pixelFormat:x.RGBA,dataType:x.UNSIGNED_BYTE,samplingMode:x.NEAREST,width:4,height:4}),D=1,E=2,H=[0,0,0,0,0];this.dispose=function(){w.dispose();w=null};var G=function(){this.camera=new q;this.lightMat=r.create()},I=[],O,J,F;for(O=0;4>
O;++O)I[O]=new G;this.getIsSupported=function(){return k.extensions.standardDerivatives};this.setTextureResolution=function(a){z=a};this.getTextureResolution=function(){return z};this.setMaxNumCascades=function(a){E=n.clamp(Math.floor(a),1,4)};this.getMaxNumCascades=function(){return E};this.setEnableState=function(a){a?this.enable():this.disable()};this.getEnableState=function(){return void 0!==B};this.enable=function(){this.getEnableState()||(this.getIsSupported()?(B=new c(k,{target:x.TEXTURE_2D,
pixelFormat:x.RGBA,dataType:x.UNSIGNED_BYTE,wrapMode:x.CLAMP_TO_EDGE,samplingMode:x.NEAREST,flipped:!0,width:z,height:z}),A=b.createWithAttachments(k,B,{colorTarget:0,depthStencilTarget:1,width:z,height:z})):u.warn("Shadow maps are not supported for this browser or hardware"))};this.disable=function(){this.getEnableState()&&A&&(A.dispose(),B=A=void 0)};var K=r.create(),T=r.create(),R=p.create(),da=Array(8);for(O=0;8>O;++O)da[O]=p.create();var S=l.create(),ba=l.create(),aa=m.create(),$=m.create(),
Z=m.create(),M=m.create(),V=m.create(),L=r.create(),U=l.create();this.prepare=function(a,b,d,c,e){n.assert(this.getEnableState());r.multiply(a.projectionMatrix,a.viewMatrix,K);var g=e[0],h=e[1];2>g&&(g=2);2>h&&(h=2);g>=h&&(g=2,h=4);D=Math.min(1+Math.floor(n.logWithBase(h/g,4)),E);d=Math.pow(h/g,1/D);for(e=0;e<D+1;++e)H[e]=g*Math.pow(d,e);r.inverse(K,T);r.lookAt([0,0,0],[-b[0],-b[1],-b[2]],[0,1,0],L);d=a.viewMatrix;a=a.projectionMatrix;for(e=0;e<D;++e){c=I[e];g=-H[e];h=-H[e+1];g=(a[10]*g+a[14])/Math.abs(a[11]*
g+a[15]);h=(a[10]*h+a[14])/Math.abs(a[11]*h+a[15]);n.assert(g<h);for(J=0;8>J;++J){p.set4(0===J%4||3==J%4?-1:1,0===J%4||1==J%4?-1:1,4>J?g:h,1,R);r.multiplyVec4(T,R,da[J]);for(F=0;3>F;++F)da[J][F]/=da[J][3]}l.negate(da[0],U);r.translate(L,U,c.camera.viewMatrix);for(J=0;8>J;++J)r.multiplyVec3(c.camera.viewMatrix,da[J]);l.set(da[0],S);l.set(da[0],ba);for(J=1;8>J;++J)for(F=0;3>F;++F)S[F]=Math.min(S[F],da[J][F]),ba[F]=Math.max(ba[F],da[J][F]);S[2]-=200;ba[2]+=200;c.camera.near=-ba[2];c.camera.far=-S[2];
g=1/da[0][3];h=1/da[4][3];n.assert(g<h);var f=g+Math.sqrt(g*h),s=Math.sin(Math.acos(d[2]*b[0]+d[6]*b[1]+d[10]*b[2])),f=f/s,g=da,t=f,u=s,s=aa,v=$,w=Z,G=M,f=V;m.set2(0,0,ca);for(var B=void 0,B=0;4>B;++B)m.add(ca,g[B],ca);m.scale(ca,0.25);m.set2(0,0,Y);for(B=4;8>B;++B)m.add(Y,g[B],Y);m.scale(Y,0.25);m.lerp(g[4],g[5],0.5,fa[0]);m.lerp(g[5],g[6],0.5,fa[1]);m.lerp(g[6],g[7],0.5,fa[2]);m.lerp(g[7],g[4],0.5,fa[3]);for(var O=0,q=m.dist2(fa[0],ca),B=1;4>B;++B){var X=m.dist2(fa[B],ca);X<q&&(q=X,O=B)}m.subtract(fa[O],
g[O+4],ea);B=ea[0];ea[0]=-ea[1];ea[1]=B;m.subtract(Y,ca,ia);m.lerp(ea,ia,u);m.normalize(ea);O=u=void 0;u=O=m.dot(m.subtract(g[0],ca,ha),ea);for(B=1;8>B;++B)q=m.dot(m.subtract(g[B],ca,ha),ea),q<u?u=q:q>O&&(O=q);m.set(ca,s);m.scale(ea,u-t,ha);m.add(s,ha,s);for(var X=-1,Q=1,B=t=q=0;8>B;++B){m.subtract(g[B],s,ma);m.normalize(ma);var P=ea[0]*ma[1]-ea[1]*ma[0];0<P?P>X&&(X=P,q=B):P<Q&&(Q=P,t=B)}n.verify(0<X,"leftArea");n.verify(0>Q,"rightArea");m.scale(ea,u,ka);m.add(ka,ca,ka);m.scale(ea,O,ga);m.add(ga,
ca,ga);ja[0]=-ea[1];ja[1]=ea[0];v=n.rayRay2D(s,g[t],ga,m.add(ga,ja,ha),1,v);w=n.rayRay2D(s,g[q],ga,ha,1,w);G=n.rayRay2D(s,g[q],ka,m.add(ka,ja,ha),1,G);g=n.rayRay2D(s,g[t],ka,ha,1,f);n.verify(v,"rayRay");n.verify(w,"rayRay");n.verify(G,"rayRay");n.verify(g,"rayRay");w=aa;g=$;s=M;G=V;f=c.camera.projectionMatrix;m.scale(m.subtract(s,G,la),0.5);W[0]=la[0];W[1]=la[1];W[2]=0;W[3]=la[1];W[4]=-la[0];W[5]=0;W[6]=la[0]*la[0]+la[1]*la[1];W[7]=la[0]*la[1]-la[1]*la[0];W[8]=1;W[6]=-m.dot(y(W,0),w);W[7]=-m.dot(y(W,
1),w);w=m.dot(y(W,0),s)+W[6];v=m.dot(y(W,1),s)+W[7];B=m.dot(y(W,0),G)+W[6];G=m.dot(y(W,1),G)+W[7];w=-(w+B)/(v+G);W[0]+=W[1]*w;W[3]+=W[4]*w;W[6]+=W[7]*w;w=1/(m.dot(y(W,0),s)+W[6]);v=1/(m.dot(y(W,1),s)+W[7]);W[0]*=w;W[3]*=w;W[6]*=w;W[1]*=v;W[4]*=v;W[7]*=v;W[2]=W[1];W[5]=W[4];W[8]=W[7];W[7]+=1;w=m.dot(y(W,1),g)+W[7];v=m.dot(y(W,2),g)+W[8];B=m.dot(y(W,1),s)+W[7];G=m.dot(y(W,2),s)+W[8];w=-0.5*(w/v+B/G);W[1]+=W[2]*w;W[4]+=W[5]*w;W[7]+=W[8]*w;w=m.dot(y(W,1),g)+W[7];v=m.dot(y(W,2),g)+W[8];B=-v/w;W[1]*=B;
W[4]*=B;W[7]*=B;f[0]=W[0];f[1]=W[1];f[2]=0;f[3]=W[2];f[4]=W[3];f[5]=W[4];f[6]=0;f[7]=W[5];f[8]=0;f[9]=0;f[10]=1;f[11]=0;f[12]=W[6];f[13]=W[7];f[14]=0;f[15]=W[8];c.camera.projectionMatrix[10]=2/(S[2]-ba[2]);c.camera.projectionMatrix[14]=-(S[2]+ba[2])/(S[2]-ba[2]);r.multiply(c.camera.projectionMatrix,c.camera.viewMatrix,c.lightMat);g=z/2;c.camera.viewport[0]=0===e%2?0:g;c.camera.viewport[1]=0===Math.floor(e/2)?0:g;c.camera.viewport[2]=g;c.camera.viewport[3]=g}H[D]=100*h;k.bindFramebuffer(A);k.bindTexture(null,
7);k.setClearColor(1,1,1,1);k.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT);k.setBlendingEnabled(!1)};var N=[];this.getCascades=function(){for(var a=0;a<D;++a)N[a]=I[a];N.length=D;return N};this.finish=function(a){n.assert(this.getEnableState());k.bindFramebuffer(a)};this.bind=function(a){var b=this.getEnableState();k.bindTexture(b?B:w,7);k.bindProgram(a);a.setUniform1i("depthTex",7);a.setUniform1f("depthHalfPixelSz",b?0.5/z:-1);a.setUniform1i("shadowMapNum",D);a.setUniform4f("shadowMapDistance",H[0],
H[1],H[2],H[3])};this.bindAll=function(a){a=a.getProgramsUsingUniform("shadowMapDistance");for(var b=0;b<a.length;b++)this.bind(a[b])};var Q=t.create(),P=new Float32Array(64);this.bindView=function(a,b){if(this.getEnableState()){var d;t.translate(I[0].lightMat,b,Q);for(d=0;16>d;++d)P[d]=Q[d];t.translate(I[1].lightMat,b,Q);for(d=0;16>d;++d)P[16+d]=Q[d];t.translate(I[2].lightMat,b,Q);for(d=0;16>d;++d)P[32+d]=Q[d];t.translate(I[3].lightMat,b,Q);for(d=0;16>d;++d)P[48+d]=Q[d];a.setUniformMatrix4fv("shadowMapMatrix",
P)}};G=new Float32Array(16);G[0]=0;G[1]=0;G[2]=0;G[3]=0;G[4]=256;G[5]=0;G[6]=1;G[7]=0;G[8]=0;G[9]=256;G[10]=0;G[11]=1;G[12]=256;G[13]=256;G[14]=1;G[15]=1;var X=new a(k,h.Default3D,{geometry:g.Pos2Tex},{geometry:e.createVertex(k,x.STATIC_DRAW,G)});this.drawDebugQuad=function(a){n.assert(this.getEnableState());var b=f.get("showDepth");k.setDepthTestEnabled(!1);k.bindProgram(b);b.setUniformMatrix4fv("proj",a);b.setUniform1i("depthTex",0);k.bindTexture(B,0);k.bindVAO(X);d.assertCompatibleVertexAttributeLocations(X,
b);k.drawArrays(x.TRIANGLE_STRIP,0,d.vertexCount(X,"geometry"));k.setDepthTestEnabled(!0)};var ca=m.create(),Y=m.create(),fa=[m.create(),m.create(),m.create(),m.create()],ea=m.create(),ia=m.create(),ha=m.create(),ma=m.create(),ka=m.create(),ga=m.create(),ja=m.create(),oa=l.create(),la=m.create(),W=s.create()}})},"esri/views/3d/webgl-engine/lib/NearFarCalc":function(){define(["require","exports","./Util","./gl-matrix"],function(q,n,k,f){q=f.vec3d;var c=f.vec4d,b=f.mat4d;f=function(){function b(){this._context=
{content:[],near:[],far:[],nearSpecial:[],farSpecial:[],bestNear:0,bestFar:0,bestNear2:0,bestFar2:0};this._boundingInfoHelper=new a}b.prototype._resetContext=function(){var a=this._context;a.content.length=0;a.near.length=0;a.far.length=0;a.nearSpecial.length=0;a.farSpecial.length=0;a.bestNear=Number.MAX_VALUE;a.bestFar=-Number.MAX_VALUE;return this._context};b.prototype.calculateSceneNearFar=function(a,b,d){var c=this._resetContext(),e=a.viewMatrix,g=e[2],h=e[6],m=e[10],f=e[14],k=0,B;for(B in b)if(e=
b[B],!(null!=e.displayedIndexRange&&0===e.displayedIndexRange.length)&&e.castShadow&&d.get(e.idx)){var z=e.bsRadius,A=e.center,w=g*A[0]+h*A[1]+m*A[2]+f,A=w-z,z=w+z;c.content[k]=e;c.near[k]=-z;c.far[k]=-A;++k}if(0===k)return[c.bestNear,c.bestFar];for(b=0;b<k;++b)c.near[b]>c.bestFar&&(c.bestFar=c.near[b]),2<c.near[b]&&c.far[b]<c.bestNear&&(c.bestNear=c.far[b]);c.bestNear2=Math.max(0.5*c.bestNear,2);c.bestFar2=2*c.bestFar;for(b=g=d=0;b<k;++b)c.near[b]<c.bestNear&&(c.near[b]>=c.bestNear2?c.bestNear=c.near[b]:
c.nearSpecial[d++]=b),c.far[b]>c.bestFar&&(c.far[b]<=c.bestFar2?c.bestFar=c.far[b]:c.farSpecial[g++]=b);if(0===d&&0===g)return[c.bestNear,c.bestFar];c.nearSpecial.length=d;c.farSpecial.length=g;c.nearSpecial.sort(function(a,b){return c.near[a]<c.near[b]?-1:c.near[a]>c.near[b]?1:0});c.farSpecial.sort(function(a,b){return c.far[a]<c.far[b]?1:c.far[a]>c.far[b]?-1:0});this._boundingInfoHelper.init(a,c);for(b=0;b<d;++b)c.near[c.nearSpecial[b]]<c.bestNear&&(e=c.content[c.nearSpecial[b]],a=e.boundingInfo,
this._boundingInfoHelper.includeNearBoundingInfoRec(a,e.transformation));for(b=0;b<g;++b)c.far[c.farSpecial[b]]>c.bestFar&&(e=c.content[c.farSpecial[b]],a=e.boundingInfo,this._boundingInfoHelper.includeFarBoundingInfoRec(a,e.transformation));return[c.bestNear,c.bestFar]};return b}();var a=function(){function a(){this._clippingHelper=new e;this._planes=[c.create(),c.create(),c.create(),c.create(),c.create(),c.create()];this._viewProj=b.create();this._view=b.create()}a.prototype.init=function(a,d){this._context=
d;b.set(a.viewMatrix,this._view);b.multiply(a.projectionMatrix,this._view,this._viewProj);a.copyFrustumPlanes(this._planes);this._clippingHelper.init(d)};a.prototype.includeNearBoundingInfoRec=function(a,d){var c=a.getBSRadius(),e=a.getCenter();b.multiplyVec3(d,e,g);var e=d[2]*d[2]+d[6]*d[6]+d[10]*d[10],e=Math.sqrt(Math.max(Math.max(d[0]*d[0]+d[4]*d[4]+d[8]*d[8],d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),e)),h=g[0],m=g[1],f=g[2],c=c*e;if(!(this._planes[0][0]*h+this._planes[0][1]*m+this._planes[0][2]*f+this._planes[0][3]>
c)&&(!(this._planes[1][0]*h+this._planes[1][1]*m+this._planes[1][2]*f+this._planes[1][3]>c)&&!(this._planes[2][0]*h+this._planes[2][1]*m+this._planes[2][2]*f+this._planes[2][3]>c)&&!(this._planes[3][0]*h+this._planes[3][1]*m+this._planes[3][2]*f+this._planes[3][3]>c))&&(e=this._view[2]*h+this._view[6]*m+this._view[10]*f+this._view[14],h=e+c,!(2>-(e-c))&&!(-h>=this._context.bestNear)))if(-h>this._context.bestNear2)this._context.bestNear=-h;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(e=0;8>e;++e)void 0!==
c[e]&&this.includeNearBoundingInfoRec(c[e],d);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,d,a.getBBMin(),a.getBBMax())}};a.prototype.includeFarBoundingInfoRec=function(a,d){var c=a.getBSRadius(),e=a.getCenter();b.multiplyVec3(d,e,g);var e=d[2]*d[2]+d[6]*d[6]+d[10]*d[10],e=Math.sqrt(Math.max(Math.max(d[0]*d[0]+d[4]*d[4]+d[8]*d[8],d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),e)),h=g[0],m=g[1],f=g[2],c=c*e;if(!(this._planes[0][0]*h+this._planes[0][1]*m+this._planes[0][2]*f+this._planes[0][3]>c)&&
(!(this._planes[1][0]*h+this._planes[1][1]*m+this._planes[1][2]*f+this._planes[1][3]>c)&&!(this._planes[2][0]*h+this._planes[2][1]*m+this._planes[2][2]*f+this._planes[2][3]>c)&&!(this._planes[3][0]*h+this._planes[3][1]*m+this._planes[3][2]*f+this._planes[3][3]>c))&&(e=this._view[2]*h+this._view[6]*m+this._view[10]*f+this._view[14]-c,!(-e<=this._context.bestFar)))if(-e<this._context.bestFar2)this._context.bestFar=-e;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(e=0;8>e;++e)void 0!==c[e]&&this.includeFarBoundingInfoRec(c[e],
d);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,d,a.getBBMin(),a.getBBMax())}};return a}(),e=function(){function a(){this._clipP=Array(8);for(var b=0;8>b;++b)this._clipP[b]=c.create()}a.prototype.init=function(a){this._context=a};a.prototype.intersectFrustumAABB=function(a,c,e,g){b.multiply(a,c,d);for(a=0;8>a;++a){c=this._clipP[a];var m=0===a||3===a||4===a||7===a?e[0]:g[0],f=0===a||1===a||4===a||5===a?e[1]:g[1],k=4>a?e[2]:g[2];c[0]=d[0]*m+d[4]*f+d[8]*k+d[12];c[1]=d[1]*m+d[5]*f+
d[9]*k+d[13];c[2]=d[2]*m+d[6]*f+d[10]*k+d[14];c[3]=d[3]*m+d[7]*f+d[11]*k+d[15]}for(a=0;12>a;++a){e=this._clipTriangle(this._clipP[h[a][0]],this._clipP[h[a][1]],this._clipP[h[a][2]]);g=!0;for(c=0;c<e.length;++c)if(m=e[c][3],2<=m){g=!1;break}if(!g)for(c=0;c<e.length;++c)m=e[c][3],m<this._context.bestNear&&(this._context.bestNear=m),m>this._context.bestFar&&(this._context.bestFar=m)}};a.prototype._inside=function(a,b){if(0===b)return a[0]>=-a[3];if(1===b)return a[1]>=-a[3];if(2===b)return a[0]<=a[3];
if(3===b)return a[1]<=a[3];k.assert(!1)};a.prototype._intersect=function(a,b,d){var e=0;0===d?e=(-a[3]-a[0])/(b[0]-a[0]+b[3]-a[3]):1===d?e=(-a[3]-a[1])/(b[1]-a[1]+b[3]-a[3]):2===d?e=(a[3]-a[0])/(b[0]-a[0]-b[3]+a[3]):3===d&&(e=(a[3]-a[1])/(b[1]-a[1]-b[3]+a[3]));return c.lerp(a,b,e,c.create())};a.prototype._clipTriangle=function(a,b,d){a=[a,b,d];for(b=0;4>b;++b){d=a;a=[];for(var c=0;c<d.length;++c){var e=d[c],g=d[(c+1)%d.length];this._inside(g,b)?(this._inside(e,b)||a.push(this._intersect(e,g,b)),a.push(g)):
this._inside(e,b)&&a.push(this._intersect(e,g,b))}}return a};return a}(),h=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],g=q.create(),d=b.create();return f})},"esri/views/3d/webgl-engine/lib/HighlightHelper":function(){define("require exports ./Util ./gl-matrix dojo/text!../materials/internal/highlight.xml ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l){var p=f.vec4d;return function(){function d(a,b,c){this.blur1Fbo=this.blur0Fbo=this.quadVAO=null;this._rctx=c;this.viewportToRestore=p.create();this.programRep=a;this.color=p.create();this.exponent=0.3;this.fill=0.1;p.set4(1,0,0.5,1,this.color)}d.prototype.createQuadVAO=function(){var a=this._rctx,b=new Float32Array([-1,-1,1,-1,-1,1,1,1]);return new e(a,l.Default3D,{geometry:m.Pos2},{geometry:h.createVertex(a,35044,b)})};d.prototype.getIsSupported=function(){return!0};
d.prototype.setEnableState=function(a){a?this.enable():this.disable()};d.prototype.getEnableState=function(){return null!==this.blur0Fbo};d.prototype.enable=function(){this.quadVAO=this.createQuadVAO();var a={colorTarget:0,depthStencilTarget:0,width:0,height:0};this.blur0Fbo=b.create(this._rctx,a);this.blur1Fbo=b.create(this._rctx,a)};d.prototype.disable=function(){this.getEnableState()&&(this.quadVAO.dispose(!0),this.blur1Fbo.dispose(),this.blur0Fbo.dispose(),this.blur1Fbo=this.blur0Fbo=this.quadVAO=
null)};d.prototype.getHighlightFBO=function(){return this.blur0Fbo};d.prototype.render=function(a,b,d){this.updateDebugData();var c=this._rctx;k.assert(this.getEnableState());p.set(a.fullViewport,this.viewportToRestore);var e=d.height;a=Math.ceil(d.width/2);e=Math.ceil(e/2);this.blur0Fbo.resize(a,e);this.blur1Fbo.resize(a,e);var h=this.programRep.get("highlight-blur"),m=this.programRep.get("highlight-apply");c.bindVAO(this.quadVAO);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setBlendingEnabled(!1);
c.bindFramebuffer(this.blur0Fbo);c.bindTexture(d.colorTexture,0);c.bindProgram(h);h.setUniform1i("tex",0);h.setUniform2f("blurSize",1/a,0);c.setViewport(0,0,a,e);c.drawArrays(5,0,g.vertexCount(this.quadVAO,"geometry"));c.bindFramebuffer(this.blur1Fbo);this.blur0Fbo.colorTexture.setSamplingMode(9729);c.bindTexture(this.blur0Fbo.colorTexture,0);h.setUniform2f("blurSize",0,1/e);c.drawArrays(5,0,g.vertexCount(this.quadVAO,"geometry"));c.bindFramebuffer(b);c.setBlendingEnabled(!0);c.setBlendFunctionSeparate(770,
771,1,771);c.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3]);c.bindProgram(m);m.setUniform1i("tex",0);this.blur1Fbo.colorTexture.setSamplingMode(9729);c.bindTexture(this.blur1Fbo.colorTexture,0);m.setUniform1i("origin",1);m.setUniform4fv("color",this.color);m.setUniform1f("exponent",this.exponent);m.setUniform1f("fill",this.fill);c.bindTexture(d.colorTexture,1);c.drawArrays(5,0,g.vertexCount(this.quadVAO,"geometry"));c.bindVAO(null);
c.setDepthWriteEnabled(!0);c.setDepthTestEnabled(!0);c.setBlendingEnabled(!1)};d.prototype.updateDebugData=function(){window.webglEngineHighlightColor?p.set(window.webglEngineHighlightColor,this.color):window.webglEngineHighlightColor=[this.color[0],this.color[1],this.color[2],this.color[3]];void 0!==window.webglEngineHighlightExponent?this.exponent=window.webglEngineHighlightExponent:window.webglEngineHighlightExponent=this.exponent;void 0!==window.webglEngineHighlightFill?this.fill=window.webglEngineHighlightFill:
window.webglEngineHighlightFill=this.fill};d.loadShaders=function(b,d,e,g){b._parse(c);d=new a(g,b.vsHighlightBlurG9,b.fsHighlightBlurG9,l.Default3D);b=new a(g,b.vsHighlightApply,b.fsHighlightApply,l.Default3D);e.add("highlight-blur",d);e.add("highlight-apply",b)};return d}()})},"esri/views/3d/webgl-engine/materials/repository":function(){define("dojo/text!./internal/util.xml ./BillboardMaterial ./ColorMaterial ./HUDMaterial ./LeafCardMaterial ./Material ./RibbonLineMaterial ./WaterMaterial ./internal/SimpleGLMaterial ./internal/TexOnlyGLMaterial ./internal/BlendLayers".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d){return{initializeShaders:function(m,l,p,s){m._parse(q);h.loadShaders(m,l,p,s);g.loadShaders(m,l,p,s);b.loadShaders(m,l,p,s);n.loadShaders(m,l,p,s);f.loadShaders(m,l,p,s);c.loadShaders(m,l,p,s);a.loadShaders(m,l,p,s);e.loadShaders(m,l,p,s);d.loadShaders(m,l,p,s);k.loadShaders(m,l,p,s)}}})},"esri/views/3d/webgl-engine/materials/BillboardMaterial":function(){define("dojo/text!./BillboardMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a){var e=function(c,e){n.basicMaterialConstructor(this,e);var f=b.Pos3NormTex;this.getSize=function(){return 1.05};this.dispose=function(){};this.getTextureId=function(){return c};this.getOutputAmount=function(b){var d=a.getStride(f)/4;return 6*b*d};this.getVertexBufferLayout=function(){return f};this.fillInterleaved=function(a,b,d,c,e,g){c=n.fill;var h=a.faces.indices.va,m=a.vertexAttr.va.data,f=a.vertexAttr.tc4.data,l=a.vertexAttr.n0.data,p=a.vertexAttr.n1.data,k=a.vertexAttr.n2.data;
a=a.vertexAttr.n3.data;for(var D=0;D<h.length;++D){var E=4*h[D],H=3*h[D];g+=c(m,E,e,g,b,3);g+=c(l,H,e,g,d,3);e[g++]=f[E];e[g++]=f[E+1];g+=c(m,E,e,g,b,3);g+=c(p,H,e,g,d,3);e[g++]=f[E+2]+1;e[g++]=f[E+1];g+=c(m,E,e,g,b,3);g+=c(k,H,e,g,d,3);e[g++]=f[E+2]+1;e[g++]=f[E+3]+1;g+=c(m,E,e,g,b,3);g+=c(k,H,e,g,d,3);e[g++]=f[E+2]+1;e[g++]=f[E+3]+1;g+=c(m,E,e,g,b,3);g+=c(a,H,e,g,d,3);e[g++]=f[E];e[g++]=f[E+3]+1;g+=c(m,E,e,g,b,3);g+=c(l,H,e,g,d,3);e[g++]=f[E];e[g++]=f[E+1]}};this.intersect=function(){};this.getGLMaterials=
function(){return{color:h,depthShadowMap:d,normal:void 0,depth:g,highlight:void 0}};this.getAllTextureIds=function(){return[c]}},h=function(a,b,d){n.basicGLMaterialConstructor(this,a);var c=k.TRANSPARENT_MATERIAL,e=b.get("billboard");n.singleTextureGLMaterialConstructor(this,d,{textureId:a.getTextureId()});this.beginSlot=function(a){return c===a};this.getProgram=function(){return e};this.bind=function(a,b){a.bindProgram(e);this.bindTexture(a,e)};this.release=function(a){};this.bindView=function(a,
b){n.bindView(b.origin,b.view,e)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation);e.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},g=function(a,b,d,c){n.basicGLMaterialConstructor(this,a);var e=k.TRANSPARENT_MATERIAL,g=null==c?b.get("billboardDepth"):b.get("billboardDepthShadowMap");n.singleTextureGLMaterialConstructor(this,d,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=
function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){n.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.detUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},d=function(a,b,d){g.call(this,a,b,d,!0)};e.loadShaders=function(a,b,d,e){a._parse(q);var g=new f(e,a.vertexShaderBillboard,a.fragmentShaderBillboard,c.Default3D),
h=b.get("fsDepthTextured");b=b.get("fsDepthTexturedShadowMap");h=new f(e,a.vertexShaderBillboardDepth,h.source,c.Default3D,h.defines);a=new f(e,a.vertexShaderBillboardDepth,b.source,c.Default3D,b.defines);d.add("billboard",g);d.add("billboardDepth",h);d.add("billboardDepthShadowMap",a)};return e})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("dojo/_base/lang dojo/text!./ColorMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../lib/Util ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h){c=function(a,b){k.basicMaterialConstructor(this,b);a=a||{};a.color=a.color||[1,1,1,1];a.polygonOffset=a.polygonOffset||!1;a.vertexColors=a.vertexColors||!1;var c=e.Pos3Color;this.getParams=function(){return a};this.setColor=function(b){a.color=b;this.notifyDirty("matChanged")};this.getColor=function(){return a.color};this.setTransparent=function(b){a.transparent=b;this.notifyDirty("matChanged")};this.getTransparent=function(b){return a.transparent};this.dispose=function(){};
this.getOutputAmount=function(a){var b=h.getStride(c)/4;return a*b};this.getVertexBufferLayout=function(){return c};this.fillInterleaved=function(a,b,d,e,g,h,m){k.fillInterleaved(a,b,d,e,c,g,h,m)};this.intersect=k.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:g,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:d}};this.getAllTextureIds=function(){return[]}};var g=function(a,b,d){k.basicGLMaterialConstructor(this,a);var c=q.clone(a.getParams()),e=b.get("colorMaterial"),
g=a.getColor();this.beginSlot=function(a){return a===(1>g[3]?f.TRANSPARENT_MATERIAL:f.OPAQUE_MATERIAL)};this.getProgram=function(){return e};this.updateParameters=function(){c.color=a.getColor();c.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(e);e.setUniform4fv("eColor",c.color);a.setFaceCullingEnabled(!1);c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1));c.transparent&&a.setBlendingEnabled(!0)};this.release=function(a){a.setPolygonOffsetFillEnabled(!1);
c.transparent&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){k.bindView(b.origin,b.view,e)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},d=function(a,b,d){k.basicGLMaterialConstructor(this,a);var c=q.clone(a.getParams()),e=b.get("colorMaterial"),g=[1,1,1,1];this.beginSlot=function(a){return a===(1>g[3]?f.TRANSPARENT_MATERIAL:f.OPAQUE_MATERIAL)};this.getProgram=function(){return e};this.updateParameters=
function(){c.color=a.getColor();c.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(e);e.setUniform4fv("eColor",c.color);a.setFaceCullingEnabled(!1);c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1))};this.release=function(a){a.setPolygonOffsetFillEnabled(!1)};this.bindView=function(a,b){k.bindView(b.origin,b.view,e)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};c.programs=
null;c.loadShaders=function(d,c,e,g){d._parse(n);d=new b(g,d.vertexShaderColorMaterial,d.fragmentShaderColorMaterial,a.Default3D);e.add("colorMaterial",d)};return c})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("dojo/_base/lang dojo/text!./HUDMaterial.xml ./internal/MaterialUtil ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),function(q,n,k,f,c,b,a,e,h,g){var d=
b.vec2d,m=b.vec3d,l=b.mat4d,p=c.assert,s=c.VertexAttrConstants,r={"bottom-left":[0,0],bottom:[0.5,0],"bottom-right":[1,0],left:[0,0.5],center:[0.5,0.5],right:[1,0.5],"top-left":[0,1],top:[0.5,1],"top-right":[1,1]},t=[253/255,231/255,229/255];c=function(a,b){k.basicMaterialConstructor(this,b);a=a||null;a.texCoordScale=a.texCoordScale||[1,1];a.occlusionTest=void 0!==a.occlusionTest?a.occlusionTest:!0;a.color=a.color||[1,1,1,1];a.screenMinMaxSize=a.screenMinMaxSize||[0,1E5];a.outlineColor=a.outlineColor||
[1,1,1,1];a.outlineSize=a.outlineSize||0;a.textureIsSignedDistanceField=a.textureIsSignedDistanceField?1:0;a.distanceFieldBoundingBox=a.distanceFieldBoundingBox||[0.25,0.25,0.75,0.75];a.screenOffset?a.screenOffset.forEach(function(b,d){a.screenOffset[d]=2*b}):a.screenOffset=[0,0];"string"===typeof a.anchorPos?(p(r[a.anchorPos],"HUDMaterial: invalid anchorPos specified"),a.anchorPos=r[a.anchorPos]):a.anchorPos||(a.anchorPos=r.center);null==a.shaderPolygonOffset&&(a.shaderPolygonOffset=1E-5);var d=
[{name:"position",count:3,type:5126,offset:0,stride:60,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:60,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:60,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:60,normalized:!1},{name:"size",count:2,type:5126,offset:36,stride:60,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:44,stride:60,normalized:!1}],c=g.getStride(d),e=c/4;this.dispose=function(){};this.getParameterValues=function(){var b={color:a.color,
texCoordScale:a.texCoordScale,polygonOffset:a.polygonOffset,anchorPos:a.anchorPos,screenOffset:a.screenOffset,screenMinMaxSize:a.screenMinMaxSize,shaderPolygonOffset:a.shaderPolygonOffset,textureIsSignedDistanceField:a.textureIsSignedDistanceField,outlineColor:a.outlineColor,outlineSize:a.outlineSize,distanceFieldBoundingBox:a.distanceFieldBoundingBox};a.textureId&&(b.textureId=a.textureId);a.direction&&(b.direction=a.direction);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===
d&&p(a.textureId,"Can only change texture of material that already has a texture"),"direction"===d&&p(a.direction,"Can only change direction of HUDMaterial which was initialized with a direction"),a[d]=b[d];this.notifyDirty("matChanged")};this.getParams=function(){return a};this.getOutputAmount=function(a){return 6*a*e};this.getVertexBufferLayout=function(){return d};this.fillInterleaved=function(b,h,f,m,l,p){var r=4*p;m=k.fill;for(var t=b.faces.indices[s.POSITION],u=b.vertexAttr[s.POSITION].data,
w=p+g.findAttribute(d,s.POSITION).offset/4,A=0;A<t.length;++A){var v=3*t[A];m(u,v,l,w,h,3);w+=e;m(u,v,l,w,h,3);w+=e;m(u,v,l,w,h,3);w+=e;m(u,v,l,w,h,3);w+=e;m(u,v,l,w,h,3);w+=e;m(u,v,l,w,h,3);w+=e}h=b.faces.indices[s.NORMAL];u=b.vertexAttr[s.NORMAL].data;w=p+g.findAttribute(d,s.NORMAL).offset/4;for(A=0;A<h.length;++A)v=3*h[A],m(u,v,l,w,f,3),w+=e,m(u,v,l,w,f,3),w+=e,m(u,v,l,w,f,3),w+=e,m(u,v,l,w,f,3),w+=e,m(u,v,l,w,f,3),w+=e,m(u,v,l,w,f,3),w+=e;w=p+g.findAttribute(d,s.UV0).offset/4;A=b.vertexAttr[s.UV0].data;
null==A||3>=A.length?(f=v=0,h=a.texCoordScale[0],u=a.texCoordScale[1]):(v=b.vertexAttr[s.UV0].data[0],f=b.vertexAttr[s.UV0].data[1],h=b.vertexAttr[s.UV0].data[2],u=b.vertexAttr[s.UV0].data[3]);h=Math.min(1.99999,h+1);u=Math.min(1.99999,u+1);for(A=0;A<t.length;++A)l[w]=v,l[w+1]=f,w+=e,l[w]=h,l[w+1]=f,w+=e,l[w]=h,l[w+1]=u,w+=e,l[w]=h,l[w+1]=u,w+=e,l[w]=v,l[w+1]=u,w+=e,l[w]=v,l[w+1]=f,w+=e;t=b.faces.indices[s.COLOR];f=b.vertexAttr[s.COLOR].data;w=r+g.findAttribute(d,s.COLOR).offset;r=new Uint8Array(l.buffer);
for(A=0;A<t.length;++A)v=4*t[A],m(f,v,r,w,null,4),w+=c,m(f,v,r,w,null,4),w+=c,m(f,v,r,w,null,4),w+=c,m(f,v,r,w,null,4),w+=c,m(f,v,r,w,null,4),w+=c,m(f,v,r,w,null,4),w+=c;r=b.faces.indices[s.SIZE];t=b.vertexAttr[s.SIZE].data;w=p+g.findAttribute(d,s.SIZE).offset/4;for(A=0;A<r.length;++A)v=t[2*r[A]],f=t[2*r[A]+1],l[w]=v,l[w+1]=f,w+=e,l[w]=v,l[w+1]=f,w+=e,l[w]=v,l[w+1]=f,w+=e,l[w]=v,l[w+1]=f,w+=e,l[w]=v,l[w+1]=f,w+=e,l[w]=v,l[w+1]=f,w+=e;if(null!=b.faces.indices[s.AUXPOS1]&&null!=b.vertexAttr[s.AUXPOS1]){r=
b.faces.indices[s.AUXPOS1];b=b.vertexAttr[s.AUXPOS1].data;w=p+g.findAttribute(d,"auxpos1").offset/4;for(A=0;A<r.length;++A)v=4*r[A],m(b,v,l,w,null,4),w+=e,m(b,v,l,w,null,4),w+=e,m(b,v,l,w,null,4),w+=e,m(b,v,l,w,null,4),w+=e,m(b,v,l,w,null,4),w+=e,m(b,v,l,w,null,4),w+=e}};var h=m.create(),f=m.create(),t=[0,0];this.intersect=function(b,d,c,e,g,r,k,u,x,v,z,y){if(y){d=b.getData().getVertexAttr()[s.POSITION];b=b.getData().getVertexAttr()[s.SIZE];p(3<=d.size);for(k=0;k<d.data.length/d.size;k++)if(u=k*d.size,
m.set3(d.data[u],d.data[u+1],d.data[u+2],h),l.multiplyVec3(c,h,h),u=k*b.size,t[0]=b.data[u],t[1]=b.data[u+1],x.projectPoint(h,f),-1<f[0]){y=a.anchorPos;u=f[0]-1-(0<y[0]?t[0]*y[0]:0);v=u+t[0];y=f[1]-1-(0<y[1]?t[1]*y[1]:0);var B=y+t[1];if(a.textureIsSignedDistanceField){var n=a.distanceFieldBoundingBox,q=a.outlineSize/2;u+=t[0]*n[0]-q;v-=t[0]*(1-n[2])-q;y+=t[1]*n[1]-q;B-=t[1]*(1-n[3])-q}e[0]>u&&(e[0]<v&&e[1]>y&&e[1]<B)&&(u=m.subtract(g,h,m.create()),v=m.length(u),m.scale(u,1/v),v=0.98*v/m.dist(g,r),
z(v,u,-1,1,!0))}}};this.getGLMaterials=function(){return{color:u,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:v}};this.getAllTextureIds=function(){return[a.textureId]};this._textureDirty=!1;this.setTextureDirty=function(){this._textureDirty=!0}};var u=function(b,c,e){function g(){return c.shaderVariators.HUDMaterial.getProgram([!!l.direction,!!l.worldScale,l.occlusionTest,l.textureIsSignedDistanceField])}k.basicGLMaterialConstructor(this,b);var h=a.OCCLUSION_PIXELS,f=a.OVERLAY,m=0,l=
q.clone(b.getParams()),p=c.get("hudOcclusionTestPixel"),s=g();k.singleTextureGLMaterialConstructor(this,e,l);this.beginSlot=function(a){m=a;return l.occlusionTest?a===h||a===f:a===f};this.getProgram=function(){return m===h&&l.occlusionTest?p:s};this.getAllPrograms=function(){return[p,s]};this.updateParameters=function(){var a=b.getParams();l.color=a.color;l.texCoordScale=a.texCoordScale;l.polygonOffset=a.polygonOffset;l.anchorPos=a.anchorPos;l.screenOffset=a.screenOffset;l.screenMinMaxSize=a.screenMinMaxSize;
l.direction=a.direction;l.shaderPolygonOffset=a.shaderPolygonOffset;l.textureIsSignedDistanceField=a.textureIsSignedDistanceField;l.outlineColor=a.outlineColor;l.outlineSize=a.outlineSize;this.updateTexture(a.textureId);s=g()};this.bind=function(a,c){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);var e=a.gl,g=c.cameraAboveGround?1:-1;if(m===h&&l.occlusionTest)a.bindProgram(p),p.setUniform1f("cameraGroundRelative",g),p.setUniform1f("polygonOffset",l.shaderPolygonOffset),p.setUniform4fv("viewport",
c.viewport),p.setUniform4f("color",t[0],t[1],t[2],1),a.setDepthFunction(e.LEQUAL);else{a.bindProgram(s);s.setUniform1f("cameraGroundRelative",g);this.bindTexture(a,s);s.setUniform1i("framebufferTex",1);a.bindTexture(c.framebufferTex,1);a.setActiveTexture(0);s.setUniform3fv("markerColor",t);s.setUniform4fv("viewport",c.viewport);s.setUniform4fv("overrideColor",l.color);s.setUniform1f("pixelRatio",c.pixelRatio);s.setUniform1f("polygonOffset",l.shaderPolygonOffset);l.textureIsSignedDistanceField&&(s.setUniform4fv("outlineColor",
l.outlineColor),s.setUniform1f("outlineSize",l.outlineSize));if(l.worldScale){var e=[-1,-1],g=l.screenMinMaxSize,f=c.proj,r=c.viewport[2]/c.pixelRatio;g&&(0!==f[11]?(f=2*Math.atan(1/f[0]),r=2*(Math.tan(f/2)/r),e[0]=g[0]*r,e[1]=g[1]*r):d.scale(g,2/(f[0]*r),e));s.setUniform2fv("minMaxWorldSizeFactor",e)}l.direction&&s.setUniform3fv("direction",l.direction);s.setUniform2fv("texScale",l.texCoordScale);s.setUniform2fv("screenOffset",l.screenOffset);s.setUniform2fv("anchorPos",l.anchorPos);l.polygonOffset&&
(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0)}};this.release=function(a){var b=a.gl;m===h&&l.occlusionTest?a.setDepthFunction(b.LESS):(a.setPolygonOffsetFillEnabled(!1),a.setBlendingEnabled(!1))};this.bindView=function(a,b){var d=b.origin;m===h&&l.occlusionTest?(k.bindView(d,b.view,p),k.bindCamPos(d,b.viewInvTransp,p)):(k.bindView(d,b.view,s),k.bindCamPos(d,b.viewInvTransp,s))};this.bindInstance=function(a,b){m===h&&l.occlusionTest?(p.setUniformMatrix4fv("model",
b.transformation),p.setUniformMatrix4fv("modelNormal",b.transformationNormal)):s.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){a=a.gl;return m===h&&l.occlusionTest?a.POINTS:a.TRIANGLES}},v=function(b,c,e){function g(){return c.shaderVariators.HUDMaterialHighlight.getProgram([!!h.direction,!!h.worldScale,h.occlusionTest,h.textureIsSignedDistanceField])}k.basicGLMaterialConstructor(this,b);var h=q.clone(b.getParams()),f=c.get("hudOcclusionTestPixel"),m=g();k.singleTextureGLMaterialConstructor(this,
e,h);this.beginSlot=function(b){return b===a.OVERLAY};this.getProgram=function(){return m};this.getAllPrograms=function(){return[f,m]};this.updateParameters=function(){var a=b.getParams();h.color=a.color;h.texCoordScale=a.texCoordScale;h.polygonOffset=a.polygonOffset;h.anchorPos=a.anchorPos;h.screenOffset=a.screenOffset;h.screenMinMaxSize=a.screenMinMaxSize;h.direction=a.direction;h.shaderPolygonOffset=a.shaderPolygonOffset;h.textureIsSignedDistanceField=a.textureIsSignedDistanceField;h.outlineColor=
a.outlineColor;h.outlineSize=a.outlineSize;this.updateTexture(a.textureId);m=g()};this.bind=function(a,c){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);a.bindProgram(m);this.bindTexture(a,m);m.setUniform1i("framebufferTex",1);a.bindTexture(c.framebufferTex,1);a.setActiveTexture(0);m.setUniform3fv("markerColor",t);m.setUniform4fv("viewport",c.viewport);m.setUniform4fv("overrideColor",h.color);m.setUniform1f("pixelRatio",c.pixelRatio);m.setUniform1f("polygonOffset",h.shaderPolygonOffset);
h.textureIsSignedDistanceField&&(m.setUniform4fv("outlineColor",h.outlineColor),m.setUniform1f("outlineSize",h.outlineSize));if(h.worldScale){var e=[-1,-1],g=h.screenMinMaxSize,f=c.proj,l=c.viewport[2]/c.pixelRatio;g&&(0!==f[11]?(f=2*Math.atan(1/f[0]),l=2*(Math.tan(f/2)/l),e[0]=g[0]*l,e[1]=g[1]*l):d.scale(g,2/(f[0]*l),e));m.setUniform2fv("minMaxWorldSizeFactor",e)}h.direction&&m.setUniform3fv("direction",h.direction);m.setUniform2fv("texScale",h.texCoordScale);m.setUniform2fv("screenOffset",h.screenOffset);
m.setUniform2fv("anchorPos",h.anchorPos);h.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0)};this.release=function(a){a.setPolygonOffsetFillEnabled(!1);a.setBlendingEnabled(!1)};this.bindView=function(a,b){var d=b.origin;k.bindView(d,b.view,m);k.bindCamPos(d,b.viewInvTransp,m)};this.bindInstance=function(a,b){m.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};c.loadShaders=function(a,b,d,c){a._parse(n);
var g=0<c.parameters.maxVertexTextureImageUnits,m=new f("hud",["vertexShaderHUD","fragmentShaderHUD"],null,d,b,a,c);m.addBinaryShaderSnippetSuffix("Direction","Direction",[!0,!1]);m.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);m.addDefine("OcclTest",g?"OCCL_TEST":"OCCL_PIXELSHADER");m.addDefine("SDF","SIGNED_DISTANCE_FIELD");d.shaderVariators.HUDMaterial=m;b=new f("hudHighlight",["vertexShaderHUD","fragmentShaderHUDHighlight"],null,d,b,a,c);b.addBinaryShaderSnippetSuffix("Direction",
"Direction",[!0,!1]);b.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);b.addDefine("OcclTest",g?"OCCL_TEST":"OCCL_PIXELSHADER");b.addDefine("SDF","SIGNED_DISTANCE_FIELD");d.shaderVariators.HUDMaterialHighlight=b;a=new e(c,a.vertexShaderOcclusionTestPixel,a.fragmentShaderSimple,h.Default3D);d.add("hudOcclusionTestPixel",a)};return c})},"esri/views/3d/webgl-engine/lib/ShaderVariations":function(){define(["dojo/_base/lang","./Util","../../../webgl/Program","./DefaultVertexAttributeLocations"],
function(q,n,k,f){var c=n.assert,b=function(a,b){return a+b.toString()};return function(a,e,h,g,d,m,l){c(2===e.length,"you must specify shader snippet prefixes for vertex and fragment shaders");if(!h||0===h.length)h=[];var p=[],s=!1,r={};this.addDefine=function(a,b,d,e){c(!s,"you cannot add another variable after the first program has been generated");c(a,"you must specify a program name suffix");p.push({programNameSuffixes:["",a],shaderNameSuffixes:e||a,defineStr:b,affectsShaderTypes:d||[!0,!0]})};
this.addBinaryShaderSnippetSuffix=function(a,b,d){c(!s,"you cannot add another variable after the first program has been generated");c(a,"you must specify a program name suffix");p.push({programNameSuffixes:["",a],shaderSnippetSuffixes:["",b],affectsShaderTypes:d||[!0,!0]})};this.addNaryShaderSnippetSuffix=function(a,b){c(!s,"you cannot add another variable after the first program has been generated");var d=a.map(function(a){c(null!=a.value,"value must always be specified");return a.value});p.push({values:d,
programNameSuffixes:a.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:d[b]}),shaderSnippetSuffixes:a.map(function(a,b){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:d[b]}),affectsShaderTypes:b||[!0,!0]})};this.getShaderVariation=function(b){c(b.length===p.length,"you must specify a value for each variable");for(var d=a,g=q.clone(e),m=q.clone(e),f=q.clone(h),l=0;l<p.length;l++){var s=p[l],r=b[l],k;s.values?(k=s.values.indexOf(r),c(0<=k,"invalid value "+r+" for variable "+
l)):k=r?1:0;d+=s.programNameSuffixes[k];for(r=0;2>r;r++)s.affectsShaderTypes[r]&&(s.shaderSnippetSuffixes&&(g[r]+=s.shaderSnippetSuffixes[k],m[r]+=s.shaderSnippetSuffixes[k]),s.defineStr&&k&&(f.push(s.defineStr),m[r]+=s.shaderNameSuffixes))}return{programName:d,shaderSnippetNames:g,shaderNames:m,defines:f}};this.getProgram=function(a,d,e){d=d||m;e=e||l;s=!0;var h=a.reduce(b,"");if(r[h])return r[h];a=this.getShaderVariation(a);var p=g.get(a.programName);if(p)return p;var x,p=a.shaderSnippetNames[0];
x=d[p];c(null!=x,"shader snippet '"+p+"' does not exist");p=a.shaderSnippetNames[1];d=d[p];c(null!=d,"shader snippet '"+p+"' does not exist");p=new k(e,x,d,f.Default3D,a.defines);r[h]=p;g.add(a.programName,p);return p}}})},"esri/views/3d/webgl-engine/materials/LeafCardMaterial":function(){define("dojo/text!./LeafCardMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),function(q,
n,k,f,c,b,a,e){function h(){r=(9301*r+49297)%233280;return r/233280}var g=f.vec3,d=f.mat4,m=f.mat4d;f=function(a,b,c,f,r,x){n.basicMaterialConstructor(this,x);var B=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:4,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:4,type:5126,offset:28,stride:44,normalized:!1}],z=e.getStride(B)/4;this.getAmbient=function(){return b};this.getDiffuse=function(){return c};this.getSpecular=function(){return f};this.getShininess=
function(){return r};this.dispose=function(){};this.getTextureId=function(){return a};this.getOutputAmount=function(a){var b=0,d;for(d=0;d<a/6;d++)0===d%1&&(b+=6);a=b;for(d=b=0;d<a/6;d++)0===d%1&&(b+=6);return b*z};this.getVertexBufferLayout=function(){return B};this.reduce=function(a,b){for(var d=a.position,c=a.normal,e=a.uv0,g=[],h=[],m=[],f=0,l=0;l<d.length/6;l++)if(0===l%b)for(var p=0;6>p;p++)g[f]=d[6*l+p],h[f]=c[6*l+p],m[f]=e[6*l+p],f++;return{position:g,normal:h,uv0:m}};this.fillInterleaved=
function(a,b,c,e,f,l){e=n.fill;var p=this.reduce(a.faces.indices,1),p=this.reduce(p,1),s=this.getOutputAmount(a.faces.indices.position.length);k.assert(s===p.position.length*z);var r=p.position,t=p.normal,u=p.uv0,p=a.vertexAttr.position.data,x=a.vertexAttr.normal.data,v=a.vertexAttr.uv0.data,y=g.create();a=r.length/6;for(var s=l,B=g.createFrom(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),C=g.createFrom(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),q=0;q<a;++q){for(var $=g.create(),
Z=g.create(),M=[100,100,-100,-100],V=g.create(),L=0;6>L;++L){var U=6*q+L,N=3*r[U],Q=3*t[U],U=2*u[U];$[0]+=p[N+0];$[1]+=p[N+1];$[2]+=p[N+2];Z[0]+=x[Q+0];Z[1]+=x[Q+1];Z[2]+=x[Q+2];Q=v[U+0];U=v[U+1];M[0]=Math.min(M[0],Q);M[1]=Math.min(M[1],U);M[2]=Math.max(M[2],Q);M[3]=Math.max(M[3],U);0===L&&g.set3(p[N+0],p[N+1],p[N+2],V)}$[0]/=6;$[1]/=6;$[2]/=6;Z[0]/=6;Z[1]/=6;Z[2]/=6;$[0]+=0.1*(2*h()-1);$[1]+=0.1*(2*h()-1);$[2]+=0.1*(2*h()-1);void 0!==b&&(m.multiplyVec3(b,V,V),m.multiplyVec3(b,$,$),m.multiplyVec3(c,
Z,Z));g.add($,y,y);g.max(B,$,B);g.min(C,$,C);M[0]+=0.01;M[1]+=0.01;M[2]-=0.01;M[3]-=0.01;for(L=0;4>L;L++)M[L]=Math.min(M[L],0.99999);L=2*h()*Math.PI;V=1.41*g.dist(V,$);l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,void 0,3);f[l++]=0;f[l++]=M[0];f[l++]=M[1];f[l++]=L;f[l++]=V;l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,void 0,3);f[l++]=0;f[l++]=M[2]+1;f[l++]=M[1];f[l++]=L;f[l++]=V;l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,void 0,3);f[l++]=0;f[l++]=M[2]+1;f[l++]=M[3]+1;f[l++]=L;f[l++]=V;l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,
void 0,3);f[l++]=0;f[l++]=M[2]+1;f[l++]=M[3]+1;f[l++]=L;f[l++]=V;l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,void 0,3);f[l++]=0;f[l++]=M[0];f[l++]=M[3]+1;f[l++]=L;f[l++]=V;l+=e($,0,f,l,void 0,3);l+=e(Z,0,f,l,void 0,3);f[l++]=0;f[l++]=M[0];f[l++]=M[1];f[l++]=L;f[l++]=V}y[0]/=a;y[1]/=a;y[2]/=a;b=g.create();g.add(B,C,b);g.scale(b,0.5,b);l=g.create();g.subtract(B,C,l);l[0]=Math.abs(l[0])/2;l[1]=Math.abs(l[1])/2;l[2]=Math.abs(l[2])/2;r=g.create(y);r[1]-=(B[1]-C[1])/3;B=g.create();C=g.create();p=g.create();t=[g.create(),
g.create(),g.create(),g.create()];y=[0,0,0,0];u=d.create();for(q=0;q<a;++q){g.set3(f[s],f[s+1],f[s+2],p);g.subtract(p,r,B);g.normalize(B,B);C=g.subtract(p,b,C);g.normalize(C,C);v=Math.abs(g.dot(C,[1,0,0]));L=Math.abs(g.dot(C,[0,1,0]));x=Math.abs(g.dot(C,[0,0,1]));v=v*Math.abs(b[0]-p[0])/l[0];v+=L*Math.abs(b[1]-p[1])/l[1];v+=x*Math.abs(b[2]-p[2])/l[2];for(L=0;4>L;L++)d.identity(u),d.rotate(u,0.8*(2*h()-1),[0,1,0],u),d.rotate(u,0.8*(2*h()-1),[1,0,0],u),d.multiplyVec3(u,B,t[L]),y[L]=0.5+0.5*v-0.2*(2*
h()-1);x=0.8+0.3*(2*h()-1);for(L=0;6>L;++L){var P;switch(L){case 0:P=0;break;case 1:P=1;break;case 2:P=2;break;case 3:P=2;break;case 4:P=3;break;case 5:P=0}s+=3;s+=e(t[P],0,f,s,c,3);f[s++]=y[P];s+=3;f[s++]*=x}}};this.intersect=function(){};this.getGLMaterials=function(){return{color:l,depthShadowMap:s,normal:void 0,depth:p,highlight:void 0}};this.getAllTextureIds=function(){return[a]}};var l=function(a,b,d){n.basicGLMaterialConstructor(this,a);var e=c.TRANSPARENT_MATERIAL,g=b.get("leafCard");n.singleTextureGLMaterialConstructor(this,
d,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=function(){return g};var h=a.getAmbient(),f=a.getDiffuse(),m=a.getSpecular(),l=a.getShininess();this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform3fv("ambient",h);g.setUniform3fv("diffuse",f);g.setUniform3fv("specular",m);g.setUniform1f("shininess",l);g.setUniform1f("trafoScale",1)};this.release=function(a){};this.bindView=function(a,b){n.bindView(b.origin,b.view,g);n.bindCamPos(b.origin,
b.viewInvTransp,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal);var d=b.transformation,c=Math.sqrt(d[0]*d[0]+d[4]*d[4]+d[8]*d[8]),e=Math.sqrt(d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),d=Math.sqrt(d[2]*d[2]+d[6]*d[6]+d[10]*d[10]);g.setUniform1f("trafoScale",(c+e+d)/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},p=function(a,b,d,e){n.basicGLMaterialConstructor(this,a);var g=c.TRANSPARENT_MATERIAL,h=null==
e?b.get("leafCardDepth"):b.get("leafCardDepthShadowMap");n.singleTextureGLMaterialConstructor(this,d,{textureId:a.getTextureId()});this.beginSlot=function(a){return g===a};this.getProgram=function(){return h};this.bind=function(a,b){a.bindProgram(h);this.bindTexture(a,h);h.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){n.bindView(b.origin,b.view,h)};this.bindInstance=function(a,b){h.setUniformMatrix4fv("model",b.transformation);var d=b.transformation,c=
Math.sqrt(d[0]*d[0]+d[4]*d[4]+d[8]*d[8]),e=Math.sqrt(d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),d=Math.sqrt(d[2]*d[2]+d[6]*d[6]+d[10]*d[10]);h.setUniform1f("trafoScale",(c+e+d)/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},s=function(a,b,d){p.call(this,a,b,d,!0)};f.loadShaders=function(d,c,e,g){d._parse(q);var h=new b(g,d.vertexShaderLeafCard,d.fragmentShaderLeafCard,a.Default3D),f=c.get("fsDepthTextured");c=c.get("fsDepthTexturedShadowMap");f=new b(g,d.vertexShaderLeafCardDepth,f.source,a.Default3D,
f.defines);d=new b(g,d.vertexShaderLeafCardDepth,c.source,a.Default3D,c.defines);e.add("leafCard",h);e.add("leafCardDepth",f);e.add("leafCardDepthShadowMap",d)};var r=1234;return f})},"esri/views/3d/webgl-engine/materials/Material":function(){define("dojo/_base/lang dojo/text!./Material.xml ./internal/MaterialUtil ../../../webgl/Program ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d){var m=b.assert,l=a.vec3,p,s=l.create();b=function(a,b){k.basicMaterialConstructor(this,b);a=a||{};a.ambient=a.ambient||[0.2,0.2,0.2];a.diffuse=a.diffuse||[0.8,0.8,0.8];a.specular=a.specular||[0,0,0];a.shininess=a.shininess||10;a.opacity=void 0!==a.opacity?a.opacity:1;a.blendModeOneOne=a.blendModeOneOne||!1;a.inverseWindingOrder=a.inverseWindingOrder||!1;a.vertexColors=a.vertexColors||!1;a.flipV=a.flipV||!1;a.doubleSided=a.doubleSided||!1;a.cullFace=a.cullFace||void 0;
a.instanced=a.instanced||!1;this.instanced=!!a.instanced;a.writeStencil=a.writeStencil||!1;a.textureId||(a.reflTextureId=void 0);var c;c=a.textureId?a.atlasRegions?"Pos3NormTexRegion":"Pos3NormTex":"Pos3Norm";a.vertexColors&&(c+="Col");var e=g[c],h=a.instanced?g.ModelCol:null;a.instanced&&(h=-1<a.instanced.indexOf("color")?g.ModelCol:g.Model);var f=this.isVisible.bind(this);this.isVisible=function(){return f()&&0<a.opacity};this.dispose=function(){};this.getParams=function(){return a};this.getParameterValues=
function(){var b={ambient:a.ambient,diffuse:a.diffuse,specular:a.specular,shininess:a.shininess,opacity:a.opacity,transparent:a.transparent,polygonOffset:a.polygonOffset,reflectivity:a.reflectivity,atlasRegions:a.atlasRegions,flipV:a.flipV,doubleSided:a.doubleSided,cullFace:a.cullFace,writeStencil:a.writeStencil};a.textureId&&(b.textureId=a.textureId,b.initTexture=a.initTexture);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===d&&m(a.textureId,"Can only change texture of material that already has a texture"),
a[d]=b[d];this.notifyDirty("matChanged")};this.getOutputAmount=function(a){var b=d.getStride(e)/4;return a*b};this.getVertexBufferLayout=function(){return e};this.getInstanceBufferLayout=function(){return h};this.fillInterleaved=function(a,b,d,c,g,h,f){k.fillInterleaved(a,b,d,c,e,g,h,f)};this.intersect=k.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:v,depthShadowMap:y,normal:x,depth:C,highlight:B}};this.getAllTextureIds=function(){var b=[];a.textureId&&b.push(a.textureId);
a.reflTextureId&&b.push(a.reflTextureId);return b}};b.paramsFromOldConstructor=function(a,b,d,c,e,g,h,f,m,l,p,s,r){return{textureId:a,transparent:b,ambient:d,diffuse:c,specular:e,shininess:g,opacity:h,polygonOffset:f,initTexture:m,reflTextureId:l,reflectivity:p,flipV:s,doubleSided:r,cullFace:void 0}};var r=function(a,b){var d=a.gl;(b.cullFace?"none"!==b.cullFace:!b.transparent)?(a.setFaceCullingEnabled(!0),"front"===b.cullFace&&a.setCullFace(d.FRONT)):a.setFaceCullingEnabled(!1)},t=function(a,b){var d=
a.gl;(b.cullFace?"none"!==b.cullFace:!b.transparent)?(a.setFaceCullingEnabled(!1),"front"===b.cullFace&&a.setCullFace(d.BACK)):a.setFaceCullingEnabled(!0)},u=function(a,b){return a?e.TRANSPARENT_MATERIAL:b?e.STENCIL_MATERIAL:e.OPAQUE_MATERIAL},v=function(a,b,d){k.basicGLMaterialConstructor(this,a);var c=q.clone(a.getParams()),e=u(c.transparent,c.writeStencil);k.singleTextureGLMaterialConstructor(this,d,c);var g=k.aquireIfNotUndefined(c.reflTextureId,c.reflInitTexture,d);g&&(g=g.getGLTexture());m(!(c.atlasRegions&&
c.reflTextureId),"Atlas texture with reflection is not yet supported");var h=!c.textureId?"none":c.atlasRegions?"AtlasTextured":"Textured";this.instanced=p&&c.instanced;var f=!!this.instanced&&-1<this.instanced.indexOf("color");this._loadProgram=function(a){return b.shaderVariators.Material.getProgram([h,!!c.reflTextureId,c.vertexColors,c.flipV,c.doubleSided,!!this.instanced,f,a])};var x=this._loadProgram(!1),v=this._loadProgram(!0),F=null,y="AtlasTextured"===h,B=this.dispose;this.dispose=function(){B();
k.releaseIfNotUndefined(c.reflTextureId,d)};this.beginSlot=function(a){return e===a};this.getProgram=function(){return F||x};this.getAllPrograms=function(){return[v,x]};this.updateParameters=function(){var b=a.getParams();c.ambient=b.ambient;c.diffuse=b.diffuse;c.specular=b.specular;c.shininess=b.shininess;c.opacity=b.opacity;c.polygonOffset=b.polygonOffset;c.reflectivity=b.reflectivity;c.flipV=b.flipV;c.doubleSided=b.doubleSided;c.cullFace=b.cullFace;c.transparent!=b.transparent&&(e=u(b.transparent),
c.transparent=b.transparent);c.initTexture=b.initTexture;this.updateTexture(b.textureId);b.atlasRegions&&(c.atlasRegions=b.atlasRegions);c.blendModeOneOne=b.blendModeOneOne;c.inverseWindingOrder=b.inverseWindingOrder};this.bind=function(a,b){var d=a.gl;F=b.shadowMap&&b.shadowMap.getEnableState()?v:x;a.bindProgram(F);F.setUniform3fv("ambient",c.ambient);F.setUniform3fv("diffuse",c.diffuse);F.setUniform3fv("specular",c.specular);F.setUniform1f("shininess",c.shininess);F.setUniform1f("opacity",c.opacity);
b.shadowMap||F.setUniform1f("depthHalfPixelSz",-1);this.bindTexture(a,F);y&&this.bindTextureSize(a,F);a.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);void 0!==g&&(F.setUniform1i("reflTex",1),a.bindTexture(g,1),F.setUniform1f("reflectivity",c.reflectivity));c.inverseWindingOrder&&a.setFrontFace(d.CW);c.transparent&&(a.setBlendingEnabled(!0),c.blendModeOneOne&&(a.setBlendFunction(d.ONE,d.ONE),a.setDepthWriteEnabled(!1)));c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),
a.setPolygonOffset(2,2));r(a,c)};this.release=function(a,b){var d=a.gl;a.setPolygonOffsetFillEnabled(!1);t(a,c);a.setBlendingEnabled(!1);a.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);a.setDepthWriteEnabled(!0);a.setFrontFace(d.CCW)};this.bindView=function(a,b){F=b.shadowMap&&b.shadowMap.getEnableState()?v:x;var d=b.origin;k.bindView(d,b.view,F);k.bindCamPos(d,b.viewInvTransp,F);b.shadowMap&&b.shadowMap.bindView(F,d)};this.bindInstance=function(a,b){F.setUniformMatrix4fv("model",
b.transformation);F.setUniformMatrix4fv("modelNormal",b.transformationNormal);if(f&&b.instanceParameters){var d=b.instanceParameters.color;d&&(l.multiply(c.ambient,d,s),F.setUniform3fv("ambient",s),l.multiply(c.diffuse,d,s),F.setUniform3fv("diffuse",s),F.setUniform1f("opacity",c.opacity*d[3]))}};this.getDrawMode=function(a){return a.gl.TRIANGLES}},C=function(a,b,c,e){k.basicGLMaterialConstructor(this,a);var g=q.clone(a.getParams()),h=null!=e?b.get(d.hasAttribute(a.getVertexBufferLayout(),"uv0")?"depthTexturedShadowMap":
"depthShadowMap"):b.get(d.hasAttribute(a.getVertexBufferLayout(),"uv0")?"depthTextured":"depth"),f=u(g.transparent,g.writeStencil);k.singleTextureGLMaterialConstructor(this,c,g);this.beginSlot=function(a){return f===a};this.getProgram=function(){return h};this.updateParameters=function(){var b=a.getParams();g.initTexture=b.initTexture;g.cullFace=b.cullFace;g.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(a,b){var d=a.gl;a.bindProgram(h);h.setUniform2fv("nearFar",
b.nearFar);g.inverseWindingOrder&&a.setFrontFace(d.CW);this.bindTexture(a,h);r(a,g)};this.release=function(a){var b=a.gl;t(a,g);g.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){k.bindView(b.origin,b.view,h)};this.bindInstance=function(a,b){h.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},y=function(a,b,d){C.call(this,a,b,d,!0)},x=function(a,b,c){k.basicGLMaterialConstructor(this,a);var e=q.clone(a.getParams()),g=b.get(d.hasAttribute(a.getVertexBufferLayout(),
"uv0")?"normalTextured":"normal"),h=u(e.transparent,e.writeStencil);k.singleTextureGLMaterialConstructor(this,c,e);this.beginSlot=function(a){return h===a};this.getProgram=function(){return g};this.updateParameters=function(){var b=a.getParams();e.initTexture=b.initTexture;e.cullFace=b.cullFace;e.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(a,b){var d=a.gl;a.bindProgram(g);this.bindTexture(a,g);g.setUniformMatrix4fv("viewNormal",b.viewInvTransp);r(a,
e);e.inverseWindingOrder&&a.setFrontFace(d.CW)};this.release=function(a){var b=a.gl;t(a,e);e.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){k.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},B=function(a,b,c,g){k.basicGLMaterialConstructor(this,a);var h=q.clone(a.getParams()),f=b.get(d.hasAttribute(a.getVertexBufferLayout(),
"uv0")?"highlightTextured":"highlight"),m=e.OPAQUE_MATERIAL;k.singleTextureGLMaterialConstructor(this,c,h);this.beginSlot=function(a){return m===a};this.getProgram=function(){return f};this.updateParameters=function(){var b=a.getParams();h.initTexture=b.initTexture;h.cullFace=b.cullFace;h.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(a,b){var d=a.gl;a.bindProgram(f);this.bindTexture(a,f);r(a,h);h.inverseWindingOrder&&a.setFrontFace(d.CW)};this.release=
function(a){var b=a.gl;t(a,h);h.inverseWindingOrder&&a.setFrontFace(b.CW)};this.bindView=function(a,b){k.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation);f.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};b.loadShaders=function(a,b,d,e){a._parse(n);p=e.extensions.angleInstancedArrays;e.extensions.shaderTextureLOD;e.extensions.standardDerivatives;var g=new c("phong",["vsPhong",
"fsPhong"],null,d,b,a,e);g.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);g.addBinaryShaderSnippetSuffix("Refl","Refl",[!1,!0]);g.addDefine("Color","VERTEXCOLORS");g.addDefine("FlipV","FLIPV");g.addDefine("DoubleSided","DOUBLESIDED");g.addDefine("Instanced","INSTANCED");g.addDefine("InstColor","INSTANCEDCOLOR");g.addDefine("ReceiveShadows","RECEIVE_SHADOWS");d.shaderVariators.Material=g;var g=new f(e,a.vsDepth,a.fsDepth,
h.Default3D,["BIAS_SHADOWMAP 1"]),m=new f(e,a.vsDepthTextured,a.fsDepthTextured,h.Default3D,["BIAS_SHADOWMAP 1"]),l=new f(e,a.vsDepth,a.fsDepth,h.Default3D),s=new f(e,a.vsDepthTextured,a.fsDepthTextured,h.Default3D),r=new f(e,a.vsNormal,a.fsNormal,h.Default3D),k=new f(e,a.vsNormalTextured,a.fsNormalTextured,h.Default3D),t=new f(e,a.vsHighlight,a.fsHighlight,h.Default3D);e=new f(e,a.vsHighlightTextured,a.fsHighlightTextured,h.Default3D);d.add("depthShadowMap",g);d.add("depthTexturedShadowMap",m);d.add("depth",
l);d.add("depthTextured",s);d.add("normal",r);d.add("normalTextured",k);d.add("highlight",t);d.add("highlightTextured",e);b.add("fsDepth",{source:a.fsDepth});b.add("fsDepthTextured",{source:a.fsDepthTextured});b.add("fsDepthShadowMap",{source:a.fsDepthShadowMap,defines:["BIAS_SHADOWMAP 1"]});b.add("fsDepthTexturedShadowMap",{source:a.fsDepthTextured,defines:["BIAS_SHADOWMAP 1"]});b.add("vsDepth",{source:a.vsDepth});b.add("fsNormal",{source:a.fsNormal})};return b})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("dojo/_base/lang dojo/text!./RibbonLineMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g){var d=[255,255,255,255],m=[0,0,0,0],l=c.vec3d,p=c.vec2d,s=c.mat4d,r=l.create(),t=l.create(),u=l.create(),v=l.create(),C=p.create(),y=p.create(),x=l.create(),B=l.create();c=function(a,b){k.basicMaterialConstructor(this,b);var c=f.VertexAttrConstants;a=a||{};a.color=a.color||[1,1,1,1];a.width=a.width||0;a.type=a.type||"screen";a.join=a.join||"miter";a.miterLimit="miter"===a.join?a.miterLimit||5:a.miterLimit;var e="wall"===a.type?2:4,p=h.Pos3Tex;"wall"!==a.type&&(p=[{name:"position",
count:3,type:5126,offset:0,stride:64,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:64,normalized:!1},{name:"auxpos1",count:3,type:5126,offset:20,stride:64,normalized:!1},{name:"auxpos2",count:3,type:5126,offset:32,stride:64,normalized:!1},{name:"color",count:4,type:5126,offset:44,stride:64,normalized:!1},{name:"size",count:1,type:5126,offset:60,stride:64,normalized:!1}]);this.canBeMerged=!1;this.getParams=function(){return a};this.getParameterValues=function(){var b={color:a.color,
width:a.width,type:a.type,join:a.join,polygonOffset:a.polygonOffset};"miter"===a.join&&(b.miterLimit=a.miterLimit);return b};this.setParameterValues=function(b){for(var d in b)b.hasOwnProperty(d)&&(f.assert("type"!==d,"RibbonLineMaterial: type cannot be changed after creation"),a[d]=b[d]);this.notifyDirty("matChanged")};this.dispose=function(){};this.getOutputAmount=function(a){return((a/2+1-2)*e+4)*g.getStride(p)/4};this.getVertexBufferLayout=function(){return p};this.fillInterleaved=function(b,
e,g,h,f,l){g=b.vertexAttr[c.POSITION].data;h=b.vertexAttr[c.COLOR]?b.vertexAttr[c.COLOR].data:d;var p=b.vertexAttr[c.SIZE]?b.vertexAttr[c.SIZE].data:m;(b=b.faces&&b.faces.indices&&b.faces.indices.position)&&b.length!=2*(g.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");if("wall"===a.type){h=l;p=g.length/3;l=0;b=g[0];for(var s=g[1],r=g[2],k,t,u,w=0;w<p;w++){var x=3*w;k=b;t=s;u=r;b=g[x];s=g[x+1];r=g[x+2];e&&(b=e[0]*b+e[4]*s+e[8]*r+e[12],s=e[1]*b+e[5]*s+e[9]*r+e[13],r=e[2]*b+
e[6]*s+e[10]*r+e[14]);l+=Math.sqrt((b-k)*(b-k)+(s-t)*(s-t)+(r-u)*(r-u));f[h++]=b;f[h++]=s;f[h++]=r;f[h++]=l;f[h++]=-1;f[h++]=b;f[h++]=s;f[h++]=r;f[h++]=l;f[h++]=1}}else{b=g.length/3;s=g[0];r=g[1];k=g[2];t=0;e&&(s=e[0]*s+e[4]*r+e[8]*k+e[12],r=e[1]*s+e[5]*r+e[9]*k+e[13],k=e[2]*s+e[6]*r+e[10]*k+e[14]);u=s;var w=r,x=k,v=g[3],y=g[4],B=g[5];e&&(v=e[0]*v+e[4]*y+e[8]*B+e[12],y=e[1]*v+e[5]*y+e[9]*B+e[13],B=e[2]*v+e[6]*y+e[10]*B+e[14]);for(var n=0;n<b;n++){var z=3*n;n<b-1&&(v=g[z+3],y=g[z+4],B=g[z+5],e&&(v=
e[0]*v+e[4]*y+e[8]*B+e[12],y=e[1]*v+e[5]*y+e[9]*B+e[13],B=e[2]*v+e[6]*y+e[10]*B+e[14]));t+=Math.sqrt((u-s)*(u-s)+(w-r)*(w-r)+(x-k)*(x-k));f[l++]=u;f[l++]=w;f[l++]=x;f[l++]=t;f[l++]=0===n?-1.2:-1;f[l++]=s;f[l++]=r;f[l++]=k;f[l++]=v;f[l++]=y;f[l++]=B;f[l++]=h[0];f[l++]=h[1];f[l++]=h[2];f[l++]=h[3];f[l++]=p[0];f[l++]=u;f[l++]=w;f[l++]=x;f[l++]=t;f[l++]=0===n?1.2:1;f[l++]=s;f[l++]=r;f[l++]=k;f[l++]=v;f[l++]=y;f[l++]=B;f[l++]=h[0];f[l++]=h[1];f[l++]=h[2];f[l++]=h[3];f[l++]=p[0];0<n&&n<b-1&&(f[l++]=u,f[l++]=
w,f[l++]=x,f[l++]=t,f[l++]=-1.2,f[l++]=s,f[l++]=r,f[l++]=k,f[l++]=v,f[l++]=y,f[l++]=B,f[l++]=h[0],f[l++]=h[1],f[l++]=h[2],f[l++]=h[3],f[l++]=p[0],f[l++]=u,f[l++]=w,f[l++]=x,f[l++]=t,f[l++]=1.2,f[l++]=s,f[l++]=r,f[l++]=k,f[l++]=v,f[l++]=y,f[l++]=B,f[l++]=h[0],f[l++]=h[1],f[l++]=h[2],f[l++]=h[3],f[l++]=p[0]);s=u;r=w;k=x;u=v;w=y;x=B}}};this.intersect=function(b,d,e,g,h,m,p,k,w,n,z,E){if(E){d=b.getData().getVertexAttr(c.position).position.data;b=b.getData().getVertexAttr(c.SIZE).size;b=(b&&b.data[0])+
a.width;p=Number.MAX_VALUE;for(k=0;k<d.length-5;k+=3){r[0]=d[k];r[1]=d[k+1];r[2]=d[k+2];s.multiplyVec3(e,r);t[0]=d[k+3];t[1]=d[k+4];t[2]=d[k+5];s.multiplyVec3(e,t);w.projectPoint(r,C);w.projectPoint(t,y);if(0>C[2]&&0<y[2])l.subtract(r,t,u),n=w.frustumPlanes,E=-(l.dot(n[4],r)+n[4][3]),n=E/l.dot(u,n[4]),l.scale(u,n,u),l.add(r,u,r),w.projectPoint(r,C);else if(0<C[2]&&0>y[2])l.subtract(t,r,u),n=w.frustumPlanes,E=-(l.dot(n[4],t)+n[4][3]),n=E/l.dot(u,n[4]),l.scale(u,n,u),l.add(t,u,t),w.projectPoint(t,y);
else if(0>C[2]&&0>y[2])continue;n=f.projectVectorVector2D(C,y,g);n<p&&(p=n,l.set(r,x),l.set(t,B))}p<b/2+4&&(e=f.linelineDistance3D(x,B,h,m),g=Number.MAX_VALUE,e[0]&&(l.subtract(e[2],h,v),g=0.98*l.length(v)/l.dist(h,m)),z(g,v))}};this.getGLMaterials=function(){return{color:z,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[]}};var z=function(a,d){k.basicGLMaterialConstructor(this,a);var c=q.clone(a.getParams());c.miterLimit="miter"===c.join?
c.miterLimit:0;delete c.join;var e=d.get("ribbonLine_"+c.type);this.updateParameters=function(){var b=a.getParams();c.polygonOffset=b.polygonOffset;c.color=b.color;c.width=b.width;c.miterLimit="miter"===b.join?b.miterLimit:0};this.beginSlot=function(a){return a===b.TRANSPARENT_MATERIAL};this.getProgram=function(){return e};this.bind=function(a,b){a.bindProgram(e);e.setUniform4fv("eColor",c.color);e.setUniform1f("miterLimit",c.miterLimit);e.setUniform1f("nearPlane",b.nearFar[0]);"screen"===c.type?
(e.setUniform2fv("screenSize",[b.viewport[2],b.viewport[3]]),e.setUniform1f("extLineWidth",c.width*b.pixelRatio)):e.setUniform1f("extLineWidth",c.width);c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0);a.setFaceCullingEnabled(!1);1>c.color[3]&&a.setDepthWriteEnabled(!1)};this.release=function(a){c.polygonOffset&&a.setPolygonOffsetFillEnabled(!1);a.setBlendingEnabled(!1);a.setDepthWriteEnabled(!0)};this.bindView=function(a,b){k.bindView(b.origin,
b.view,e)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP}};c.loadShaders=function(b,d,c,g){b._parse(n);d=new a(g,b.vsRibbonLine,b.fsRibbonLine,e.Default3D,["SCREENSCALE"]);var h=new a(g,b.vsRibbonLine,b.fsRibbonLine,e.Default3D);b=new a(g,b.vsRibbonLine,b.fsRibbonLine,e.Default3D,["WALL"]);c.add("ribbonLine_screen",d);c.add("ribbonLine_strip",h);c.add("ribbonLine_wall",b)};return c})},"esri/views/3d/webgl-engine/materials/WaterMaterial":function(){define("dojo/text!./WaterMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a){var e=function(c,d,e,f,p,s){n.basicMaterialConstructor(this,s);var r=b.Pos3;this.dispose=function(){};this.getNoiseTextureId=function(){return c};this.getReflTextureId=function(){return d};this.getColor=function(){return e};this.getScale=function(){return f};this.getSpeed=function(){return p};this.getOutputAmount=function(b){return b*a.getStride(r)/4};this.getVertexBufferLayout=function(){return r};this.fillInterleaved=function(a,b,d,c,e,g,h){n.fillInterleaved(a,b,d,c,r,e,
g,h)};this.intersect=n.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:h,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[c,d]}},h=function(a,b,c){n.basicGLMaterialConstructor(this,a);var e=k.TRANSPARENT_MATERIAL,h=b.get("water");b={noiseTextureId:a.getNoiseTextureId(),reflTextureId:a.getReflTextureId()};n.multiTextureGLMaterialConstructor(this,c,b,[["noiseTextureId",void 0,"noiseTex"],["reflTextureId",void 0,"reflTex"]]);
var f=a.getColor(),r=a.getScale(),t=a.getSpeed(),u=Date.now();this.beginSlot=function(a){return e===a};this.getProgram=function(){return h};this.bind=function(a,b){a.bindProgram(h);this.bindTextures(a,h);h.setUniform3fv("color",f);h.setUniform1f("scale",r);var d=(Date.now()-u)/1E5*t,d=d-Math.floor(d);h.setUniform1f("speed",d);b.shadowMap||h.setUniform1f("depthHalfPixelSz",-1)};this.release=function(a){};this.bindView=function(a,b){var d=b.origin;n.bindView(d,b.view,h);n.bindCamPos(d,b.viewInvTransp,
h);b.shadowMap&&b.shadowMap.bindView(h,d)};this.bindInstance=function(a,b){h.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};e.loadShaders=function(a,b,e,h){a._parse(q);a=new f(h,a.vertexShaderWater,a.fragmentShaderWater,c.Default3D);e.add("water",a)};return e})},"esri/views/3d/webgl-engine/materials/internal/BlendLayers":function(){define(["dojo/text!./BlendLayers.xml","../../../../webgl/Program","../../lib/DefaultVertexAttributeLocations"],function(q,
n,k){return{loadShaders:function(f,c,b,a){f._parse(q);f=new n(a,f.vertexShaderBlendLayers,f.fragmentShaderBlendLayers,k.Default3D);b.add("blendlayers",f)}}})},"esri/views/3d/webgl-engine/lib/tracer":function(){define(["require","exports","./webgl-debug"],function(q,n,k){var f=null,c=[];n.enabled=!1;n.begin=function(){n.enabled&&(f=[])};n.trace=function(b){n.enabled&&null!=f&&f.push(b)};n.end=function(){if(n.enabled){var b=f;f=null;b&&(c.forEach(function(a){return a(b)}),c.length=0);return b}};n.instrumentContext=
function(b){return!n.enabled?b:k.makeDebugContext(b,void 0,function(a,b){n.enabled&&f&&f.push("gl."+a+"("+k.glFunctionArgsToString(a,b)+")")})};n.request=function(b){c.push(b)}})},"esri/views/3d/webgl-engine/lib/webgl-debug":function(){define([],function(){function q(a){if(null==h){h={};g={};for(var b in a)"number"==typeof a[b]&&(h[a[b]]=b,g[b]=a[b])}}function n(){if(null==h)throw"WebGLDebugUtils.init(ctx) not called";}function k(a){n();var b=h[a];return void 0!==b?"gl."+b:"/*UNKNOWN WebGL ENUM*/ 0x"+
a.toString(16)+""}function f(a,b,c,h){a=e[a];if(void 0!==a&&(a=a[b],void 0!==a&&a[c])){if("object"===typeof a[c]&&void 0!==a[c].enumBitwiseOr){b=a[c].enumBitwiseOr;c=0;a=[];for(var f=0;f<b.length;++f){var r=g[b[f]];0!==(h&r)&&(c|=r,a.push(k(r)))}return c===h?a.join(" | "):k(h)}return k(h)}return null===h?"null":void 0===h?"undefined":h.toString()}function c(a,b,c){a.__defineGetter__(c,function(){return b[c]});a.__defineSetter__(c,function(a){b[c]=a})}function b(a,e,g,h){function s(a,b){return function(){g&&
g(b,arguments);var d=a[b].apply(a,arguments),c=h.getError();0!=c&&(r[c]=!0,e(c,b,arguments));return d}}h=h||a;q(a);e=e||function(a,b,d){for(var c="",e=d.length,g=0;g<e;++g)c+=(0==g?"":", ")+f(b,e,g,d[g]);a="WebGL error "+k(a)+" in "+b+"("+c+")";window.console&&window.console.error?window.console.error(a):window.console&&window.console.log&&window.console.log(a)};var r={},t={},u;for(u in a)if("function"==typeof a[u])if("getExtension"!=u)t[u]=s(a,u);else{var v=s(a,u);t[u]=function(){var c=v.apply(a,
arguments);return b(c,e,g,h)}}else c(t,a,u);t.getError=function(){for(var b in r)if(r.hasOwnProperty(b)&&r[b])return r[b]=!1,b;return a.NO_ERROR};return t}function a(a){var b=a.getParameter(a.MAX_VERTEX_ATTRIBS),c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);for(var e=0;e<b;++e)a.disableVertexAttribArray(e),a.vertexAttribPointer(e,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(e,0);a.deleteBuffer(c);b=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);for(e=0;e<b;++e)a.activeTexture(a.TEXTURE0+e),a.bindTexture(a.TEXTURE_CUBE_MAP,
null),a.bindTexture(a.TEXTURE_2D,null);a.activeTexture(a.TEXTURE0);a.useProgram(null);a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.DITHER);a.disable(a.SCISSOR_TEST);a.blendColor(0,0,0,0);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.clearColor(0,0,0,0);a.clearDepth(1);a.clearStencil(-1);a.colorMask(!0,!0,
!0,!0);a.cullFace(a.BACK);a.depthFunc(a.LESS);a.depthMask(!0);a.depthRange(0,1);a.frontFace(a.CCW);a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE);a.lineWidth(1);a.pixelStorei(a.PACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);a.polygonOffset(0,0);a.sampleCoverage(1,!1);a.scissor(0,0,a.canvas.width,
a.canvas.height);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilMask(4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.viewport(0,0,a.canvas.width,a.canvas.height);for(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}var e={enable:{1:{"0":!0}},disable:{1:{"0":!0}},getParameter:{1:{"0":!0}},drawArrays:{3:{"0":!0}},drawElements:{4:{"0":!0,2:!0}},createShader:{1:{"0":!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{"0":!0,
1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{"0":!0}},activeTexture:{1:{"0":!0}},getTexParameter:{2:{"0":!0,1:!0}},texParameterf:{3:{"0":!0,1:!0}},texParameteri:{3:{"0":!0,1:!0,2:!0}},texImage2D:{9:{"0":!0,2:!0,6:!0,7:!0},6:{"0":!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{"0":!0,6:!0,7:!0},7:{"0":!0,4:!0,5:!0}},copyTexImage2D:{8:{"0":!0,2:!0}},copyTexSubImage2D:{8:{"0":!0}},generateMipmap:{1:{"0":!0}},compressedTexImage2D:{7:{"0":!0,2:!0}},compressedTexSubImage2D:{8:{"0":!0,
6:!0}},bindBuffer:{2:{"0":!0}},bufferData:{3:{"0":!0,2:!0}},bufferSubData:{3:{"0":!0}},getBufferParameter:{2:{"0":!0,1:!0}},pixelStorei:{2:{"0":!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{"0":!0}},bindFramebuffer:{2:{"0":!0}},checkFramebufferStatus:{1:{"0":!0}},framebufferRenderbuffer:{4:{"0":!0,1:!0,2:!0}},framebufferTexture2D:{5:{"0":!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{"0":!0,1:!0,2:!0}},getRenderbufferParameter:{2:{"0":!0,1:!0}},renderbufferStorage:{4:{"0":!0,1:!0}},
clear:{1:{"0":{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{"0":!0}},blendFunc:{2:{"0":!0,1:!0}},blendFuncSeparate:{4:{"0":!0,1:!0,2:!0,3:!0}},blendEquation:{1:{"0":!0}},blendEquationSeparate:{2:{"0":!0,1:!0}},stencilFunc:{3:{"0":!0}},stencilFuncSeparate:{4:{"0":!0,1:!0}},stencilMaskSeparate:{2:{"0":!0}},stencilOp:{3:{"0":!0,1:!0,2:!0}},stencilOpSeparate:{4:{"0":!0,1:!0,2:!0,3:!0}},cullFace:{1:{"0":!0}},frontFace:{1:{"0":!0}},drawArraysInstancedANGLE:{4:{"0":!0}},
drawElementsInstancedANGLE:{5:{"0":!0,2:!0}},blendEquationEXT:{1:{"0":!0}}},h=null,g=null;return{init:q,mightBeEnum:function(a){n();return void 0!==h[a]},glEnumToString:k,glFunctionArgToString:f,glFunctionArgsToString:function(a,b){for(var c="",e=b.length,g=0;g<e;++g)c+=(0==g?"":", ")+f(a,e,g,b[g]);return c},makeDebugContext:b,makeLostContextSimulatingCanvas:function(b){function e(a){return"function"==typeof a?a:function(b){a.handleEvent(b)}}function g(){for(var a=Object.keys(q),b=0;b<a.length;++b)delete q[a]}
function h(){++w;B||A==w&&b.loseContext()}function f(a,b){var d=a[b];return function(){h();if(!B)return d.apply(a,arguments)}}function r(a){return{statusMessage:a,preventDefault:function(){D=!0}}}function k(a){for(var b in a)"function"==typeof a[b]?v[b]=f(a,b):c(v,a,b);v.getError=function(){h();if(!B)for(var a;a=u.getError();)q[a]=!0;for(a in q)if(q[a])return delete q[a],a;return v.NO_ERROR};var d="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");
for(b=0;b<d.length;++b){var e=d[b];v[e]=function(b){return function(){h();if(B)return null;var d=b.apply(a,arguments);d.__webglDebugContextLostId__=x;z.push(d);return d}}(a[e])}d="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(b=0;b<d.length;++b)e=d[b],v[e]=function(b){return function(){h();return B?null:b.apply(a,arguments)}}(v[e]);d="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(b=0;b<d.length;++b)e=d[b],v[e]=function(b){return function(){h();return B?!1:b.apply(a,arguments)}}(v[e]);v.checkFramebufferStatus=function(b){return function(){h();return B?v.FRAMEBUFFER_UNSUPPORTED:b.apply(a,arguments)}}(v.checkFramebufferStatus);v.getAttribLocation=function(b){return function(){h();
return B?-1:b.apply(a,arguments)}}(v.getAttribLocation);v.getVertexAttribOffset=function(b){return function(){h();return B?0:b.apply(a,arguments)}}(v.getVertexAttribOffset);v.isContextLost=function(){return B};return v}var u,v,n=[],y=[];v={};var x=1,B=!1,z=[],A=0,w=0,D=!1,E=0,q={};b.getContext=function(a){return function(){var c=a.apply(b,arguments);if(c instanceof WebGLRenderingContext){if(c!=u){if(u)throw"got different context";u=c;v=k(u)}return v}return c}}(b.getContext);(function(a){var b=a.addEventListener;
a.addEventListener=function(d,c,g){switch(d){case "webglcontextlost":n.push(e(c));break;case "webglcontextrestored":y.push(e(c));break;default:b.apply(a,arguments)}}})(b);b.loseContext=function(){if(!B){B=!0;A=0;for(++x;u.getError(););g();q[u.CONTEXT_LOST_WEBGL]=!0;var a=r("context lost"),c=n.slice();setTimeout(function(){for(var e=0;e<c.length;++e)c[e](a);0<=E&&setTimeout(function(){b.restoreContext()},E)},0)}};b.restoreContext=function(){B&&y.length&&setTimeout(function(){if(!D)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var b=0;b<z.length;++b){var d=z[b];d instanceof WebGLBuffer?u.deleteBuffer(d):d instanceof WebGLFramebuffer?u.deleteFramebuffer(d):d instanceof WebGLProgram?u.deleteProgram(d):d instanceof WebGLRenderbuffer?u.deleteRenderbuffer(d):d instanceof WebGLShader?u.deleteShader(d):d instanceof WebGLTexture&&u.deleteTexture(d)}a(u);B=!1;w=0;D=!1;for(var b=y.slice(),d=r("context restored"),c=0;c<b.length;++c)b[c](d)},0)};b.loseContextInNCalls=function(a){if(B)throw"You can not ask a lost contet to be lost";
A=w+a};b.getNumCalls=function(){return w};b.setRestoreTimeout=function(a){E=a};return b},resetToInitialState:a}})},"esri/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(q,n,k,f){return function(){function c(b,a){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState=
{r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=b;this._extensions=new f(b,a);var c=b.getParameter(b.VIEWPORT);this._viewport={x:c[0],y:c[1],width:c[2],height:c[3]};c=this.extensions.textureFilterAnisotropic;this._parameters={versionString:b.getParameter(b.VERSION),
maxVertexTextureImageUnits:b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:b.getParameter(b.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:c?b.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}Object.defineProperty(c.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});c.prototype.setBlendingEnabled=function(b){this._blendEnabled!==b&&(!0===b?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=b)};c.prototype.setBlendColor=function(b,a,c,h){if(b!==this._blendColorState.r||a!==this._blendColorState.g||c!==this._blendColorState.b||h!==this._blendColorState.a)this.gl.blendColor(b,a,c,h),
this._blendColorState.r=b,this._blendColorState.g=a,this._blendColorState.b=c,this._blendColorState.a=h};c.prototype.setBlendFunction=function(b,a){if(b!==this._blendFunctionState.srcRGB||a!==this._blendFunctionState.dstRGB)this.gl.blendFunc(b,a),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=a};c.prototype.setBlendFunctionSeparate=function(b,a,c,h){if(this._blendFunctionState.srcRGB!==b||this._blendFunctionState.srcAlpha!==
c||this._blendFunctionState.dstRGB!==a||this._blendFunctionState.dstAlpha!==h)this.gl.blendFuncSeparate(b,a,c,h),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=c,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=h};c.prototype.setBlendEquation=function(b){this._blendEquationState.mode!==b&&(this.gl.blendEquation(b),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=b)};c.prototype.setBlendEquationSeparate=function(b,a){if(this._blendEquationState.mode!==
b||this._blendEquationState.modeAlpha!==a)this.gl.blendEquationSeparate(b,a),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=a};c.prototype.setColorMask=function(b,a,c,h){if(this._colorMaskState.r!==b||this._colorMaskState.g!==a||this._colorMaskState.b!==c||this._colorMaskState.a!==h)this.gl.colorMask(b,a,c,h),this._colorMaskState.r=b,this._colorMaskState.g=a,this._colorMaskState.b=c,this._colorMaskState.a=h};c.prototype.setClearColor=function(b,a,c,h){if(this._clearColor.r!==b||
this._clearColor.g!==a||this._clearColor.b!==c||this._clearColor.a!==h)this.gl.clearColor(b,a,c,h),this._clearColor.r=b,this._clearColor.g=a,this._clearColor.b=c,this._clearColor.a=h};c.prototype.setFaceCullingEnabled=function(b){this._polygonCullingEnabled!==b&&(!0===b?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=b)};c.prototype.setPolygonOffsetFillEnabled=function(b){this._polygonOffsetFillEnabled!==b&&(!0===b?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):
this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=b)};c.prototype.setPolygonOffset=function(b,a){if(this._polygonOffset[0]!==b||this._polygonOffset[1]!==a)this._polygonOffset[0]=b,this._polygonOffset[1]=a,this.gl.polygonOffset(b,a)};c.prototype.setCullFace=function(b){this._cullFace!==b&&(this.gl.cullFace(b),this._cullFace=b)};c.prototype.setFrontFace=function(b){this._frontFace!==b&&(this.gl.frontFace(b),this._frontFace=b)};c.prototype.setScissorTestEnabled=function(b){this._scissorTestEnabled!==
b&&(!0===b?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=b)};c.prototype.setScissorRect=function(b,a,c,h){if(this._scissorRect.x!==b||this._scissorRect.y!==a||this._scissorRect.width!==c||this._scissorRect.height!==h)this.gl.scissor(b,a,c,h),this._scissorRect.x=b,this._scissorRect.y=a,this._scissorRect.width=c,this._scissorRect.height=h};c.prototype.setDepthTestEnabled=function(b){this._depthTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.DEPTH_TEST):
this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=b)};c.prototype.setClearDepth=function(b){this._clearDepth!==b&&(this.gl.clearDepth(b),this._clearDepth=b)};c.prototype.setDepthFunction=function(b){this._depthFunction!==b&&(this.gl.depthFunc(b),this._depthFunction=b)};c.prototype.setDepthWriteEnabled=function(b){this._depthWriteEnabled!==b&&(this.gl.depthMask(b),this._depthWriteEnabled=b)};c.prototype.setDepthRange=function(b,a){if(this._depthRange.zNear!==b||this._depthRange.zFar!==a)this.gl.depthRange(b,
a),this._depthRange.zNear=b,this._depthRange.zFar=a};c.prototype.setStencilTestEnabled=function(b){this._stencilTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=b)};c.prototype.setClearStencil=function(b){b!==this._clearStencil&&(this.gl.clearStencil(b),this._clearStencil=b)};c.prototype.setStencilFunction=function(b,a,c){if(this._stencilFunction.func!==b||this._stencilFunction.ref!==a||this._stencilFunction.mask!==c)this.gl.stencilFunc(b,
a,c),this._stencilFunction.face=1032,this._stencilFunction.func=b,this._stencilFunction.ref=a,this._stencilFunction.mask=c};c.prototype.setStencilFunctionSeparate=function(b,a,c,h){if(this._stencilFunction.face!==b||this._stencilFunction.func!==a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==h)this.gl.stencilFuncSeparate(b,a,c,h),this._stencilFunction.face=b,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=h};c.prototype.setStencilWriteMask=function(b){this._stencilWriteMask!==
b&&(this.gl.stencilMask(b),this._stencilWriteMask=b)};c.prototype.setStencilOp=function(b,a,c){if(this._stencilOperation.fail!==b||this._stencilOperation.zFail!==a||this._stencilOperation.zPass!==c)this.gl.stencilOp(b,a,c),this._stencilOperation.face=1032,this._stencilOperation.fail=b,this._stencilOperation.zFail=a,this._stencilOperation.zPass=c};c.prototype.setStencilOpSeparate=function(b,a,c,h){if(this._stencilOperation.face!==b||this._stencilOperation.fail!==a||this._stencilOperation.zFail!==c||
this._stencilOperation.zPass!==h)this.gl.stencilOpSeparate(b,a,c,h),this._stencilOperation.face=b,this._stencilOperation.face=b,this._stencilOperation.fail=a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=h};c.prototype.setLineWidth=function(b){var a=this._lineWidth;this._lineWidth!==b&&(this.gl.lineWidth(b),this._lineWidth=b);return a};c.prototype.setActiveTexture=function(b){var a=this._activeTextureUnit;0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(k.BASE_TEXTURE_UNIT+
b),this._activeTextureUnit=b);return a};c.prototype.clear=function(b){b&&this.gl.clear(b)};c.prototype.drawArrays=function(b,a,c){this.gl.drawArrays(b,a,c)};c.prototype.drawElements=function(b,a,c,h){5123===c?this.gl.drawElements(b,a,c,h):5125===c&&this._extensions.elementIndexUint?this.gl.drawElements(b,a,c,h):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made")};c.prototype.drawArraysInstanced=function(b,a,c,h){this._extensions.angleInstancedArrays?
this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(b,a,c,h):console.error("Extension ANGLE_instanced_arrays isn't supported!")};c.prototype.drawElementsInstanced=function(b,a,c,h,g){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(b,a,c,h,g):console.error("Extension ANGLE_instanced_arrays isn't supported!")};c.prototype.setViewport=function(b,a,c,h){var g=this._viewport;if(g.x!==b||g.y!==a||g.width!==c||g.height!==h)g.x=b,g.y=a,g.width=
c,g.height=h,this.gl.viewport(b,a,c,h)};c.prototype.getViewport=function(){return this._viewport};c.prototype.bindProgram=function(b){b?this._activeShaderProgram!==b&&(b.initialize(),this.gl.useProgram(b.glName),this._activeShaderProgram=b):(this.gl.useProgram(null),this._activeShaderProgram=null)};c.prototype.bindTexture=function(b,a){void 0===a&&(a=0);-1===c._MAX_TEXTURE_IMAGE_UNITS&&(c._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(a>=c._MAX_TEXTURE_IMAGE_UNITS||
0>a)&&console.error("Input texture unit is out of range of available units!");var e=this._textureUnitMap[a];this.setActiveTexture(a);null==b?(null!=e&&this.gl.bindTexture(e.descriptor.target,null),this._textureUnitMap[a]=null):e&&e.id===b.id?b.applyChanges():(this.gl.bindTexture(b.descriptor.target,b.glName),b.applyChanges(),this._textureUnitMap[a]=b)};c.prototype.bindFramebuffer=function(b){b?this._activeFramebuffer!==b&&(b.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.glName),this._activeFramebuffer=
b):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null)};c.prototype.bindBuffer=function(b){b&&(34962===b.bufferType?this._activeVertexBuffer=c._bindBuffer(this.gl,b,b.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,b,b.bufferType,this._activeIndexBuffer))};c.prototype.unbindBuffer=function(b){34962===b?this._activeVertexBuffer=c._bindBuffer(this.gl,null,b,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,null,b,
this._activeIndexBuffer)};c.prototype.bindVAO=function(b){b?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===b.id||(b.bind(),this._activeVertexArrayObject=b):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};c.prototype.getBoundTexture=function(b){return this._textureUnitMap[b]};c.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};c.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};
c.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var b=0;b<this.parameters.maxTextureImageUnits;b++)this.bindTexture(null,b);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);
this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};c.prototype.enforceState=
function(){var b=this.gl,a=this._extensions.vao;a&&a.bindVertexArrayOES(null);for(var c=0;c<this.parameters.maxVertexAttributes;c++)b.disableVertexAttribArray(c);this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null);this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null);if(a&&this._activeVertexArrayObject){if(a=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),
this._activeVertexArrayObject=null;this.bindVAO(a)}b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,
this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?
b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?
b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(a=0;a<this.parameters.maxTextureImageUnits;a++)b.activeTexture(k.BASE_TEXTURE_UNIT+a),b.bindTexture(3553,
null),(c=this._textureUnitMap[a])&&b.bindTexture(c.descriptor.target,c.glName);b.activeTexture(k.BASE_TEXTURE_UNIT+this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};c._bindBuffer=function(b,a,c,h){if(!a)return b.bindBuffer(c,null),null;if(h===a)return h;b.bindBuffer(c,a.glName);return a};c._MAX_TEXTURE_IMAGE_UNITS=-1;return c}()})},"esri/views/webgl/Extensions":function(){define(["require","exports"],function(q,n){return function(){function k(f,
c){this._compressedTextureS3TCInit=this._shaderTextureLODInit=this._textureFilterAnisotropicInit=this._depthTextureInit=this._elementIndexUintInit=this._standardDerivativesInit=this._angleInstancedArraysInit=this._vaoInit=!1;this._gl=f;if(c&&c.disabledExtensions){var b=c.disabledExtensions;b.vao&&(this._vao=null,this._vaoInit=!0);b.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0);b.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=
!0);b.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0);b.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0);b.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0);b.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0);b.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0)}}Object.defineProperty(k.prototype,"vao",{get:function(){this._vaoInit||
(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0);return this._vao},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"angleInstancedArrays",{get:function(){this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0);return this._angleInstancedArrays},enumerable:!0,
configurable:!0});Object.defineProperty(k.prototype,"standardDerivatives",{get:function(){this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0);return this._standardDerivatives},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"elementIndexUint",{get:function(){this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0);return this._elementIndexUint},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"depthTexture",{get:function(){this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0);return this._depthTexture},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"textureFilterAnisotropic",{get:function(){this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=
this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0);return this._textureFilterAnisotropic},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"shaderTextureLOD",{get:function(){this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0);return this._shaderTextureLOD},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"compressedTextureS3TC",{get:function(){this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0);return this._compressedTextureS3TC},enumerable:!0,configurable:!0});return k}()})},"esri/views/3d/webgl-engine/lib/ProgramRepository":function(){define(["require","exports","./Util"],function(q,n,k){return function(){function f(){this._nextId=
0;this._programsByName={};this._namesById=[];this._programRefCount=[];this.shaderVariators={};this._commonUniforms={model:[],modelNormal:[],lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[]}}f.prototype.dispose=function(){for(var c in this._programsByName)this._programsByName[c].dispose();this._programRefCount=this._namesById=this._programsByName=null};f.prototype.add=function(c,b){k.assert(null==this._programsByName[c]);this._programsByName[c]=b;this._namesById[b.id]=c};f.prototype.get=
function(c){return this._programsByName[c]};f.prototype.getProgramsUsingUniform=function(c){return this._commonUniforms[c]||[]};f.prototype.increaseRefCount=function(c){var b=c.id;this._programRefCount[b]?this._programRefCount[b]++:(this._programRefCount[b]=1,this._findCommonUniforms(c))};f.prototype.decreaseRefCount=function(c){var b=c.id;1<this._programRefCount[b]?this._programRefCount[b]--:(this._forgetCommonUniforms(c),this._programRefCount[b]=0)};f.prototype._getNextId=function(){return this._nextId++};
f.prototype._findCommonUniforms=function(c){for(var b in this._commonUniforms)c.hasUniform(b)&&(k.assert(-1===this._commonUniforms[b].indexOf(c),"common uniforms of program have already been determined"),this._commonUniforms[b].push(c))};f.prototype._forgetCommonUniforms=function(c){for(var b in this._commonUniforms){var a=this._commonUniforms[b],e=a.indexOf(c);-1<e&&(a[e]=a[a.length-1],a.pop())}};return f}()})},"esri/views/3d/webgl-engine/lib/Selector":function(){define(["require","exports","dojo/has",
"./PerformanceTimer","./gl-matrix"],function(q,n,k,f,c){var b=c.vec3d,a=c.mat4d,e=a.create(),h=b.create(),g=b.create(),d=0;q=function(){function c(e,g,h,l,k,v,n){void 0===n&&(n=!1);this.dir=b.create();this.normalDir=null;this.minResult=new m;this.maxResult=new m;this.invertedM=a.create();this.mode="intersect";this.performanceInfo={queryDuration:0,numObjectsTested:0};this.intersectObject=this.intersectObject.bind(this);d&&(this.timer=new f(1));this.init(e,g,h,l,k,v,n)}c.prototype.init=function(a,c,
e,g,h,f,l){c&&e&&b.subtract(e,c,this.dir);this.minResult.init(c,e);this.maxResult.init(c,e);this.numObjectsTested=0;this.point=g;this.camera=h;this.isSelection=l;this.layers=a;this.p0=c;this.p1=e;this.hudResults=[];null==f&&(f=1E-5);this.tolerance=f;if(this.layers){d&&this.timer.start();for(a=0;a<this.layers.length;++a)if(c=this.layers[a],e=c.getSpatialQueryAccelerator?c.getSpatialQueryAccelerator():void 0)e.forEachAlongRay(this.p0,this.dir,this.intersectObject);else{c=c.getObjects();e=0;for(g=c.length;e<
g;++e)this.intersectObject(c[e])}d&&(this.timer.stop(),this.performanceInfo.queryDuration=this.timer.getLast(),this.performanceInfo.numObjectsTested=this.numObjectsTested)}};c.prototype.getDirection=function(){this.normalDir||(this.normalDir=b.create(),b.normalize(this.dir,this.normalDir));return this.normalDir};c.prototype.intersectObject=function(b){var c=this;this.numObjectsTested++;for(var d=b.getId(),f=b.getGeometryRecords(),l=b.getObjectTransformation(),k,n=0;n<f.length;n++){var y=f[n].geometry,
x=f[n].materials;k=y.getId();a.set(l,e);a.multiply(e,f[n].transformation);a.inverse(e,this.invertedM);a.multiplyVec3(this.invertedM,this.p0,h);a.multiplyVec3(this.invertedM,this.p1,g);for(var B=0,z=y.numGroups;B<z;++B)x[B].intersect(y,B,e,this.point,this.p0,this.p1,h,g,this.camera,this.tolerance,function(a,e,g,h,f){if(0<=a)if(f)f=new m,f.set(b,d,a,e,h,b.getCenter(),k,g),c.hudResults.push(f);else{if(null==c.minResult.priority||h>=c.minResult.priority)(null==c.minResult.dist||a<c.minResult.dist)&&c.minResult.set(b,
d,a,e,h,null,k,g);if(null==c.maxResult.priority||h>=c.maxResult.priority)(null==c.maxResult.dist||a>c.maxResult.dist)&&c.maxResult.set(b,d,a,e,h,null,k,g)}},this.isSelection)}};c.prototype.getMinResult=function(){return this.minResult};c.prototype.getMaxResult=function(){return this.maxResult};c.prototype.getHudResults=function(){return this.hudResults};c.DEFAULT_TOLERANCE=1E-5;c.Result=typeof m;return c}();var m=function(){function a(c,d){this.normal=b.create();this.init(c,d)}a.prototype.getIntersectionPoint=
function(a){if(null==this.dist)return!1;b.lerp(this.p0,this.p1,this.dist,a);return!0};a.prototype.set=function(a,c,d,e,g,h,f,l){this.dist=d;b.set(e,this.normal);this.object=a;this.name=c;this.priority=g;this.center=h;this.geometryId=f;this.triangleNr=l};a.prototype.setIntersector=function(a){this.intersector=a};a.prototype.init=function(a,b){this.priority=this.name=this.object=this.dist=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="stage";this.p0=a;this.p1=b};return a}();
return q})},"esri/views/3d/support/RenderCoordsHelper":function(){define(["./earthUtils","./projectionUtils","../lib/glMatrix","../webgl-engine/lib/BufferVectorMath","../../../geometry/support/scaleUtils"],function(q,n,k,f,c){var b=k.vec3,a=f.Vec3Compact,e=q.earthRadius,h=[0,0,1];q=function(a){this.spatialReference=a};q.prototype.toRenderCoords=function(a,b,c){return"esri.geometry.Point"===a.declaredClass?n.pointToVector(a,b,this.spatialReference):n.vectorToVector(a,b,c,this.spatialReference)};q.prototype.fromRenderCoords=
function(a,b,c){return"esri.geometry.Point"===b.declaredClass||"esri.SpatialReference"===b.declaredClass?n.vectorToPoint(a,this.spatialReference,b,c):n.vectorToVector(a,this.spatialReference,b,c)};k=function(a){this.spatialReference=a=a||n.SphericalRenderSpatialReference;this.unitInMeters=1};k.prototype=new q;k.prototype.getAltitude=function(b,c){return a.length(b,c||0)-e};k.prototype.setAltitude=function(b,c,h){h=h||0;b=(b+e)/a.length(c,h);a.scale(c,h,b)};k.prototype.setAltitudeOfTransformation=
function(a,b){this.setAltitude(a,b,12)};k.prototype.worldUpAtPosition=function(a,c){b.normalize(a,c)};f=function(a){this.spatialReference=a;this.unitInMeters=c.getUnitValueForSR(a);this.worldUp=h};f.prototype=new q;f.prototype.getAltitude=function(a,b){return b?a[b+2]:a[2]};f.prototype.setAltitude=function(a,b,c){c?b[c+2]=a:b[2]=a};f.prototype.setAltitudeOfTransformation=function(a,b){this.setAltitude(a,b,12)};f.prototype.worldUpAtPosition=function(a,c){b.set(h,c)};f.worldUp=h;q.Spherical=k;q.Planar=
f;return q})},"esri/views/3d/support/MapCoordsHelper":function(){define("dojo/Evented dojo/Deferred ../../../core/declare ../../../portal/support/geometryServiceUtils ../../../tasks/support/ProjectParameters ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils".split(" "),function(q,n,k,f,c,b,a,e){return k(q,{unitInMeters:1,spatialReference:null,constructor:function(a,b,c){this.spatialReference=b;this.unitInMeters=e.getUnitValueForSR(this.spatialReference);
(this.geometryService=c)||f.create(a&&a.portalItem).then(function(a){this.geometryService=a}.bind(this)).otherwise(function(){})},toGeographic:function(e){var g=new n,d=!0,f=this.spatialReference;if(!this.geometryService)return g.reject("Must specify geometryService in esri/config"),g;if(!Array.isArray(e[0])||"number"===typeof e[0])e=[e],d=!1;e.forEach(function(b,c){b instanceof a||(e[c]=new a(b,f))});var l=new c({geometries:e,outSR:b.WGS84});this.geometryService.project(l).then(function(a){try{a=
a.map(function(a){return[a.x,a.y]}),g.resolve(d?a:a[0])}catch(b){g.reject(b)}},function(a){g.reject(a)});return g.promise},canProject:function(){return!!this.geometryService}})})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../core/promiseUtils ../../core/Error".split(" "),function(q,n,k,f,c,b,a,e){n.create=function(h){void 0===h&&(h=null);if(c.geometryServiceUrl)return a.resolve(new b({url:c.geometryServiceUrl}));
if(!h)return a.reject(new e("internal:geometry-service-url-not-configured"));var g;h.isInstanceOf(f)?g=h.portal||k.getDefault():h.isInstanceOf(k)&&(g=h);return g.load().then(function(c){if(c.helperServices&&c.helperServices.geometry&&c.helperServices.geometry.url)return a.resolve(new b({url:c.helperServices.geometry.url}));throw new e("internal:geometry-service-url-not-configured");})}})},"esri/tasks/GeometryService":function(){define("../core/kebabDictionary ../geometry/Extent ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ../geometry/support/jsonUtils ../request ./Task dojo/_base/lang".split(" "),
function(q,n,k,f,c,b,a,e,h){var g=q({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"});q=e.createSubclass({declaredClass:"esri.tasks.GeometryService",areasAndLengths:function(b){b=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON());return a(this.parsedUrl.path+"/areasAndLengths",{query:b,callbackParamName:"callback"}).then(function(a){return a.data})},autoComplete:function(b,e){var g=b[0].spatialReference,f=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),
polygons:JSON.stringify(this._encodeGeometries(b).geometries),polylines:JSON.stringify(this._encodeGeometries(e).geometries)});return a(this.parsedUrl.path+"/autoComplete",{query:f,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return new c({spatialReference:g,rings:a.rings})})})},buffer:function(b){var e=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON()),g=b.outSpatialReference||b.geometries[0].spatialReference;return a(this.parsedUrl.path+"/buffer",
{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return new c({spatialReference:g,rings:a.rings})})})},cut:function(c,e){var g=c[0].spatialReference,f=c.map(function(a){return a.toJSON()}),f=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),target:JSON.stringify({geometryType:b.getJsonType(c[0]),geometries:f}),cutter:JSON.stringify(e.toJSON())});return a(this.parsedUrl.path+"/cut",{query:f,callbackParamName:"callback"}).then(function(a){a=
a.data;return{cutIndexes:a.cutIndexes,geometries:(a.geometries||[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})}})},convexHull:function(c){var e=c[0].spatialReference;c=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c))});return a(this.parsedUrl.path+"/convexHull",{query:c,callbackParamName:"callback"}).then(function(a){return b.fromJSON(a.data.geometry).set("spatialReference",e)})},densify:function(c){var e=
h.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON()),g=c.geometries[0].spatialReference;return a(this.parsedUrl.path+"/densify",{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})})},difference:function(c,e){var g=c[0].spatialReference,f=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c)),geometry:JSON.stringify({geometryType:b.getJsonType(e),
geometry:e.toJSON()})});return a(this.parsedUrl.path+"/difference",{query:f,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})})},distance:function(b){b=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON());return a(this.parsedUrl.path+"/distance",{query:b,callbackParamName:"callback"}).then(this._handleDistanceResponse)},fromGeoCoordinateString:function(b){var c={};h.isObject(b.sr)?c.sr=b.sr.wkid||JSON.stringify(b.sr.toJSON()):
c.sr=b.sr;c.strings=JSON.stringify(b.strings);c.conversionType=g.toJSON(b.conversionType||"mgrs");c.conversionMode=b.conversionMode;b=h.mixin({},this.parsedUrl.query,{f:"json"},c);return a(this.parsedUrl.path+"/fromGeoCoordinateString",{query:b,callbackParamName:"callback"}).then(this._handleFromGeoCoordinateResponse)},generalize:function(c){var e=h.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON()),g=c.geometries[0].spatialReference;return a(this.parsedUrl.path+"/generalize",{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||
[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})})},intersect:function(c,e){var g=c[0].spatialReference,f=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c)),geometry:JSON.stringify({geometryType:b.getJsonType(e),geometry:e.toJSON()})});return a(this.parsedUrl.path+"/intersect",{query:f,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return b.fromJSON(a).set("spatialReference",
g)})})},lengths:function(b){b=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON());return a(this.parsedUrl.path+"/lengths",{query:b,callbackParamName:"callback"}).then(function(a){return a.data})},labelPoints:function(c){var e=c.map(function(a){return a.toJSON()}),g=c[0].spatialReference;c=h.mixin({},this.parsedUrl.query,{f:"json",sr:g.wkid?g.wkid:JSON.stringify(g.toJSON()),polygons:JSON.stringify(e)});return a(this.parsedUrl.path+"/labelPoints",{query:c,callbackParamName:"callback"}).then(function(a){return(a.data.labelPoints||
[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})})},offset:function(c){var e=h.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON()),g=c.geometries[0].spatialReference;return a(this.parsedUrl.path+"/offset",{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return b.fromJSON(a).set("spatialReference",g)})})},project:function(c,e){var g=h.mixin({},this.parsedUrl.query,{f:"json"}),f;c.geometries?(e=c.outSR,f=c.geometries[0],g=h.mixin(g,
c.toJSON())):(f=c[0],g=h.mixin(g,{outSR:e.wkid||JSON.stringify(e.toJSON()),inSR:f.spatialReference.wkid||JSON.stringify(f.spatialReference.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c))}));var s=b.getJsonType(f),r=this._decodeGeometries;return a(this.parsedUrl.path+"/project",{query:g,callbackParamName:"callback"}).then(function(a){return r(a.data,s,e)})},relation:function(b){b=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON());return a(this.parsedUrl.path+"/relation",{query:b,
callbackParamName:"callback"}).then(this._handleRelationResponse)},reshape:function(c,e){var g=c.spatialReference,f=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),target:JSON.stringify({geometryType:b.getJsonType(c),geometry:c.toJSON()}),reshaper:JSON.stringify(e.toJSON())});return a(this.parsedUrl.path+"/reshape",{query:f,callbackParamName:"callback"}).then(function(a){return b.fromJSON(a.data.geometry).set("spatialReference",g)})},simplify:function(c){var e=c[0].spatialReference,
g=h.mixin({},this.parsedUrl.query,{f:"json",sr:e.wkid?e.wkid:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c))}),f=b.getJsonType(c[0]),s=this._decodeGeometries;return a(this.parsedUrl.path+"/simplify",{query:g,callbackParamName:"callback"}).then(function(a){return s(a.data,f,e)})},toGeoCoordinateString:function(b){var c={};h.isObject(b.sr)?c.sr=b.sr.wkid||JSON.stringify(b.sr.toJSON()):c.sr=b.sr;c.coordinates=JSON.stringify(b.coordinates);c.conversionType=g.toJSON(b.conversionType||
"mgrs");c.conversionMode=b.conversionMode;c.numOfDigits=b.numOfDigits;c.rounding=b.rounding;c.addSpaces=b.addSpaces;b=h.mixin({},this.parsedUrl.query,{f:"json"},c);return a(this.parsedUrl.path+"/toGeoCoordinateString",{query:b,callbackParamName:"callback"}).then(this._handleToGeoCoordinateResponse)},trimExtend:function(b){var c=h.mixin({},this.parsedUrl.query,{f:"json"},b.toJSON()),e=b.sr;return a(this.parsedUrl.path+"/trimExtend",{query:c,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||
[]).map(function(a){return new f({spatialReference:e,paths:a.paths})})})},union:function(c){var e=c[0].spatialReference;c=h.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(c))});return a(this.parsedUrl.path+"/union",{query:c,callbackParamName:"callback"}).then(function(a){return b.fromJSON(a.data.geometry).set("spatialReference",e)})},_handleRelationResponse:function(a){return a.data.relations},_handleDistanceResponse:function(a){return(a=
a.data)&&a.distance},_handleToGeoCoordinateResponse:function(a){return a.data.strings},_handleFromGeoCoordinateResponse:function(a){return a.data.coordinates},_encodeGeometries:function(a){var c=[],e,g=a.length;for(e=0;e<g;e++)c.push(a[e].toJSON());return{geometryType:b.getJsonType(a[0]),geometries:c}},_decodeGeometries:function(a,c,e){var g=b.getGeometryType(c);a=a.geometries;var f=[],r={spatialReference:e.toJSON()},k=h.mixin;a.forEach(function(a,b){f[b]=new g(k(a,r))});return f},_toProjectGeometry:function(a){var b=
a.spatialReference.toJSON();return a instanceof n?new c({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new f({paths:[[].concat(a.points)],spatialReference:b})},_fromProjectedGeometry:function(a,b,c){return"extent"===b?(a=a.rings[0],new n(a[0][0],a[0][1],a[2][0],a[2][1],c)):new k({points:a.paths[0],spatialReference:c.toJSON()})}});h.mixin(q,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,
UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,
UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,
UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",
UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return q})},"esri/tasks/support/ProjectParameters":function(){define(["../../core/declare","dojo/_base/array","../../core/Accessoire","../../core/lang","../../geometry/support/jsonUtils"],
function(q,n,k,f,c){return q(k,{declaredClass:"esri.tasks.support.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJSON:function(){var b=n.map(this.geometries,function(a){return a.toJSON()}),a={};a.outSR=this.outSR.wkid||JSON.stringify(this.outSR.toJSON());a.inSR=this.geometries[0].spatialReference.wkid||JSON.stringify(this.geometries[0].spatialReference.toJSON());a.geometries=JSON.stringify({geometryType:c.getJsonType(this.geometries[0]),geometries:b});this.transformation&&
(a.transformation=this.transformation.wkid||JSON.stringify(this.transformation));f.isDefined(this.transformForward)&&(a.transformForward=this.transformForward);return a}})})},"esri/views/3d/support/ResourceController":function(){define("../../../core/declare ../../../core/Scheduler ../../../core/HandleRegistry ../../../core/watchUtils ./StreamDataManager ./PreallocArray ../webgl-engine/lib/Util".split(" "),function(q,n,k,f,c,b,a){function e(b){this.budget=this.begin=0;this.performance=a.performance;
this.enabled=!0;void 0!==b&&this.reset(b)}var h=a.assert,g={TERRAIN:"terrain",SCENE:"scene",SYMBOLOGY:"symbols"},d=new b(20);e.prototype.now=function(){return this.performance.now()};e.prototype.reset=function(a){this.begin=this.now();this.budget=this.enabled?a:Number.MAX_VALUE};e.prototype.done=function(){return this.enabled&&this.elapsed()>=this.budget};e.prototype.remaining=function(){return Math.max(this.budget-this.elapsed(),0)};e.prototype.elapsed=function(){return this.now()-this.begin};q=
q(null,{constructor:function(b,d){this._clients=[];this._frameWorker=null;this._budget=new e;this._idleFrameWorkers=[];this._idleFrameWorkerRobin=0;this._idleUpdatesStartFired=!1;this._lastTargetChangeTime=a.performance.now();this.navigationTimeout=300;this.animatingFrameTimeBudget=10;this.idleFrameWorkerBudget=30;this.idleFrameTimeBudget=50;var h={},r;for(r in g)h[g[r]]=0;h[g.TERRAIN]=15;h[g.SCENE]=20;h[g.SYMBOLOGY]=5;this._maxGpuMemory=1500;this.streamDataManager=new c(h);this._cameraListeners=
new k;this._cameraListeners.add([f.on(b,"navigation","currentViewReachedTarget",this._targetReached.bind(this)),f.on(b,"navigation","targetViewChanged",this._targetChanged.bind(this))]);d||(d=n);this._frameTask=d.addFrameTask({update:this._frameUpdate.bind(this)});this._view=b;this.stats={frameUpdateTime:new m,idleUpdateTime:new m};this.frameUpdateNavigation=null},destroy:function(){this._frameTask.remove();this._frameTask=null;this._cameraListeners.remove();this.streamDataManager.destroy();this.streamDataManager=
null},setEnableBudget:function(a){this._budget.enabled=!!a},registerClient:function(a,b,c){this._clients.push({client:a,type:b});"function"===typeof a.setMaxGpuMemory&&a.setMaxGpuMemory(this._maxGpuMemory);return this.streamDataManager.makeSupplier(b,c)},deregisterClient:function(a){for(var b=0;b<this._clients.length;b++)if(this._clients[b].client===a){this._clients[b]=this._clients[this._clients.length-1];this._clients.pop();return}console.warn("deregistering an unregistered client.")},setMaxGpuMemory:function(a){this._maxGpuMemory=
a;for(var b=0;b<this._clients.length;b++){var c=this._clients[b].client;"function"===typeof c.setMaxGpuMemory&&c.setMaxGpuMemory(a)}},registerIdleFrameWorker:function(a,b){var c=this._idleFrameWorkers.some(function(b){return b.client===a});h(!c,"Can only register idle frame workers once per client/layer");h(!b.idleFrame||b.needsUpdate,"needsUpdate has to be specified if idleFrame is specified");this._idleFrameWorkers.push({client:a,callbacks:b});this._isIdle()&&(this._idleUpdatesStartFired&&b.idleBegin)&&
b.idleBegin.call(a)},deregisterIdleFrameWorker:function(a){for(var b=this._idleFrameWorkers,c=0;c<b.length;c++){var d=b[c];if(d.client===a){this._idleUpdatesStartFired&&d.callbacks.idleEnd&&d.callbacks.idleEnd.call(a);b[c]=b[b.length-1];b.pop();break}}},registerFrameWorker:function(a){h(!this._frameWorker,"Only one (non-idle) per-frame worker supported at the moment");this._frameWorker=a},deregisterFrameWorker:function(){this._frameWorker=null},_targetChanged:function(b){this._lastTargetChangeTime=
a.performance.now();this._targetReached=!1;this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._callWorkersNoScheduling("idleEnd"))},_targetReached:function(a){this._targetReached=!0},_frameUpdate:function(a){var b=this._isIdle();this._budget.reset((b?this.idleFrameWorkerBudget:this.animatingFrameTimeBudget)-a.spendInFrame);this._view.navigation&&this._view.navigation.step(a.deltaTime);this._frameWorker&&(this._frameWorker(this._budget),this.stats.frameUpdateTime.addSample(this._budget.elapsed()));
b&&(this._idleUpdatesStartFired||(this._callWorkersNoScheduling("idleBegin"),this._idleUpdatesStartFired=!0),this._budget.reset(this.idleFrameTimeBudget-this._budget.elapsed()),3<this._budget.remaining()&&(this._callWorkersStrictScheduling("idleFrame",this._budget),this.stats.idleUpdateTime.addSample(this._budget.elapsed())))},_isIdle:function(){return this._budget.now()-this._lastTargetChangeTime>this.navigationTimeout&&this._targetReached},_callWorkersNoScheduling:function(a){for(var b=this._idleFrameWorkers,
c=0;c<b.length;c++){var d=b[c];d.callbacks[a]&&d.callbacks[a].call(d.client)}},_callWorkersStrictScheduling:function(a,b){var c=this._idleFrameWorkers,e=c.length,g,h,f;d.clear();h=0;for(f=this._idleFrameWorkerRobin;h<e;h++)g=c[f++%e],g.callbacks.needsUpdate&&g.callbacks.needsUpdate.call(g.client)&&(0===d.length&&(this._idleFrameWorkerRobin=f),d.push(g));g=b.now();for(c=g+b.remaining();0<d.length&&g<c;)b.reset((c-g)/d.length),g=d.pop(),g.callbacks[a].call(g.client,b),g=b.now()}});q.ClientType=g;var m=
function(){this.addSample=function(a){this.min=Math.min(this.min,a);this.max=Math.max(this.max,a);this.total+=a;this.numSamples++};this.getAverage=function(){return this.total/this.numSamples};this.reset=function(){this.numSamples=this.total=0;this.min=Number.MAX_VALUE;this.max=-Number.MAX_VALUE};this.reset()};return q})},"esri/views/3d/support/StreamDataManager":function(){define(["../../../core/declare","./StreamDataLoader"],function(q,n){var k=q(null,{_clientType:void 0,_loader:void 0,constructor:function(f,
c,b){this._clientType=f;this._loader=c;this._addUrlTokenFunction=b},request:function(f,c,b){return this._loader.request(f,c,this._clientType,b,this._addUrlTokenFunction)},isRequested:function(f){return this._loader.isRequested(f)},cancelRequest:function(f){this._loader.cancel(f)},getRequestedURLs:function(){return this._loader.getRequestedURLs(this._clientType)},cancelRequestsBulk:function(f){this._loader.cancelBulk(f,this._clientType)}});return q(null,{constructor:function(f){this._loader=new n(f)},
destroy:function(){this._loader.destroy();this._loader=null},hasPendingDownloads:function(){return this._loader.hasPendingDownloads()},makeSupplier:function(f,c){return new k(f,this._loader,c)}})})},"esri/views/3d/support/StreamDataLoader":function(){define("../../../core/declare ../../../request ../../../config ../../../core/urlUtils ./PromiseLightweight ./AsyncQuotaRoundRobinQueue ../webgl-engine/lib/Util".split(" "),function(q,n,k,f,c,b,a){var e=a.assert,h={QUEUED:1,DOWNLOADING:2,CANCELLED:4};
q=q(null,{constructor:function(a){this.alreadyLoading={};this.loadQueue=new b(g,this._doneLoadingCallback,this,a);this._urlInfo={hasSameOrigin:{},canUseXhr:{}}},destroy:function(){for(var a in this.alreadyLoading){for(var b=this.alreadyLoading[a],c=0;c<b.clientPromises.length;c++){var e=b.clientPromises[c];e.isRejected()||e.reject(b.url.url,null,b.docType,b.clientMetadata[c])}this._cancelTask(b)}this.loadQueue.clear();this.alreadyLoading=this.loadQueue=null},request:function(a,b,e,f,s){f=f||{};var k=
new c.Promise;k.requestURL=a;var t=this.alreadyLoading[a];t?(t.clientPromises.push(k),t.clientMetadata.push(f.metadata)):(t={url:{url:null,normalized:null,normalizedWithToken:null,hasSameOrigin:!1,canUseXhr:!1},docType:b,clientType:e,status:h.QUEUED,clientMetadata:[f.metadata],clientPromises:[k],downloadObj:null,_cancelledInQueue:!1},this._prepareUrl(t,a,s),this.alreadyLoading[a]=t,f.notQueueable?g(t,this._doneLoadingCallback.bind(this)):this.loadQueue.push(t));return k},isRequested:function(a){return void 0!==
this.alreadyLoading[a]},cancel:function(a){var b=this.alreadyLoading[a.requestURL];b&&this._removeRequestPromiseFromTask(b,a)},getRequestedURLs:function(a){var b={},c;for(c in this.alreadyLoading)this.alreadyLoading[c].clientType===a&&(b[c]=!0);return b},cancelBulk:function(b,e){var g;if(a.getFirstObjectValue(b)instanceof c.Promise)for(g in b)this.cancel(b[g]);else{var h=[];for(g in b){var f=this.alreadyLoading[g];f&&(this._cancelTask(f),h.push(f))}0<h.length&&this.loadQueue.removeTasks(h,e)}},hasPendingDownloads:function(){return!a.objectEmpty(this.alreadyLoading)},
_prepareUrl:function(a,b,c){a.url.url=b;a.url.isData=f.isDataProtocol(b);if(a.url.isData||"image"!==a.docType)a.url.normalized=b,!a.url.isData&&c&&(a.url.normalizedWithToken=c(b));else{b=f.normalize(b);a.url.normalized=b;var e=f.getOrigin(b);c&&(a.url.normalizedWithToken=c(b));b=this._urlInfo.hasSameOrigin[e];void 0!==b?a.url.hasSameOrigin=b:(a.url.hasSameOrigin=f.hasSameOrigin(e,window.location.href),this._urlInfo.hasSameOrigin[e]=a.url.hasSameOrigin);a.url.hasSameOrigin||(b=this._urlInfo.canUseXhr[e],
void 0!==b?a.url.canUseXhr=b:(a.url.canUseXhr=f.canUseXhr(e),this._urlInfo.canUseXhr[e]=a.url.canUseXhr))}},_removeRequestPromiseFromTask:function(a,b){var c=a.clientPromises.length;if(1<c){var g=a.clientPromises.indexOf(b);e(-1<g,"request to be cancelled is already cancelled or invalid");a.clientPromises[g]=a.clientPromises[c-1];a.clientPromises.pop();a.clientMetadata[g]=a.clientMetadata[c-1];a.clientMetadata.pop()}else e(a.clientPromises[0]===b,"request to be cancelled is already cancelled or invalid"),
this._cancelTask(a)},_cancelTask:function(a){if(a.status===h.DOWNLOADING){this.loadQueue.workerCancelled(a);if("image"===a.docType){var b=a.downloadObj;b.removeAttribute("onload");b.removeAttribute("onerror");b.removeAttribute("src")}else a.status=h.CANCELLED,a.downloadObj.cancel();a.downloadObj=null}a.status=h.CANCELLED;a.clientPromise=void 0;a.metadata=void 0;delete this.alreadyLoading[a.url.url]},_doneLoadingCallback:function(a,b){var c;e(a.status===h.DOWNLOADING);delete this.alreadyLoading[a.url.url];
if(b)for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].isRejected()||a.clientPromises[c].reject(a.url.url,b,a.docType,a.clientMetadata[c]);else for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].done(a.url.url,a.result,a.docType,a.clientMetadata[c])}});var g=function(b,c){if(b.status===h.CANCELLED)return!1;if("image"===b.docType){var e=new Image;e.onload=function(){b.status!==h.CANCELLED&&(b.result=e,e.removeAttribute("onload"),e.removeAttribute("onerror"),c(b))};e.onerror=function(){b.status!==
h.CANCELLED&&(e.removeAttribute("onload"),e.removeAttribute("onerror"),c(b,{status:404}))};b.url.isData?e.src=b.url.normalized:b.url.hasSameOrigin||b.url.canUseXhr?(b.url.hasSameOrigin||(e.crossOrigin="anonymous"),e.src=b.url.normalizedWithToken||b.url.normalized):e.src=b.url.normalizedWithToken||!k.request.proxyUrl?b.url.normalizedWithToken:k.request.proxyUrl+"?"+b.url.normalized;b.downloadObj=e}else{var g=n(b.url.normalizedWithToken||b.url.normalized,{responseType:"binary"===b.docType?"array-buffer":
"json",failOk:!0});g.then(function(e){b.duration=a.performance.now()-b.startTime;b.size=0;b.result=e.data;c(b)},function(a){b.status!==h.CANCELLED&&c(b,a)});b.downloadObj=g}b.status=h.DOWNLOADING;return!0};q.TaskStatus=h;return q})},"esri/views/3d/support/PromiseLightweight":function(){(function(q){function n(c){this._callbacks=[];this._errbacks=[];this._cancelCallback=c;this._iserr=this._isdone=this._iscancelled=!1}function k(c,b){var a=new n;0===c.length?a.done.apply(a,b):c[0].apply(null,b).then(function(){c.splice(0,
1);k(c,arguments).then(function(){a.done.apply(a,arguments)})});return a}n.prototype.cancel=function(c){this._callbacks=[];this._errbacks=[];this._iscancelled=!0;this._cancelCallback&&this._cancelCallback(c)};n.prototype.then=function(c,b,a){var e;if(!this._iscancelled)return this._isdone?e=c.apply(a,this.result):this._iserr&&b?e=b.apply(a,this.result):(this._callbacks.push(function(){return c.apply(a,arguments)}),b&&this._errbacks.push(function(){return b.apply(a,arguments)})),e};n.prototype.done=
function(){this.result=arguments;this._isdone=!0;for(var c=0;c<this._callbacks.length;c++)this._callbacks[c].apply(null,arguments);this._callbacks=[];this._errbacks=[]};n.prototype.resolve=n.prototype.done;n.prototype.reject=function(){if(!this._iscancelled){this.result=arguments;this._iserr=!0;for(var c=0;c<this._errbacks.length;c++)this._errbacks[c].apply(null,arguments);this._callbacks=[];this._errbacks=[]}};n.prototype.isRejected=function(){return this._iserr};n.prototype.isFulfilled=function(){return this._isdone||
this._iserr};n.prototype.isCancelled=function(){return this._iscancelled};var f={Promise:n,join:function(c){function b(b,c){return function(){c&&(d=!0);h+=1;g[b]=Array.prototype.slice.call(arguments);h===e&&(d?a.reject():a.done(g))}}for(var a=new n,e=c.length,h=0,g=[],d=!1,f=0;f<e;f++)c[f].then(b(f,!1),b(f,!0));0===c.length&&a.done();return a},chain:k};"function"===typeof define&&define.amd?define(function(){return f}):q.promise=f})(this)},"esri/views/3d/support/AsyncQuotaRoundRobinQueue":function(){define(["../../../core/arrayUtils",
"../webgl-engine/lib/Util"],function(q,n){return function(k,f,c,b,a){function e(){return"workers: "+m+", queues: "+d.map(function(a){return a.length})}var h=0,g={},d=[],m=[],l=[],p=[],s=0,r=0,t;for(t in b)d[h]=[],m[h]=0,p[h]={requests:0,size:0,duration:0,speed:0},l[h]=b[t],g[t]=h++,r+=b[t];var u=d.length,h=0;this.setWorkerQuota=function(a){n.assert(q.equals(Object.keys(this.typeWorkerAllication),Object.keys(a)));this.typeWorkerAllication=a;r=0;for(var b in a)l[g[b]]=a[b],r+=a[b]};this.setWorkerFunc=
function(a){k=a};this.push=function(b){var c=g[b.clientType];s<r?(m[c]++,s++,a&&console.log("queue start type "+c+", "+e()),k(b,y)):(d[c].push(b),a&&console.log("queue push type "+c+", "+e()))};this._getStatsForType=function(a){a=g[a];return{quota:l[a],workers:m[a],queueSize:d[a].length,requestStats:p[a]}};this.removeTasks=function(a,b){for(var c=[],e=d[g[b]],h=0;h<e.length;h++){var f=e[h];-1<a.indexOf(f)||c.push(f)}d[g[b]]=c};this.workerCancelled=function(a){v(a);a._cancelledInQueue=!0};this.clear=
function(){for(var a=0;a<d.length;a++)d[a]=[]};var v=function(b){var c=g[b.clientType];m[c]--;s--;p[c].requests++;p[c].size+=b.size||0;p[c].duration+=b.duration||0;p[c].speed=0<p[c].duration?p[c].size/p[c].duration:0;n.assert(0<=m[c]);b=h;c=!1;do m[b]<l[b]&&C(b)&&(c=!0),b=(b+1)%u;while(!c&&b!=h);if(!c){do C(b)&&(c=!0),b=(b+1)%u;while(!c&&b!=h)}!c&&a&&console.log("queue sink, "+e());h=b},C=function(b){for(;0<d[b].length;){if(k(d[b].shift(),y))return a&&console.log("queue startqueued clientType "+b+
", "+e()),m[b]++,s++,!0;a&&console.log("queue task cancelled, "+e())}return!1},y=function(a){a._cancelledInQueue||(f.apply(c,arguments),v(a))}}})},"esri/core/arrayUtils":function(){define([],function(){function q(k,f){return-1===k.indexOf(f)}function n(k,f,c){return!k.some(f.bind(null,c))}return{findIndex:function(k,f,c){for(var b=k.length,a,e=0;e<b;e++)if(a=k[e],f.call(c,a,e,k))return e;return-1},find:function(k,f,c){for(var b=k.length,a,e=0;e<b;e++)if(a=k[e],f.call(c,a,e,k))return a},equals:function(k,
f){if(!k&&!f)return!0;if(!k||!f||k.length!=f.length)return!1;for(var c=0;c<k.length;c++)if(k[c]!==f[c])return!1;return!0},difference:function(k,f,c){var b;c?(b=f.filter(n.bind(null,k,c)),k=k.filter(n.bind(null,f,c))):(b=f.filter(q.bind(null,k)),k=k.filter(q.bind(null,f)));return{added:b,removed:k}},range:function(k,f){null==f&&(f=k,k=0);for(var c=Array(f-k),b=k;b<f;b++)c[b-k]=b;return c}}})},"esri/views/3d/support/PreallocArray":function(){define(["../../../core/declare","./HeapSort"],function(q,
n){return q([],{constructor:function(k,f){this.data=Array(k);this.length=0;if(f){for(var c=0;c<k;c++)this.data[c]=f(c);this._allocator=f;this._hasAllocator=!0}else this._allocator=this._nullAllocator,this._hasAllocator=!1},_nullAllocator:function(){return null},grow:function(k){for(;this.data.length<k;)this.data.push(this._allocator(this.data.length))},next:function(){if(!this._hasAllocator)return null;this.data.length===this.length&&this.grow(2*this.length);return this.data[this.length++]},swap:function(k,
f){var c=this.data[k];this.data[k]=this.data[f];this.data[f]=c},push:function(k){this.data.length===this.length&&this.grow(2*this.length);this.data[this.length++]=k},pushArray:function(k){var f=this.length+k.length;f>=this.data.length&&this.grow(Math.max(2*this.length,f));for(f=0;f<k.length;f++)this.data[this.length++]=k[f]},pushEither:function(k){Array.isArray(k)?this.pushArray(k):this.push(k)},pop:function(){if(0===this.length)return null;var k=this.data[--this.length];this._hasAllocator||(this.data[this.length]=
null);return k},slice:function(k,f){void 0===f&&(f=this.length);return this.data.slice(k,f)},clear:function(){if(!this._hasAllocator)for(var k=0;k<this.length;k++)this.data[k]=null;this.length=0},peek:function(){return 0===this.length?null:this.data[this.length-1]},sort:function(k){n.sort(this.data,0,this.length,k);return this}})})},"esri/views/3d/support/HeapSort":function(){define([],function(){function q(k,f,c,b){for(var a=f,e=c>>>1,h=k[a-1];f<=e;){f=a<<1;f<c&&0>b(k[f-1],k[f])&&++f;var g=k[f-1];
if(0>=b(g,h))break;k[a-1]=g;a=f}k[a-1]=h}function n(k,f){return k<f?-1:k>f?1:0}return{sort:function(k,f,c,b){void 0===f&&(f=0);void 0===c&&(c=k.length);void 0===b&&(b=n);for(var a=c>>>1;a>f;a--)q(k,a,c,b);for(var e=f+1,a=c-1;a>f;a--)c=k[f],k[f]=k[a],k[a]=c,q(k,e,a,b);return k}}})},"esri/views/3d/support/DisplayQualityProfile":function(){define(["require","exports","../../../core/sniff"],function(q,n,k){var f={low:{sceneService:{"3dObject":{lodFactor:0.2},point:{lodFactor:1},integratedMesh:{lodFactor:0.6}},
tiledSurface:{lodBias:-1,angledSplitBias:0.5},antialiasingEnabled:!1},high:{sceneService:{"3dObject":{lodFactor:1},point:{lodFactor:1},integratedMesh:{lodFactor:1}},tiledSurface:{lodBias:0,angledSplitBias:1},antialiasingEnabled:!0}};return function(){function c(){}c.isValidProfile=function(b){return b in f};c.getDefaultProfile=function(){return k("trident")||k("safari")?"low":"high"};c.apply=function(b,a){var c=f[b];a.qualitySettings.sceneService["3dObject"].lodFactor=c.sceneService["3dObject"].lodFactor;
a.qualitySettings.sceneService.point.lodFactor=c.sceneService.point.lodFactor;a.qualitySettings.sceneService.integratedMesh.lodFactor=c.sceneService.integratedMesh.lodFactor;a.qualitySettings.tiledSurface.lodBias=c.tiledSurface.lodBias;a.qualitySettings.tiledSurface.angledSplitBias=c.tiledSurface.angledSplitBias;a.qualitySettings.antialiasingEnabled=c.antialiasingEnabled};return c}()})},"esri/views/3d/support/QualitySettings":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),
function(q,n,k,f,c,b){var a=function(a){function b(){a.apply(this,arguments)}k(b,a);f([c.property({value:1})],b.prototype,"lodFactor",void 0);return b=f([c.subclass()],b)}(b),e=function(b){function d(){b.apply(this,arguments)}k(d,b);d.prototype.getDefaults=function(){return{"3dObject":new a,point:new a,integratedMesh:new a}};f([c.property()],d.prototype,"3dObject",void 0);f([c.property()],d.prototype,"point",void 0);f([c.property()],d.prototype,"integratedMesh",void 0);return d=f([c.subclass()],d)}(b),
h=function(a){function b(){a.apply(this,arguments)}k(b,a);f([c.property({value:0})],b.prototype,"lodBias",void 0);f([c.property({value:1})],b.prototype,"angledSplitBias",void 0);return b=f([c.subclass()],b)}(b);return function(a){function b(){a.apply(this,arguments)}k(b,a);b.prototype.getDefaults=function(){return{sceneService:new e,tiledSurface:new h,antialiasingEnabled:!0}};f([c.property()],b.prototype,"sceneService",void 0);f([c.property()],b.prototype,"tiledSurface",void 0);f([c.property()],b.prototype,
"antialiasingEnabled",void 0);return b=f([c.subclass()],b)}(b)})},"esri/core/accessorSupport/typescript":function(){define(["../declare","../typescript","../JSONSupport","dojo/_base/lang"],function(q,n,k,f){function c(b,a){if(!b)return a;if(!a)return b;for(var e in a){var h=b[e],g=a[e];Array.isArray(g)&&Array.isArray(h)?b[e]=h.concat(g):b[e]="object"===typeof g&&"object"===typeof h?c(h,g):g}return b}return{subclass:function(b,a){return function(a){a=n.declareDefinition(a,b);h&&(a.instanceMembers.properties=
c(h,a.instanceMembers.properties));var h=a.instanceMembers.properties;if(h)for(var g in h){var d=h[g];d&&(!d.reader&&d.type)&&(d.type===Date?d.reader=function(a){return null!=a?new Date(a):null}:-1!==d.type._meta.bases.indexOf(k)&&(d.reader=function(a){return function(b){return a.fromJSON(b)}}(d.type)))}return f.mixin(q(a.bases,a.instanceMembers),a.classMembers)}},shared:n.shared,property:function(b){return function(a,c){var h=Object.getPrototypeOf(a),h=h&&h.properties;if(!a.properties||a.properties===
h)a.properties={};a.properties=a.properties||{};a.properties[c]=b||{}}}}})},"esri/core/typescript":function(){define(["./declare","dojo/_base/lang"],function(q,n){var k={declareDefinition:function(f,c){var b=[],a=Object.getPrototypeOf(f.prototype),e;if(a!==Object.prototype){var h=a.constructor;e=h.prototype;b.push(h)}c&&(b=b.concat(c));for(var h={},g=Object.getOwnPropertyNames(f.prototype),d=0;d<g.length;d++){var m=g[d];if("constructor"!==m){var l=m;"dojoConstructor"===m&&(l="constructor");if(!e||
f.prototype[m]!==e[m])h[l]=f.prototype[m]}}g=Object.getOwnPropertyNames(f);a=Object.getOwnPropertyNames(a.constructor);e={};for(d=0;d<g.length;d++)m=g[d],-1===a.indexOf(m)&&(e[m]=f[m]);return{bases:b,instanceMembers:h,classMembers:e}},subclass:function(f){return function(c){c=k.declareDefinition(c,f);return n.mixin(q(c.bases,c.instanceMembers),c.classMembers)}},shared:function(f){return function(c,b){c[b]=f}}};return k})},"esri/views/3d/support/SharedSymbolResources":function(){define("require exports dojo/io-query ./TextureCollection ./ResourceController ../../../core/urlUtils ../../../identity/IdentityManager".split(" "),
function(q,n,k,f,c,b,a){return function(){function e(a,b){var d=this;this.streamDataSupplier=this.textures=null;this.canUseXhr={};this.tokens={};this.streamDataSupplier=b.registerClient(this,c.ClientType.SYMBOLOGY,function(a){return d.addUrlToken(a)});this.textures=new f(this.streamDataSupplier,a,{wrapClamp:!0})}e.prototype.destroy=function(){this.streamDataSupplier=this.textures=null};e.prototype.addUrlToken=function(c){if(0===c.indexOf("data:"))return c;var e=c.match(/^(((?:https?:)?\/\/[^\/]+).*?)(?:\?(.*))?$/);
if(!e)return c;var d=e[1],f=e[2],e=k.queryToObject(e[3]||"");"token"in e||(null==this.tokens[f]&&(c=a.findCredential(c),this.tokens[f]=c&&c.token||""),this.tokens[f]&&(e.token=this.tokens[f]));c=(c=k.objectToQuery(e))?d+"?"+c:d;null==this.canUseXhr[f]&&(this.canUseXhr[f]=b.canUseXhr(c));return!this.canUseXhr[f]?b.addProxy(c):c};return e}()})},"esri/views/3d/support/TextureCollection":function(){define("../../../core/declare dojo/Deferred dojo/_base/lang ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),
function(q,n,k,f,c,b){var a=b.assert;return q(null,{constructor:function(a,b,c){this._streamDataSupplier=a;this._stage=b;this._textureRecords={};this._loadedHandler=this._loadedHandler.bind(this);this._errorHandler=this._errorHandler.bind(this);this._textureOptions=c||{}},acquire:function(a,b){var c;if(c=this._textureRecords[a])return c.referenceCount++,c.texture||c.clientDfd;if(b){var d=b(a);this._stage.add(f.ModelContentType.TEXTURE,d);c={texture:d,referenceCount:1};this._textureRecords[a]=c;return d}c=
new n;d=this._streamDataSupplier.request(a,"image");this._textureRecords[a]={clientDfd:c,loaderDfd:d,texture:null,referenceCount:1};d.then(this._loadedHandler,this._errorHandler);return c.promise},release:function(a){var b=this._textureRecords[a];b?(1>b.referenceCount&&console.warn("TextureCollection: reference count is \x3c 1 for "+a),b.referenceCount--,1>b.referenceCount&&(b.texture?(this._stage.remove(f.ModelContentType.TEXTURE,b.texture.getId()),b.texture=null):this._streamDataSupplier.cancelRequest(b.loaderDfd),
delete this._textureRecords[a])):console.warn("TextureCollection: texture doesn't exist: "+a)},isInUse:function(b){b=this._textureRecords[b];a(!b||0<b.referenceCount,"texture record with zero reference count");return!!b},_loadedHandler:function(b,h,g){b=this._textureRecords[b];a(b&&!b.texture);g=k.mixin({width:h.width,height:h.height},this._textureOptions);h=new c(h,"symbol",g);this._stage.add(f.ModelContentType.TEXTURE,h);b.texture=h;b.clientDfd.resolve(h)},_errorHandler:function(b){b=this._textureRecords[b];
a(b&&!b.texture);b.clientDfd.reject()}})})},"esri/views/3d/terrain/TerrainSurface":function(){define("../../../core/declare ../../../core/Accessor ../../../core/arrayUtils ../../../core/Logger ../../../core/watchUtils ../../../core/CollectionFlattener dojo/Evented dojo/on ../lib/glMatrix ../support/projectionUtils ../support/ResourceController ../support/PromiseLightweight ../../../geometry/support/webMercatorUtils ./TerrainRenderer ./OverlayManager ./SurfaceExtentHelper ./SurfaceTilingSchemeLogic ./terrainUtils ./TileUtils ./TerrainConst ./TileGeometryFactory ./SphericalTile ./PlanarTile ./TilemapOnlyTile ./MapTileAgent ./ElevationTileAgent ../support/PreallocArray ../support/ObjectPool ../support/aaBoundingRect ../support/mathUtils".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A,w,D,E,H,G){function I(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}var O=h.vec3d,J=h.vec4d,F=h.mat4d,K=u.weakAssert,T=f.getLogger("esri.views.3d.terrain"),R=C.MAX_ROOT_TILES,da=80/180*Math.PI,S=C.TileUpdateTypes,ba=J.create(),aa=[0,0,0],$=Array(10),Z={spatialReference:null,tile:null},M={spatialReference:null,extent:null},V={spatialReference:null,extent:null,scale:0},L=[-Infinity,-Infinity,Infinity,Infinity],U=function(a){a.remove()},
N=q([n,a],{properties:{ready:{readOnly:!0,get:function(){return!!this.rootTiles}},rootTiles:{readOnly:!0},manifold:{readOnly:!0},tilingScheme:{readOnly:!0},tilingSchemeLogic:{readOnly:!0},tilingSchemeLocked:{readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeLocked"},spatialReference:{readOnly:!0,dependsOn:["tilingScheme"],aliasOf:"tilingScheme.spatialReference"},overlayManager:{value:null},wireframe:{value:!1},opacity:1,cullBackFaces:!1,renderOrder:1,skirts:!0,frontMostTransparent:!1,tileBackground:"data:image/png;base64,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",
velvetOverground:!0,extent:{},loaded:!1},defaultTileBackground:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA2JJREFUeNrs3d1O20AQgFFvRJInQLQBhHj/h0JVW34El1yQ2F73DVq3jTys55zrqUBbPrErZUSZ+vcOsto4AjK76Lqu1vr8+G3mPzjc3D/+eJj/Bcz/cd75R80fbu79BsAVCAQAAgABgABAACAAEAAIAAQAAgABQPOKfQAy83Ho+HnnHzXv49B4A4AAQAAgABAACAAEAAIAAYAAQAAgABAANM4+AKnZB4ifd/5R8/YB8AYAAYAAQAAgABAACAAEAAIAAYAAQAAgAGicfQBSsw8QP+/8o+btA+ANAAIAAYAAQAAgABAACAAEAAIAAYAAQADQOPsApGYfIH7e+UfN2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAXA201QdggAggH0AUrMPED8/jsPL03fns/y8fQC8AUAAIAAQAAgABAACAAGAAEAAIAAQAAgAGmcfgNTsA8TP2weImrcPgDcACAAEAAIAAYAAQAAgABAACAAEAAIAAUDj7AOQmn2A+Hn7AFHz9gHwBgABgABAACAAEAAIAAQAAgABgABgNS4cAf9pu9u3O1+m/n2aplKK/0j+TX86/tVP5+eZ3+729gFIfwWyDxA7bx8gat4+ANkJAAGAAEAAIAAQAAgABAACAAGAAEAAIABonn0AUrMPED9vHyBq3j4A3gAgABAACAAEAAIAAYAAQAAgABAA51VrdQgCAAHAsuwDkJp9gPj5vj+9vvx0PsvP2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAYAAoHH2AUjNPkD8vH2AqHn7AHgDgABAACAAEAAIAAQAAgABgABAACAAEAA0zj4AqdkHiJ+3DxA1bx8AbwAQACQ0DL0AyKuOowBwBYKUSikCIHUBAsAVCAQAAgABgABAALBy9gFIzT5A/Lx9gKj5y6trVyC8AUAAIAAQAAgAVq90Pg5N5gA2AsAVCAQAAgABgABAALB29gFIzT5A/Lx9gKj5q6+3rkB4A4AAQAAgABAACADWzB/IIHsCAsAVCARAlKlWhyAAEAAIABZjH4DU7APEz5+OH2+vT85n+fkvhztXILwBQAAgABAACAAEAGtWigBIHcBGALgCgQBAACAAyPMO9nHosxuHodZx5vB2t691HIdh/nx/Os7/Zsz/fvgXAAAA//8DAF1P1hM2ICMfAAAAAElFTkSuQmCC",
constructor:function(){this._set("rootTiles",null);this._iteratorPool=new E(2,v.IteratorPreorder);this._postorderIterator=new v.IteratorPostorder;this._topLevelTilemapOnlyTiles=Array(C.TILEMAP_SIZE_EXP+1);for(a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._topLevelTilemapOnlyTiles[a]=new z([a-C.TILEMAP_SIZE_EXP,0,0]);this._dataExtent=this._clippingExtent=null;this._rootExtent=[0,0,0,0];this.notifyChange("extent");this._elevationBounds=[0,0];this._frameUpdateLowerPrio=new D(500);this.maxTextureScale=
1.2;this._stage=this._view._stage;this._updateNextFrame=this._lvPendingUpdates=this._pendingUpdates=this.suspended=this.visible=!1;this._curOverlayOpacity=1;this._curEyePos=O.create();this._curSplitLimits=[0,0,0,0,0,0];this._curFrustumPlanes=Array(6);this._viewProjectionMatrix=F.identity();for(var a=0;6>a;++a)this._curFrustumPlanes[a]=J.create();this.tilemapStats={tilemapRequestsSent:0,tilemapRequestsPending:0,tilemapRequestErrors:0,fullTilemaps:0,emptyTilemaps:0,tilesRequested:0,tileRequestsSent:0,
tileRequestErrors:0,tilesNotPresent:0};this._layerViews=[[],[]];this._layerIndexByLayerViewId=[{},{}];this._basemapLayerViewHandles={};this._groupLayerViewHandles={};this._layerViewChangesHandle=null;this.hideSkirtsDistanceFromExtentMargin=1.2;this.hideSkirtsMinimumCameraTilt=da},normalizeCtorArgs:function(a,b){this._view=a;this._set("manifold",b);this.TileClass="planar"===b?B:x;return{}},initialize:function(){this._renderer=new p(this.manifold);this._renderer.loaded=this._setLoaded.bind(this);this._renderer.updateTileBackground(this.tileBackground);
this._renderer.install(this._view._stage);this.overlayManager=new s(this,this._view);this.extentHelper=new ("spherical"===this.manifold?r.SurfaceExtentHelperGlobal:r.SurfaceExtentHelperLocal)({layers:this._view.map.allLayers,layerViews:this._view.allLayerViews,spatialReference:this._view.spatialReference});var a;a=this._view.defaultsFromMap?new b({root:this._view.map,rootCollectionNames:this._view.defaultsFromMap.mapCollectionPaths,getChildrenFunction:function(a){return a.layers}}):this._view.map.allLayers;
this._set("tilingSchemeLogic",new t({layers:a,extentHelper:this.extentHelper,manifold:this.manifold,viewSpatialReference:this._view.spatialReference}));this.tilingSchemeLogic.watch("tilingScheme",this._updateTilingSchemeAndExtent.bind(this),!0);this.tilingSchemeLogic.watch("extent",this._updateTilingSchemeAndExtent.bind(this),!0);this._updateTilingSchemeAndExtent();this._streamDataSupplier=this._view.resourceController.registerClient(this,d.ClientType.TERRAIN);this._idleWorkers={needsUpdate:this._needsIdleUpdate,
idleFrame:this._idleUpdate};this._view.resourceController.registerFrameWorker(this._frameUpdate.bind(this));this._view.resourceController.registerIdleFrameWorker(this,this._idleWorkers);this._viewChangeListenerHandles=[];this._viewChangeUpdate=this._viewChangeUpdate.bind(this);this._viewChangeListenerHandles.push(this._view.on("resize",this._viewChangeUpdate));this._viewChangeListenerHandles.push(c.on(this._view,"navigation","currentViewChanged",this._viewChangeUpdate));this._viewChangeListenerHandles.push(this._view.watch("qualitySettings.tiledSurface.lodBias",
this._viewChangeUpdate));this._layerViewChangesHandle=this._view.allLayerViews.on("change",this._handleLayerViewChanges.bind(this));this._handleLayerViewChanges({added:this._view.allLayerViews.toArray(),removed:[],moved:[]});this._clippingChangedHandle=this._view.watch("clippingArea",this._clippingChanged.bind(this));this._updateClippingExtent()},destroy:function(){this._removeAllTiles();this.tilingSchemeLogic.destroy();this._set("tilingSchemeLogic",null);this.extentHelper.destroy();this.extentHelper=
null;for(var a in this._basemapLayerViewHandles)this._unregisterTiledLayerView(a);this._view.resourceController.deregisterFrameWorker(this);this._view.resourceController.deregisterIdleFrameWorker(this);this._view.resourceController.deregisterClient(this);this._viewChangeListenerHandles.forEach(U);for(var b in this._groupLayerViewHandles)this._groupLayerViewHandles[b].forEach(U);this._layerViewChangesHandle.remove();this._clippingChangedHandle.remove();this.overlayManager&&(this.overlayManager.destroy(),
this.overlayManager=null);this._renderer.uninstall(this._stage);this._streamDataSupplier=this._stage=this._view=this._renderer=null},setVisibility:function(a){a!==this.visible&&(this.visible=a,this._renderer.setVisibility(a),this.setUpdatesDisabled(!a),a&&this._viewChangeUpdate())},isVisible:function(){return this.visible&&this.ready},setUpdatesDisabled:function(a){(this.suspended=a)||this._viewChangeUpdate()},getElevation:function(a){return!this.ready||0===this.rootTiles[0].layerInfo[C.LayerClass.ELEVATION].length?
null:Array.isArray(a)?this._getElevation(a):!g.pointToVector(a,ba,this.tilingScheme.spatialReference)?(T.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null):this._getElevation(ba)},_getElevation:function(a){var b=C.LayerClass.ELEVATION,c=this.rootTiles[0].layerInfo[b].length,d;$.length<c&&($.length=c);for(var e=0;e<this.rootTiles.length;e++){var g=this.rootTiles[e];if(v.isPosWithinTile(g,a))for(;g;){var h=g.layerInfo[b];for(d=0;d<c;d++)h[d].data&&
($[d]=h[d].data.samplerData);if(!g.children[0])break;d=0;a[0]>g.children[0].extent[2]&&(d+=1);a[1]<g.children[0].extent[1]&&(d+=2);g=g.children[d]}}a=y.elevationSampler(a[0],a[1],$);for(d=0;d<c;d++)$[d]=void 0;return a},getElevationBounds:function(){return this._elevationBounds},getScale:function(a){if(this.tilingScheme){if(!g.pointToVector(a,ba,this.spatialReference))return T.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;if(this.rootTiles)for(var b=
0;b<this.rootTiles.length;b++)if(a=this.rootTiles[b],v.isPosWithinTile(a,ba)){for(;a.children[0];)b=0,ba[0]>a.children[0].extent[2]&&(b+=1),ba[1]<a.children[0].extent[1]&&(b+=2),a=a.children[b];return this._getLodBiasCorrectedScale(a.lij[0])}}return 1E100},queryVisibleScaleRange:function(a,b,c,d){b=b?this.tilingScheme.levelAtScale(b):0;c=c?this.tilingScheme.levelAtScale(c):Infinity;var e=this._getLodBias();this._renderer.queryVisibleLevelRange(a,b+e,c+e,d)},_setLoaded:function(){this.loaded||(this.loaded=
!0,this.emit("load"))},_updateTilingSchemeAndExtent:function(){var a=this.tilingSchemeLogic.extent,b=this.tilingSchemeLogic.tilingScheme,c=!1;a&&!H.equals(a,this._dataExtent)&&(c=!0,this._dataExtent?H.set(this._dataExtent,a):this._dataExtent=H.create(a));b!=this.tilingScheme&&(K(b,"tiling scheme cannot be reset to undefined"),c=!0,this.tilingScheme&&this._removeAllTiles(),this._set("tilingScheme",b),this._updateClippingExtent(),b&&(this._updateTiledLayers(),this._renderer.setTileSize(b.pixelSize[0]),
this.overlayManager.setSpatialReference(b.spatialReference,"spherical"===this.manifold)));c&&this._updateRootTiles()},_acquireTile:function(a,b,c,d){var e=this.TileClass.Pool.acquire();aa[0]=a;aa[1]=b;aa[2]=c;e.init(aa,d,this,this.tilingScheme);return e},_releaseTile:function(a){a.dispose();a.parent=null;a.parentSurface=null;this.TileClass.Pool.release(a)},_updateRootTiles:function(){var a=this._clippingExtent||this._dataExtent,b=this.tilingScheme;if(a&&b){var c=b.rootTilesInExtent(a,ba,Infinity);
if(this.rootTiles){if(c.length>R){T.warn(N.TOO_MANY_ROOT_TILES_AFTER_CHANGE);return}var a=this.rootTiles.map(function(a){return a.lij}),d=k.difference(a,c,I);if(0<d.removed.length||0<d.added.length){var e=this.rootTiles.filter(function(a){return-1<k.findIndex(d.removed,I.bind(null,a.lij))?(this._purgeChildTiles(a),this._purgeTile(a),!1):!0}.bind(this));d.added.forEach(function(a){a=this._acquireTile(0,a[1],a[2],null);e.push(a);this._loadTile(a)}.bind(this));this._set("rootTiles",e);this._renderer.setRootTiles(this.rootTiles)}}else c.length>
R&&(T.warn(N.TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR),c=b.rootTilesInExtent(a,ba,R)),this._set("rootTiles",c.map(function(a){a=this._acquireTile(0,a[1],a[2],null);this._loadTile(a);return a}.bind(this))),this._renderer.setRootTiles(this.rootTiles);k.equals(ba,this._rootExtent)||(this._rootExtent=J.create(ba),this._hasFixedExtent()||this.notifyChange("extent"));this.setVisibility(!0);this._viewChangeUpdate();this.notifyChange("ready")}},_viewChangeUpdate:function(){this._stage&&(!this.suspended&&this.tilingScheme&&
this.visible)&&(this._updateViewDependentParameters(),this._updateOverlayOpacity(this._curEyePos),this._updateTiles(this.rootTiles),this.overlayManager&&this.overlayManager.setOverlayDirty())},_updateTiles:function(a){var b=this._iteratorPool.acquire();b.reset(a);a=this._curSplitLimits;for(var c=this._curFrustumPlanes,d=this._curEyePos,g=Infinity,h=-Infinity;!b.done;){var f=b.next();f.updateClippingStatus(this._clippingExtent);var l=!0;if(f.updateVisibility(c,d)){f.updateScreenDepth(this._viewProjectionMatrix);
f.renderData&&(g=Math.min(f.elevationBounds[0],g),h=Math.max(f.elevationBounds[1],h));var m=f.shouldSplit(a,d);m===S.SPLIT?(f.pendingUpdates&=~S.MERGE,f.renderData?(l=!1,f.pendingUpdates|=S.SPLIT,b.skip()):l=!1):(f.pendingUpdates&=~S.SPLIT,m===S.VSPLITMERGE&&f.updateAgents(C.LayerClass.ELEVATION),b.skip())}else b.skip();if(l&&!f.renderData){f.pendingUpdates|=S.MERGE;f.pendingUpdates&=~S.SPLIT;l=this._iteratorPool.acquire();for(l.reset(f);!l.done;)m=l.next(),m.updateVisibility(c,d),m.visible&&m.updateScreenDepth(this._viewProjectionMatrix);
this._iteratorPool.release(l)}0!==f.pendingUpdates&&(this._pendingUpdates=!0)}this._iteratorPool.release(b);if(isFinite(g)&&isFinite(h)&&(this._elevationBounds[0]!==g||this._elevationBounds[1]!==h))this._elevationBounds[0]=g,this._elevationBounds[1]=h,e.emit(this,"elevation-bounds-change")},_viewParamSelector:{projectionMatrix:!0,fovX:!0,viewport:!0},_updateViewDependentParameters:function(){var a=this._view.navigation.currentCamera,b=Math.tan(0.5*a.fovX),c=Math.tan(0.5*a.fovY),d=this.tilingScheme.pixelSize,
e=Math.pow(2,-this._getLodBias());this._curSplitLimits[0]=b;this._curSplitLimits[1]=d[0]/a.width*this.maxTextureScale*e;this._curSplitLimits[2]=c;this._curSplitLimits[3]=d[1]/a.height*this.maxTextureScale*e;this._curSplitLimits[4]=this.tilingScheme.getMaxLod();this._curSplitLimits[5]=this._view.qualitySettings.tiledSurface.angledSplitBias;a.copyFrustumPlanes(this._curFrustumPlanes);F.multiply(a.projectionMatrix,a.viewMatrix,this._viewProjectionMatrix);O.set(a.eye,this._curEyePos);u.autoUpdateSkirtsVisibility(this,
this._curEyePos)},_setLayerViewsUpdating:function(){for(var a=0;a<C.LayerClass.LAYER_CLASS_COUNT;a++)for(var b=this._layerViews[a],c=0;c<b.length;c++)b[c]._evaluateUpdatingState(this._pendingUpdates)},_frameUpdateTraversal:function(a){if(!this.suspended){this._frameUpdateLowerPrio.clear();var b=this._renderer.numTileTexturesComposited,c=this._iteratorPool.acquire();c.reset(this.rootTiles);for(var d=!1,e=!1;!c.done&&(1<a.remaining()||!d)&&12>this._renderer.numTileTexturesComposited-b;){var g=c.next();
g.pendingUpdates&S.MERGE?(this._mergeTile(g),g.pendingUpdates&=~S.MERGE,d=!0,c.skip()):g.pendingUpdates&S.SPLIT?(this._splitTile(g),g.pendingUpdates&=~S.SPLIT,d=!0,c.skip()):0<g.pendingUpdates&&this._frameUpdateLowerPrio.push(g);0!==g.pendingUpdates&&(e=!0)}this._pendingUpdates=e||!c.done;this._iteratorPool.release(c);return d}},_updateTileGeometry:function(a){this._renderer._updateTileGeometry(a);Z.spatialReference=this.spatialReference;Z.tile=a;e.emit(this,"elevation-change-tile",Z)},_updateTileTexture:function(a){this._renderer.updateTileTexture(a)},
_frameUpdate:function(a){if(this.rootTiles){for(var b=this._frameUpdateTraversal(a);(1<a.remaining()||!b)&&0<this._frameUpdateLowerPrio.length;){var c=this._frameUpdateLowerPrio.pop();c.pendingUpdates&S.DECODE_LERC?(this._decodeLERC(c),c.pendingUpdates&=~S.DECODE_LERC,b=!0):c.pendingUpdates&S.UPDATE_GEOMETRY?(this._renderer.updateTileGeometryNeedsUpdate(c),this._updateTileGeometry(c),b=!0,c.pendingUpdates&=~S.UPDATE_GEOMETRY):c.pendingUpdates&S.UPDATE_TEXTURE&&(this._updateTileTexture(c),c.pendingUpdates&=
~S.UPDATE_TEXTURE,b=!0);0!==c.pendingUpdates&&(this._pendingUpdates=!0)}0<this._frameUpdateLowerPrio.length&&(this._pendingUpdates=!0);this._streamDataSupplier._loader.hasPendingDownloads()&&(this._pendingUpdates=!0);if(this._pendingUpdates!==this._lvPendingUpdates&&(this._pendingUpdates||20===++this._updateNextFrame))this._setLayerViewsUpdating(),this._lvPendingUpdates=this._pendingUpdates,this._updateNextFrame=0}},_needsIdleUpdate:function(){return this.isVisible()&&this.overlayManager&&this.overlayManager.overlaysNeedUpdate()},
_idleUpdate:function(a){this.overlayManager.updateOverlay();this._updateOverlayOpacity(this._curEyePos)},_updateClippingExtent:function(){if(!this.spatialReference)return!1;var a=[],b=null;g.extentToBoundingRect(this._view.clippingArea,a,this.spatialReference)&&(b=a);if(k.equals(b,this._clippingExtent))return!1;this._clippingExtent=b;this.notifyChange("extent");return!0},_clippingChanged:function(){this._updateClippingExtent()&&this._updateRootTiles()},_getLodBias:function(){return Math.round(this._view.qualitySettings.tiledSurface.lodBias)},
_getLodBiasCorrectedScale:function(a){var b=this.tilingScheme.levels;a=G.clamp(a-this._getLodBias(),0,b.length-1);return b[a].scale},_cancelTilemapRequests:function(a){for(var b=0;b<C.LayerClass.LAYER_CLASS_COUNT;b++){var c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var e=c[d];e.tilemapRequest&&(e.tilemapRequest.cancel(),e.tilemapRequest=null)}}},_removeAllTiles:function(){this.rootTiles&&(this.rootTiles.forEach(function(a){this._purgeChildTiles(a);this._purgeTile(a)}.bind(this)),this._set("rootTiles",
null),this.notifyChange("ready"));for(var a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._cancelTilemapRequests(this._topLevelTilemapOnlyTiles[a]);this.setVisibility(!1)},_purgeChildTiles:function(a){var b=this._postorderIterator;for(b.reset(a);!b.done;){for(var c=b.next(),d=0;4>d;d++)c.children[d]=null;c!==a&&this._purgeTile(c)}},_purgeTile:function(a){a.unload(this._renderer);this._cancelTilemapRequests(a);a.parent=null;this._renderer.releaseTileTextures(a);this._releaseTile(a)},_splitTile:function(a){var b=
a.lij[0]+1,c=2*a.lij[1],d=2*a.lij[2];a.children[0]=this._createTile(b,c,d,a);a.children[1]=this._createTile(b,c,d+1,a);a.children[2]=this._createTile(b,c+1,d,a);a.children[3]=this._createTile(b,c+1,d+1,a);a.unload(this._renderer);V.spatialReference=this.spatialReference;V.extent=a.extent;V.scale=this._getLodBiasCorrectedScale(b);e.emit(this,"scale-change",V)},_createTile:function(a,b,c,d){K(d,"_createTile sanity check");a=this._acquireTile(a,b,c,d);a.updateClippingStatus(this._clippingExtent);a.updateVisibility(this._curFrustumPlanes,
this._curEyePos);a.visible&&(a.updateScreenDepth(this._viewProjectionMatrix),a.shouldSplit(this._curSplitLimits,this._curEyePos)===S.SPLIT&&(a.pendingUpdates|=S.SPLIT,this._pendingUpdates=!0));this._loadTile(a);return a},_mergeTile:function(a){K(!a.renderData,"_mergeTile sanity check");this._loadTile(a);this._purgeChildTiles(a);V.spatialReference=this.spatialReference;V.extent=a.extent;V.scale=this._getLodBiasCorrectedScale(a.lij[0]);e.emit(this,"scale-change",V)},_loadTile:function(a){a.load(this._renderer);
this.overlayManager&&this.overlayManager.hasOverlays()&&this.overlayManager.setOverlayParamsOfTile(a,a.renderData,this._curOverlayOpacity)},_decodeLERC:function(a){var b=C.LayerClass.ELEVATION,c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var g=c[d];g.pendingUpdates&=~S.DECODE_LERC;if(g.rawData){var h=a.createElevationDataFromLERC(g.rawData);g.rawData=null;if(h){g.data=h;var g=a.lij[0],f=this._iteratorPool.acquire();for(f.reset(a);!f.done;){var l=f.next();l.findElevationBoundsForLayer(d,g);l.computeElevationBounds()}this._iteratorPool.release(f);
a.dataArrived(d,b,h);this._updateTiles(a);M.spatialReference=this.spatialReference;M.extent=a.extent;e.emit(this,"elevation-change",M)}}}},_handleLayerViewChanges:function(a){var b=!1;a.added.forEach(function(a){var c=a.layer;if(u.isTiledLayerView(a))this._registerTiledLayer(c,a),c.loaded&&(b=!0);else if(a.supportsDraping&&this.overlayManager)this.overlayManager.registerLayerView(a);else if("IntegratedMeshLayer"===c.operationalLayerType&&!this._renderer.isStencilEnabledLayerExtent(a.uid)){var d=c.fullExtent,
c=d.spatialReference,e=[d.xmax,d.ymax,d.zmax],h=Array(6);(d=(d=g.bufferToBuffer([d.xmin,d.ymin,d.zmin],c,0,h,this.spatialReference,0))&&g.bufferToBuffer(e,c,0,h,this.spatialReference,3))&&this._renderer.addStencilEnabledLayerExtent(a.uid,h)}}.bind(this));a.removed.forEach(function(a){u.isTiledLayerView(a)?(b=!0,this._unregisterTiledLayerView(a.uid)):a.supportsDraping&&this.overlayManager?this.overlayManager.unregisterLayerView(a):this._renderer.isStencilEnabledLayerExtent(a.uid)&&this._renderer.removeStencilEnabledLayerExtent(a.uid)}.bind(this));
(b=b||0<a.moved.filter(u.isTiledLayerView).length)&&this._updateTiledLayers()},_registerTiledLayer:function(a,b){var c=[];c.push(b.watch("suspended",function(){this._updateTiledLayers()}.bind(this)));c.push(b.watch("fullOpacity",this._updateTileTextures.bind(this)));this._basemapLayerViewHandles[b.uid]=c},_unregisterTiledLayerView:function(a){var b=this._basemapLayerViewHandles[a];if(b){for(var c=0;c<b.length;c++)b[c].remove();delete this._basemapLayerViewHandles[a]}},_updateTiledLayers:function(){if(this.tilingScheme){var a=
this._view.allLayerViews,b=[[],[]],c=C.LayerClass,d=null,g=H.create(H.NEGATIVE_INFINITY),h=function(a){var e=a.layer;if(e&&a&&!a.suspended&&u.isTiledLayerView(a)){var h=e.fullExtent;if(h)if(this.tilingScheme.compatibleWith(e.tileInfo))if(H.expand(g,h),u.isElevationLayerView(a))b[c.ELEVATION].push(a);else{if(Infinity!==a.maxDataLevel&&(null===d||a.maxDataLevel>d))d=a.maxDataLevel;b[c.MAP].push(a)}else T.warn("Terrain: tiling scheme of layer "+e.id+" is incompatible with other tiled layers, will not be drawn");
else T.warn("Terrain: Map or elevation layer does not have fullExtent: "+e.id)}}.bind(this);a.forEach(h,this);for(var f=0;f<c.LAYER_CLASS_COUNT;f++){a=this._layerViews[f];h=b[f];h.reverse();var l=a.length!==h.length,m=h.length,p=Array(m),s=Array(a.length);this._layerIndexByLayerViewId[f]={};for(var k=0;k<m;k++){this._layerIndexByLayerViewId[f][h[k].uid]=k;var r=a.indexOf(h[k]);p[k]=r;k!==r&&(l=!0);-1<r&&(s[r]=k)}if(l){this._layerViews[f]=h;this._topLevelTilemapOnlyTiles.forEach(function(a){a.modifyLayers(s,
p,f)});if(this.rootTiles){a=this._postorderIterator;for(a.reset(this.rootTiles);!a.done;)a.next().modifyLayers(s,p,f);for(a.reset(this.rootTiles);!a.done;)h=a.next(),h.restartAgents(f),f===c.ELEVATION&&h.computeElevationBounds();this._updateTiles(this.rootTiles)}f===c.ELEVATION&&this.tilingScheme&&(M.spatialReference=this.tilingScheme.spatialReference,M.extent=L,e.emit(this,"elevation-change",M))}}this.tilingScheme.levels.length-1<d&&(this.tilingScheme.ensureMaxLod(d),this._viewChangeUpdate())}},
_getLayerExtentUnion:function(a){var b=this._view.allLayerViews,c=H.create(H.NEGATIVE_INFINITY);b.forEach(function(b){var d=b.layer;(b=b.fullExtentInViewSpatialReference||d.fullExtent)&&!b.spatialReference.equals(a)&&(b=l.canProject(b.spatialReference,a)?l.project(b,a):null);b&&H.expand(c,b)});return H.allFinite(c)?c:null},layerViewByIndex:function(a,b){return this._layerViews[b][a]},agentTypeByLayerIndex:function(a,b){return b===C.LayerClass.ELEVATION?w:A},numLayers:function(a){return this._layerViews[a].length},
numTotalLayers:function(){return this._layerViews.reduce(function(a,b){return b.length+a},0)},_updateTileTextures:function(){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)a.next().updateTexture();this._iteratorPool.release(a)},requestTileData:function(a,b,c){this.tilemapStats.tilesRequested++;var d=this.layerViewByIndex(b,c);if(d.layer.tileMap){var e=this.getTilemapTile(a),g=e.layerInfo[c][b];if(g.tilemapData){if(!e.tileDataAvailable(a,b,c))return this.tilemapStats.tilesNotPresent++,
this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),b=new m.Promise,b.reject(),b}else{var h=new m.Promise;h.actualTileRequestPromise=null;g.tilemapRequest||(g.tilemapRequest=this.requestTilemapData(e,b,c,d));g.tilemapRequest.then(function(){g.tilemapRequest=null;if(!h.isCancelled()){var b=this._layerIndexByLayerViewId[c][d.uid];null!=b&&(e.tileDataAvailable(a,b,c)?(h.actualTileRequestPromise=this._requestTileData(a,b,c,d),h.actualTileRequestPromise.then(function(){h.resolve()})):(this.tilemapStats.tilesNotPresent++,
this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),h.reject()))}}.bind(this));return h}}return this._requestTileData(a,b,c,d)},_requestTileData:function(a,b,c,d){this.tilemapStats.tileRequestsSent++;b=d.getTileUrl(a.lij[0],a.lij[1],a.lij[2]);var e=this;c===C.LayerClass.ELEVATION?(b=this._streamDataSupplier.request(b,"binary"),b.then(function(b,g){var h=e._layerIndexByLayerViewId[c][d.uid];null!=h?(h=a.layerInfo[c][h],g.url=b,h.rawData=g,a.pendingUpdates|=S.DECODE_LERC,h.pendingUpdates|=
S.DECODE_LERC,e._pendingUpdates=!0):T.warn("TerrainSurface: received data from unknown layer %d %s",c,a.lij.toString())},function(b){e.tilemapStats.tileRequestErrors++;e._dispatchDataEvent(a,"dataMissing",c,d,b)})):(b=this._streamDataSupplier.request(b,"image"),b.then(function(b,g){e._dispatchDataEvent(a,"dataArrived",c,d,g)},function(b){e.tilemapStats.tileRequestErrors++;e._dispatchDataEvent(a,"dataMissing",c,d,b)}));return b},requestTilemapData:function(a,b,c,d){var e,g=new m.Promise(function(){e.cancel()}),
h=a.lij[0]+C.TILEMAP_SIZE_EXP,f=a.lij[1]<<C.TILEMAP_SIZE_EXP,l=a.lij[2]<<C.TILEMAP_SIZE_EXP;this.tilemapStats.tilemapRequestsSent++;this.tilemapStats.tilemapRequestsPending++;var p=this,s=1<<Math.min(C.TILEMAP_SIZE_EXP,h);e=d.layer.tileMap.getTileMap(h,f,l,s,s);e.then(function(e){p.tilemapStats.tilemapRequestsPending--;var m=e.location;!0!==e.valid||!m||m.top!==f||m.left!==l||m.width!==s||m.height!==s?(T.warn("Unexpected tilemap response for %s/%d/%d/%d/%d/%d",d.uid,h,f,l,s,s),p.tilemapStats.tilemapRequestErrors++):
(b=this._layerIndexByLayerViewId[c][d.uid],null!=b&&(a.layerInfo[c][b].tilemapData=e));g.resolve()}.bind(this),function(){p.tilemapStats.tilemapRequestErrors++;g.resolve()});return g},getTilemapTile:function(a){var b=a.lij[0];return b>C.TILEMAP_SIZE_EXP?v.getTileNLevelsUp(a,C.TILEMAP_SIZE_EXP):this._topLevelTilemapOnlyTiles[b]},_dispatchDataEvent:function(a,b,c,d,e){d=this._layerIndexByLayerViewId[c][d.uid];if(null!=d)a[b](d,c,e);else T.warn("TerrainSurface: received data from unknown layer")},cancelRequest:function(a){var b=
a.actualTileRequestPromise;void 0!==b?(null!==b&&this._streamDataSupplier.cancelRequest(b),a.cancel()):this._streamDataSupplier.cancelRequest(a)},_updateTileOverlayParams:function(){if(this.rootTiles){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;){var b=a.next();b.renderData&&this.overlayManager&&this.overlayManager.setOverlayParamsOfTile(b,b.renderData,this._curOverlayOpacity)}this._iteratorPool.release(a);this._renderer.setNeedsRender()}},_updateOverlayOpacity:function(a){if(this.overlayManager&&
(a=this.overlayManager.updateOpacity(a),!isNaN(a))){if(a!==this._curOverlayOpacity&&this.rootTiles){var b=this._iteratorPool.acquire();for(b.reset(this.rootTiles);!b.done;){var c=b.next();c.renderData&&c.renderData.overlayTexId&&(c.renderData.overlayOpacity=a)}this._iteratorPool.release(b)}this._curOverlayOpacity=a;this._renderer.setNeedsRender()}},getStats:function(){var a=0,b=0,c=0,d=[],e=this._iteratorPool.acquire();for(e.reset(this.rootTiles);!e.done;){var g=e.next();a++;g.renderData&&(b++,g.visible&&
(c++,g=g.lij[0],d[g]=null!=d[g]?d[g]+1:1))}this._iteratorPool.release(e);return{numNodes:a,numLeaves:b,numVisible:c,numVisiblePerLevel:d}},getTile:function(a){var b=a.split("/").map(JSON.parse);if(0===b[0])return this.rootTiles.forEach(function(a){if(a.lij[1]===b[1]&&a.lij[2]===b[2])return a}),null;var c=b[1]>>b[0],d=b[2]>>b[0],e;this.rootTiles.some(function(a){return a.lij[1]===c&&a.lij[2]===d?(e=a,!0):!1});if(e){for(var g=1<<b[0]-1;e.lij[0]<b[0];){var h=b[1]&g?2:0;0<(b[2]&g)&&h++;if(!e.children[h])return console.log("Tile "+
a+" doesn't exist, smallest ancestor is "+v.tile2str(e)),null;e=e.children[h];g>>=1}K(e.lij[0]===b[0]&&e.lij[1]===b[1]&&e.lij[2]===b[2],"not the right tile?");return e}return null},hasPendingUpdates:function(){if(this._streamDataSupplier._loader.hasPendingDownloads())return!0;var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)if(0<a.next().pendingUpdates)return this._iteratorPool.release(a),!0;this._iteratorPool.release(a);return!1},setBorders:function(a){this._renderer.setBorders(a)},
setDisableRendering:function(a){this._renderer.setDisableRendering(a)},_extentGetter:function(){return this._clippingExtent||this._rootExtent},_hasFixedExtent:function(){return!!this._clippingExtent},_wireframeSetter:function(a){this._renderer.setWireframe(a);this._set("wireframe",a);this._view._stage.setRenderParams({earlyOcclusionPixelDraw:a})},_opacitySetter:function(a){this._renderer.setOpacity(a);this._set("opacity",a)},_skirtsSetter:function(a){this._renderer.setDrawSkirts(!!a);this._set("skirts",
a)},_cullBackFacesSetter:function(a){this._renderer.setCullBackFaces(a);this._set("cullBackFaces",a)},_renderOrderSetter:function(a){this._renderer.setRenderOrder(a);this._set("renderOrder",a)},_frontMostTransparentSetter:function(a){this._renderer.setFrontMostTransparent(!!a);this._set("frontMostTransparent",a)},_tileBackgroundSetter:function(a){a!==this.tileBackground&&this._renderer.updateTileBackground(a);this._set("tileBackground",a)},_velvetOvergroundSetter:function(a){a!==this.velvetOverground&&
this._renderer.setVelvetOverground(a);this._set("velvetOverground",a)}});N.TOO_MANY_ROOT_TILES_INITIALLY="Maximum number of root tiles exceeded, only a part of the map will be visible.";N.TOO_MANY_ROOT_TILES_AFTER_CHANGE="Cannot extend surface to encompass all layers because it would result in too many root tiles.";return N})},"esri/views/3d/terrain/TerrainRenderer":function(){define("dojo/Deferred dojo/when ./TileUtils ./TerrainConst ./TileGeometryFactory ../support/PreallocArray ../support/ObjectPool ../webgl-engine/lib/ShaderVariations dojo/text!./TerrainMaterial.xml ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/Util ../lib/glMatrix ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/tracer ../../webgl/Texture ../../webgl/FramebufferObject ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../../webgl/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B){var z=d.assert,A=m.vec2d,w=m.vec3d,D=m.vec4d,E=m.mat4d.identity(),H=[2,2],G=p.OPAQUE_TERRAIN,I=p.TRANSPARENT_TERRAIN,O=[0,0],J=w.create(),F,K=A.create(),T=function(){this.overlayTexOffset=A.create();this.texOffset=A.create();this.geometryInfo={geometry:null,numSurfaceIndices:0,numSkirtIndices:0,numWithoutSkirtIndices:0,numVertsPerRow:0};this.init()};T.prototype.init=function(){this.geometryInfo.geometry=null;this.geometryInfo.numSurfaceIndices=
0;this.geometryInfo.numSkirtIndices=0;this.geometryInfo.numWithoutSkirtIndices=0;this.geometryInfo.numVertsPerRow=0;this.textureReference=this.texture=this.vao=this.geometryState=null;A.set2(0,0,this.texOffset);this.texScale=1;this.overlayTexId=null;this.overlayTexScale=[1,1];this.overlayOpacity=1;this.localOrigin=null};T.prototype.updateGeometryState=function(a){return this.geometryState=a.geometryState(this.geometryState)};d=function(d,m){function p(a,b){var c=a.screenDepth,d=b.screenDepth;return c<
d?-W:c>d?W:0}function ba(a,b){return 0===a.tiles.length?-W:0===b.tiles.length?W:p(a.tiles.data[0],b.tiles.data[0])}function aa(a,b){void 0===b&&(b=ga.subdivisionReduceLevels);return 0===b?a:0>b?Math.floor((a-1)*(1<<-b))+1:Math.floor((a-1)/(1<<b))+1}m=m||256;var $,Z=!1,M=null,V=null,L=null,U={},N,Q,P=new a(100,T),X=new b(10,function(){return{root:null,tiles:new b(300)}}),ca=new k.IteratorPreorder,Y,fa,ea,ia,ha=!0,ma=1,ka=!0,ga={mode:"none",width:1.5,falloff:1.5,wireOpacity:1,surfaceOpacity:0,color:[1,
1,1,0],subdivision:"geometry",subdivisionReduceLevels:0},ja=!1,oa=!1,la=!1,W=1,ra=!0,Aa=!0,na=null,qa=null,ta=null,ua=null,va=null,Ea=null,sa=[];this.updateTileBackground=function(a){va&&va.reject();Ea=a;var b=new q;va=b;if(a){var c=new Image;c.src=a instanceof Image?a.src:a;c.onload=function(){b.isFulfilled()||b.resolve(c)}}else b.resolve(null);this.renderTileBackground();return b.promise};var ya=0,wa=0,Ba=0,Ca=0;this.numTileTexturesComposited=0;this.castShadows=!1;this.loaded=function(){};var Fa=
!1;this.needsRender=!0;this.receiveShadows=this.didRender=!1;var pa=new b(10),xa=0,za=new b(30),Ga=new a(10,function(){this.extent=D.create();this.maxLevel=this.minLevel=0;this.callback=null});this.renderTileBackground=function(){if(N&&va)return va.then(function(a){ta=this._buildTexture(a);M&&k.traverseTilesPreorder(M,function(a){this.updateTileTexture(a)}.bind(this))}.bind(this))};this.initializeRenderContext=function(a){N=a.rctx;Q=a.rctx.gl;fa=N.extensions.textureFilterAnisotropic;z(!F||F===fa.TEXTURE_MAX_ANISOTROPY_EXT,
"contexts have different definitions afExt.TEXTURE_MAX_ANISOTROPY_EXT");null!=fa&&(F=fa.TEXTURE_MAX_ANISOTROPY_EXT,ea=N.parameters.maxMaxAnisotropy,ia=Math.min(8,ea));c.setSupportsUintIndices(!!N.extensions.elementIndexUint);n(this.renderTileBackground(),function(){Z=!0;this.setNeedsRender()}.bind(this));var b=new Float32Array(20);b[0]=-1;b[1]=-1;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=-1;b[7]=0;b[8]=1;b[9]=0;b[10]=-1;b[11]=1;b[12]=0;b[13]=0;b[14]=1;b[15]=1;b[16]=1;b[17]=0;b[18]=1;b[19]=1;qa=new u(N,y.Default3D,
{geometry:x.Pos3Tex},{geometry:v.createVertex(N,Q.STATIC_DRAW,b)});$=a.textureRep;var b=a.shaderSnippets,d=a.shaderRep;a=a.programRep;b.vsTerrain||b._parse(h);N.extensions.standardDerivatives;var g=new e("terrain",["vsTerrain","fsTerrain"],null,a,d,b,N);g.addDefine("Spherical","SPHERICAL");g.addDefine("Overlay","OVERLAY");g.addDefine("Atmosphere","ATMOSPHERE");g.addDefine("Wireframe","WIREFRAME");g.addDefine("TileBorders","TILE_BORDERS");g.addBinaryShaderSnippetSuffix("Wireframe","Wireframe",[!1,
!0]);g.addDefine("ReceiveShadows","RECEIVE_SHADOWS");d=new e("terrainNormal",["vsTerrainNormal","fsNormal"],null,a,d,b,N);d.addDefine("Spherical","SPHERICAL");d.addDefine("AlphaZero","ALPHA_ZERO");L={depth:a.get("depth"),depthShadowMap:a.get("depthShadowMap"),depthOnly:new C(N,b.vsTerrainDepthOnly,b.fsTerrainDepthOnly,y.Default3D),blendLayers:new C(N,b.vertexShaderBlendLayers,b.fragmentShaderBlendLayers,y.Default3D)};V={color:g,normal:d};this._updatePrograms();ua=new r(N,{target:Q.TEXTURE_2D,pixelFormat:Q.RGBA,
dataType:Q.UNSIGNED_BYTE,samplingMode:Q.NEAREST,width:4,height:4})};this.uninitializeRenderContext=function(a){null!=qa&&(qa.dispose(!0),qa=null);null!=ua&&(ua.dispose(),ua=null);null!=ta&&(ta.dispose(),ta=null);null!=na&&(na.dispose(),na=null)};this._updatePrograms=function(){var a="spherical"===d,b="shader"===ga.mode;L.color=V.color.getProgram([a,!0,a&&Aa,b,ja,b||ja,this.receiveShadows]);L.normal=V.normal.getProgram([a,!0])};this.install=function(a){a.addExternalRenderer([G,I],this)};this.uninstall=
function(a){a.removeExternalRenderer(this)};this.setRootTiles=function(a){M=a};this.isStencilEnabledLayerExtent=function(a){return sa.some(function(b){return a===b.id})};this.addStencilEnabledLayerExtent=function(a,b){sa.push({id:a,extent:[b[0],b[1],b[3],b[4]]})};this.removeStencilEnabledLayerExtent=function(a){for(var b=0;b<sa.length;b++)if(a===sa[b].id){sa.splice(b,1);break}};this.setTileSize=function(a){m=a};this.loadTile=function(a){z(null===a.renderData);a.renderData=P.acquire();a.renderData.init();
var b=this.getLocalOriginOfTile(a),c=a.createGeometry(a.renderData.updateGeometryState(a),b,"debug"===ga.mode,a.renderData.geometryInfo);a.renderData.localOrigin=b;this._setTileGeometry(a,c);this.updateTileTexture(a)};this.queryVisibleLevelRange=function(a,b,c,d){var e=Ga.acquire();D.set(a,e.extent);e.minLevel=b?b:-Number.MAX_VALUE;e.maxLevel=null!=c?c:Number.MAX_VALUE;e.callback=d;za.push(e);this.setNeedsRender()};this._buildTexture=function(a){var b={target:Q.TEXTURE_2D,pixelFormat:Q.RGBA,dataType:Q.UNSIGNED_BYTE,
wrapMode:Q.CLAMP_TO_EDGE,samplingMode:Q.LINEAR,maxAnisotropy:ia,flipped:!0,hasMipmap:!0},c;if(a)try{c=new r(N,b,a)}catch(d){b.width=b.height=m,c=new r(N,b),console.warn("TerrainRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}else b.width=b.height=m,c=new r(N,b);N.bindTexture(c);c.generateMipmap();return c};this._composeTexture=function(a,b,c){N.bindTexture(a,0);L.blendLayers.setUniform1f("scale",b);L.blendLayers.setUniform2fv("offset",c);N.bindVAO(qa);N.drawArrays(Q.TRIANGLE_STRIP,
0,B.vertexCount(qa,"geometry"))};this._composeMapLayers=function(a,b,c,d,e){var g=f.LayerClass.MAP;a.renderData.texture||(a.renderData.texture=this._buildTexture());var h=a.renderData.texture;null===na||na.width!==h.descriptor.width||na.height!==h.descriptor.height?na=t.createWithAttachments(N,h,{colorTarget:0,depthStencilTarget:0}):(na.detachColorTexture(),na.attachColorTexture(h));N.bindFramebuffer(na);N.setViewport(0,0,m,m);N.setClearColor(0,0,0,0);N.clear(Q.COLOR_BUFFER_BIT);N.setBlendingEnabled(!0);
N.setBlendFunctionSeparate(Q.ONE_MINUS_DST_ALPHA,Q.DST_ALPHA,Q.ONE_MINUS_DST_ALPHA,Q.ONE);N.bindProgram(L.blendLayers);L.blendLayers.setUniform1i("tex",0);N.bindVAO(qa);B.assertCompatibleVertexAttributeLocations(qa,L.blendLayers);for(h=0;h<=c;h++){var l=b[h],p=null,s,k;l.data?(p=l,s=O,k=1):l.upsampleFromTile&&(k=l.upsampleFromTile,p=k.tile.layerInfo[g][h],s=k.offset,k=k.scale);p&&(p.data instanceof Image&&(p.data=this._buildTexture(p.data)),L.blendLayers.setUniform1f("opacity",e[h]),this._composeTexture(p.data,
k,s))}d&&this._composeTexture(ta,1,O);N.bindTexture(a.renderData.texture);a.renderData.texture.generateMipmap();N.bindFramebuffer(null);N.setBlendFunctionSeparate(Q.SRC_ALPHA,Q.ONE_MINUS_SRC_ALPHA,Q.ONE,Q.ONE_MINUS_SRC_ALPHA);N.setBlendingEnabled(!1);this.numTileTexturesComposited++};var Ha=Array(20);this.updateTileTexture=function(a){for(var b=a.layerInfo[f.LayerClass.MAP],c=0;c<b.length;c++)b[c].pendingUpdates&=~f.TileUpdateTypes.UPDATE_TEXTURE;if(a.renderData){var d,e=f.LayerClass.MAP,c=a.renderData,
g,h=0;for(g=0;g<b.length;g++){d=b[g];var l=a.parentSurface.layerViewByIndex(g,e),m=l.fullOpacity;Ha[g]=m;if(d.data||d.upsampleFromTile)if(h++,!l.isTransparent()&&1<=m)break}d=!1;g===b.length&&(d=!0,g--);0===h?(c.textureReference=ta,A.set2(0,0,c.texOffset),c.texScale=1):1===h&&!d?(d=b[g],d.data?(b=d,A.set2(0,0,c.texOffset),c.texScale=1):(a=d.upsampleFromTile,b=a.tile.layerInfo[e][g],A.set(a.offset,c.texOffset),c.texScale=a.scale),b&&(b.data instanceof Image&&(b.data=this._buildTexture(b.data)),c.textureReference=
b.data)):(this._composeMapLayers(a,b,g,d,Ha),c.textureReference=null,A.set2(0,0,c.texOffset),c.texScale=1);this.setNeedsRender()}};this.releaseTileTexture=function(a){a.dispose()};this.releaseTileTextures=function(a){a=a.layerInfo[f.LayerClass.MAP];for(var b=0;b<a.length;b++){var c=a[b];c&&c.data instanceof window.WebGLTexture&&c.data.dispose()}};this.updateTileGeometryNeedsUpdate=function(a){return a.renderData.updateGeometryState(a).needsUpdate};this._updateTileGeometry=function(a){for(var b=a.renderData.geometryState,
c=a.layerInfo[f.LayerClass.ELEVATION],d=0;d<c.length;d++)c[d].pendingUpdates&=~f.TileUpdateTypes.UPDATE_GEOMETRY;return b.needsUpdate?(a.renderData.vao&&this._releaseTileGeometry(a),b=a.createGeometry(b,a.renderData.localOrigin,"debug"===ga.mode,a.renderData.geometryInfo),this._setTileGeometry(a,b),!0):!1};this.updateTileGeometry=function(a){a.renderData.updateGeometryState(a);return this._updateTileGeometry(a)};this.unloadTile=function(a){this._releaseTileGeometry(a);a.renderData.texture&&a.renderData.texture.dispose();
P.release(a.renderData);a.renderData=null};this.getLocalOriginOfTile=function(a){if(10<=a.lij[0]){for(;7<a.lij[0];)a=a.parent;return a.centerAtSeaLevel}if("spherical"===d)return J;for(;a.parent;)a=a.parent;return a.centerAtSeaLevel};this.setVisibility=function(a){ha=a;this.setNeedsRender()};this.getStats=function(){return{numTilesRendered:wa,numTilesCulled:Ba,numTrianglesRendered:ya,numOriginsRendered:Ca}};this.setDisableRendering=function(a){oa=!!a;this.setNeedsRender()};this.getOpacity=function(){return ma};
this.getWireframeEnabled=function(){return"shader"===ga.mode};this.setWireframe=function(a){if(!a||!0===a)a={mode:a?"shader":"none"};if(void 0!==a.mode&&ga.mode!==a.mode){var b="debug"===ga.mode,c="debug"===a.mode;ga.mode=a.mode;this._updatePrograms();b!==c&&M&&k.traverseTilesPreorder(M,function(a){if(a.renderData){a.renderData.vao&&this._releaseTileGeometry(a);var b=a.createGeometry(a.renderData.updateGeometryState(a),a.renderData.localOrigin,c,a.renderData.geometryInfo);this._setTileGeometry(a,
b)}}.bind(this));this.setNeedsRender()}for(var d in a)ga.hasOwnProperty(d)&&(ga[d]=a[d]),this.setNeedsRender()};this.setOpacity=function(a){ma=a;this.setNeedsRender()};this.setDrawSkirts=function(a){ka=a;this.setNeedsRender()};this.setCullBackFaces=function(a){la=a;this.setNeedsRender()};this.setRenderOrder=function(a){W=a;this.setNeedsRender()};this.setBorders=function(a){ja!==a&&(ja=a,"none"===ga.mode&&(ga.transitionTime=0),this._updatePrograms(),this.setNeedsRender())};this.setFrontMostTransparent=
function(a){ra!==a&&(ra=a,this.setNeedsRender())};this.setVelvetOverground=function(a){Aa!==a&&(Aa=a,this._updatePrograms(),this.setNeedsRender())};this.setNeedsRender=function(){this.needsRender=!0;this.didRender=!1};this.resetNeedsRender=function(){this.didRender&&(this.needsRender=0!==za.length,this.didRender=!1)};var Da=w.create();this.isTransparent=function(){return 1>ma||"shader"===ga.mode&&(1>ga.wireOpacity||1>ga.surfaceOpacity)||!Ea};this.render=function(a){if(Z&&!oa&&ha&&M){var b=this.isTransparent();
if(a.slot===(b?I:G)){s.trace("# BEGIN RENDER TERRAIN");X.clear();Y=null;this._renderCollectOrigins();if(0!==W){for(var c=0;c<X.length;c++)this._sortFrontToBack(X.data[c].tiles,p);this._sortFrontToBack(X,ba)}var d,e=!1,h=!1;d=a.pass;var f=a.camera;N.setBlendFunctionSeparate(Q.SRC_ALPHA,Q.ONE_MINUS_SRC_ALPHA,Q.ONE,Q.ONE_MINUS_SRC_ALPHA);N.setFaceCullingEnabled(la);if(d===l.MATERIAL){if(h=b,e=a.shadowMap&&a.shadowMap.getEnableState(),this.receiveShadows!=e&&(this.receiveShadows=e,this._updatePrograms()),
b&&ra&&(e=L.depthOnly,N.bindProgram(e),N.setColorMask(!1,!1,!1,!1),N.setDepthTestEnabled(!0),this._renderTilesDepthOnly(f,N,e),N.setColorMask(!0,!0,!0,!0),N.setDepthFunction(Q.EQUAL),N.setDepthWriteEnabled(!1)),d=L.color,e=!0,N.bindProgram(d),d.setUniform1f("opacity",ma),N.setBlendingEnabled(h),"shader"===ga.mode||ja)d.setUniform1f("wireframe.width",ga.width),d.setUniform1f("wireframe.falloff",Math.min(ga.width,ga.falloff)),d.setUniform1f("wireframe.wireOpacity",ga.wireOpacity*ma),d.setUniform1f("wireframe.surfaceOpacity",
ga.surfaceOpacity*ma),d.setUniform4fv("wireframe.color",ga.color),d.setUniform1f("wireframe.near",f.near),d.setUniform1f("wireframe.far",f.far),"geometry"!==ga.subdivision&&"constant"!==ga.subdivision&&d.setUniform1f("wireframe.subdivision",aa(ga.subdivision))}else if(d===l.MATERIAL_DEPTH_SHADOWMAP&&this.castShadows||d===l.MATERIAL_DEPTH)d=d===l.MATERIAL_DEPTH_SHADOWMAP?L.depthShadowMap:L.depth,N.bindProgram(d),d.setUniformMatrix4fv("model",E),K[0]=f.near,K[1]=f.far,d.setUniform2fv("nearFar",K);else if(d===
l.MATERIAL_NORMAL)d=L.normal,N.bindProgram(d);else return;a.shadowMap&&a.shadowMap.bind(d);a.ssaoHelper&&a.ssaoHelper.setUniforms(d);e&&(d.setUniform1i("tex",4),d.setUniform1i("overlayTex",5));d.setUniformMatrix4fv("viewNormal",f.viewInverseTransposeMatrix);d.setUniformMatrix4fv("proj",f.projectionMatrix);d.setUniform3fv("lightDirection",a.lightingData.direction);f=f.viewMatrix;w.set3(f[12],f[13],f[14],Da);w.normalize(Da);d.setUniform3fv("viewDirection",Da);for(Ca=ya=Ba=wa=0;pa.length<pa.data.length&&
0<za.length;)c=za.pop(),pa.push(c);xa=pa.length;for(c=0;c<X.length;c++){var m=X.data[c];d.setUniform3fv("origin",m.origin);g.bindView(m.origin,f,d);a.shadowMap&&a.shadowMap.bindView(d,m.origin);Ca++;this._renderTiles(m.tiles,d,e,a)}h&&N.setBlendingEnabled(!1);b&&ra&&(N.setDepthFunction(Q.LESS),N.setDepthWriteEnabled(!0));la&&N.setFaceCullingEnabled(!1);a.stencilRenderingHelper&&a.stencilRenderingHelper.getEnableState()&&a.stencilRenderingHelper.prepareStencilDisabledPass();for(a=0;a<pa.length;a++)b=
pa.data[a],Ga.release(b),b.callback(a>=xa),b.callback=null;pa.clear();0<wa&&!Fa&&(Fa=!0,this.loaded&&this.loaded());s.trace("# END RENDER TERRAIN");return!0}}};this._renderCollectOrigins=function(){for(var a=0;a<M.length;a++){var b=M[a],c=X.next();c.root=b;c.origin="spherical"===d?J:b.centerAtSeaLevel;c.tiles.clear();this._renderCollectOriginsForRoot(c)}};this._renderCollectOriginsForRoot=function(a){for(ca.reset(a.root);!ca.done;){var b=ca.next(),c=b.renderData;if(c&&!b.visible)Ba++,ca.skip();else{var d=
X.peek();if(7===b.lij[0]){if(d===a||0!==d.tiles.length)d=X.next(),d.tiles.clear();d.root=b;d.origin=b.centerAtSeaLevel}if(c){c=b.lij[0];10<=c?X.peek().tiles.push(b):a.tiles.push(b);if(null===Y||Y.lij[0]<c)Y=b;ca.skip()}}}};this._sortFrontToBack=function(a,b){a.sort(b)};this._renderTilesDepthOnly=function(a,b,c){var d=a.viewMatrix;c.setUniformMatrix4fv("proj",a.projectionMatrix);for(a=0;a<X.length;a++){var e=X.data[a];c.setUniform3fv("origin",e.origin);g.bindView(e.origin,d,c);for(var h=0;h<e.tiles.length;h++){var f=
e.tiles.data[h].renderData;b.bindVAO(f.vao);B.assertCompatibleVertexAttributeLocations(f.vao,c);var l=f.vao.indexBuffer.size;ka||(l=f.geometryInfo.numWithoutSkirtIndices);b.drawElements(Q.TRIANGLES,l,f.vao.indexBuffer.indexType,0)}}b.bindVAO(null)};this._renderTiles=function(a,b,c,d){if(0!==a.length){var e=Q.TRIANGLES;"debug"===ga.mode&&(e=Q.LINES);var g="geometry"===ga.subdivision,h="constant"===ga.subdivision,f=Y,l,m=!1;f?(l=f.lij[0],f=aa(f.renderData.geometryInfo.numVertsPerRow)):f=l=16;N.setDepthTestEnabled(!0);
N.setBlendingEnabled(this.isTransparent());for(var p=0;p<a.length;p++){var k=a.data[p],r=k.renderData;if(d.stencilRenderingHelper&&d.stencilRenderingHelper.getEnableState()){for(var t=!1,w=0;w<sa.length;w++)if(k.intersectsExtent(sa[w].extent)){t=!0;break}t&&!m?(d.stencilRenderingHelper.prepareStencilReadPass(),m=!0):!t&&m&&(d.stencilRenderingHelper.prepareStencilDisabledPass(),m=!1)}s.trace("# RENDER TILE "+k.lij[0]+"/"+k.lij[1]+"/"+k.lij[2]+", screenDepth:"+k.screenDepth);if(c){b.setUniform2fv("texOffset",
r.texOffset);b.setUniform1f("texScale",r.texScale);N.bindTexture(r.textureReference||r.texture,4);if(r.overlayTexId){var t=b,w=r,u=w.overlayTexId,v=U[u];v||(v=$.aquire(u).getGLTexture(),z(v),U[u]=v);t.setUniform2fv("overlayTexOffset",w.overlayTexOffset);t.setUniform2fv("overlayTexScale",w.overlayTexScale);t.setUniform1f("overlayOpacity",w.overlayOpacity);N.bindTexture(v,5)}else b.setUniform2fv("overlayTexOffset",H),N.bindTexture(ua,5);if(("shader"===ga.mode||ja)&&(g||h))g?b.setUniform1f("wireframe.subdivision",
aa(r.geometryInfo.numVertsPerRow)):(t=aa(f,k.lij[0]-l),b.setUniform1f("wireframe.subdivision",t))}t=r.vao.indexBuffer.size;ka||(t=r.geometryInfo.numWithoutSkirtIndices);N.bindVAO(r.vao);B.assertCompatibleVertexAttributeLocations(r.vao,b);N.drawElements(e,t,r.vao.indexBuffer.indexType,0);k.renderOrder=wa;wa++;ya+=t/3;r=k.extent;k=k.lij[0];for(t=0;t<xa;)w=pa.data[t],u=w.extent,k>=w.minLevel&&k<=w.maxLevel&&u[0]<=r[2]&&u[2]>=r[0]&&u[1]<=r[3]&&u[3]>=r[1]?(pa.swap(t,xa-1),xa--):t++}N.bindVAO(null)}};var Ka=
w.create(),Ia=w.create(),Ja=w.create();this.intersect=function(a,b,c,d){if(M&&!("select"===a.mode&&this.isTransparent())){w.subtract(c,b,Ka);var e=a.getMinResult(),h=a.getMaxResult();for(ca.reset(M);!ca.done;){var f=ca.next();if(null!==f.renderData){var l=f.renderData.geometryInfo.geometry,m=f.renderData.localOrigin;w.subtract(b,m,Ia);w.subtract(c,m,Ja);g.intersectTriangleGeometry(l,0,void 0,d,b,c,Ia,Ja,void 0,a.tolerance,function(a,b){if(0<=a){var c;if(void 0===e.dist||a<e.dist)c=k.lij2str(f.lij[0],
f.lij[1],f.lij[2]),e.set(void 0,c,a,b,void 0),e.setIntersector("terrain");if(void 0===h.dist||a>h.dist)c=k.lij2str(f.lij[0],f.lij[1],f.lij[2]),h.set(void 0,c,a,b,void 0),h.setIntersector("terrain")}})}}}};this._setTileGeometry=function(a,b){var d=a.renderData,e=b.geometry.getData(),g=e.getVertexAttr().terrain.data,e=e.getFaces()[0].indices.terrain;d.vao=new u(N,y.Default3D,{geometry:x.Pos3Tex},{geometry:v.createVertex(N,Q.STATIC_DRAW,g)},v.createIndex(N,Q.STATIC_DRAW,e));d.geometryInfo.geometry&&
c.releaseGeometry(d.geometryInfo.geometry);d.geometryInfo=b;this.setNeedsRender()};this._releaseTileGeometry=function(a){a=a.renderData;a.vao.dispose(!0);a.vao=null;a.geometryInfo.geometry&&c.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo.geometry=null;this.setNeedsRender()}};d.TileRenderData=T;return d})},"esri/views/3d/terrain/TileUtils":function(){define(["./UpsampleInfo","../support/PreallocArray"],function(q,n){function k(a){this.q=new n(a||100);this._last=null;this.done=!0}function f(a){this.q=
new n(a||100);this.done=!0}var c=12756274*Math.PI;k.prototype.reset=function(a){this.q.clear();a&&this.q.pushEither(a);this._last=null;this.done=0===this.q.length};k.prototype.skip=function(){this._last=null;0===this.q.length&&(this.done=!0)};k.prototype.next=function(){if(this.done)return null;if(null!==this._last){var a=this._last.children;if(a[0])for(var b=4;0<=b;b--){var c=a[b];c&&this.q.push(c)}this._last=null}this._last=this.q.pop();0===this.q.length&&!this._last.children[0]&&(this.done=!0);
return this._last};f.prototype.reset=function(a){this.q.clear();this.q.pushEither(a);for(a=0;a<this.q.length;)for(var b=this.q.data[a++],c=0;4>c;c++){var g=b.children[c];g&&this.q.push(g)}this.done=0===this.q.length};f.prototype.next=function(){var a=this.q.pop();this.done=0===this.q.length;return a};var b={li2lat:function(a,b){return 2*Math.atan(Math.exp(-Math.PI+2*Math.PI*b/(1<<a)))-0.5*Math.PI},lj2lon:function(a,b){return-Math.PI+2*Math.PI*b/(1<<a)},lij2webMerc:function(a,b,h){return[-0.5*c+c*
h/(1<<a),-0.5*c+c*b/(1<<a)]},lij2str:function(a,b,c){return a+"/"+b+"/"+c},tile2str:function(a){return a.lij[0]+"/"+a.lij[1]+"/"+a.lij[2]},latLon2WebMercator:function(a,b,c){1.570796<a?a=1.570796:-1.570796>a&&(a=-1.570796);c[0]=6378137*b;c[1]=3189068.5*Math.log((1+Math.sin(a))/(1-Math.sin(a)))},traverseTilesPreorder:function(a,c,h,g){if(Array.isArray(a))for(var d=0;d<a.length;d++)b._traverseTilesPreorder(a[d],c,h,g);else b._traverseTilesPreorder(a,c,h,g)},_traverseTilesPreorder:function(a,c,h,g){g=
c.call(h,a,g);for(var d=0;4>d;d++){var f=a.children[d];f&&b.traverseTilesPreorder(f,c,h,g)}},traverseTilesPostorder:function(a,c,h){if(Array.isArray(a))for(var g=0;g<a.length;g++)b._traverseTilesPostorder(a[g],c,h);else b._traverseTilesPostorder(a,c,h)},_traverseTilesPostorder:function(a,c,h){for(var g=0;4>g;g++){var d=a.children[g];d&&b.traverseTilesPostorder(d,c,h)}c.call(h,a)},IteratorPreorder:k,IteratorPostorder:f,fallsWithinLayer:function(a,b,c){var g=b.layer;if(!b.hasGlobalExtent){b=g.fullExtent;
var d=a.extent;if(c){if(d[0]<b.xmin||d[1]<b.ymin||d[2]>b.xmax||d[3]>b.ymax)return!1}else if(b.xmin>d[2]||b.ymin>d[3]||b.xmax<d[0]||b.ymax<d[1])return!1}a=a.parentSurface.tilingScheme.levels[a.lij[0]].scale;return 0<g.minScale&&a>1.00000001*g.minScale?!1:a>=0.99999999*g.maxScale},isPosWithinTile:function(a,b){var c=a.extent;return b[0]>=c[0]&&b[1]>=c[1]&&b[0]<=c[2]&&b[1]<=c[3]},getTileNLevelsUp:function(a,b){for(;0<b;)a=a.parent,b--;return a},nextTileInAncestry:function(a,b){var c=a.lij[0]-b.lij[0]-
1,g=a.lij[2]>>c,d=0;a.lij[1]>>c&1&&(d+=2);g&1&&(d+=1);return b.children[d]},computeUpsampleInfoForAncestor:function(a,b){for(var c=1,g=0,d=0;a!==b;)if(c*=0.5,g*=0.5,d*=0.5,a.lij[2]&1&&(g+=0.5),0===(a.lij[1]&1)&&(d+=0.5),a=a.parent,null==a)throw Error("tile was not a descendant of ancestorTile");var f=q.Pool.acquire();f.init(b,g,d,c);return f}};return b})},"esri/views/3d/terrain/UpsampleInfo":function(){define(["../support/ObjectPool","../lib/glMatrix"],function(q,n){function k(c,b,a,e){this.offset=
f.create();this.scale=0;this.tile=null;void 0!==c&&this.init(c,b,a,e)}var f=n.vec2d;k.prototype.init=function(c,b,a,e){this.tile=c;this.offset[0]=b;this.offset[1]=a;this.scale=e};k.Pool=new q(400,k);return k})},"esri/views/3d/support/ObjectPool":function(){define(["../../../core/declare","./PreallocArray"],function(q,n){var k=q([],{constructor:function(f,c){this.freelist=new n(f);this.cls=c;this.initialSize=f},_allocate:function(){return new this.cls},acquire:function(){if(0===this.freelist.length)for(var f=
Math.max(1,this.initialSize/2),c=0;c<f;c++)this.freelist.push(new this.cls);return this.freelist.pop()},release:function(f){this.freelist.push(f)}});k.on=function(f,c){f._pool=null;Object.defineProperty(f,"Pool",{get:function(){this._pool||(this._pool=new k(c,f));return this._pool}})};return k})},"esri/views/3d/terrain/TerrainConst":function(){define(["./TilingScheme","../support/aaBoundingRect"],function(q,n){var k={LayerClass:{MAP:0,ELEVATION:1,LAYER_CLASS_COUNT:2},TileUpdateTypes:{NONE:0,SPLIT:1,
VSPLITMERGE:2,MERGE:4,DECODE_LERC:8,UPDATE_GEOMETRY:16,UPDATE_TEXTURE:32},TILE_LOADING_DEBUGLOG:!1,MAX_ROOT_TILES:64,MAX_TILE_TESSELATION:512,ELEVATION_NODATA_VALUE:3.40282347E38/10,ELEVATION_DESIRED_RESOLUTION_LEVEL:4,TILEMAP_SIZE_EXP:5};k.TILEMAP_SIZE=1<<k.TILEMAP_SIZE_EXP;k.WEBMERCATOR_WORLD_EXTENT=n.create([0,0,0,0]);q.WebMercatorAuxiliarySphere.getExtent(0,0,0,k.WEBMERCATOR_WORLD_EXTENT);k.GEOGRAPHIC_WORLD_EXTENT=n.create([-180,-90,180,90]);return k})},"esri/views/3d/terrain/TilingScheme":function(){define(["../../../geometry/SpatialReference",
"../../../geometry/support/scaleUtils","../support/projectionUtils","../support/mathUtils"],function(q,n,k,f){function c(a,b){var c=Error(b);c.name=a;return c}var b=k.webMercator.x2lon,a=k.webMercator.y2lat,e=[0,0,0,0],h=function(a){var b=h._checkUnsupported(a);if(b)throw b;this.spatialReference=a.spatialReference;this._isWebMercator=this.spatialReference.isWebMercator;this._isWGS84=this.spatialReference.isWGS84;this.origin=[a.origin.x,a.origin.y];this.pixelSize=[a.size[0],a.size[1]];var c=a.lods.reduce(function(a,
b,c){b.level<a.min&&(a.min=b.level,a.minIndex=c);a.max=Math.max(a.max,b.level);return a},{min:Infinity,minIndex:0,max:-Infinity}),e=a.lods[c.minIndex],f=Math.pow(2,e.level),b=e.resolution*f,e=e.scale*f;this.levels=Array(c.max+1);for(c=0;c<this.levels.length;c++)this.levels[c]={resolution:b,scale:e,tileSize:[b*a.size[0],b*a.size[1]]},b/=2,e/=2};h.prototype={getExtent:function(c,d,e,h,p){h=h||Array(4);var k=this.levels[c];c=k.tileSize[0];k=k.tileSize[1];h[0]=this.origin[0]+e*c;h[2]=h[0]+c;h[3]=this.origin[1]-
d*k;h[1]=h[3]-k;p&&(this._isWebMercator?(p[0]=b(h[0]),p[1]=a(h[1]),p[2]=b(h[2]),p[3]=a(h[3])):this._isWGS84&&(p[0]=f.deg2rad(h[0]),p[1]=f.deg2rad(h[1]),p[2]=f.deg2rad(h[2]),p[3]=f.deg2rad(h[3])))},ensureMaxLod:function(a){for(;this.levels.length<=a;){var b=this.levels[this.levels.length-1],c=b.resolution/2;this.levels.push({resolution:c,scale:b.scale/2,tileSize:[c*this.pixelSize[0],c*this.pixelSize[1]]})}},capMaxLod:function(a){this.levels.length>a+1&&(this.levels.length=a+1)},getMaxLod:function(){return this.levels.length-
1},scaleAtLevel:function(a){return this.levels[0].scale/Math.pow(2,a)},levelAtScale:function(a){var b=this.levels[0].scale;return a>=b?0:Math.log(b/a)*Math.LOG2E},compatibleWith:function(a){if(!(a instanceof h)){if(h._checkUnsupported(a))return!1;a=new h(a)}if(!a.spatialReference.equals(this.spatialReference)||a.pixelSize[0]!==this.pixelSize[0]||a.pixelSize[1]!==this.pixelSize[1])return!1;var b=Math.min(this.levels.length,a.levels.length)-1,c=this.levels[b].resolution,e=f.floatEqualAbsolute,p=0.5*
c;if(!e(a.origin[0],this.origin[0],p)||!e(a.origin[1],this.origin[1],p))return!1;var p=Math.max(this.pixelSize[0],this.pixelSize[1]),k=Math.pow(2,b);return e(c,a.levels[b].resolution,12*(0.5*c/k/p))},rootTilesInExtent:function(a,b,c){var f=this.levels[0].tileSize;h.computeRowColExtent(a,f,this.origin,e);a=e[1];var p=e[3],k=e[0],r=e[2],t=r-k,u=p-a;t*u>c&&(c=Math.floor(Math.sqrt(c)),u>c&&(a=a+Math.floor(0.5*u)-Math.floor(0.5*c),p=a+c),t>c&&(k=k+Math.floor(0.5*t)-Math.floor(0.5*c),r=k+c));c=Array((r-
k)*(p-a));t=0;for(u=a;u<p;u++)for(var v=k;v<r;v++)c[t++]=[0,u,v];b&&(b[0]=this.origin[0]+k*f[0],b[1]=this.origin[1]-p*f[1],b[2]=this.origin[0]+r*f[0],b[3]=this.origin[1]-a*f[1]);return c}};h.computeRowColExtent=function(a,b,c,e){var h=0.0010*(a[2]-a[0]+(a[3]-a[1]));e[0]=Math.floor((a[0]+h-c[0])/b[0]);e[2]=Math.ceil((a[2]-h-c[0])/b[0]);e[1]=Math.floor((c[1]-a[3]+h)/b[1]);e[3]=Math.ceil((c[1]-a[1]-h)/b[1])};h.isPowerOfTwo=function(a){a=a.lods;var b=a[0].resolution*Math.pow(2,a[0].level);return!a.some(function(a){return!f.floatEqualRelative(a.resolution,
b/Math.pow(2,a.level))})};h.hasGapInLevels=function(a){a=a.lods.map(function(a){return a.level});a.sort(function(a,b){return a-b});for(var b=1;b<a.length;b++)if(a[b]!==a[0]+b)return!0;return!1};h.tileSizeSupported=function(a){var b=a.size[1];return b===a.size[0]&&0===(b&b-1)&&128<=b&&512>=b};h._checkUnsupported=function(a){return!a?c("tilingscheme:tile-info-missing","Tiling scheme must have tiling information"):1>a.lods.length?c("tilingscheme:generic","Tiling scheme must have at least one level"):
!h.isPowerOfTwo(a)?c("tilingscheme:power-of-two","Tiling scheme must be power of two"):null};h.checkUnsupported=function(a){var b=h._checkUnsupported(a);return b?b:h.hasGapInLevels(a)?c("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):!h.tileSizeSupported(a)?c("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):null};h.fromExtent=function(a,b){var c=a[2]-a[0],e=a[3]-a[1],f=n.getUnitValueForSR(b),k=1.2*Math.max(c,e),c=new h({size:[256,
256],origin:{x:a[0]-0.5*(k-c),y:a[3]+0.5*(k-e)},lods:[{level:0,resolution:k/256,scale:1/(0.0254*(256/96)/(k*f))}],spatialReference:b});c.ensureMaxLod(20);return c};h.WebMercatorAuxiliarySphereTileInfo={size:[256,256],origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:q.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:5.91657527591555E8}]};h.makeWebMercatorAuxiliarySphere=function(a){a=a||19;var b=new h(h.WebMercatorAuxiliarySphereTileInfo);b.ensureMaxLod(a);return b};
h.WebMercatorAuxiliarySphere=h.makeWebMercatorAuxiliarySphere(19);h.makeWGS84WithTileSize=function(a,b){b=b||16;var c=256/a,c=new h({size:[a,a],origin:{x:-180,y:90},spatialReference:q.WGS84,lods:[{level:0,resolution:0.703125*c,scale:2.95497598570834E8*c}]});c.ensureMaxLod(b);return c};return h})},"esri/views/3d/terrain/TileGeometryFactory":function(){define("../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../lib/glMatrix ../support/earthUtils ../support/mathUtils ./TerrainConst".split(" "),
function(q,n,k,f,c,b){function a(a,b,c,d,e){a<d[0]&&(d[0]=a);a>e[0]&&(e[0]=a);b<d[1]&&(d[1]=b);b>e[1]&&(e[1]=b);c<d[2]&&(d[2]=c);c>e[2]&&(e[2]=c)}function e(a,d,e){for(var g=0;g<e.length;g++){var h=e[g];if(h){var f=h.safeWidth,l=h.width,m=h.pixelData,p=c.clamp(h.dy*(h.y1-d),0,f),h=c.clamp(h.dx*(a-h.x0),0,f),f=Math.floor(p),k=Math.floor(h),r=f*l+k,s=r+l,t=m[r],l=m[s],r=m[r+1],m=m[s+1];if(t+l+r+m<0.5*b.ELEVATION_NODATA_VALUE)return p-=f,h-=k,a=t+(r-t)*h,a+(l+(m-l)*h-a)*p}}return null}function h(a){l||
a*a+4*(a-1)>x&&(a=1<<Math.floor(c.log2(0.5*(-4+Math.sqrt(16+4*(4+x))))));return a}var g=f.earthRadius,d=k.vec3d,m=c.lerp,l=!1,p=function(){var a=d.create(),b=d.create(),c=d.create(),e,g,h;this.init=function(f,l){g=f;h=l;d.subtract(c,b,a);e=0.5*d.length(a);d.lerp(b,c,0.5,a)};this.getCenter=function(){return a};this.getBSRadius=function(){return e};this.getBBMin=function(){return b};this.getBBMax=function(){return c};this.getPosition=function(){return g};this.getIndices=function(){return h};this.getPrimitiveIndices=
function(){};this.getChildren=function(){}},s=function(a,b,c,d){a*=g;for(var e=0;e<=b;e++)c[5*d]=0,c[5*d+1]=0,c[5*d+2]=a,d++},r=new function(){var a=Array(50),b=0,c={};this.get=function(e){var g=c[e];g||(g={ptr:0,data:Array(50)},c[e]=g);0<g.ptr?(d.vertexArrayHits++,e=g.data[--g.ptr],g.data[g.ptr]=null):(d.vertexArrayMisses++,e=new Float32Array(e));if(0<b)return d.geometryHits++,g=a[--b],a[b]=null,g.getData().getVertexAttr().terrain.data=e,g;d.geometryMisses++;g={};g.terrain={size:5,data:e};e=new p;
return new q(new n([{type:"triangle",indices:{terrain:null},positionKey:"terrain"}],g),"tile",[e])};this.put=function(d){var e=d.getData(),g=e.getVertexAttr(),h=g.terrain.data,f=c[h.length];50>f.ptr&&(f.data[f.ptr++]=h);g.terrain.data=null;e.getFaces()[0].indices.terrain=null;50>b&&(a[b++]=d)};var d={geometryHits:0,geometryMisses:0,vertexArrayHits:0,vertexArrayMisses:0};this.stats=d;this._pools={geometry:a,vertexArray:c}},t=[],u=Array(b.MAX_TILE_TESSELATION+1),v=Array(b.MAX_TILE_TESSELATION+1),C=
Array(b.MAX_TILE_TESSELATION+1),y=Array(b.MAX_TILE_TESSELATION+1),x=65536,B={values:null,numSurfaceIndices:0,numSkirtIndices:0},z=function(a,b,c){c||(a.values=b.values);a.numSurfaceIndices=b.numSurfaceIndices;a.numSkirtIndices=b.numSkirtIndices;return a},A=function(a,b,c,d,e){var g;g=B;var h=c&2,f=b+(d?1024:0)+(h?2048:0),m=t[f];g||(g={});if(m)z(g,m);else{var m=b-1,p=b-1,k=b*b,r=2*m+2*p,s=6*m*p,u=6*r,v=6*(2*m+p-1);d&&(s*=2,u*=2,v*=2);for(var r=l&&k+r>x?new Uint32Array(s+u):new Uint16Array(s+u),y=0,
n=0,A=s,C,q,L,U,N=0,Q=0;Q<=p;Q++){h&&(N=0===Q?v:Q===p?-v:0);for(var A=A+N,P=0;P<=m;P++)U=q=-1,0===Q&&(q=k+P,P!==m&&(U=y+1)),P===m&&(q=k+m+Q,Q<p&&(U=y+m+1)),Q===p&&(q=k+m+p+(m-P),0<P&&(U=y-1)),0===P&&0<Q&&(q=k+2*m+p+(p-Q),U=y-(m+1)),-1<q&&(L=0===P&&1===Q?k:q+1,-1<U&&(C=y,d?(r[A+0]=C,r[A+1]=q,r[A+2]=q,r[A+3]=L,r[A+4]=L,r[A+5]=C,r[A+6]=L,r[A+7]=U,r[A+8]=U,r[A+9]=C,r[A+10]=C,r[A+11]=L,A+=12):(r[A+0]=C,r[A+1]=q,r[A+2]=L,r[A+3]=L,r[A+4]=U,r[A+5]=C,A+=6))),++y,P<m&&Q<p&&(C=Q*(m+1)+P,q=C+1,L=q+(m+1),U=L-
1,d?(r[n+0]=C,r[n+1]=q,r[n+2]=q,r[n+3]=L,r[n+4]=L,r[n+5]=C,r[n+6]=L,r[n+7]=U,r[n+8]=U,r[n+9]=C,r[n+10]=C,r[n+11]=L,n+=12):(r[n+0]=C,r[n+1]=q,r[n+2]=L,r[n+3]=L,r[n+4]=U,r[n+5]=C,n+=6));A-=N}g.values=r;g.numSurfaceIndices=s;g.numSkirtIndices=u;t[f]=z({},g)}h=a.getData();f=h.getVertexAttr();h.getFaces()[0].indices.terrain=g.values;a.getBoundingInfo(0).init(f.terrain,g.values);e||(e={});e.geometry=a;e.numWithoutSkirtIndices=g.numSurfaceIndices+(c?6*(b-1)*(d?2:1):0);e.numVertsPerRow=b;return z(e,g,!0)};
return{createPlanarGlobeTile:function(b,c,g,f,l,m,p){var k=c[0],s=c[1],t=c[2]-k;c=c[3]-s;var u=0.1*t;b=h(b);var v=b-1,x=b-1,n=b*b,y=r.get(5*(n+(2*v+2*x))),B=y.getData().getVertexAttr().terrain.data,z,C,q=0;z=y.getBoundingInfo(0);var V=z.getBBMin(),L=z.getBBMax();d.set3(1E7,1E7,1E7,V);d.set3(-1E7,-1E7,-1E7,L);for(C=0;C<=x;C++){var U=C/x,N=s+U*c;m&&(N<m[1]?(N=m[1],U=(N-s)/c):N>m[3]&&(N=m[3],U=(N-s)/c));for(z=0;z<=v;z++){var Q=z/v,P=k+Q*t;m&&(P<m[0]?(P=m[0],Q=(P-k)/t):P>m[2]&&(P=m[2],Q=(P-k)/t));var X=
g?e(P,N,g)||0:0,P=P-f[0],ca=N-f[1],X=X-f[2];a(P,ca,X,V,L);B[5*q]=P;B[5*q+1]=ca;B[5*q+2]=X;B[5*q+3]=Q;B[5*q+4]=U;var Y=-1;0===C&&(Y=n+z);z===v&&(Y=n+v+C);C===x&&(Y=n+v+x+(v-z));0===z&&0<C&&(Y=n+2*v+x+(x-C));-1<Y&&(B[5*Y]=P,B[5*Y+1]=ca,B[5*Y+2]=X-u,B[5*Y+3]=Q,B[5*Y+4]=U,a(P,ca-u,X,V,L));++q}}return A(y,b,0,l,p)},createSphericalGlobeTile:function(b,c,f,l,p,k,t,x,n){var B=f[0],z=f[1],q=f[2],da=f[3],S=Math.max(0.9,1-0.5*(q-B));b=h(b);f=b-1;var ba=b-1,aa=b*b,$=r.get(5*(aa+(2*f+2*ba))),Z=$.getData().getVertexAttr().terrain.data,
M=c[2]-c[0],V=c[3]-c[1],L=q-B,q=k[0],U=k[1];k=k[2];var N=$.getBoundingInfo(0),Q=N.getBBMin(),N=N.getBBMax();d.set3(1E7,1E7,1E7,Q);d.set3(-1E7,-1E7,-1E7,N);var P;for(P=0;P<=f;P++){var X=P/f,ca=B+X*L;u[P]=Math.sin(ca);v[P]=Math.cos(ca);C[P]=X;y[P]=c[0]+X*M}for(B=M=0;B<=ba;B++){L=B/ba;P=m(z,da,L);var ca=Math.cos(P),Y=Math.sin(P),fa;l?(fa=g/2*Math.log((1+Y)/(1-Y)),L=(fa-c[1])/V):fa=180*P/Math.PI;for(P=0;P<=f;P++){var X=C[P],ea=u[P],ia=v[P],ha=g;p&&(ha+=e(y[P],fa,p)||0);var ia=ia*ca*ha,ea=ea*ca*ha,ha=
Y*ha,ma=ia-q,ka=ea-U,ga=ha-k;a(ma,ka,ga,Q,N);var ja=5*M;Z[ja+0]=ma;Z[ja+1]=ka;Z[ja+2]=ga;Z[ja+3]=X;Z[ja+4]=L;ja=-1;0===B&&(ja=aa+P);P===f&&(ja=aa+f+B);B===ba&&(ja=aa+f+ba+(f-P));0===P&&0<B&&(ja=aa+2*f+ba+(ba-B));-1<ja&&(ia=ia*S-q,ea=ea*S-U,ha=ha*S-k,a(ia,ea,ha,Q,N),ja*=5,Z[ja+0]=ia,Z[ja+1]=ea,Z[ja+2]=ha,Z[ja+3]=X,Z[ja+4]=L);++M}}l&&(c=!!(t&2),t&1&&s(-1,f,Z,aa),c&&s(1,f,Z,aa+f+ba));return A($,b,l?t:0,x,n)},releaseGeometry:r.put,elevationSampler:e,_geometryObjectPool:r,supportedNumVertsPerRow:h,setSupportsUintIndices:function(a){l=
a}}})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define(["require","exports","./IdGen","./Util","./BoundingInfo"],function(q,n,k,f,c){return function(){function b(a,c,h){this.singleUse=!1;this.originalColors=null;this.id=b.__idGen.gen(c);this.data=a;this.boundingInfos=h||[];f.assert(1<=a.faces.length)}b.prototype.getId=function(){return this.id};b.prototype.getData=function(){return this.data};Object.defineProperty(b.prototype,"numGroups",{get:function(){return this.data.faces.length},
enumerable:!0,configurable:!0});b.prototype.getNumGroups=function(){return this.numGroups};b.prototype.calculateBoundingInfo=function(a,b){var h=this.data.faces[a],g="triangle"===h.type?3:1,d=h.indices[h.positionKey];if(0===d.length)for(var d=new Uint32Array(g),m=0;m<g;++m)d[m]=m;m=d.length;f.assert(0===m%g);for(var l=m/g,p=new Uint32Array(l),m=0;m<l;++m)p[m]=m;return new c(p,g,d,this.data.vertexAttributes[h.positionKey],b)};b.prototype.getBoundingInfo=function(a){var b=this.boundingInfos[a];null==
b&&(b=this.calculateBoundingInfo(a),this.boundingInfos[a]=b);return b};b.prototype.invalidateBoundingInfo=function(){this.boundingInfos=[]};b.__idGen=new k;return b}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["require","exports","./Util","./gl-matrix"],function(q,n,k,f){var c=f.vec3d;return function(){function b(a,b,h,g,d){k.assert(1<=a.length);k.assert(0===h.length%b);k.assert(h.length>=a.length*b);k.assert(3===g.size||4===g.size);this.primitiveIndices=a;this.indices=h;
this.position=g;this._numIndexPerPrimitive=b;this._faceRange=d;var f=g.data;g=g.size;var l=0,p=a.length;null!=d&&(l=d[0],p=d[1]+1);var s=g*h[b*a[l]];this.bbMin=c.createFrom(f[s],f[s+1],f[s+2]);this.bbMax=c.create(this.bbMin);for(d=l;d<p;++d)for(var r=b*a[d],t=0;t<b;++t)for(var s=g*h[r+t],u=0;3>u;++u){var v=f[s+u];v<this.bbMin[u]?this.bbMin[u]=v:v>this.bbMax[u]&&(this.bbMax[u]=v)}this.center=c.create();c.lerp(this.bbMin,this.bbMax,0.5,this.center);this.bsRadius=0;for(d=l;d<p;++d){r=b*a[d];for(t=0;t<
b;++t)s=g*h[r+t],l=f[s]-this.center[0],u=f[s+1]-this.center[1],s=f[s+2]-this.center[2],s=l*l+u*u+s*s,s>this.bsRadius&&(this.bsRadius=s)}this.bsRadius=Math.sqrt(this.bsRadius)}b.prototype.getCenter=function(){return this.center};b.prototype.getBSRadius=function(){return this.bsRadius};b.prototype.getBBMin=function(){return this.bbMin};b.prototype.getBBMax=function(){return this.bbMax};b.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};b.prototype.getIndices=function(){return this.indices};
b.prototype.getPosition=function(){return this.position};b.prototype.getChildren=function(){if(this.children)return this.children;if(1<c.dist2(this.bbMin,this.bbMax)){for(var a=c.lerp(this.bbMin,this.bbMax,0.5,c.create()),e=this.primitiveIndices.length,h=new Uint8Array(e),g=Array(8),d=0;8>d;++d)g[d]=0;for(var f=this.position.size,d=0;d<e;++d){for(var l=0,p=this._numIndexPerPrimitive*this.primitiveIndices[d],k=this.position.data,r=f*this.indices[p],t=k[r],u=k[r+1],v=k[r+2],n=1;n<this._numIndexPerPrimitive;++n){var r=
f*this.indices[p+n],y=k[r],x=k[r+1],r=k[r+2];y<t&&(t=y);x<u&&(u=x);r<v&&(v=r)}t<a[0]&&(l|=1);u<a[1]&&(l|=2);v<a[2]&&(l|=4);h[d]=l;++g[l]}for(d=l=0;8>d;++d)0<g[d]&&++l;if(2>l)return;a=Array(8);for(d=0;8>d;++d)a[d]=0<g[d]?new Uint32Array(g[d]):void 0;for(d=0;8>d;++d)g[d]=0;for(d=0;d<e;++d)l=h[d],a[l][g[l]++]=this.primitiveIndices[d];this.children=Array(8);for(d=0;8>d;++d)void 0!==a[d]&&(this.children[d]=new b(a[d],this._numIndexPerPrimitive,this.indices,this.position))}return this.children};return b}()})},
"esri/views/3d/terrain/OverlayManager":function(){define("../../../core/declare dojo/on ../support/mathUtils ../support/earthUtils ../support/projectionUtils ../support/aaBoundingRect ../lib/glMatrix ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),function(q,n,k,f,c,b,a,e,h,g){var d=a.vec2d,m=a.vec3d,l=a.vec4d,p=g.assert,s={width:0,height:0,pixelRatio:0,views:null},r=[{viewport:l.create(),extent:l.create()}],t=[r[0],{viewport:l.create(),extent:l.create()}],u=
l.create(),v=m.create(),C=[l.create(),l.create()];return q(null,{constructor:function(a,b){this._view=b;this._stage=b._stage;this._renderSR=this._overlaySR=null;this._overlaySREqualsRenderSR=!0;this.terrainSurface=a;this._renderer=this._stage.getTextureGraphicsRenderer();this._connectedLayers={};this._overlays=void 0;this._scale=0;this._dirty=!1},destroy:function(){for(var a in this._connectedLayers)this.unregisterLayerView(this._connectedLayers[a]);this._disposeOverlays()},hasOverlays:function(){return!!this._overlays},
setSpatialReference:function(a,b){(this._overlaySR=a)?(this._renderSR=this._view.renderSpatialReference,this._overlaySREqualsRenderSR=this._overlaySR.equals(this._renderSR),this._longitudeCyclical=(this._isSpherical=b)?a.isWebMercator?new k.Cyclical(-2.0037508342788905E7,2.0037508342788905E7):new k.Cyclical(-180,180):null):(this._disposeOverlays(),this._longitudeCyclical=null)},registerLayerView:function(a){var b=a.layer.uid;p(!this._connectedLayers[b],"layer already connected");var c=n(a,"draped-data-change",
function(){this.setOverlayDirty()}.bind(this));this._connectedLayers[b]={eventHandles:[c],layerView:a};if(a.setDrapingExtent&&this._overlays)for(b=0;b<this._overlays.length;b++)a.setDrapingExtent(b,this._overlays[b].extent,this._overlaySR,2048);this.setOverlayDirty()},unregisterLayerView:function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b];if(c.layerView===a){if(c.eventHandles)for(var d=0;d<c.eventHandles;d++)c.eventHandles[d].remove();delete this._connectedLayers[b];this.setOverlayDirty();
a.destroyed||(a._overlayUpdating=!1,a._evaluateUpdatingState())}}},setOverlayDirty:function(){this._dirty||(this._setOverlayUpdating(!0),this._dirty=!0)},_setOverlayUpdating:function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b].layerView;if(!a||!c.suspended&&c.hasDraped)c._overlayUpdating=a,c._evaluateUpdatingState()}if(b=this._view._graphicsView)b._overlayUpdating=a,b._evaluateUpdatingState()},updateOverlay:function(){if(this._overlaySR){var a=this._computeOverlayExtents();
if(a){this._overlays||this._initOverlays();for(var b=0;b<this._overlays.length;b++){var c;a:{c=a[b];for(var d=this._overlays[b].extent,e=1E-5*Math.max(c[2]-c[0],c[3]-c[1],d[2]-d[0],d[3]-d[1]),g=0;4>g;g++)if(Math.abs(d[g]-c[g])>e){c=!0;break a}c=!1}if(c){l.set(a[b],this._overlays[b].extent);for(var h in this._connectedLayers)c=this._connectedLayers[h].layerView,c.setDrapingExtent&&c.setDrapingExtent(b,a[b],this._overlaySR,2048)}}this._setOverlayUpdating(!1);this._drawOverlays();this.terrainSurface._updateTileOverlayParams();
this._dirty=!1}}},overlaysNeedUpdate:function(){return this._dirty&&this._overlaySR},updateOpacity:function(a){var b=1;if(this._overlays){var c=this._scale;a=this._view.renderCoordsHelper.getAltitude(a);3.5*a<c&&(b=Math.sqrt(k.clamp((a-c/10)/(c/3.5-c/10),0,1)))}return b},setOverlayParamsOfTile:function(a,b,c){a=a.extent;var e=-1;this._rectInsideRect(a,this._overlays[0].extent)?e=0:this._rectanglesOverlap(a,this._overlays[1].extent)&&(e=1);if(0<=e){var g=this._overlays[e].extent;b.overlayTexScale[0]=
(a[2]-a[0])/(g[2]-g[0]);b.overlayTexScale[1]=(a[3]-a[1])/(g[3]-g[1]);var h=a[0];if(this._longitudeCyclical){var h=this._longitudeCyclical.minimalMonotonic(g[0],h),f=this._longitudeCyclical.minimalMonotonic(g[0],a[2]);h>f&&(h=f-(a[2]-a[0]))}d.set2((h-g[0])/(g[2]-g[0]),(a[1]-g[1])/(g[3]-g[1]),b.overlayTexOffset);b.overlayTexId=this._overlays[e].texture.getId();b.overlayOpacity=void 0!==c?c:1}else b.overlayTexId=null},overlayPixelSizeInMapUnits:function(a){var b;this._overlays&&(this._overlays[0]&&this._pointIsInExtent(a,
this._overlays[0].extent)?b=this._overlays[0].extent:this._overlays[1]&&(b=this._overlays[1].extent));return b?(b[2]-b[0])/2048:0},_initOverlays:function(){this._overlays=Array(2);for(var a=0;2>a;a++){var b=new h(null,"overlay",{wrapClamp:!0,mipmap:!0});this._stage.add(e.ModelContentType.TEXTURE,b);this._overlays[a]={texture:b,extent:l.create()}}},_disposeOverlays:function(){if(this._overlays){var a=this._stage;this._overlays.forEach(function(b){a.remove(e.ModelContentType.TEXTURE,b.texture.getId())});
this._overlays=null}},_overlayExtentIncTable:[[0,-1,2,1],[0,-2,2,0],[-1,-2,1,0],[-2,-2,0,0],[-2,-1,0,1],[-2,0,0,2],[-1,0,1,2],[0,0,2,2]],_computeOverlayExtents:function(){var a=this._view.navigation.currentCamera,b=this.terrainSurface.extent,e=m.create();m.set(a.center,e);this._scale=this._view.renderCoordsHelper.getAltitude(a.eye);var g=c.vectorToPoint(e,this._renderSR,this.terrainSurface.spatialReference);(g=this.terrainSurface.getElevation(g))?this._view.renderCoordsHelper.setAltitude(g,e):this._view.navigation.getCenterIntersectManifold(a.eye,
a.center,e);var h=m.dist(a.eye,e),g=a.angleOfElevation;if(!isNaN(g)){this._overlaySREqualsRenderSR||c.vectorToVector(e,this._renderSR,e,this._overlaySR);var h=2*1024*a.perPixelRatio*h,p=!1,r=Infinity;this._isSpherical&&(this._overlaySR.isWebMercator?(h/=Math.cos(c.webMercator.y2lat(e[1])),r=this.terrainSurface.extent[3],r*=0.999):(p=!0,h/=f.metersPerDegree,r=90),h>=r&&(h=r,e[1]=0,this._overlaySR.isWebMercator&&(e[0]=0)));var s=1;p&&(s=1/Math.max(0.2,Math.cos(Math.abs(k.deg2rad(e[1])))),180<h*s&&(s=
180/h));var t=h*s,n=C[0];n[0]=e[0]-t;n[1]=e[1]-h;n[2]=e[0]+t;n[3]=e[1]+h;this._isSpherical&&this._shiftExtentToFitBounds(n,Infinity,r);p=C[1];l.set(n,p);6*t>b[2]-b[0]?l.set(b,p):g>0.25*Math.PI?(p[0]-=t,p[1]-=h,p[2]+=t,p[3]+=h):(c.vectorToVector(a.eye,this._renderSR,v,this._overlaySR),d.subtract(e,v,u),a=-Math.atan2(u[1],u[0])+0.125*Math.PI,0>a&&(a+=2*Math.PI),l.scale(this._overlayExtentIncTable[Math.floor(a/(0.25*Math.PI))],2*h,u),u[0]*=s,u[2]*=s,l.add(p,u,p));this._isSpherical&&(p[0]=this._longitudeCyclical.clamp(p[0]),
p[2]=this._longitudeCyclical.clamp(p[2]),p[1]=Math.max(p[1],-r),p[3]=Math.min(p[3],r));this.opacity=1;return C}},_drawOverlays:function(){for(var a=this._overlays[0].extent[2]-this._overlays[0].extent[0],b=this._stage.getTextureGraphicsRenderer(),c=0;c<this._overlays.length;c++){var d=this._overlays[c].extent,e=this._longitudeCyclical?d[2]>this._longitudeCyclical.max:!1,g=this._longitudeCyclical?d[0]<this._longitudeCyclical.min:!1;if(e||g){s.views=t;var g=Math.round(2048*((e?this._longitudeCyclical.max-
d[0]:this._longitudeCyclical.min-d[0])/(d[2]-d[0]))),h=s.views[0];l.set4(0,0,g,2048,h.viewport);l.set4(d[0],d[1],this._longitudeCyclical.max,d[3],h.extent);e||(h.extent[0]+=this._longitudeCyclical.range);h=s.views[1];l.set4(g,0,2048-g,2048,h.viewport);l.set4(this._longitudeCyclical.min,d[1],d[2],d[3],h.extent);e&&(h.extent[2]-=this._longitudeCyclical.range)}else s.views=r,l.set(d,s.views[0].extent),l.set4(0,0,2048,2048,s.views[0].viewport);s.width=2048;s.height=2048;s.pixelRatio=a/(d[2]-d[0]);b.draw(this._overlays[c].texture,
s)}},_rectanglesOverlap:function(a,b){return this._longitudeCyclical?(this._longitudeCyclical.contains(b[0],b[2],a[0])||this._longitudeCyclical.contains(b[0],b[2],a[2]))&&!(a[1]>b[3]||a[3]<b[1]):!(a[0]>b[2]||a[2]<b[0]||a[1]>b[3]||a[3]<b[1])},_rectInsideRect:function(a,b){return this._longitudeCyclical?this._longitudeCyclical.contains(b[0],b[2],a[0])&&this._longitudeCyclical.contains(b[0],b[2],a[2])&&a[1]>b[1]&&a[3]<b[3]:a[0]>b[0]&&a[2]<b[2]&&a[1]>b[1]&&a[3]<b[3]},_pointIsInExtent:function(a,b){if(this._longitudeCyclical)return this._longitudeCyclical.contains(b[0],
b[2],a.x)&&a.y>=b[1]&&a.y<=b[3];var c=a.x,d=a.y;return c>b[0]&&c<b[2]&&d>b[1]&&d<b[3]},_shiftExtentToFitBounds:function(a,c,d){var e=0,g=0;a[0]<-c?e=a[0]+c:a[2]>c&&(e=c-a[2]);a[1]<-d?g=a[1]+d:a[3]>d&&(g=d-a[3]);b.offset(a,e,g)}})})},"esri/views/3d/terrain/SurfaceExtentHelper":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/_base/lang ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l){q=function(a){function d(){a.apply(this,arguments)}k(d,a);Object.defineProperty(d.prototype,"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"spatialReference",{set:function(a){this.tilingScheme||this._set("spatialReference",a)},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"tilingScheme",{set:function(a){this._set("tilingScheme",a);this._set("spatialReference",a.spatialReference)},enumerable:!0,configurable:!0});d.prototype.normalizeCtorArgs=function(a){a=b.mixin({},a);this._layers=a.layers;delete a.layers;this._layerViews=a.layerViews;delete a.layerViews;return a};f([c.property({readOnly:!0})],d.prototype,"layerViewsExtent",null);f([c.property({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],d.prototype,
"tiledLayersExtent",null);f([c.property()],d.prototype,"spatialReference",null);f([c.property()],d.prototype,"tilingScheme",null);f([c.property()],d.prototype,"defaultTiledLayersExtent",void 0);return d=f([c.subclass()],d)}(c.declared(a));a=function(a){function b(){a.apply(this,arguments)}k(b,a);b.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()};b.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()};b.prototype._getGlobalExtent=function(){return this.spatialReference.isWebMercator?
l.WEBMERCATOR_WORLD_EXTENT:l.GEOGRAPHIC_WORLD_EXTENT};f([c.property({dependsOn:["spatialReference"]})],b.prototype,"layerViewsExtent",void 0);return b=f([c.subclass()],b)}(c.declared(q));n.SurfaceExtentHelperGlobal=a;q=function(a){function b(){a.call(this);this._changeListeners=new h}k(b,a);b.prototype.initialize=function(){this._changeListeners.add(this._layers.on("change",this.notifyChange.bind(this,"tiledLayersExtent")));this._changeListeners.add(this._layerViews.on("change",this.notifyChange.bind(this,
"layerViewsExtent")))};b.prototype.destroy=function(){this._changeListeners.destroy();this._changeListeners=null};b.prototype._computeLayerViewsExtent=function(){var a=d.create(d.NEGATIVE_INFINITY),b=this.spatialReference;this._layerViews.forEach(function(c){c.isResolved()&&((c=c.fullExtentInViewSpatialReference||c.layer.fullExtent)&&!c.spatialReference.equals(b)&&(c=g.canProject(c.spatialReference,b)?g.project(c,b):null),c&&d.expand(a,c))});var c=d.allFinite(a)?a:null,h=this._get("layerViewsExtent");
return e.equals(c,h)?h:c};b.prototype._computeTiledLayersExtent=function(){var a=this.tilingScheme;if(!a)return null;var b=this.spatialReference,c=d.create(d.NEGATIVE_INFINITY);this._layers.forEach(function(e){m.isTiledLayer(e)&&a.compatibleWith(e.tileInfo)&&(e.fullExtent&&e.fullExtent.spatialReference.equals(b))&&d.expand(c,e.fullExtent)});this.defaultTiledLayersExtent&&d.expand(c,this.defaultTiledLayersExtent);var g=d.allFinite(c)?c:null,h=this._get("tiledLayersExtent");return e.equals(g,h)?h:g};
return b=f([c.subclass()],b)}(c.declared(q));n.SurfaceExtentHelperLocal=q})},"esri/views/3d/terrain/terrainUtils":function(){define("require exports ./terrainUtilsPlanar ./terrainUtilsSpherical ../../../layers/TiledLayer ../../../support/basemapDefinitions".split(" "),function(q,n,k,f,c,b){function a(a){return"esri.views.3d.layers.TiledLayerView3D"===a.declaredClass}function e(a){return"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function h(){d={};for(var a in b)b[a].baseMapLayers.forEach(function(a){d[a.url]=
19});d["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}var g={planar:k,spherical:f};n.weakAssert=function(a,b){a||console.warn("Terrain: "+b)};n.autoUpdateSkirtsVisibility=function(a,b){g[a.manifold].autoUpdateSkirtsVisibility(a,b)};n.isTiledLayer=function(a){return a.isInstanceOf(c)};n.isTiledMapLayerView=a;n.isElevationLayerView=e;n.isTiledLayerView=function(b){return a(b)||e(b)};var d=null;n.getKnownTiledServiceLevelCap=function(a){d||h();a=a&&a.replace(/https?:/,
"");return a in d?d[a]:Infinity};n.prepareKnownTiledServiceLevelCaps=h;n.checkIfTileInfoSupportedForView=function(a,b,c,d){return g["local"===d||"planar"===d?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(a,b,c)}})},"esri/views/3d/terrain/terrainUtilsPlanar":function(){define("require exports ./TilingScheme ./TerrainConst ../../../core/Error ../../../geometry/support/scaleUtils ../support/aaBoundingRect ../lib/glMatrix".split(" "),function(q,n,k,f,c,b,a,e){function h(a,b,c,e){d.set(c,m);
m[e]=b[e];e=d.subtract(m,b);var g=d.subtract(a,b,l),g=d.dot(g,e),h=d.dot(e,e);b=0>=g?b:h<=g?c:d.add(b,d.scale(e,g/h),m);a=d.subtract(a,b,m);return Math.PI/2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+a[1]*a[1]))}function g(a,b){var c=a.getElevationBounds(),d=a.extent,c=0.5*(c[0]+c[1]);p[0]=d[0];p[1]=d[1];p[2]=c;s[0]=d[2];s[1]=d[3];s[2]=c;c=d=Infinity;b[0]<p[0]?d=h(b,p,s,0):b[0]>s[0]&&(d=h(b,s,p,0));b[1]<p[1]?c=h(b,p,s,1):b[1]>s[1]&&(c=h(b,s,p,1));return Math.min(d,c)}var d=e.vec3d,m=d.create(),l=d.create(),
p=d.create(),s=d.create();n.autoUpdateSkirtsVisibility=function(b,c){var d,e=!0,h=b.extent,f=a.contains(h,c);f?d=b.getElevation(c):(d=b.getElevationBounds(),d=0.5*(d[0]+d[1]));d>c[2]?e=!1:f||(f=Math.min(h[2]-h[0],h[3]-h[1]),a.containsWithMargin(h,c,b.hideSkirtsDistanceFromExtentMargin*f)?g(b,c)>b.hideSkirtsMinimumCameraTilt&&(e=!1):e=!1);e!==b.skirts&&(b.skirts=e)};n.tiltOnEdge=h;n.tiltToExtentEdge=g;n.checkIfTileInfoSupportedForViewSR=function(d,e,g){if(null==b.getUnitValue(d.spatialReference))return new c("tilingscheme:local-gcs-not-supported",
"Geographic coordinate systems are not supported in local scenes");var h=k.checkUnsupported(d);if(h)return h;var l=d.lods,h=l[0].resolution*Math.pow(2,l[0].level),m=[h*d.size[0],h*d.size[1]],p=[d.origin.x,d.origin.y];e=a.fromExtent(e);var s=a.create();k.computeRowColExtent(e,m,p,s);m=(s[2]-s[0])*(s[3]-s[1]);m>f.MAX_ROOT_TILES?(l=l[0].scale*Math.pow(2,l[0].level),h=Math.max((e[3]-e[1])/d.size[1],(e[2]-e[0])/d.size[0])*l/h,e=Math.floor(Math.log(h)/Math.log(10)),h=Math.ceil(h/Math.pow(10,e))*Math.pow(10,
e),h=new c("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(l).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+h.toLocaleString()+".",{level0Scale:l,suggestedLevel0Scale:h,requiredNumRootTiles:m,allowedNumRootTiles:f.MAX_ROOT_TILES})):h=null;return h?h:!d.spatialReference.equals(g)?new c("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}})},"esri/views/3d/terrain/terrainUtilsSpherical":function(){define(["require",
"exports","./TilingScheme","../../../core/Error"],function(q,n,k,f){n.autoUpdateSkirtsVisibility=function(c,b){};n.checkIfTileInfoSupportedForViewSR=function(c,b,a){b=c.lods.length-1;if(c.spatialReference.isWebMercator){if(!k.makeWebMercatorAuxiliarySphere(b).compatibleWith(c))return new f("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else if(c.spatialReference.isWGS84){if(!k.makeWGS84WithTileSize(c.size[1],
b).compatibleWith(c))return new f("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}else return new f("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!c.spatialReference.equals(a))return new f("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}})},"esri/views/3d/terrain/SurfaceTilingSchemeLogic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ./TilingScheme ./terrainUtils".split(" "),
function(q,n,k,f,c,b,a,e,h){return function(b){function d(){b.call(this);this._changeHandles=new a}k(d,b);d.prototype.normalizeCtorArgs=function(a){this._layers=a.layers;this._extentHelper=a.extentHelper;this._manifold=a.manifold;return{viewSpatialReference:a.viewSpatialReference}};d.prototype.initialize=function(){var a=this;this._changeHandles.add(this._layers.on("change",function(){return a._update()}));this._changeHandles.add(this._extentHelper.watch("layerViewsExtent",function(){return a._setAdHocTilingScheme()}));
this._update();this.tilingSchemeLocked||this._setAdHocTilingScheme()};d.prototype.destroy=function(){this._changeHandles.destroy();this._changeHandles=null};d.prototype._update=function(){var a=this;this._waitTask=null;if(!this.tilingSchemeLocked){var b=this._layers.find(function(b){if(h.isTiledLayer(b))return b.isResolved()&&!a._isTileInfoSupported(b.tileInfo,b.fullExtent)?!1:!b.isRejected()});if(b)if(b.isResolved()){var c=new e(b.tileInfo),b=h.getKnownTiledServiceLevelCap(b.url);Infinity>b&&c.capMaxLod(b);
this._lockTilingScheme(c)}else this._updateWhen(b)}};d.prototype._updateWhen=function(a){var b=this,c=a.always(function(){c===b._waitTask&&b._update()});this._waitTask=c};d.prototype._lockTilingScheme=function(a){var b=this;if("spherical"===this._manifold){var c=a.levels.length-1;a=a.spatialReference.isWebMercator?e.makeWebMercatorAuxiliarySphere(c):e.makeWGS84WithTileSize(a.pixelSize[0],c)}this.tilingSchemeLocked=!0;this.tilingScheme=a;this._extentHelper.tilingScheme=this.tilingScheme;this._updateTiledLayerExtent();
this._changeHandles.removeAll();this._changeHandles.add(this._extentHelper.watch("tiledLayersExtent",function(){return b._updateTiledLayerExtent()}))};d.prototype._updateTiledLayerExtent=function(){this.extent=this._extentHelper.tiledLayersExtent};d.prototype._setAdHocTilingScheme=function(){if("spherical"===this._manifold)this.tilingScheme=this._extentHelper.spatialReference.isWebMercator?e.WebMercatorAuxiliarySphere:e.makeWGS84WithTileSize(256),this.extent=this._extentHelper.layerViewsExtent;else{var a=
this._extentHelper.layerViewsExtent;a&&(this.tilingScheme=e.fromExtent(a,this._extentHelper.spatialReference),this.extent=a)}};d.prototype._isTileInfoSupported=function(a,b){return null==h.checkIfTileInfoSupportedForView(a,b,this.viewSpatialReference,this._manifold)};f([c.property()],d.prototype,"tilingScheme",void 0);f([c.property()],d.prototype,"extent",void 0);f([c.property({value:!1})],d.prototype,"tilingSchemeLocked",void 0);f([c.property()],d.prototype,"viewSpatialReference",void 0);return d=
f([c.subclass()],d)}(c.declared(b))})},"esri/views/3d/terrain/SphericalTile":function(){define("./TileBase ./TileGeometryFactory ../support/ObjectPool ../support/mathUtils ../support/earthUtils ../lib/glMatrix".split(" "),function(q,n,k,f,c,b){var a=b.vec3d,e=c.earthRadius,h=function(a,b,c,h){c=e+c;var f=Math.cos(a);h[0]=Math.cos(b)*f*c;h[1]=Math.sin(b)*f*c;h[2]=Math.sin(a)*c};c=function(b,c,e,h){q.call(this);this.tileUp=a.create();this.obb=Array(8);this._isWebMercator=!1;for(var f=0;8>f;f++)this.obb[f]=
a.create();void 0!==b&&this.init(b,c,e,h)};c.prototype=new q;c.prototype.constructor=c;c.prototype.init=function(b,c,m,l){q.prototype.init.call(this,b,c,m,l);this._isWebMercator=l.spatialReference.isWebMercator;c=this.extentWGS84Rad[0];l=this.extentWGS84Rad[1];m=this.extentWGS84Rad[2];var p=this.extentWGS84Rad[3],k=b[0];b=f.lerp(l,p,0.5);var r=f.lerp(c,m,0.5);l=0===k?0:Math.min(Math.abs(l),Math.abs(p));this.edgeLen=(m-c)*Math.cos(l)*e;this.curvatureHeight=e-Math.sqrt(e*e-this.edgeLen*this.edgeLen/
4);h(b,r,0,this.centerAtSeaLevel);a.set(this.centerAtSeaLevel,this.tileUp);a.normalize(this.tileUp);this._updateOBB();this.updateRadiusAndCenter()};c.prototype.isVisible=function(a,b){if(!this.intersectsClippingArea)return!1;if(9<this.lij[0])for(var c=this.obb,e=0;6>e;e++){for(var h=0;8>h&&!(0>a[e][0]*c[h][0]+a[e][1]*c[h][1]+a[e][2]*c[h][2]+a[e][3]);h++);if(8===h)return!1}else if(c=this.radius,e=this.center,a[0][0]*e[0]+a[0][1]*e[1]+a[0][2]*e[2]+a[0][3]>c||a[1][0]*e[0]+a[1][1]*e[1]+a[1][2]*e[2]+a[1][3]>
c||a[2][0]*e[0]+a[2][1]*e[1]+a[2][2]*e[2]+a[2][3]>c||a[3][0]*e[0]+a[3][1]*e[1]+a[3][2]*e[2]+a[3][3]>c||a[4][0]*e[0]+a[4][1]*e[1]+a[4][2]*e[2]+a[4][3]>c||a[5][0]*e[0]+a[5][1]*e[1]+a[5][2]*e[2]+a[5][3]>c)return!1;return!0};c.prototype.computeElevationBounds=function(){q.prototype.computeElevationBounds.call(this);this._updateOBB()};c.prototype.updateRadiusAndCenter=function(){if(0===this.lij[0])a.set3(0,0,0,this.center),this.radius=e+this.elevationBounds[1];else{q.prototype.updateRadiusAndCenter.call(this);
var b=Math.max(a.dist2(this.center,this.obb[0]),a.dist2(this.center,this.obb[1]));this.radius=Math.sqrt(b)}};c.prototype._numSubdivisionsAtLevel=[128,64,32,16,16,8,8,4];c.prototype.createGeometry=function(a,b,c){var e=this._isPole(this.lij[1],this.lij[0]);a.needsUpdate=!1;return n.createSphericalGlobeTile(a.numVertsPerRow,this.extent,this.extentWGS84Rad,this._isWebMercator,a.samplerData,b,e,c)};c.prototype._updateOBB=function(){var b=this.extentWGS84Rad,c=this.obb,f;for(f=0;2>f;f++){var l=this.elevationBounds[f],
p=4*f;h(b[1],b[0],l,c[p++]);h(b[3],b[0],l,c[p++]);h(b[3],b[2],l,c[p++]);h(b[1],b[2],l,c[p++])}this._isWebMercator&&(b=this._isPole(this.lij[1],this.lij[0]),2===b?(a.set3(0,0,e,c[1]),a.set3(0,0,e,c[2]),a.set3(0,0,e,c[5]),a.set3(0,0,e,c[6])):1===b&&(a.set3(0,0,-e,c[0]),a.set3(0,0,-e,c[3]),a.set3(0,0,-e,c[4]),a.set3(0,0,-e,c[7])))};c.prototype._isPole=function(a,b){var c=0;a===(1<<b)-1&&(c+=1);0===a&&(c+=2);return c};k.on(c,400);return c})},"esri/views/3d/terrain/TileBase":function(){define("./terrainUtils ./TileUtils ./TerrainConst ./TileGeometryFactory ./UpsampleInfo ./ElevationData ../support/mathUtils ../lib/glMatrix ../../../core/arrayUtils".split(" "),
function(q,n,k,f,c,b,a,e,h){function g(a){this.waitingAgents=[];this.init(a)}var d=e.vec3d,m=e.vec2d,l=e.vec4d,p=e.mat4d,s=q.weakAssert,r=d.create(),t=l.create(),u=l.create(),v=d.create(),C={},y=k.LayerClass.LAYER_CLASS_COUNT,x=k.LayerClass.MAP,B=k.LayerClass.ELEVATION,z=k.TileUpdateTypes;q=function(a,b,c){this.lij=[0,0,0];this.extent=l.create();this.extentWGS84Rad=l.create();this.centerAtSeaLevel=d.create();this.center=d.create();this.tileUp=v;this.elevationBounds=m.create();this.children=[null,
null,null,null];this.layerInfo=Array(y);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this._maxTesselation=0};q.prototype.init=function(a,b,c,d){this.lij[0]=a[0];this.lij[1]=a[1];this.lij[2]=a[2];d.getExtent(a[0],a[1],a[2],this.extent,this.extentWGS84Rad);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this.radius=this.edgeLen=0;this.vlevel=a?a[0]:0;b&&b.elevationBounds?m.set(b.elevationBounds,this.elevationBounds):m.set2(0,0,this.elevationBounds);
this.parent=b;for(a=0;4>a;a++)this.children[a]=null;this.pendingUpdates=0;this.renderData=null;this.renderOrder=this.screenDepth=0;this.visible=!1;this.parentSurface=c;for(a=0;a<y;a++)if(c){b=c.numLayers(a);var e;this.layerInfo[a]?(e=this.layerInfo[a],e.length=b):(e=Array(b),this.layerInfo[a]=e);for(var h=0;h<b;h++)e[h]=A(a,e[h]),a==B&&this.findElevationBoundsForLayer(h,-1)}else this.layerInfo[a]=null;this.computeElevationBounds();this._maxTesselation=Math.min(d.pixelSize[0],k.MAX_TILE_TESSELATION)};
q.prototype.dispose=function(){for(var a=0;a<y;a++)for(var b=this.layerInfo[a],d=0;d<b.length;d++){var e=b[d];e.upsampleFromTile&&(c.Pool.release(e.upsampleFromTile),e.upsampleFromTile=null)}};q.prototype.updateScreenDepth=function(a){d.set(this.center,u);u[3]=1;p.multiplyVec4(a,u,u);this.screenDepth=u[2]/u[3]};q.prototype.shouldSplit=function(b,c){var e=this.lij[0];if(1>e)return z.SPLIT;d.subtract(this.center,c,r);var h=d.length(r),g=this.edgeLen/(2*b[0]*h),h=this.edgeLen/(2*b[2]*h),f=b[1],l=b[3],
m=b[4],p=b[5];return g<f?this.vlevel!==this.lij[0]?(this.vlevel=this.lij[0],z.VSPLITMERGE):z.NONE:e>=m?(e+=Math.ceil(-a.log2(f/g)),e!==this.vlevel?(this.vlevel=e,z.VSPLITMERGE):z.NONE):6<e&&(d.scale(this.tileUp,d.dot(this.tileUp,r),t),d.subtract(t,r),d.length2(t)>this.radius*this.radius&&(d.scale(t,this.radius/d.length(t)),d.add(t,this.center),d.subtract(c,t,t),e=this.elevationBounds[1]-this.elevationBounds[0],Math.min(1,(Math.abs(d.dot(t,this.tileUp))+0.5*e+this.curvatureHeight)/d.length(t))*h<0.1/
p*l))?z.NONE:z.SPLIT};q.prototype.createElevationDataFromLERC=function(a){var c;try{c=b.createFromLERC(this.lij,this.extent,a,{noDataValue:k.ELEVATION_NODATA_VALUE})}catch(d){console.warn("Error decoding %s: %s",a.url,d.message)}return c};q.prototype.getWGS84Extent=function(){return this.extentWGS84Rad.map(a.rad2deg)};q.prototype.load=function(a){for(var b=0;b<y;b++)this.layerInfo[b]&&this._createOrUpdateAgents(0,b);a.loadTile(this)};q.prototype.unload=function(a){this.renderData&&a.unloadTile(this);
for(a=0;a<y;a++)for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&d.loadingAgent!==C&&(d.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(c,a).Pool.release(d.loadingAgent),d.loadingAgent=null);d.pendingUpdates=0}this.pendingUpdates&=~k.TileUpdateTypes.UPDATE_GEOMETRY;this.pendingUpdates&=~k.TileUpdateTypes.UPDATE_TEXTURE};q.prototype.updateClippingStatus=function(a){h.equals(a,this.clippingArea)||(a?(this.intersectsClippingArea=this.intersectsExtent(a),this.isWithinClippingArea=
this.isWithinExtent(a)):this.isWithinClippingArea=this.intersectsClippingArea=!0,this.clippingArea=a,this.renderData&&this.updateGeometry())};q.prototype.updateVisibility=function(a,b,c){a=c||this.isVisible(a,b)&&this.intersectsClippingArea;if(a!==this.visible){this.visible=a;b=this.layerInfo[0];for(c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&d.loadingAgent!==C&&d.loadingAgent.setSuspension(!a)}}return a};q.prototype.getLayerInfo=function(a,b){return this.layerInfo[b][a]};q.prototype.hasLayerData=
function(a,b){var c=this.layerInfo[b][a];return c&&c.data};q.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemapData)?null!=b.dataValue?b.dataValue:b.isTileAvailable(a.lij[1],a.lij[2]):!0};q.prototype.requestLayerData=function(a,b,c){k.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d requested by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var d=this.layerInfo[b][a];if(-1<d.waitingAgents.indexOf(c))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",
this.lij.toString(),c.tile.lij.toString(),b,a),!0;if(d.data)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),c.tile.lij.toString(),b,a),d.waitingAgents.push(c),setTimeout(c.dataArrived.bind(c,this),0),!0;if(d.pendingUpdates&z.DECODE_LERC)return d.waitingAgents.push(c),!0;d.waitingAgents.push(c);if(!d.requestPromise){var e=this.parentSurface.requestTileData(this,a,b);a=function(){d.requestPromise===e&&(d.requestPromise=null)};d.requestPromise=
e;e.then(a,a)}return d.requestPromise?!0:!1};q.prototype.descendants=function(a){a||(a=[]);for(var b=0;4>b;b++){var c=this.children[b];c&&(c.descendants(a),a.unshift(this.children[b]))}return a};q.prototype.isLij=function(a){return this.lij[0]===a[0]&&this.lij[1]===a[1]&&this.lij[2]==a[2]};q.prototype.findByLij=function(a){if(this.isLij(a))return this;for(var b=0;4>b;b++){var c=this.children[b];if(c&&(c=c.findByLij(a)))return c}return null};q.prototype.unrequestLayerData=function(a,b,c){k.TILE_LOADING_DEBUGLOG&&
console.log("tile %s layer %d/%d canceled by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var d=this.layerInfo[b][a],e=d.waitingAgents;c=e.indexOf(c);s(-1<c,"agent has not requested this piece of map data");e[c]=e[e.length-1];e.length--;1>e.length&&(s(d.requestPromise||d.rawData,"no pending operations on layerInfo that agents were waiting for"),d.requestPromise&&(this.parentSurface.cancelRequest(d.requestPromise),d.requestPromise=null),k.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d request/loading canceled",
this.lij.toString(),b,a))};q.prototype.dataArrived=function(a,b,c){a=this.layerInfo[b][a];a.data=c;for(c=0;c<a.waitingAgents.length;c++)a.waitingAgents[c].dataArrived(this);a.waitingAgents.length=0};q.prototype.dataMissing=function(a,b,c){c.notInTilemap||console.error("Tile %s layer %d/%d error",this.lij.toString(),b,a);a=this.layerInfo[b][a];for(b=0;b<a.waitingAgents.length;b++)a.waitingAgents[b].dataMissing(this);a.waitingAgents.length=0};q.prototype.updateTexture=function(a){this.renderData&&(a?
this.parentSurface._renderer.updateTileTexture(this):(this.pendingUpdates|=k.TileUpdateTypes.UPDATE_TEXTURE,this.parentSurface._pendingUpdates=!0))};q.prototype.computeElevationBounds=function(){m.set2(Number.MAX_VALUE,-Number.MAX_VALUE,this.elevationBounds);for(var a=this.layerInfo[B],b=!1,c=0;c<a.length;c++){var d=a[c];d.elevationBounds&&(this.elevationBounds[0]=Math.min(this.elevationBounds[0],d.elevationBounds[0]),this.elevationBounds[1]=Math.max(this.elevationBounds[1],d.elevationBounds[1]),
b=!0)}b||m.set2(0,0,this.elevationBounds);this.updateRadiusAndCenter()};q.prototype.updateRadiusAndCenter=function(){d.scale(this.tileUp,0.5*(this.elevationBounds[0]+this.elevationBounds[1]),t);d.add(this.centerAtSeaLevel,t,this.center)};q.prototype.findElevationBoundsForLayer=function(a,b){var c=this.layerInfo[B][a];if(!c.elevationBounds||c.elevationBounds[2]<b){var e=this.parentSurface.layerViewByIndex(a,B);if(n.fallsWithinLayer(this,e,!1)){e=!1;if(c.data)m.set(c.data.bounds,t),t[2]=this.lij[0],
e=!0;else{for(var h=this.parent,g=0,f=null,l=c.data;h&&(!l||g<k.ELEVATION_DESIRED_RESOLUTION_LEVEL);){g=this.vlevel-h.lij[0];f=l||f;l=h.layerInfo[B][a].data;if(!l&&f&&g>=k.ELEVATION_DESIRED_RESOLUTION_LEVEL)break;h=h.parent}if(l=l||f)l.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],t),Infinity!==t[0]&&(t[2]=l.level,e=!0)}e&&(c.elevationBounds?d.set(t,c.elevationBounds):c.elevationBounds=[t[0],t[1],t[2]])}}};q.prototype.updateGeometry=function(){this.pendingUpdates|=k.TileUpdateTypes.UPDATE_GEOMETRY;
this.parentSurface._pendingUpdates=!0};q.prototype.modifyLayers=function(a,b,c){for(var d=b.length,e=this.layerInfo[c],h=Array(d),g=0;g<e.length;g++){var f=e[g];f.loadingAgent&&f.loadingAgent!==C&&(f.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(g,c).Pool.release(f.loadingAgent),f.loadingAgent=null);f.waitingAgents.length=0}if(c===x)for(g=0;g<e.length;g++)void 0===a[g]&&(f=e[g],f.data instanceof WebGLTexture&&this.parentSurface._renderer.releaseTileTexture(f.data));for(g=0;g<d;g++)a=
b[g],h[g]=-1<a?e[a]:A(c);this.layerInfo[c]=h};q.prototype.restartAgents=function(a){if(this.renderData)if(this._createOrUpdateAgents(0,a),a===B){this.updateGeometry();a=this.layerInfo[a];for(var b=0;b<a.length;b++)a[b].pendingUpdates|=k.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0}else this.updateTexture(!0)};q.prototype.updateAgents=function(a){if(this.renderData){for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent===C&&(d.loadingAgent=null)}this._createOrUpdateAgents(0,
a)}};q.prototype.agentDone=function(a,b){var c=this.layerInfo[b],d=c[a];d.loadingAgent=C;!d.data&&!d.upsampleFromTile&&a<c.length-1&&this._createOrUpdateAgents(a+1,b)};q.prototype._createOrUpdateAgents=function(a,b){var c;c=b===B?!1:!this.visible;for(var d=a,e=this.layerInfo[b];d<e.length;){var h=e[d],g=!1,f=this.parentSurface.layerViewByIndex(d,b);if(null!==h.loadingAgent&&h.loadingAgent!==C)g=h.loadingAgent.update();else if(h.loadingAgent!==C&&n.fallsWithinLayer(this,f,!1)){var l=this.parentSurface.agentTypeByLayerIndex(d,
b),m=l.Pool.acquire();(g=m.init(this,d,b,c))?h.loadingAgent=m:(l.Pool.release(m),h.loadingAgent=C)}if(g&&!f.isTransparent())break;d++}};q.prototype.geometryState=function(b){var c,d=this._getElevationInfo(b?b.samplerData:null),e=this.lij[0],g=!1;d.samplerData?(c=this.vlevel-e,c=Math.max(e-d.maxTileLevel,k.ELEVATION_DESIRED_RESOLUTION_LEVEL-c),e=this._maxTesselation,c=a.clamp((e>>c)+1,2,e+1)):c=8>e?this._numSubdivisionsAtLevel[e]+1:2;c=f.supportedNumVertsPerRow(c);e=this.clippingArea;if(!this.intersectsClippingArea||
this.isWithinClippingArea)e=null;b?(b.numVertsPerRow!==c&&(b.numVertsPerRow=c,g=!0),d.changed&&(b.samplerData=d.samplerData,g=!0),h.equals(b.clippingArea,e)||(b.clippingArea=e,g=!0),b.needsUpdate=g):b={numVertsPerRow:c,samplerData:d.samplerData,needsUpdate:!0,clippingArea:e};return b};q.prototype._getElevationInfo=function(a){for(var b=this.layerInfo[B],c=b.length,d=Array(c),e=0,h=0,g=!1,f=0;f<c;f++){var l=b[f];if(l.upsampleFromTile){var l=l.upsampleFromTile.tile,m=l.layerInfo[B][f].data;if(!a||a[e]!==
m.samplerData)g=!0;d[e++]=m.samplerData;h=Math.max(h,l.lij[0])}else if(l.data&&(m=this.parentSurface.layerViewByIndex(f,B),n.fallsWithinLayer(this,m,!1))){if(!a||a[e]!==l.data.samplerData)g=!0;d[e++]=l.data.samplerData;h=this.lij[0]}}a&&a.length!==e&&(g=!0);0<e?d.length=e:d=null;return{changed:g,samplerData:d,maxTileLevel:h}};q.prototype.isWithinExtent=function(a){var b=this.extent;return b[0]>=a[0]&&a[2]>=b[2]&&b[1]>=a[1]&&a[3]>=b[3]};q.prototype.intersectsExtent=function(a){var b=this.extent;return b[2]>=
a[0]&&a[2]>=b[0]&&b[3]>=a[1]&&a[3]>=b[1]};g.prototype.init=function(a){this.waitingAgents.length=0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemapData=this.data=null;this.pendingUpdates=0;a===B&&(this.elevationBounds=null)};var A=function(a,b){return b?(b.init(a),b):new g(a)};return q})},"esri/views/3d/terrain/ElevationData":function(){define(["require","exports","../../../layers/support/rasterFormats/LercCodec","./TerrainConst","../support/mathUtils"],
function(q,n,k,f,c){return function(){function b(a,b,c,g){this.samplerData=null;this.level=a;this.i=b;this.j=c;this.extent=g}b.prototype.computeMinMaxValue=function(a,b,h,g){var d=Infinity,m=-Infinity;a-=this.level;var l=Math.pow(2,a);if(Math.floor(b/l)===this.i&&Math.floor(h/l)===this.j&&0<a){var p=this.samplerData.width,k=this.samplerData.pixelData,r=0.5*f.ELEVATION_NODATA_VALUE;a=(p-1)/l;h=(h-this.j*l)*a;b=(b-this.i*l)*a;if(1>a){var l=Math.floor(h),t=Math.floor(b),u=l+t*p,v=k[u],n=k[u+1],y=k[u+
p],u=k[u+p+1];if(v+n+y+u<r)return d=c.bilerp(v,n,y,u,h-l,b-t),m=c.bilerp(v,n,y,u,h-l+a,b-t),p=c.bilerp(v,n,y,u,h-l,b-t+a),a=c.bilerp(v,n,y,u,h-l+a,b-t+a),g[0]=Math.min(d,m,p,a),g[1]=Math.max(d,m,p,a),g;h=l;b=t;a=1}else h=Math.floor(h),b=Math.floor(b),a=Math.ceil(a);for(l=h;l<=h+a;l++)for(t=b;t<=b+a;t++)u=l+t*p,v=k[u],v<r?(d=Math.min(d,v),m=Math.max(m,v)):(d=0<d?0:d,m=0>m?0:m)}g[0]=d;g[1]=m;return g};b.createFromLERC=function(a,c,h,g){h=k.decode(h,g);a=new b(a[0],a[1],a[2],c);a.samplerData={pixelData:h.pixelData,
width:h.width,height:h.height,minValue:h.minValue,maxValue:h.maxValue,noDataValue:h.noDataValue,safeWidth:0.99999999*(h.width-1),dx:(h.width-1)/(a.extent[2]-a.extent[0]),dy:(h.width-1)/(a.extent[3]-a.extent[1]),x0:a.extent[0],y1:a.extent[3]};a.bounds=[a.samplerData.minValue,-3E38<a.samplerData.maxValue?a.samplerData.maxValue:0];return a};return b}()})},"esri/layers/support/rasterFormats/LercCodec":function(){define([],function(){var q={defaultNoDataValue:-3.4027999387901484E38,decode:function(k,f){var c;
f=f||{};var b=f.inputOffset||0,a=f.encodedMaskData||null===f.encodedMaskData,e={},h=new Uint8Array(k,b,10);e.fileIdentifierString=String.fromCharCode.apply(null,h);if("CntZImage"!=e.fileIdentifierString.trim())throw"Unexpected file identifier string: "+e.fileIdentifierString;var b=b+10,g=new DataView(k,b,24);e.fileVersion=g.getInt32(0,!0);e.imageType=g.getInt32(4,!0);e.height=g.getUint32(8,!0);e.width=g.getUint32(12,!0);e.maxZError=g.getFloat64(16,!0);b+=24;if(!a)if(g=new DataView(k,b,16),e.mask=
{},e.mask.numBlocksY=g.getUint32(0,!0),e.mask.numBlocksX=g.getUint32(4,!0),e.mask.numBytes=g.getUint32(8,!0),e.mask.maxValue=g.getFloat32(12,!0),b+=16,0<e.mask.numBytes){var a=new Uint8Array(Math.ceil(e.width*e.height/8)),g=new DataView(k,b,e.mask.numBytes),h=g.getInt16(0,!0),d=2,m=0;do{if(0<h)for(;h--;)a[m++]=g.getUint8(d++);else for(var l=g.getUint8(d++),h=-h;h--;)a[m++]=l;h=g.getInt16(d,!0);d+=2}while(d<e.mask.numBytes);if(-32768!==h||m<a.length)throw"Unexpected end of mask RLE encoding";e.mask.bitset=
a;b+=e.mask.numBytes}else 0===(e.mask.numBytes|e.mask.numBlocksY|e.mask.maxValue)&&(a=new Uint8Array(Math.ceil(e.width*e.height/8)),e.mask.bitset=a);g=new DataView(k,b,16);e.pixels={};e.pixels.numBlocksY=g.getUint32(0,!0);e.pixels.numBlocksX=g.getUint32(4,!0);e.pixels.numBytes=g.getUint32(8,!0);e.pixels.maxValue=g.getFloat32(12,!0);b+=16;a=e.pixels.numBlocksX;h=e.pixels.numBlocksY;a+=0<e.width%a?1:0;h+=0<e.height%h?1:0;e.pixels.blocks=Array(a*h);d=1E9;for(l=m=0;l<h;l++)for(var p=0;p<a;p++){var s=
0,g=new DataView(k,b,Math.min(10,k.byteLength-b)),r={};e.pixels.blocks[m++]=r;var t=g.getUint8(0);s++;r.encoding=t&63;if(3<r.encoding)throw"Invalid block encoding ("+r.encoding+")";if(2===r.encoding)b++,d=Math.min(d,0);else{if(0!==t&&2!==t){t>>=6;r.offsetType=t;if(2===t)r.offset=g.getInt8(1),s++;else if(1===t)r.offset=g.getInt16(1,!0),s+=2;else if(0===t)r.offset=g.getFloat32(1,!0),s+=4;else throw"Invalid block offset type";d=Math.min(r.offset,d);if(1===r.encoding)if(t=g.getUint8(s),s++,r.bitsPerPixel=
t&63,t>>=6,r.numValidPixelsType=t,2===t)r.numValidPixels=g.getUint8(s),s++;else if(1===t)r.numValidPixels=g.getUint16(s,!0),s+=2;else if(0===t)r.numValidPixels=g.getUint32(s,!0),s+=4;else throw"Invalid valid pixel count type";}b+=s;if(3!=r.encoding)if(0===r.encoding){g=(e.pixels.numBytes-1)/4;if(g!==Math.floor(g))throw"uncompressed block has invalid length";s=new ArrayBuffer(4*g);t=new Uint8Array(s);t.set(new Uint8Array(k,b,4*g));s=new Float32Array(s);for(t=0;t<s.length;t++)d=Math.min(d,s[t]);r.rawData=
s;b+=4*g}else 1===r.encoding&&(g=Math.ceil(r.numValidPixels*r.bitsPerPixel/8),s=Math.ceil(g/4),s=new ArrayBuffer(4*s),t=new Uint8Array(s),t.set(new Uint8Array(k,b,g)),r.stuffedData=new Uint32Array(s),b+=g)}}e.pixels.minValue=d;e.eofOffset=b;var b=null!=f.noDataValue?f.noDataValue:q.defaultNoDataValue,h=f.encodedMaskData,s=f.returnMask,d=0,m=e.pixels.numBlocksX,l=e.pixels.numBlocksY,p=Math.floor(e.width/m),r=Math.floor(e.height/l),g=2*e.maxZError,h=h||(e.mask?e.mask.bitset:null),u,a=new (f.pixelType||
Float32Array)(e.width*e.height);s&&h&&(u=new Uint8Array(e.width*e.height));for(var s=new Float32Array(p*r),v,C,t=0;t<=l;t++){var y=t!==l?r:e.height%l;if(0!==y)for(var x=0;x<=m;x++){var B=x!==m?p:e.width%m;if(0!==B){var z=t*e.width*r+x*p,A=e.width-B,w=e.pixels.blocks[d],D,E;if(2>w.encoding){if(0===w.encoding)D=w.rawData;else{D=w.stuffedData;E=w.bitsPerPixel;v=w.numValidPixels;C=w.offset;var H=g,G=s,I=e.pixels.maxValue,O=(1<<E)-1,J=0,F=void 0,K=0,T=void 0,R=void 0,da=Math.ceil((I-C)/H),F=4*D.length-
Math.ceil(E*v/8);D[D.length-1]<<=8*F;for(F=0;F<v;F++)0===K&&(R=D[J++],K=32),K>=E?(T=R>>>K-E&O,K-=E):(K=E-K,T=(R&O)<<K&O,R=D[J++],K=32-K,T+=R>>>K),G[F]=T<da?C+T*H:I;D=s}E=0}else c=2===w.encoding?0:w.offset;var S;if(h)for(C=0;C<y;C++){z&7&&(S=h[z>>3],S<<=z&7);for(v=0;v<B;v++)z&7||(S=h[z>>3]),S&128?(u&&(u[z]=1),a[z++]=2>w.encoding?D[E++]:c):(u&&(u[z]=0),a[z++]=b),S<<=1;z+=A}else if(2>w.encoding)for(C=0;C<y;C++){for(v=0;v<B;v++)a[z++]=D[E++];z+=A}else for(C=0;C<y;C++){for(v=0;v<B;v++)a[z++]=c;z+=A}if(1===
w.encoding&&E!==w.numValidPixels)throw"Block and Mask do not match";d++}}}c=u;u={width:e.width,height:e.height,pixelData:a,minValue:e.pixels.minValue,maxValue:e.pixels.maxValue,noDataValue:b};c&&(u.maskData=c);f.returnEncodedMask&&e.mask&&(u.encodedMaskData=e.mask.bitset?e.mask.bitset:null);if(f.returnFileInfo&&(u.fileInfo=n(e),f.computeUsedBitDepths)){c=u.fileInfo;S=e.pixels.numBlocksX*e.pixels.numBlocksY;D={};for(E=0;E<S;E++)b=e.pixels.blocks[E],0===b.encoding?D.float32=!0:1===b.encoding?D[b.bitsPerPixel]=
!0:D[0]=!0;e=Object.keys(D);c.bitDepths=e}return u}},n=function(k){return{fileIdentifierString:k.fileIdentifierString,fileVersion:k.fileVersion,imageType:k.imageType,height:k.height,width:k.width,maxZError:k.maxZError,eofOffset:k.eofOffset,mask:k.mask?{numBlocksX:k.mask.numBlocksX,numBlocksY:k.mask.numBlocksY,numBytes:k.mask.numBytes,maxValue:k.mask.maxValue}:null,pixels:{numBlocksX:k.pixels.numBlocksX,numBlocksY:k.pixels.numBlocksY,numBytes:k.pixels.numBytes,maxValue:k.pixels.maxValue,minValue:k.pixels.minValue,
noDataValue:this.noDataValue}}};return q})},"esri/views/3d/terrain/PlanarTile":function(){define(["./TileBase","./TileGeometryFactory","../support/ObjectPool","../support/mathUtils","../lib/glMatrix"],function(q,n,k,f,c){var b=c.vec3d.createFrom(0,0,1);c=function(a,c,h,g){q.call(this);this.tileUp=b;void 0!==a&&this.init(a,c,h,g)};c.prototype=new q;c.prototype.constructor=c;c.prototype.init=function(a,b,c,g){q.prototype.init.call(this,a,b,c,g);this.edgeLen=this.extent[2]-this.extent[0];this.curvatureHeight=
0;this.centerAtSeaLevel[0]=f.lerp(this.extent[0],this.extent[2],0.5);this.centerAtSeaLevel[1]=f.lerp(this.extent[1],this.extent[3],0.5);this.centerAtSeaLevel[2]=0;this.updateRadiusAndCenter()};c.prototype.updateRadiusAndCenter=function(){q.prototype.updateRadiusAndCenter.call(this);var a=(this.extent[2]-this.extent[0])*Math.SQRT1_2,b=0.5*(this.elevationBounds[0]-this.elevationBounds[1]);this.radius=Math.sqrt(a*a+b*b)};c.prototype.isVisible=function(a){if(!this.intersectsClippingArea)return!1;var b=
this.extent[0],c=this.extent[1],g=this.elevationBounds[0],d=this.extent[2],f=this.extent[3],l=this.elevationBounds[1];return 0<a[0][0]*(0<a[0][0]?b:d)+a[0][1]*(0<a[0][1]?c:f)+a[0][2]*(0<a[0][2]?g:l)+a[0][3]||0<a[1][0]*(0<a[1][0]?b:d)+a[1][1]*(0<a[1][1]?c:f)+a[1][2]*(0<a[1][2]?g:l)+a[1][3]||0<a[2][0]*(0<a[2][0]?b:d)+a[2][1]*(0<a[2][1]?c:f)+a[2][2]*(0<a[2][2]?g:l)+a[2][3]||0<a[3][0]*(0<a[3][0]?b:d)+a[3][1]*(0<a[3][1]?c:f)+a[3][2]*(0<a[3][2]?g:l)+a[3][3]||0<a[4][0]*(0<a[4][0]?b:d)+a[4][1]*(0<a[4][1]?
c:f)+a[4][2]*(0<a[4][2]?g:l)+a[4][3]||0<a[5][0]*(0<a[5][0]?b:d)+a[5][1]*(0<a[5][1]?c:f)+a[5][2]*(0<a[5][2]?g:l)+a[5][3]?!1:!0};c.prototype._numSubdivisionsAtLevel=[2,2,2,2,2,2,2,2];c.prototype.createGeometry=function(a,b,c){a.needsUpdate=!1;return n.createPlanarGlobeTile(a.numVertsPerRow,this.extent,a.samplerData,b,c,a.clippingArea)};k.on(c,400);return c})},"esri/views/3d/terrain/TilemapOnlyTile":function(){define(["./TerrainConst","./TileBase"],function(q,n){var k=function(f){this.lij=f;this.layerInfo=
Array(q.LayerClass.LAYER_CLASS_COUNT)};k.prototype.tileDataAvailable=n.prototype.tileDataAvailable;k.prototype.modifyLayers=function(f,c,b){f=c.length;for(var a=this.layerInfo[b],e=Array(f),h=0;h<f;h++){var g=c[h];e[h]=-1<g?a[g]:{tilemapData:null,tilemapRequest:null,pendingUpdates:0}}this.layerInfo[b]=e};return k})},"esri/views/3d/terrain/MapTileAgent":function(){define(["./TileAgentBase","./TileUtils","./UpsampleInfo","../support/ObjectPool"],function(q,n,k,f){var c=function(){q.apply(this,arguments)};
c.prototype=new q;c.prototype.constructor=c;c.prototype.dataArrived=function(b){b!==this.tile?this._setUpsamplingTile(b):this.tile.updateTexture();this._dataRequested=null;b!==this.tile&&this._requestNext()};c.prototype._findNextDownload=function(){var b,a=this.layerIdx,c=this.layerClass,h=this.tile.parentSurface.layerViewByIndex(a,c),g=h.minDataLevel,d=h.maxDataLevel;if(this._tileLayerInfo.data||g>this.tile.lij[0])b=null;else{for(var f=0,l=this.tile,p=this.tile.parentSurface,k=p.getTilemapTile(l),
p=p.tilemapStats,r=!1;l&&4>=f&&n.fallsWithinLayer(l,h,!1)&&l.lij[0]>=g;){if(l.layerInfo[c][a].data){this._setUpsamplingTile(l);break}k&&!k.tileDataAvailable(l,a,c)?r=!0:l.lij[0]<=d&&(b=l);l=l.parent;k=k?k.parent:null;f++}!b&&r&&p.tilesNotPresent++}return b};c.prototype._setUpsamplingTile=function(b){this._tileLayerInfo.upsampleFromTile&&this._tileLayerInfo.upsampleFromTile.tile===b||(this._tileLayerInfo.upsampleFromTile&&k.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=
n.computeUpsampleInfoForAncestor(this.tile,b),this.tile.updateTexture())};f.on(c,400);return c})},"esri/views/3d/terrain/TileAgentBase":function(){define(["./UpsampleInfo"],function(q){var n=Error("Abstract method called on TileAgentBase"),k=function(){};k.prototype.init=function(c,b,a,e){this.tile=c;this.layerIdx=b;this.layerClass=a;this._tileLayerInfo=c.getLayerInfo(b,a);this._dataRequested=null;this.suspended=e;if(!c.data)return(c=this._findAncestorWithData())?(this._setUpsamplingTile(c.tile),
q.Pool.release(c)):(this._tileLayerInfo.upsampleFromTile&&q.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=null),this._requestNext(!0)};k.prototype.dispose=function(){this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null);this._tileLayerInfo=this.tile=null};k.prototype.setSuspension=function(c){c!==this.suspended&&((this.suspended=c)?this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,
this.layerClass,this),this._dataRequested=null):this._tileLayerInfo.data||this.update())};k.prototype.update=function(){var c=this._findAncestorWithData();c&&this._tileLayerInfo.upsampleFromTile&&c.tile!==this._tileLayerInfo.upsampleFromTile.tile?this._setUpsamplingTile(c.tile):c&&q.Pool.release(c);return this._requestNext()};k.prototype.dataArrived=function(c){throw n;};k.prototype.dataMissing=function(c){this._dataRequested=null;this._agentDone()};k.prototype._agentDone=function(){this.tile.agentDone(this.layerIdx,
this.layerClass);this.dispose()};k.prototype._requestNext=function(c){if(this.suspended)return!0;var b=this._findNextDownload();if(this._dataRequested){if(b===this._dataRequested)return!0;this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this);this._dataRequested=null}b?b.requestLayerData(this.layerIdx,this.layerClass,this)&&(this._dataRequested=b):c||this._agentDone();return!!this._dataRequested};k.prototype._findAncestorWithData=function(){return f(this.tile,this.layerIdx,this.layerClass,
1,0,0,0)};var f=function(c,b,a,e,h,g,d){if(!c.parent||6<d)return null;e*=0.5;h*=0.5;g*=0.5;c.lij[2]&1&&(h+=0.5);0===(c.lij[1]&1)&&(g+=0.5);return c.parent.hasLayerData(b,a)?(b=q.Pool.acquire(),b.init(c.parent,h,g,e),b):f(c.parent,b,a,e,h,g,d+1)};k.prototype._findNextDownload=function(){throw n;};return k})},"esri/views/3d/terrain/ElevationTileAgent":function(){define(["./TileAgentBase","./TerrainConst","./UpsampleInfo","../support/ObjectPool"],function(q,n,k,f){var c=function(){q.apply(this,arguments)};
c.prototype=new q;c.prototype.constructor=c;c.prototype.dataArrived=function(b){b!==this.tile?this._setUpsamplingTile(b):this.updateGeometry();this._dataRequested=null;this._requestNext()};c.prototype.updateGeometry=function(){this._tileLayerInfo.pendingUpdates|=n.TileUpdateTypes.UPDATE_GEOMETRY;this.tile.updateGeometry()};c.prototype._findAncestorWithData=function(){for(var b=this.layerClass,a=this.layerIdx,c=this.tile,h=c.vlevel,g;c&&(!c.layerInfo[b][a].data||!(g=c,h-c.lij[0]>=n.ELEVATION_DESIRED_RESOLUTION_LEVEL));)c=
c.parent;return g?(b=k.Pool.acquire(),b.init(g,0,0,1),b):null};c.prototype._findNextDownload=function(){var b,a=this.layerIdx,c=this.layerClass,h=this.tile.parentSurface.layerViewByIndex(a,c),g=h.minDataLevel,h=h.maxDataLevel,d=n.ELEVATION_DESIRED_RESOLUTION_LEVEL-(this.tile.vlevel-this.tile.lij[0]),f=4+d;if(this._tileLayerInfo.data||this.tile.lij[0]<g)b=null;else{for(var l=this.tile,p=l.lij[0],k=0,r=this._tileLayerInfo.upsampleFromTile?this._tileLayerInfo.upsampleFromTile.tile.lij[0]:-1,t=this.tile.parentSurface,
u=t.getTilemapTile(l),t=t.tilemapStats,v=!1;l&&k<=f&&l.lij[0]>=g;){if(l.layerInfo[this.layerClass][this.layerIdx].data&&p-l.lij[0]>=d){l.lij[0]>r&&this._setUpsamplingTile(l);break}u&&!u.tileDataAvailable(l,a,c)?(v=!0,b=null):l.lij[0]<=h&&(b=l);l=l.parent;u=u?u.parent:null;k++}b&&(p-b.lij[0]<d&&this._tileLayerInfo.upsampleFromTile)&&(b=null);!b&&v&&t.tilesNotPresent++}return b};c.prototype._setUpsamplingTile=function(b){this._tileLayerInfo.upsampleFromTile&&k.Pool.release(this._tileLayerInfo.upsampleFromTile);
var a=k.Pool.acquire();a.init(b,0,0,1);this._tileLayerInfo.upsampleFromTile=a;this.updateGeometry()};f.on(c,400);return c})},"esri/views/3d/layers/graphics/LabelManager":function(){define("../../../../core/declare ../../../../core/watchUtils ../../support/PreallocArray ../../lib/glMatrix ../../webgl-engine/lib/Util ../../webgl-engine/materials/HUDMaterial".split(" "),function(q,n,k,f,c,b){function a(a,b){return b.posView-a.posView}var e=f.mat4d,h=f.vec3d,g=f.vec2d,d=f.vec4d,m=c.lerp,l=c.VertexAttrConstants,
p=[[-1,-1],[1,-1],[1,1],[-1,1]],s=d.create(),r=d.create(),t=d.create(),u=d.create(),v=g.create(),C=g.create(),y=d.create(),x=d.create(),B=d.create(),z=h.create(),A=g.create(),w=d.create(),D=h.create(),E=h.create(),H=e.create(),G=h.create(),I=d.create(),O=new k(100);f=function(a,b){this.constructor=a;this.releaser=b;this.list=[];this.currentIndex=0};f.prototype.alloc=function(){this.currentIndex>=this.list.length&&this.list.push(this.constructor.apply(this,arguments));return this.list[this.currentIndex++]};
f.prototype.freeAll=function(a){a=this.currentIndex;for(var b=this.releaser,c=this.list;0<=--a;)b(c[a]);this.currentIndex=0};var J=new f(function(){return{labelGraphics:null,c3dGraphic:null,positions:[g.create(),g.create(),g.create(),g.create()],xMin:0,xMax:0,yMin:0,yMax:0,posView:0,layerView:null,labelId:0}},function(a){a.layerGraphics=null;a.c3dGraphic=null;a.layerView=null});return q(null,{constructor:function(a){this.layerViews=[];this.view=a;this.stage=a._stage;this._deconflictTimeoutId=0;this._cameraListener=
n.on(a,"navigation","targetViewChanged",this._targetViewChanged.bind(this));this._viewReadyWatcher=a.watch("ready",function(a){!a&&this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),this._deconflictTimeoutId=0)}.bind(this))},destroy:function(){this._cameraListener.remove();0!==this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),this._deconflictTimeoutId=0);this._viewReadyWatcher.remove()},addSceneServiceLayerView:function(a){this.layerViews.push(a)},setDirty:function(){this._deconflictLabelsTimeout(10)},
setInitialLabelGraphicState:function(a){a.setVisibilityFlag("VISIBILITY_LABELMANAGER",!1)},removeSceneServiceLayerView:function(a){a=this.layerViews.indexOf(a);0<=a&&this.layerViews.splice(a,1)},_drawPoly:function(a,b,c){a.beginPath();a.lineWidth="1";a.strokeStyle=c;a.moveTo(b[0][0],b[0][1]);for(c=1;4>c;c++)a.lineTo(b[c][0],b[c][1]),a.stroke();a.lineTo(b[0][0],b[0][1]);a.stroke();a.closePath()},_tmp_vec:g.create(),_doesIntersectExistingPoly:function(a){var b=this._tmp_vec,c=a.positions,d={},e,h,f,
l,m,p,k,r,s,t,u,n,v,x;for(e=Math.floor(a.xMin/this._accBinsSizeX);e<=Math.floor(a.xMax/this._accBinsSizeX);e++)if(!(0>e||e>=this._accBinsNumX))for(h=Math.floor(a.yMin/this._accBinsSizeY);h<=Math.floor(a.yMax/this._accBinsSizeY);h++)if(!(0>h||h>=this._accBinsNumY)){f=this._accBins[e][h];l=0;a:for(;l<f.length;l++)if(m=f.data[l],null==d[m.labelId]){d[m.labelId]=!0;m=m.positions;this._accNumTests++;for(r=0;2>r;r++){p=0===r?c:m;k=0===r?m:c;v=0;b:for(;4>v;v++){s=p[v];t=p[(v+1)%4];u=p[(v+2)%4];b[0]=t[0]-
s[0];b[1]=t[1]-s[1];t=g.normalize(b);n=t[1];t[1]=t[0];t[0]=-n;n=t[0]*s[0]+t[1]*s[1];x=t[0]*u[0]+t[1]*u[1]<n;for(s=0;4>s;s++)if(u=k[s],u=t[0]*u[0]+t[1]*u[1],x&&u<n||!x&&u>n)continue b;continue a}}return!0}}return!1},_accBinsNumX:15,_accBinsNumY:20,_accBinsSizeX:0,_accBinsSizeY:0,_accBins:null,_accNumTests:0,_initBins:function(a,b){var c,d,e;if(null==this._accBins){this._accBins=[];for(c=0;c<this._accBinsNumX;c++){this._accBins.push([]);e=this._accBins[this._accBins.length-1];for(d=0;d<this._accBinsNumY;d++)e.push(new k(10))}}for(c=
0;c<this._accBinsNumX;c++)for(d=0;d<this._accBinsNumY;d++)this._accBins[c][d].clear();this._accBinsSizeX=a/this._accBinsNumX;this._accBinsSizeY=b/this._accBinsNumY;this._accNumTests=0},_addToBins:function(a){var b,c;for(b=Math.floor(a.xMin/this._accBinsSizeX);b<=Math.floor(a.xMax/this._accBinsSizeX);b++)if(!(0>b||b>=this._accBinsNumX))for(c=Math.floor(a.yMin/this._accBinsSizeY);c<=Math.floor(a.yMax/this._accBinsSizeY);c++)0>c||c>=this._accBinsNumY||this._accBins[b][c].push(a)},_accDrawDebug:function(a){var b=
[g.create(),g.create(),g.create(),g.create()],c=0,d,e,h,f,l,m,p;for(d=0;d<this._accBinsNumX;d++)for(e=0;e<this._accBinsNumY;e++)h=this._accBins[d][e],c+=h.length,f=d*this._accBinsSizeX,l=(d+1)*this._accBinsSizeX,m=e*this._accBinsSizeY,p=(e+1)*this._accBinsSizeY,b[0][0]=f,b[0][1]=m,b[1][0]=l,b[1][1]=m,b[2][0]=l,b[2][1]=p,b[3][0]=f,b[3][1]=p,a.fillText(h.length.toFixed(),f+5,m+15),this._drawPoly(a,b,"blue");a.fillText("total totalShownLabels: "+c,70,40)},_targetViewChanged:function(){this._deconflictLabelsTimeout()},
_deconflictLabelsTimeout:function(a){0===this._deconflictTimeoutId&&(this._deconflictTimeoutId=setTimeout(this._deconflictLabels.bind(this),a||200))},_deconflictLabels:function(){var c=this.view;this._deconflictTimeoutId=0;J.freeAll();var f=c.navigation.targetCamera,k=f.viewMatrix,n=1/Math.tan(f.fovX/2),q=f.projectionMatrix,S=f.fullWidth,ba=f.fullHeight;O.clear();for(var aa={},$=!1,Z=0;Z<this.layerViews.length;Z++){var M=this.layerViews[Z];if(null!=M.layerLabelsEnabled&&M.layerLabelsEnabled()&&!(null==
M.getGraphics3DGraphics||null==M.getGraphics3DGraphicsKeys)){$||(this._initBins(S,ba),$=!0);for(var V=M.getGraphics3DGraphics(),L=M.getGraphics3DGraphicsKeys(),U=0;U<L.length;U++){var N=V[L[U]];if(!(null==N._labelGraphics||1>N._labelGraphics.length)&&N.areVisibilityFlagsSet(void 0,"VISIBILITY_LABELMANAGER")){var Q=N._labelGraphics[0],P=Q.stageObject,X=P.getGeometryRecord(0);if(null!=X){var ca=X.materials[0];if(!(null==ca||!(ca instanceof b)||null==X.origin)){var c=k,P=P.getCenter(),Y=X.origin.vec3;
d.set4(P[0]-Y[0],P[1]-Y[1],P[2]-Y[2],1,s);e.translate(c,Y,H);c=H;e.multiplyVec4(c,s,r);for(var fa=X.geometry.getData().getVertexAttr()[l.AUXPOS1],Y=0;3>Y;Y++)r[Y]+=fa.data[Y];e.multiplyVec4(q,r,t);d.scale(t,1/Math.abs(t[3]),u);g.set2(m(0,S,0.5+0.5*u[0]),m(0,ba,0.5+0.5*u[1]),A);if(-1>u[0]||-1>u[1]||-1>u[2]||1<=u[0]||1<=u[1]){c=!1;for(X=0;X<N._labelGraphics.length;X++)c=c||N._labelGraphics[X].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);c&&(aa[M]=!0)}else{Y=ca.getParams();ca=X.geometry.getData().getVertexAttr()[l.SIZE].data;
g.subtract(Y.anchorPos,[0.5,0.5],v);g.scale(Y.screenOffset,0.5,C);X=J.alloc();if(Y.direction){var ea=h.set3(Q.geometry.normal[0],Q.geometry.normal[1],Q.geometry.normal[2],D),fa=h.normalize(h.subtract(f.eye,f.center,y),y),ia=h.normalize(h.set(Y.direction,E)),ha,Q=0;h.scale(ia,h.dot(ia,fa),z);h.subtract(fa,z,z);h.normalize(z);ha=Math.abs(h.dot(z,ea));0.985>Math.abs(h.dot(fa,ia))&&0.5>ha?0.422>ha?(fa=ia,ha=ea,Q=0.5):(fa=ia,ha=G,h.cross(ia,z,ha),Q=h.dot(ha,ea)/2):(fa=ia,ha=h.normalize(h.cross(ea,ia)));
ea=2*(h.dist(f.eye,P)/n/f.width);P=ea*Y.screenMinMaxSize[0];ia=ea*Y.screenMinMaxSize[1];Y.worldScale?(ea=1,0<P&&P>ca[1]&&(ea=P/ca[1]),0<ia&&ca[1]>ia&&(ea=ia/ca[1])):ea=0.5*t[3]/S;for(Y=0;4>Y;Y++)d.set(s,I),h.add(I,h.scale(fa,p[Y][0]*ca[0]*ea,x)),h.add(I,h.scale(ha,(p[Y][1]+Q)*ca[1]*ea,B)),e.multiplyVec4(c,I,y),P=e.multiplyVec4(q,y,x),d.scale(P,1/Math.abs(P[3]),P),X.positions[Y][0]=m(0,S,0.5+0.5*P[0]),X.positions[Y][1]=ba-m(0,ba,0.5+0.5*P[1])}else if(Y.worldScale){ea=2*(h.dist(f.eye,P)/n/f.width);
P=ea*Y.screenMinMaxSize[0];ia=ea*Y.screenMinMaxSize[1];ea=1;0<P&&P>ca[1]&&(ea=P/ca[1]);0<ia&&ca[1]>ia&&(ea=ia/ca[1]);for(Y=0;4>Y;Y++)w[0]=r[0]+(0.5*p[Y][0]-v[0])*ca[0]*ea,w[1]=r[1]+(0.5*p[Y][1]-v[1])*ca[1]*ea,P=e.multiplyVec4(q,w,y),d.scale(P,1/Math.abs(P[3]),P),X.positions[Y][0]=m(0,S,0.5+0.5*P[0])+C[0],X.positions[Y][1]=ba-m(0,ba,0.5+0.5*P[1])-C[1]}else{c=h.dist(f.eye,s);for(Y=0;4>Y;Y++)X.positions[Y][0]=A[0]+(0.5*p[Y][0]-v[0])*ca[0]+C[0],X.positions[Y][1]=ba-A[1]+(0.5*p[Y][1]+v[1])*ca[1]-C[1]}c=
r[2];N.areVisibilityFlagsSet("VISIBILITY_LABELMANAGER",void 0)&&(c*=0.7);X.labelId=O.length;X.xMin=Number.MAX_VALUE;X.yMin=Number.MAX_VALUE;X.xMax=-Number.MAX_VALUE;X.yMax=-Number.MAX_VALUE;for(ca=0;4>ca;ca++)X.xMin=Math.min(X.positions[ca][0],X.xMin),X.yMin=Math.min(X.positions[ca][1],X.yMin),X.xMax=Math.max(X.positions[ca][0],X.xMax),X.yMax=Math.max(X.positions[ca][1],X.yMax);X.labelGraphics=N._labelGraphics;X.c3dGraphic=N;X.posView=c;X.layerView=M;O.push(X)}}}}}}}O.sort(a);for(Z=0;Z<O.length;Z++){f=
O.data[Z];c=!1;M=f.layerView;if(this._doesIntersectExistingPoly(f))for(Y=0;Y<f.labelGraphics.length;Y++)c=c||f.labelGraphics[Y].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);else{this._addToBins(f);for(Y=0;Y<f.labelGraphics.length;Y++)c=c||f.labelGraphics[Y].setVisibilityFlag("VISIBILITY_LABELMANAGER",!0)}c&&f.c3dGraphic.isDraped()&&(aa[M]=!0);Object.keys(aa).forEach(function(a){a.emit&&a.emit("draped-data-change")})}}})})},"esri/views/3d/layers/GraphicsView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../layers/GraphicsView ./graphics/Graphics3DCore ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DElevationAlignment ../support/PromiseLightweight".split(" "),
function(q,n,k,f,c,b,a,e,h,g){return function(b){function m(a){b.call(this);this.elevation=this.spatialIndex=this.graphicsCore=null;this.supportsDraping=!0;this._overlayUpdating=!1;this._progressMaxNumNodes=0;this._eventHandles=null}k(m,b);Object.defineProperty(m.prototype,"graphics",{set:function(a){a!==this.loadedGraphics&&(this.loadedGraphics=a);this._set("graphics",a)},enumerable:!0,configurable:!0});m.prototype.initialize=function(){var b=this;this.loadedGraphics=this.graphics;this.graphicsCore=
new a;this.spatialIndex=new e;this.elevation=new h;this.supportsDraping=!0;this._overlayUpdating=!1;this._progressMaxNumNodes=0;this._eventHandles=[];this.mockLayerId="__sceneView.graphics-"+Date.now().toString(16);var c={id:this.mockLayerId};this.spatialIndex.initialize(this,c,this.view.spatialReference,this.graphicsCore);this.elevation.initialize(this,function(a,c,d){b.spatialIndex.intersects(a,c,d)},this.graphicsCore,this.view.basemapTerrain);this.graphicsCore.initialize(this,c,this.elevation,
null,this.spatialIndex,null,null,null,this.view.basemapTerrain);this._eventHandles.push(this.view.watch("clippingArea",function(){return b.updateClippingExtent()}));this.updateClippingExtent();this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate})};m.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.view.resourceController.deregisterIdleFrameWorker(this);this.spatialIndex&&
(this.spatialIndex.destroy(),this.spatialIndex=null);this.elevation&&(this.elevation.destroy(),this.elevation=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.loadedGraphics=null};m.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===c?(d=a,!0):!1});var e=new g.Promise;null!==d?e.done(d):e.reject();return e};m.prototype.whenGraphicBounds=function(a){return this.graphicsCore.whenGraphicBounds(a)};
m.prototype._needsIdleUpdate=function(){return this.elevation.needsIdleUpdate()};m.prototype._idleUpdate=function(a){this.elevation.idleUpdate(a)};m.prototype._notifySuspendedChange=function(){};m.prototype._notifyDrapedDataChange=function(){this.view.basemapTerrain&&this.view.basemapTerrain.overlayManager.setOverlayDirty()};m.prototype._evaluateUpdatingState=function(){if(this.elevation){var a;a=0+this.elevation.numNodesUpdating();a+=this.graphicsCore.numNodesUpdating();this.updating=a=(a=0<a||this._overlayUpdating)||
this.spatialIndex.isUpdating()}else this.updating=!1};m.prototype.updateClippingExtent=function(){this.graphicsCore.setClippingExtent(this.view.clippingArea,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()};f([c.property()],m.prototype,"graphics",null);f([c.property()],m.prototype,"loadedGraphics",void 0);f([c.property({value:!0})],m.prototype,"updating",void 0);f([c.property({value:!1})],m.prototype,"suspended",void 0);return m=f([c.subclass("esri.views.3d.layers.GraphicsView3D")],
m)}(c.declared(b))})},"esri/views/layers/GraphicsView":function(){define(["../../core/Accessor","../../core/declare"],function(q,n){return n([q],{declaredClass:"esri.views.layers.GraphicsView",graphics:null,renderer:null,view:null,getRenderer:function(k){if(!k||k.symbol)return null;var f=this._rndForScale||this.renderer;k&&(f&&f.getObservationRenderer)&&(f=f.getObservationRenderer(k));return f},getSymbol:function(k){if(k.symbol)return k.symbol;var f=this.getRenderer(k);return f&&f.getSymbol(k)},getRenderingInfo:function(k){var f=
this.getRenderer(k),c=this.getSymbol(k);if(!c)return null;c={renderer:f,symbol:c};if(f&&f.visualVariables){var b=this.view.view.state,f=f.getVisualVariableValues(k,{resolution:b.resolution,scale:b.scale});k=["proportional","proportional","proportional"];for(b=0;b<f.length;b++){var a=f[b],e=a.variable.type;"color"===e?c.color=a.value:"size"===e?a.variable.target?c.outlineSize=a.value:(e=a.variable.axis,a=a.variable.useSymbolValue?"symbolValue":a.value,"width"===e?k[0]=a:"depth"===e?k[1]=a:"height"===
e?k[2]=a:k[0]="width-and-depth"===e?k[1]=a:k[1]=k[2]=a):"opacity"===e?c.opacity=a.value:"rotation"===e&&(c.rotationAngle=a.value)}if(isFinite(k[0])||isFinite(k[1])||isFinite(k[2]))c.size=k}return c},_evalSDRenderer:function(k){}})})},"esri/views/3d/layers/graphics/Graphics3DCore":function(){define("require exports ../../../../core/watchUtils ../../../../core/arrayUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../support/projectionUtils ../../../../renderers/support/rendererConversion ../../../../geometry/Point ../../../../geometry/Extent ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Layer ../../webgl-engine/lib/FloatingBoxLocalOriginFactory ../../../../symbols/WebStyleSymbol ../../../../symbols/support/symbolConversion ../../lib/glMatrix ./Graphics3DGraphic ./Graphics3DSymbol ./Graphics3DWebStyleSymbol ./graphicUtils ../../support/aaBoundingBox ../../support/mathUtils dojo/Deferred".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A){q=u.vec3d;var w=new g,D=q.create(),E=b.getLogger("esri.views.3d.LayerView3D"),H=function(){return function(){this.localOriginFactory=this.layer=this.overlaySR=this.renderCoordsHelper=this.renderSpatialReference=this.clippingExtent=this.layerOrder=this.stage=this.renderer=this.elevationProvider=this.streamDataSupplier=this.sharedResources=null}}();return function(){function b(){this.graphics={};this.graphicsDrapedIds={};this.graphicsBySymbol=
{};this.graphicsKeys=[];this.symbols={};this.computedExtent=null;this.symbolCreationContext=new H;this.hasDraped=!1;this.updatingGraphicIds={};this.graphicTransformFunc=this.onComputedExtentChange=this.stage=this.labelStageLayer=this.stageLayer=this.tilingSchemeHandle=null;this.eventHandles=[];this.labeling=this.spatialIndex=this.scaleVisibility=this.elevation=this.layer=this.layerView=this.viewSR=null;this.whenGraphics3DGraphicRequests={}}b.prototype.initialize=function(a,c,d,e,h,g,f,l,m){var p=
this;this.layerView=a;this.layer=c;this.viewSR=a.view.spatialReference;this.elevation=d;this.scaleVisibility=e;this.spatialIndex=h;this.labeling=g;this.onComputedExtentChange=f;this.graphicTransformFunc=l;this.initializeStage(this.layerView.view,this.layer.id);this.symbolCreationContext.sharedResources=this.layerView.view.sharedSymbolResources;this.symbolCreationContext.renderer=this.layer.renderer;this.symbolCreationContext.stage=this.stage;this.symbolCreationContext.streamDataSupplier=this.layerView.view.sharedSymbolResources.streamDataSupplier;
this.symbolCreationContext.renderSpatialReference=this.layerView.view.renderSpatialReference;this.symbolCreationContext.renderCoordsHelper=this.layerView.view.renderCoordsHelper;this.symbolCreationContext.layer=this.layer;this.symbolCreationContext.layerView=this.layerView;this.symbolCreationContext.layerOrder=0;this.symbolCreationContext.localOriginFactory=b.createLocalOriginFactory();this.symbolCreationContext.elevationProvider=m;this.tilingSchemeHandle=k.when(m,"tilingScheme",function(a){a.spatialReference.equals(p.symbolCreationContext.overlaySR)||
(p.symbolCreationContext.overlaySR=m.spatialReference,p.recreateAllGraphics())});this.eventHandles.push(this.layerView.watch("suspended",function(){return p.suspendedChange()}));this.eventHandles.push(k.on(a,"loadedGraphics","change",function(a){return p.graphicsCollectionChanged(a)},function(){p.clearSymbolsAndGraphics();p.graphicsCollectionChanged({added:p.layerView.loadedGraphics.toArray(),removed:[]})}));this.validateRenderer(this.layer.renderer)};b.prototype.destroy=function(){var a=this;this.clear();
if(this.stage){var b=[this.stageLayer.getId()];this.labelStageLayer&&b.push(this.labelStageLayer.getId());this.stage.removeFromViewContent(b);b.forEach(function(b){return a.stage.remove(m.ModelContentType.LAYER,b)});this.stage=this.labelStageLayer=this.stageLayer=null}this.tilingSchemeHandle&&(this.tilingSchemeHandle.remove(),this.tilingSchemeHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.layerView=this.labeling=this.scaleVisibility=this.viewSR=this.onComputedExtentChange=
this.eventHandles=null;for(var d in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[d].reject(new c("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=null};b.prototype.clear=function(){var a=!1,b;for(b in this.graphics){var c=this.graphics[b];c&&(a=a||c.isDraped(),c.destroy())}this.graphics={};this.graphicsKeys=null;for(var d in this.symbols)(b=this.symbols[d])&&b.destroy();this.symbols={};this.graphicsBySymbol={};this.hasDraped=!1;a&&
this.layerView._notifyDrapedDataChange()};b.prototype.initializeStage=function(a,b){this.stage=a._stage;this.stageLayer=new p(b,{state:this.layerView.suspended?"HIDDEN":"VISIBLE"},b);this.stage.add(m.ModelContentType.LAYER,this.stageLayer);var c=[this.stageLayer.getId()];this.labeling&&(this.labelStageLayer=new p(b,{state:this.layerView.suspended?"HIDDEN":"IGNORED"},b+"_labels"),this.stage.add(m.ModelContentType.LAYER,this.labelStageLayer),c.push(this.labelStageLayer.getId()));this.stage.addToViewContent(c)};
b.prototype.setDrawingOrder=function(a){this.symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this.graphics)this.graphics[d].setDrawOrder(a,b,c);for(var e in c)this.symbols[e].setDrawOrder(a,b);l.objectEmpty(b)||(this.stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.layerView._notifyDrapedDataChange())};b.prototype.suspendedChange=function(){!0===this.layerView.suspended?(this.stageLayer.setState("HIDDEN"),this.labelStageLayer&&this.labelStageLayer.setState("HIDDEN"),this.hideAllGraphics()):
!1===this.layerView.suspended&&(this.stageLayer.setState("VISIBLE"),this.labelStageLayer&&this.labelStageLayer.setState("IGNORED"),this.updateAllGraphicsVisibility())};b.prototype.getGraphics3DGraphics=function(){return this.graphics};b.prototype.getGraphics3DGraphicById=function(a){return this.graphics[a]};b.prototype.getGraphics3DGraphicsKeys=function(){null===this.graphicsKeys&&(this.graphicsKeys=Object.keys(this.graphics));return this.graphicsKeys};b.prototype.numNodesUpdating=function(){return Object.keys(this.updatingGraphicIds).length};
b.prototype.whenGraphics3DGraphic=function(b){var c=this.graphics[b.uid];if(c)return a.resolve(c);c=this.whenGraphics3DGraphicRequests[b.uid];c||(c=new A,this.whenGraphics3DGraphicRequests[b.uid]=c);return c.promise};b.prototype.boundsForGraphics3DGraphic=function(a,b){void 0===b&&(b=B.create());var c=this.layerView.view.spatialReference,d=this.layerView.view.renderSpatialReference,h=this.layerView.view.basemapTerrain.spatialReference,g=a.getProjectedBoundingBox(function(a,b,h){return e.bufferToBuffer(a,
d,b,a,c,b,h)},function(a,b,d){return e.bufferToBuffer(a,h,b,a,c,b,d)},b);if(!g)return null;var f=a.isDraped(),l=this.symbolCreationContext.elevationProvider;f&&l&&(B.center(g,D),w.x=D[0],w.y=D[1],w.z=void 0,w.spatialReference=c,f=l.getElevation(w)||0,g[2]=Math.min(g[2],f),g[5]=Math.max(g[5],f));return g};b.prototype.whenGraphicBounds=function(a){var b=this;return k.whenOnce(this.layerView,"loadedGraphics").then(function(){if(b.layerView.loadedGraphics.some(function(b){return b===a}))return b.whenGraphics3DGraphic(a);
throw new c("internal:graphic-not-part-of-view","Graphic is not part of this view");}).then(function(a){return b.boundsForGraphics3DGraphic(a)})};b.prototype.graphicsCollectionChanged=function(a){var b=this.graphicTransformFunc?this.graphicTransformFunc(a.added):a.added;this.add(b);this.remove(a.removed)};b.prototype.graphicUpdateHandler=function(a){var b=this.graphics[a.graphic.uid];if(b)switch(a.property){case "visible":b.setVisibilityFlag("VISIBILITY_GRAPHIC",a.newValue)&&(b.isDraped()&&this.layerView._notifyDrapedDataChange(),
this.labeling&&this.layerView.view.labelManager.setDirty())}};b.prototype.beginGraphicUpdate=function(a){this.updatingGraphicIds[a.uid]=!0;this.layerView.get("symbols-updating")||this.layerView.set("symbols-updating",!0);this.layerView._evaluateUpdatingState()};b.prototype.endGraphicUpdate=function(a){a&&delete this.updatingGraphicIds[a.uid];this.layerView.get("symbols-updating")&&l.objectEmpty(this.updatingGraphicIds)&&(this.layerView.view.flushDisplayModifications(),this.layerView.set("symbols-updating",
!1));this.layerView._evaluateUpdatingState()};b.prototype.expandComputedExtent=function(a){var c,h,g,f,l,m;if("point"===a.type)c=h=a.x,g=f=a.y,a.z&&(l=m=a.z);else if("polygon"===a.type||"polyline"===a.type||"multipoint"===a.type){m=a.extent;if(!m)return;c=m.xmin;h=m.xmax;g=m.ymin;f=m.ymax;l=m.zmin;m=m.zmax}var p=this.viewSR,k=b.tmpVec;!a.spatialReference.equals(p)&&e.xyzToVector(c,g,0,a.spatialReference,k,p)&&(c=k[0],g=k[1],e.xyzToVector(h,f,0,a.spatialReference,k,p),h=k[0],f=k[1]);z.isFinite(c)&&
(z.isFinite(h)&&z.isFinite(g)&&z.isFinite(f))&&((p=this.computedExtent)?(p.xmin=Math.min(c,p.xmin),p.xmax=Math.max(h,p.xmax),p.ymin=Math.min(g,p.ymin),p.ymax=Math.max(f,p.ymax)):this.computedExtent=p=new d(c,g,h,f,a.spatialReference),z.isFinite(l)&&!z.isFinite(m)&&(p.zmin=null!=p.zmin?Math.min(l,p.zmin):l,p.zmax=null!=p.zmax?Math.max(m,p.zmax):m),this.onComputedExtentChange&&this.onComputedExtentChange())};b.prototype.updateHasDraped=function(){this.hasDraped=!1;for(var a in this.graphicsDrapedIds)if(this.graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=
!0;break}};b.prototype.elevationInfoChange=function(){this.labeling&&this.labeling.elevationInfoChange();for(var a in this.graphicsBySymbol){var b=this.symbols[a],c=this.graphicsBySymbol[a];if(!b||!b.layerPropertyChanged("elevationInfo",c))this.recreateSymbol(a);else for(var d in c)for(var e=c[d],b=e.graphic,e=e._labelGraphics,h=0;h<e.length;h++){var g=e[h];g.graphics3DSymbolLayer.updateGraphicElevationInfo(b,g)}}};b.prototype.clearSymbolsAndGraphics=function(){this.clear();this.elevation&&this.elevation.clear();
this.labeling&&this.labeling.clear()};b.prototype.recreateAllGraphics=function(){this.clearSymbolsAndGraphics();this.computedExtent=null;this.onComputedExtentChange&&this.onComputedExtentChange();this.layerView.loadedGraphics&&this.layerView.view.basemapTerrain.tilingScheme&&this.add(this.layerView.loadedGraphics.toArray())};b.prototype.recreateSymbol=function(a){var b=this.graphicsBySymbol[a],c=[],d=!1,e;for(e in b){var h=b[e];h.isDraped()&&(delete this.graphicsDrapedIds[e],d=!0);c.push(h.graphic);
h.destroy();this.graphics[e]=null}this.graphicsBySymbol[a]={};(b=this.symbols[a])&&b.destroy();this.symbols[a]=void 0;this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.add(c)};b.prototype.add=function(a){if(this.layerView.view.basemapTerrain&&this.layerView.view.basemapTerrain.tilingScheme){for(var b=a.length,c=Array(b),d=Array(b),e=Array(b),h=0;h<b;h++){var g=a[h],f=g.geometry;if(f&&(this.expandComputedExtent(f),(f=this.layerView.getRenderingInfo?this.layerView.getRenderingInfo(g):
{symbol:g.symbol})&&f.symbol))if(d[h]=f.symbol,e[h]=f,f=this.getOrCreateGraphics3DSymbol(d[h],f.renderer))c[h]=f,this.beginGraphicUpdate(g)}for(h=0;h<b;h++)this.waitForSymbol(c[h],d[h],a[h],e[h])}};b.prototype.waitForSymbol=function(a,b,c,d){var e=this;a&&a.then(function(){e.graphicsBySymbol[b.id]||(e.graphicsBySymbol[b.id]={});e.createGraphics3DGraphic(a,c,d);e.endGraphicUpdate(c);e.labeling&&e.layerView.view.labelManager.setDirty()},function(){e.endGraphicUpdate(c)})};b.prototype.remove=function(a){for(var b=
!1,c=a.length,d=0;d<c;d++){var e=a[d].uid,h=this.graphics[e];if(h){h.isDraped()&&(delete this.graphicsDrapedIds[e],b=!0);var g=h.graphics3DSymbol.symbol.id;h.destroy();delete this.graphics[e];delete this.graphicsBySymbol[g][e];this.graphicsKeys=null}}this.updateHasDraped();b&&this.layerView._notifyDrapedDataChange();this.labeling&&this.layerView.view.labelManager.setDirty()};b.prototype.createGraphics3DSymbol=function(a,b){var c=t.to3D(a,!0,!1);if(c.symbol){var d=void 0;if(b&&b.backgroundFillSymbol){var e=
t.to3D(b.backgroundFillSymbol,!1,!0);e.symbol&&(d=e.symbol.symbolLayers)}return new C(c.symbol,this.symbolCreationContext,d)}return null};b.prototype.getOrCreateGraphics3DSymbol=function(a,b){var c=this,d=this.symbols[a.id];void 0===d&&(d=a instanceof r?new y(a,function(a){return c.createGraphics3DSymbol(a,b)}):this.createGraphics3DSymbol(a,b),this.symbols[a.id]=d);return d};b.prototype.createGraphics3DGraphic=function(a,b,c){if(!this.graphics[b.uid]&&(c=a.createGraphics3DGraphic(b,c),this.labeling&&
this.labeling.layerLabelsEnabled()&&(c=this.labeling.createLabelsForGraphic(b,c)),this.graphics[b.uid]=c,this.graphicsKeys=null,this.graphicsBySymbol[a.symbol.id][b.uid]=c,c.initialize(this.stageLayer,this.labelStageLayer,this.stage),c.isDraped()&&(this.hasDraped=this.graphicsDrapedIds[b.uid]=!0,this.layerView._notifyDrapedDataChange()),c.centroid=null,"point"!==b.geometry.type&&c instanceof v&&(c.centroid=x.computeCentroid(b.geometry,this.viewSR)),a=this.scaleVisibility&&this.scaleVisibility.scaleRangeActive(),
this.spatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,a)&&this.spatialIndex.addGraphicToSpatialIndex(b,c),a&&this.scaleVisibility.updateGraphicScaleVisibility(b,c),c.setVisibilityFlag("VISIBILITY_GRAPHIC",b.visible&&!this.layerView.suspended),a=this.whenGraphics3DGraphicRequests[b.uid]))a.resolve(c),delete this.whenGraphics3DGraphicRequests[b.uid]};b.prototype.rendererChange=function(a){this.validateRenderer(a);this.symbolCreationContext.renderer=a;this.recreateAllGraphics()};b.prototype.opacityChange=
function(){var a=!1,b;for(b in this.graphicsBySymbol){var c=this.graphicsBySymbol[b];this.symbols[b].layerPropertyChanged("opacity");if(!a)for(var d in c)if(c[d].isDraped()){this.layerView._notifyDrapedDataChange();a=!0;break}}};b.prototype.setClippingExtent=function(a,b){var c=this.symbolCreationContext.clippingExtent,d=[];e.extentToBoundingRect(a,d,b)?this.symbolCreationContext.clippingExtent=[d[0],d[1],-Infinity,d[2],d[3],Infinity]:this.symbolCreationContext.clippingExtent=null;return!f.equals(this.symbolCreationContext.clippingExtent,
c)};b.prototype.updateAllGraphicsVisibility=function(){var a=this;if(this.layerView.loadedGraphics){var b=!1;this.layerView.loadedGraphics.forEach(function(c){var d=a.getGraphics3DGraphicById(c.uid);if(d){var e=d.setVisibilityFlag("VISIBILITY_GRAPHIC",c.visible);a.scaleVisibility&&(c=a.scaleVisibility.updateGraphicScaleVisibility(c,d),e=e||c);e&&d.isDraped()&&(b=!0)}});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};b.prototype.hideAllGraphics=function(){var a=
this;if(this.layerView.loadedGraphics){var b=!1;this.layerView.loadedGraphics.forEach(function(c){(c=a.getGraphics3DGraphicById(c.uid))&&c.setVisibilityFlag("VISIBILITY_GRAPHIC",!1)&&c.isDraped()&&(b=!0)});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};b.prototype.validateRenderer=function(a){(a=h.validateTo3D(a))&&E.warn("Renderer for layer '"+(this.layer.title?this.layer.title+", ":"")+", id:"+this.layer.id+"' is not supported in a SceneView",a.message)};
b.createLocalOriginFactory=function(){return new s(5E6,16)};b.tmpVec=u.vec3d.create();return b}()})},"esri/renderers/support/rendererConversion":function(){define(["require","exports","../../core/Error","../../symbols/support/symbolConversion"],function(q,n,k,f){function c(a,b){if(!b)return null;var c;c=Array.isArray(b)?b:[b];if(0<c.length){var d=c.map(function(a){return a.details.symbol.type||a.details.symbol.declaredClass}).filter(function(a){return!!a});d.sort();var f=[];d.forEach(function(a,b){(0===
b||a!==d[b-1])&&f.push(a)});return new k("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols ("+f.join(", ")+") which are not supported in 3D",{renderer:a,symbolErrors:c})}return null}function b(a){var b=a.uniqueValueInfos.map(function(a){return f.to3D(a.symbol).error}).filter(function(a){return!!a}),g=f.to3D(a.defaultSymbol);g.error&&b.unshift(g.error);return c(a,b)}function a(a){var b=a.classBreakInfos.map(function(a){return f.to3D(a.symbol).error}).filter(function(a){return!!a}),
g=f.to3D(a.defaultSymbol);g.error&&b.unshift(g.error);return c(a,b)}n.validateTo3D=function(e){return!e?null:"simple"===e.type?c(e,f.to3D(e.symbol).error):"uniqueValue"===e.type?b(e):"classBreaks"===e.type?a(e):new k("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '"+(e.type||e.declaredClass)+"'",{renderer:e})}})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports dojo/has ./IdGen ./Octree ./PerformanceTimer ./Util ./gl-matrix ./ModelContentType".split(" "),
function(q,n,k,f,c,b,a,e,h){var g=e.vec3d;return function(){function b(a,c,e){this._parentStages=[];this._children=[];this.id=b._idGen.gen(e);this.name=a;c=c||{};this.group=c.group||"";this.state=c.state||"VISIBLE";this.interaction=c.interaction||"PICKABLE";this.translation=g.create(c.translation);this._extent=[g.createFrom(0,0,0),g.createFrom(1E3,1E3,1E3)];this._extentDirty=!0}b.prototype.getId=function(){return this.id};b.prototype.getParentStages=function(){return this._parentStages};b.prototype.addParentStage=
function(a){-1===this._parentStages.indexOf(a)&&this._parentStages.push(a)};b.prototype.removeParentStage=function(a){a=this._parentStages.indexOf(a);-1<a&&this._parentStages.splice(a,1)};b.prototype.getName=function(){return this.name};b.prototype.getGroup=function(){return this.group};b.prototype.getState=function(){return this.state};b.prototype.getInteraction=function(){return this.interaction};b.prototype.getTranslation=function(){return this.translation};b.prototype.getObjectIds=function(){return this._children.map(function(a){return a.getId()})};
b.prototype.getObjects=function(){return this._children};b.prototype.setState=function(a){this.state=a};b.prototype.getExtent=function(){this._updateExtent();return this._extent};b.prototype.addObject=function(a){this._children.push(a);a.addParentLayer(this);this.notifyDirty("layObjectAdded",a);this._invalidateExtent();this._spatialAccelerator&&this._spatialAccelerator.add(a)};b.prototype.hasObject=function(a){return-1<this._children.indexOf(a)};b.prototype.removeObject=function(a){var b=this._children.indexOf(a);
return-1<b?(this._children.splice(b,1),a.removeParentLayer(this),this.notifyDirty("layObjectRemoved",a),this._invalidateExtent(),this._spatialAccelerator&&this._spatialAccelerator.remove(a),!0):!1};b.prototype.replaceObject=function(b,c){var d=this._children.indexOf(b);a.assert(-1<d,"Layer.replaceObject: layer doesn't contain specified object");this._children[d]=c;b.removeParentLayer(this);c.addParentLayer(this);this.notifyDirty("layObjectReplaced",[b,c]);this._invalidateExtent();this._spatialAccelerator&&
(this._spatialAccelerator.remove(b),this._spatialAccelerator.add(c))};b.prototype.notifyObjectBBChanged=function(a,b){this._spatialAccelerator&&this._spatialAccelerator.update(a,b)};b.prototype.getCenter=function(){this._updateExtent();var a=g.create();return g.lerp(this._extent[0],this._extent[1],0.5,a)};b.prototype.getBSRadius=function(){this._updateExtent();return 0.5*g.dist(this._extent[0],this._extent[1])};b.prototype.getSpatialQueryAccelerator=function(){if(this._spatialAccelerator)return this._spatialAccelerator;
if(50<this._children.length)return this._createOctree(),this._spatialAccelerator};b.prototype.notifyDirty=function(a,b,c,d){c=c||h.LAYER;d=d||this;for(var e=0;e<this._parentStages.length;e++)this._parentStages[e].notifyDirty(c,d,a,b)};b.prototype._createOctree=function(){for(var a=this.getExtent(),b=0,d=0;3>d;d++)b=Math.max(b,a[1][d]-a[0][d]);d=g.create();g.lerp(a[0],a[1],0.5,d);this._spatialAccelerator=new c(d,1.2*b);this._spatialAccelerator.add(this._children)};b.prototype._invalidateExtent=function(){this._extentDirty=
!0};b.prototype._updateExtent=function(){if(this._extentDirty)if(0===this._children.length)this._extent=[[0,0,0],[0,0,0]];else{var a=this._children[0];this._extent=[g.create(a.getBBMin()),g.create(a.getBBMax())];for(a=0;a<this._children.length;++a)for(var b=this._children[a],c=b.getBBMin(),b=b.getBBMax(),d=0;3>d;++d)this._extent[0][d]=Math.min(this._extent[0][d],c[d]),this._extent[1][d]=Math.max(this._extent[1][d],b[d]);this._extentDirty=!1}};b._idGen=new f;return b}()})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ./gl-matrix ./Util dojo/has ./PerformanceTimer".split(" "),
function(q,n,k,f,c,b){function a(a,b,c){c=c||a;c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c}function e(a,b){var c=a.indexOf(b);return-1!==c?(a.splice(c,1),b):null}var h=k.vec3d;q=function(){function b(a,c,d){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._autoResize=!0;this._outsiders=[];d&&(void 0!==d.maximumObjectsPerNode&&(this._maximumObjectsPerNode=d.maximumObjectsPerNode),void 0!==d.maximumDepth&&(this._maximumDepth=d.maximumDepth),void 0!==d.autoResize&&(this._autoResize=d.autoResize));
isNaN(a[0])||isNaN(a[1])||isNaN(a[2])||isNaN(c)?this._root=new g(null,h.createFrom(0,0,0),0.5):this._root=new g(null,a,c/2)}Object.defineProperty(b.prototype,"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"outsiders",{get:function(){return this._outsiders.slice()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"autoResize",{get:function(){return this._autoResize},enumerable:!0,configurable:!0});b.prototype.add=function(a){a=
this._objectOrObjectsArray(a);this._grow(a);for(var b=g.acquire(),c=0;c<a.length;c++){var d=a[c];b.init(this._root);0===d.getBSRadius()||isNaN(d.getBSRadius())||!this._autoResize&&!this._fitsInsideTree(this._boundingSphereFromObject(d,t))?this._outsiders.push(d):this._add(d,b)}g.release(b)};b.prototype.remove=function(a,b){for(var c=this._objectOrObjectsArray(a),d=g.acquire(),h=!0,f=0;f<c.length;f++){var h=c[f],l=this._boundingSphereFromObject(b||h,t);0===l.radius||isNaN(l.radius)||!this._autoResize&&
!this._fitsInsideTree(l)?h=null!=e(this._outsiders,h):(d.init(this._root),h=this._remove(h,l,d))}g.release(d);this._shrink();return h};b.prototype.update=function(a,b){this.remove(a,b);this.add(a)};b.prototype.forEachAlongRay=function(b,c,d){this._forEachTest(function(d){a(d.center,2*-d.halfSize,p);a(d.center,2*d.halfSize,s);return f.rayBoxTest(b,c,p,s)},d)};b.prototype.forEachInBoundingBox=function(a,b,c){this._forEachTest(function(c){for(var d=2*c.halfSize,e=0;3>e;e++)if(c.center[e]+d<a[e]||c.center[e]-
d>b[e])return!1;return!0},c)};b.prototype.forEachNode=function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})};b.prototype._forEachTest=function(a,b){this._outsiders.forEach(b);this._forEachNode(this._root,function(c){return a(c)?(c=c.node,c.terminals.forEach(b),null!==c.residents&&c.residents.forEach(b),!0):!1})};b.prototype._forEachNode=function(a,b){for(var c=g.acquire().init(a),d=[c];0!==d.length;){c=d.pop();if(b(c)&&!c.isLeaf())for(var e=0;e<c.node.children.length;e++)c.node.children[e]&&
d.push(g.acquire().init(c).advance(e));g.release(c)}};b.prototype._objectOrObjectsArray=function(a){Array.isArray(a)||(m[0]=a,a=m);return a};b.prototype._remove=function(a,b,c){r.length=0;c.advanceTo(b,function(a,b){r.push(a.node,b)})?(a=null!=e(c.node.terminals,a),c=0===c.node.terminals.length):(a=null!=e(c.node.residents,a),c=0===c.node.residents.length);if(c)for(c=r.length-2;0<=c&&this._purge(r[c],r[c+1]);c-=2);return a};b.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==
a.residents)return 0===a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0};b.prototype._purge=function(a,b){0<=b&&(a.children[b]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=[]),!0):!1};b.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,t))?b.node.terminals.push(a):(b.node.residents.push(a),b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))};b.prototype._split=function(a){var b=
a.node.residents;a.node.residents=null;for(var c=0;c<b.length;c++){var d=g.acquire().init(a);this._add(b[c],d);g.release(d)}};b.prototype._grow=function(a){if(0!==a.length&&this._autoResize&&(a=this._boundingSphereFromObjects(a,this._boundingSphereFromObject,u),!isNaN(a.radius)&&!(0===a.radius||this._fitsInsideTree(a))))if(this._nodeIsEmpty(this._root.node))h.set(a.center,this._root.center),this._root.halfSize=1.25*a.radius;else{var b=g.acquire();this._rootBoundsForRootAsSubNode(a,b);this._placingRootViolatesMaxDepth(b)?
this._rebuildTree(a,b):this._growRootAsSubNode(b);g.release(b)}};b.prototype._rebuildTree=function(a,b){var c=this;h.set(b.center,v.center);v.radius=b.halfSize;var d=this._boundingSphereFromObjects([a,v],function(a){return a},C),e=g.acquire().init(this._root);this._root.initFrom(null,d.center,1.25*d.radius);this._forEachNode(e,function(a){c.add(a.node.terminals);null!==a.node.residents&&c.add(a.node.residents);return!0});g.release(e)};b.prototype._placingRootViolatesMaxDepth=function(a){var b=0;this._forEachNode(this._root,
function(a){b=Math.max(b,a.depth);return!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};b.prototype._rootBoundsForRootAsSubNode=function(a,b){for(var c=a.radius,d=a.center,e=-Infinity,h=this._root.center,g=this._root.halfSize,f=0;3>f;f++){var m=d[f]+c-(h[f]+g),p=Math.max(0,Math.ceil((h[f]-g-(d[f]-c))/(2*g))),m=Math.max(0,Math.ceil(m/(2*g)))+1,k=Math.pow(2,Math.ceil(Math.log(p+m)*Math.LOG2E)),e=Math.max(e,k);y[f].min=p;y[f].max=m}for(f=0;3>f;f++)p=y[f].min,m=y[f].max,
c=(e-(p+m))/2,p+=Math.ceil(c),m+=Math.floor(c),l[f]=h[f]-g-2*p*g+(m+p)*g;return b.initFrom(null,l,e*g,0)};b.prototype._growRootAsSubNode=function(a){var b=this._root.node;h.set(this._root.center,u.center);u.radius=this._root.halfSize;this._root.init(a);a.advanceTo(u,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=b.terminals};b.prototype._shrink=function(){if(this._autoResize)for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=
0}};b.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;return c};b.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return a.radius<=c&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c};b.prototype._boundingSphereFromObject=function(a,b){h.set(a.getCenter(),
b.center);b.radius=a.getBSRadius();return b};b.prototype._boundingSphereFromObjects=function(a,b,c){if(1===a.length){var d=b(a[0],u);h.set(d.center,c.center);c.radius=d.radius}else{p[0]=Infinity;p[1]=Infinity;p[2]=Infinity;s[0]=-Infinity;s[1]=-Infinity;s[2]=-Infinity;for(var e=0;e<a.length;e++){var d=b(a[e],u),g=p,f=d.center,l=d.radius;g[0]=Math.min(g[0],f[0]-l);g[1]=Math.min(g[1],f[1]-l);g[2]=Math.min(g[2],f[2]-l);g=s;f=d.center;d=d.radius;g[0]=Math.max(g[0],f[0]+d);g[1]=Math.max(g[1],f[1]+d);g[2]=
Math.max(g[2],f[2]+d)}h.scale(h.add(p,s,c.center),0.5);c.radius=Math.max(s[0]-p[0],s[1]-p[1],s[2]-p[2])/2}return c};return b}();var g=function(){function a(b,c,d,e){void 0===d&&(d=0);this.center=h.create();this.initFrom(b,c,d,0)}a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};a.prototype.initFrom=function(b,c,d,e){void 0===b&&(b=null);void 0===d&&(d=this.halfSize);void 0===e&&(e=this.depth);this.node=b||a.createEmptyNode();c&&h.set(c,this.center);this.halfSize=
d;this.depth=e;return this};a.prototype.advance=function(b){var c=this.node.children[b];c||(c=a.createEmptyNode(),this.node.children[b]=c);this.node=c;this.halfSize/=2;this.depth++;b=d[b];this.center[0]+=b[0]*this.halfSize;this.center[1]+=b[1]*this.halfSize;this.center[2]+=b[2]*this.halfSize;return this};a.prototype.advanceTo=function(a,b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,-1),!1;this.isLeaf()&&(this.node.residents=null);
var d=this._childIndex(a);b&&b(this,d);this.advance(d)}};a.prototype.isLeaf=function(){return null!=this.node.residents};a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};a.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c};a.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:[],residents:[]}};a.acquire=function(){if(0===this._pool.length)return new a;var b=this._pool[this._pool.length-
1];this._pool.length--;return b};a.release=function(a){this._pool.push(a)};a._pool=[];return a}(),d=[[-1,-1,-1],[1,-1,-1],[-1,1,-1],[1,1,-1],[-1,-1,1],[1,-1,1],[-1,1,1],[1,1,1]],m=[null],l=h.create(),p=h.create(),s=h.create(),r=[],t={center:h.create(),radius:0},u={center:h.create(),radius:0},v={center:h.create(),radius:0},C={center:h.create(),radius:0},y=[{min:0,max:0},{min:0,max:0},{min:0,max:0}];return q})},"esri/views/3d/webgl-engine/lib/FloatingBoxLocalOriginFactory":function(){define(["require",
"exports","./gl-matrix"],function(q,n,k){var f=k.vec3d;q=function(){function b(a,b){this._origins=[];this._boxSize=a;this._maxNumOrigins=b}b.prototype.getOrigin=function(a){for(var e=this._origins.length,h,g=!1,d=Number.MAX_VALUE,m=0;m<e;m++){var l=this._origins[m];f.subtract(a,l.vec3,c);c[0]=Math.abs(c[0]);c[1]=Math.abs(c[1]);c[2]=Math.abs(c[2]);var p=c[0]+c[1]+c[2];p<d&&(h=l,d=p,g=c[0]<this._boxSize&&c[1]<this._boxSize&&c[2]<this._boxSize)}if(!g&&(!h||null==this._maxNumOrigins||this._origins.length<
this._maxNumOrigins))e=b.OFFSET,h={vec3:[a[0]+e,a[1]+e,a[2]+e],id:b.ORIGIN_PREFIX+this._origins.length},this._origins.push(h);return h};b.OFFSET=1.11;b.ORIGIN_PREFIX="fb_";return b}();var c=f.create();return q})},"esri/views/3d/layers/graphics/Graphics3DGraphic":function(){define(["../../../../core/declare","../../support/aaBoundingBox","../../support/aaBoundingRect"],function(q,n,k){var f=n.create(),c=k.create();return q(null,{constructor:function(b,a,c){this.graphics3DSymbol=a;this.graphic=b;this._graphics=
c;this._labelGraphics=[];this.addedToSpatialIndex=!1},initialize:function(b,a,c){var h=function(a,b){b&&b.initialize(a,c)};this._graphics.forEach(h.bind(this,b));a&&this._labelGraphics.forEach(h.bind(this,a))},addLabelGraphic:function(b){this._labelGraphics.push(b)},isDraped:function(){for(var b=0;b<this._graphics.length;b++){var a=this._graphics[b];if(a&&a.isDraped())return!0}return!1},areVisibilityFlagsSet:function(b,a){for(var c=!0,h=0;h<this._graphics.length;h++){var g=this._graphics[h];g&&(c=
c&&g.areVisibilityFlagsSet(b,a))}for(h=0;h<this._labelGraphics.length;h++)(g=this._labelGraphics[h])&&(c=c&&g.areVisibilityFlagsSet(b,a));return c},setVisibilityFlag:function(b,a){var c=!1,h=function(h){h&&(c=h.setVisibilityFlag(b,a)||c)};this._graphics.forEach(h);this._labelGraphics.forEach(h);return c},destroy:function(){var b=function(a){a&&a.destroy()};this._graphics.forEach(b);this._graphics.length=0;this._labelGraphics.forEach(b);this._labelGraphics.length=0},getBSRadius:function(){var b=0;
this._graphics.forEach(function(a){b=Math.max(b,a.getBSRadius())});return b},getCenterObjectSpace:function(){return this._graphics[0].getCenterObjectSpace()},getProjectedBoundingBox:function(b,a,e){e?n.set(e,n.NEGATIVE_INFINITY):e=n.create(n.NEGATIVE_INFINITY);for(var h=0;h<this._graphics.length;h++){var g=this._graphics[h];if(g){var d=g.isDraped()?a:b;g&&g.getProjectedBoundingBox(d,f)&&n.expand(e,g.isDraped()?n.toRect(f,c):f)}}return n.allFinite(e)||k.allFinite(n.toRect(e,c))?e:null},mustAlignToTerrain:function(){for(var b=
this._graphics.length,a=0;a<b;a++){var c=this._graphics[a];if(c&&c.mustAlignToTerrain())return!0}b=this._labelGraphics.length;for(a=0;a<b;a++)if((c=this._labelGraphics[a])&&c.mustAlignToTerrain())return!0;return!1},alignWithElevation:function(b,a){for(var c=this._graphics.length,h=0;h<c;h++){var g=this._graphics[h];g&&g.alignWithElevation(b,a)}c=this._labelGraphics.length;for(h=0;h<c;h++)(g=this._labelGraphics[h])&&this._labelGraphics[h].alignWithElevation(b,a)},setDrawOrder:function(b,a,c){c[this.graphics3DSymbol.symbol.id]=
!0;for(var h=this._graphics.length,g=0;g<h;g++){var d=this._graphics[g];d&&d.setDrawOrder(b+(1-(1+g)/h),a,c)}}})})},"esri/views/3d/layers/graphics/Graphics3DSymbol":function(){define(["../../../../core/declare","../../support/PromiseLightweight","./Graphics3DSymbolLayerFactory","./Graphics3DGraphic"],function(q,n,k,f){return q(n.Promise,{constructor:function(c,b,a){this.symbol=c;c=c.symbolLayers;a&&(c=a.concat(c));a=c.length;this.childGraphics3DSymbols=Array(c.length);this.childGraphics3DSymbolPromises=
Array(c.length);for(var e=b.layerOrder,h=0,g=0,d=!1,f=function(a,b){b&&(this.childGraphics3DSymbols[a]=b,g++);h--;!this.isRejected()&&(d&&1>h)&&(0<g?this.resolve():this.reject())},l=0;l<a;l++){var p=c.getItemAt(l);if(!1!==p.enabled&&(b.layerOrder=e+(1-(1+l)/a),b.layerOrderDelta=1/a,p=k.make(p,b,p._ignoreDrivers)))h++,this.childGraphics3DSymbolPromises[l]=p,p.then(f.bind(this,l,p),f.bind(this,l,null))}b.layerOrder=e;d=!0;!this.isRejected()&&1>h&&(0<g?this.resolve():this.reject())},createGraphics3DGraphic:function(c,
b,a){for(var e=Array(this.childGraphics3DSymbols.length),h=0;h<this.childGraphics3DSymbols.length;h++){var g=this.childGraphics3DSymbols[h];g&&(e[h]=g.createGraphics3DGraphic(c,b))}return new f(c,a||this,e)},layerPropertyChanged:function(c,b){for(var a=this.childGraphics3DSymbols.length,e=0;e<a;e++){var h=this.childGraphics3DSymbols[e];if(h&&!h.layerPropertyChanged(c,b,e))return!1}return!0},setDrawOrder:function(c,b){for(var a=this.childGraphics3DSymbols.length,e=1/a,h=0;h<a;h++){var g=this.childGraphics3DSymbols[h];
g&&g.setDrawOrder(c+(1-(1+h)/a),e,b)}},destroy:function(){this.isFulfilled()||this.reject();for(var c=0;c<this.childGraphics3DSymbolPromises.length;c++)this.childGraphics3DSymbolPromises[c]&&this.childGraphics3DSymbolPromises[c].destroy()}})})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayerFactory":function(){define("./Graphics3DIconSymbolLayer ./Graphics3DObjectSymbolLayer ./Graphics3DLineSymbolLayer ./Graphics3DPathSymbolLayer ./Graphics3DFillSymbolLayer ./Graphics3DExtrudeSymbolLayer ./Graphics3DTextSymbolLayer ../../webgl-engine/lib/Util".split(" "),
function(q,n,k,f,c,b,a,e){var h=e.assert,g={Icon:q,Object:n,Line:k,Path:f,Fill:c,Extrude:b,Text:a};return{make:function(a,b,c){var e=g[a.type];h(e,"unknown symbol type "+a.type);return new e(a,b,c)}}})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("../../../../core/declare dojo/_base/lang dojo/when ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./SignedDistanceFunctions ../../../../core/urlUtils ../../../../core/screenUtils ../../../../config ../../../../Color ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x){function B(a){return"cross"===a||"x"===a}function z(a){var b,c=I,d=c*O;"primitive:"===a.substring(0,10)&&(a=a.substring(10));switch(a){case J.PRIM_CIRCLE:b=h.computeSignedDistancefieldCicle(c,d);break;case J.PRIM_SQUARE:b=h.computeSignedDistancefieldSquare(c,d,!1);break;case J.PRIM_KITE:b=h.computeSignedDistancefieldSquare(c,d,!0);break;case J.PRIM_CROSS:b=h.computeSignedDistancefieldCrossAndX(c,d,!1);break;case J.PRIM_X:b=h.computeSignedDistancefieldCrossAndX(c,
d,!0)}return new y(b,"sdf_"+a,{mipmap:!1,wrapClamp:!0,width:I,height:I,components:4})}var A=r.vec3d,w=r.vec4d,D=r.mat4d.identity(),E=[0,0,1],H=[0,0,0,0],G="center bottom top left right bottom-left bottom-right top-left top-right".split(" "),I=128,O=0.5,J={PRIM_CIRCLE:"circle",PRIM_SQUARE:"square",PRIM_CROSS:"cross",PRIM_X:"x",PRIM_KITE:"kite"};q=q([f],{_prepareResources:function(){var a=this.symbol,b=null!=a.size?d.pt2px(a.size):16;this._size=null;this._symbolTextureRatio=1;this._primitive=null;var c=
this._getStageIdHint();this._isPropertyDriven("size")&&64>b&&(b=64);var e=a.resource||{primitive:"circle"},h={anchorPos:this._getAnchorPos(a)};if(e.href)h.color=this._getFillColor(a,null),h.outlineColor=this._getOutlineColor(a),h.outlineSize=this._getOutlineSize(a,null),h.textureIsSignedDistanceField=!1,this._prepareImageResources(e.href,b,h,c);else{var e=e.primitive||"circle",g="primitive:"+e;this._primitive=e;h.color=this._getFillColor(a,e);h.outlineColor=this._getOutlineColor(a);h.outlineSize=
this._getOutlineSize(a,e);B(e)&&0===h.outlineSize?this.reject():(this.texture=this._context.sharedResources.textures.acquire(g,z),this._textureURI=g,h.textureIsSignedDistanceField=!0,h.textureId=this.texture.getId(),this._createMaterialsAndAddToStage(h,this._context.stage,c),this._size=[b,b],this._symbolTextureRatio=1/O,this.resolve())}},_getOutlineDefaultSize:function(a){return B(a)?1.5:0},_getOutlineSize:function(a,b){return a.outline?null!=a.outline.size?d.pt2px(a.outline.size):this._getOutlineDefaultSize(b):
this._getOutlineDefaultSize(b)},_getOutlineColor:function(a){var b=this._getLayerOpacity();if(a.outline&&null!=a.outline.color){var c=l.toUnitRGB(a.outline.color);return[c[0],c[1],c[2],a.outline.color.a*b]}return[0,0,0,b]},_getFillColor:function(a,b){return B(b)?H:this._getMaterialOpacityAndColor()},_getAnchorPos:function(a){return-1<G.indexOf(a.anchor)?a.anchor:"center"},_prepareImageResources:function(a,b,c,d){var e=function(a){if(!this.isRejected()){var e=a.params,h=e.width/e.height;this._size=
b?1<h?[b,b/h]:[b*h,b]:[e.width,e.height];c.textureId=a.getId();this._createMaterialsAndAddToStage(c,this._context.stage,d);this.resolve()}}.bind(this),h="data:image/svg"===a.substring(0,14),f=".svg"===a.substring(a.length-4,a.length);if(!h&&!f)k(this._context.sharedResources.textures.acquire(a),e,function(){this.reject()}.bind(this)),this._textureURI=a;else{a=g.normalize(a);var l=new Image,f=!h&&g.hasSameOrigin(a,window.location.href);h||(f||g.canUseXhr(a)?f||(l.crossOrigin="anonymous"):m.request.proxyUrl&&
(a=m.request.proxyUrl+"?"+a));l.src=a;l.onerror=function(){this.reject()}.bind(this);l.onload=function(){var a=l.width,c=l.height,d=1;a&&c&&(d=a/c);null!=b&&(1<d?(a=b,c=Math.round(b/d)):(c=b,a=Math.round(b*d)));d=document.createElement("canvas");d.width=a;d.height=c;d.getContext("2d").drawImage(l,0,0,a,c);a=d.toDataURL();k(this._context.sharedResources.textures.acquire(a),e,function(){this.reject()});this.textureURI=a}.bind(this);l.onerror=function(){console.warn("Failed to create Icon primitive");
this.reject()}.bind(this)}},_createMaterialsAndAddToStage:function(a,b,c){var d=n.clone(a);d.occlusionTest=!1;d.shaderPolygonOffset=0;this._drapedMaterial=new x(d,c+"_iconDraped");b.add(t.ModelContentType.MATERIAL,this._drapedMaterial);a.occlusionTest=!0;this._material=new x(a,c+"_icon");b.add(t.ModelContentType.MATERIAL,this._material)},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._material.getId()),this._material=
null);this._drapedMaterial&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._drapedMaterial.getId()),this._drapedMaterial=null);this._textureURI&&(this._context.sharedResources.textures.release(this._textureURI),this._textureURI=null)},createGraphics3DGraphic:function(a,b,c){var h=a.geometry;"extent"===h.type&&(h=p.fromExtent(h));if("polyline"===h.type)h=e.placePointOnPolyline(h);else if("polygon"===h.type)h=e.placePointOnPolygon(h);else if("point"!==h.type)return this._logWarning("unsupported geometry type for icon symbol: "+
h.type),null;var g="graphic"+a.uid,f=1;if(this._isPropertyDriven("size")&&b.size){for(var l=0;3>l;l++)b.size[l]&&(b.size[l]=d.pt2px(b.size[l]));l=this._size[0]>this._size[1]?this._size[0]:this._size[1];isFinite(b.size[0])?f=b.size[0]/l:"symbolValue"===b.size[0]?f=1:isFinite(b.size[2])&&(f=b.size[2]/l)}b=this._getVertexOpacityAndColor(b);f*=this._symbolTextureRatio;f=[this._size[0]*f,this._size[1]*f];l=this._getGraphicElevationInfo(a);return l.mode===e.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,
h,b,f,l,g,a.uid,c):this._createAs3DShape(a,h,b,f,l,g,a.uid,c)},layerPropertyChanged:function(b,c,d){if("opacity"===b)return c=this._getFillColor(this.symbol,this._primitive),this._drapedMaterial.setParameterValues({color:c}),this._material.setParameterValues({color:c}),c=this._getOutlineColor(this.symbol),this._drapedMaterial.setParameterValues({outlineColor:c}),this._material.setParameterValues({outlineColor:c}),!0;if("elevationInfo"===b){var h=this._elevationInfo.mode;this._updateElevationInfo();
b=this._elevationInfo.mode;var g=e.ELEV_MODES;if(h===g.ON_THE_GROUND&&b===g.ON_THE_GROUND)return!0;if(h!==b&&(h===g.ON_THE_GROUND||b===g.ON_THE_GROUND))return!1;var h=this._context.elevationProvider,f=this._context.renderCoordsHelper,l=a.perObjectElevationAligner,m;for(m in c){var p=c[m],k=p._graphics[d];k&&(p=this._getGraphicElevationInfo(p.graphic),k.elevationAligner=b===g.RELATIVE_TO_GROUND?l:null,k.elevationInfo.set(p),l(k,h,f))}return!0}return!1},setDrawOrder:function(a,b,c){this._drapedMaterial&&
(this._drapedMaterial.setRenderPriority(a),c[this._drapedMaterial.getId()]=!0)},_defaultElevationInfoNoZ:{mode:e.ELEV_MODES.RELATIVE_TO_GROUND,offset:0},_getGraphicElevationInfo:function(a){var b=this.inherited(arguments);b.mode===e.ELEV_MODES.RELATIVE_TO_GROUND&&(0===b.offset&&!a.geometry.get("hasZ"))&&(b.offset=1/this._context.renderCoordsHelper.unitInMeters);return b},_createAs3DShape:function(b,d,h,g,f,l,m){b=v.createPointGeometry(E,null,h,g,null,w.createFrom(0,0,0,1));b=[new u(b,l)];l=e.createStageObjectForPoint.call(this,
d,b,[[this._material]],null,null,f,l,this._context.layer.id,m,!0);if(null===l)return null;m=null;f.mode===e.ELEV_MODES.RELATIVE_TO_GROUND&&(m=a.perObjectElevationAligner);f=new c(this,l,b,null,null,m,f);f.getScreenSize=function(a,b){return function(){return[a,b]}}(g[0]/this._symbolTextureRatio,g[1]/this._symbolTextureRatio);e.extendPointGraphicElevationInfo(f,d,this._context.elevationProvider);return f},_createAsOverlay:function(a,c,d,h,g,f,l){this._drapedMaterial.setRenderPriority(this._symbolLayerOrder);
a=A.create();s.pointToVector(c,a,this._context.overlaySR);a[2]=this._getDrapedZ();if((c=this._context.clippingExtent)&&!e.pointInBox2D(a,c))return null;d=v.createPointGeometry(E,a,d,h,!0);c=new C(d);c.material=this._drapedMaterial;c.center=a;c.bsRadius=0;c.transformation=D;c.name=f;c.uniqueName=f+"#"+d.id;f=new b(this,[c],null,null);f.getScreenSize=function(a,b){return function(){return[a,b]}}(h[0]/this._symbolTextureRatio,h[1]/this._symbolTextureRatio);return f}});q.VALID_ANCHOR_STRINGS=G;return q})},
"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("../../../../core/declare ../../../../core/Logger dojo/_base/lang ../../support/PromiseLightweight ./ElevationInfo ../../../../Color ./graphicUtils".split(" "),function(q,n,k,f,c,b,a){var e=new c,h=n.getLogger("esri.symbols.Symbol3D");return q([f.Promise],{constructor:function(a,b,e){this.symbol=a;this._context=b;this._symbolLayerOrder=b.layerOrder;this._symbolLayerOrderDelta=b.layerOrderDelta;this._elevationInfo=new c;this._updateDrivenProperties(e);
this._updateElevationInfo();this._prepareResources()},_logWarning:function(a){h.warn(a)},_prepareResources:function(a){throw Error("This is an abstract base class");},_defaultElevationInfoNoZ:{mode:c.MODES.ON_THE_GROUND,offset:0},_defaultElevationInfoZ:{mode:c.MODES.ABSOLUTE_HEIGHT,offset:0},_updateElevationInfo:function(){for(var a in this._elevationInfo)this._elevationInfo[a]=void 0;if(a=this._context.layer.elevationInfo)this._elevationInfo=k.mixin(this._elevationInfo,a);this.symbol.elevationInfo&&
(this._elevationInfo=k.mixin(this._elevationInfo,this.symbol.elevationInfo))},_getGraphicElevationInfo:function(a){a=a.geometry.hasZ?this._defaultElevationInfoZ:this._defaultElevationInfoNoZ;e.mode=this._elevationInfo.mode||a.mode;e.offset=null!=this._elevationInfo.offset?this._elevationInfo.offset:a.offset;e.featureExpression=this._elevationInfo.featureExpression;e.offset/=this._context.renderCoordsHelper.unitInMeters;return e},_getDrapedZ:function(){return-2},_updateDrivenProperties:function(a){var b=
{color:!1,opacity:!1,size:!1};if(!a&&(a=this._context.renderer))b.color=!!a.colorInfo,b.size=!!a.sizeInfo,a.visualVariables&&a.visualVariables.forEach(function(a){switch(a.type){case "color":var c,e;b.color=!0;if(a.colors)for(c=0;c<a.colors.length;c++)if((e=a.colors[c])&&(Array.isArray(e)&&3<e.length&&255!==e[3]||void 0!==e.a&&255!==e.a))b.opacity=!0;if(a.stops)for(c=0;c<a.stops.length;c++)if((e=a.stops[c].color)&&(Array.isArray(e)&&3<e.length&&255!==e[3]||void 0!==e.a&&255!==e.a))b.opacity=!0;break;
case "opacity":case "transparencyInfo":b.opacity=!0;break;case "size":b.size=!0}});this._drivenProperties=b},_isPropertyDriven:function(a){return this._drivenProperties[a]},_getLayerOpacity:function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var a=this._context.layer.opacity;return null==a?1:a},_getMaterialOpacity:function(){var a;a=1*this._getLayerOpacity();var b=this.symbol.material;b&&!this._isPropertyDriven("opacity")&&(a*=
b.color.a);return a},_getMaterialOpacityAndColor:function(){var c=this.symbol.material,d=this._getMaterialOpacity(),c=this._isPropertyDriven("color")||!c?null:b.toUnitRGB(c.color);return a.mixinColorAndOpacity(c,d)},_getVertexOpacityAndColor:function(b,c,e){var h=this._isPropertyDriven("color")?b.color:null;b=this._isPropertyDriven("opacity")?b.opacity:null;h=a.mixinColorAndOpacity(h,b);e&&(h[0]*=e,h[1]*=e,h[2]*=e,h[3]*=e);return c?new c(h):h},_getStageIdHint:function(){return this._context.layer.id+
"_symbol"},setDrawOrder:function(a,b,c){this._material&&(this._material.setRenderPriority(a),c[this._material.getId()]=!0)},createGraphics3DGraphic:function(a,b){throw Error("This is an abstract base class");},destroy:function(){throw Error("This is an abstract base class");}})})},"esri/views/3d/layers/graphics/ElevationInfo":function(){define(["dojo/_base/lang"],function(q){var n=function(k){k?this.set(k):(this.mode=null,this.offset=0,this.featureExpression=null)};n.prototype.set=function(k){this.mode=
k.mode;this.offset=k.offset;this.featureExpression=k.featureExpression?q.clone(k.featureExpression):null};n.MODES={ABSOLUTE_HEIGHT:"absolute-height",RELATIVE_TO_GROUND:"relative-to-ground",ON_THE_GROUND:"on-the-ground"};return n})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../geometry/SpatialReference ../../../../geometry/Point ../../../../geometry/support/webMercatorUtils ../../lib/glMatrix".split(" "),function(q,n,k,f,c,b){function a(a,b){var d=a.spatialReference;
d.equals(b)||(d.isWebMercator&&b.wkid===k.WGS84.wkid?c.webMercatorToGeographic(a,!1,a):b.isWebMercator&&d.wkid===k.WGS84.wkid&&c.geographicToWebMercator(a,!1,a))}var e=b.vec4d;n.computeCentroid=function(b,c){if("extent"===b.type)return b.center;for(var d=b["polygon"===b.type?"rings":"paths"],e=0,l=0,p=0,k=b.hasZ,r=0,t=0;t<d.length;t++){for(var u=d[t],n=0;n<u.length;n++)e+=u[n][0],l+=u[n][1],k&&(p+=u[n][2]);r+=u.length}d=new f({x:e/r,y:l/r,z:k?p/r:void 0,spatialReference:b.spatialReference});c&&a(d,
c);return d};n.convertToSR=a;n.enlargeExtent=function(a,b,c){if(a){b||(b=e.create());var f=0.5*a.width*(c-1);c=0.5*a.height*(c-1);a.width<1E-7*a.height?f+=c/20:a.height<1E-7*a.width&&(c+=f/20);e.set4(a.xmin-f,a.ymin-c,a.xmax+f,a.ymax+c,b);return b}return null};n.updateVertexAttributeAuxpos1w=function(a,b){for(var c=0;c<a.geometries.length;++c){var e=a.geometries[c].data.vertexAttributes.auxpos1;e&&e.data[3]!==b&&(e.data[3]=b,a.geometryVertexAttrsUpdated(c))}};n.mixinColorAndOpacity=function(a,b){var c=
[1,1,1,1];null!=a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);null!==b&&void 0!==b?c[3]=b:null!=a&&3<a.length&&(c[3]=a[3]);return c};n.overrideColor=function(a,b,c,e,f){f=f.slice();for(var p=0;3>p;++p)a&&null!=a[p]?f[p]=a[p]:c&&null!=c[p]&&(f[p]=c[p]);null!=b?f[3]=b:null!=e&&(f[3]=e);return f}})},"esri/views/3d/layers/graphics/Graphics3DGraphicLayer":function(){define(["../../../../core/declare","./ElevationInfo","../../webgl-engine/Stage","../../support/aaBoundingBox","../../lib/glMatrix"],function(q,n,k,f,
c){var b=c.vec3d,a=c.mat4d,e=q(null,{constructor:function(a,b,c,h,f,g,k,n){this.graphics3DSymbolLayer=a;this.uniqueMaterials=h;this.uniqueGeometries=c;this.uniqueTextures=f;this.stageObject=b;this.elevationAligner=g;this.elevationInfo=new d(k);this.stageLayer=this.stage=null;this._shown=!1;this._visibilityFlags={};this.visibilityMode=null!=n?n:e.VisibilityModes.HIDE_FACERANGE},initialize:function(a,b){this.stageLayer=a;this.stage=b;var c;if(this.uniqueMaterials)for(c=0;c<this.uniqueMaterials.length;c++)b.add(k.ModelContentType.MATERIAL,
this.uniqueMaterials[c]);if(this.uniqueGeometries)for(c=0;c<this.uniqueGeometries.length;c++)b.add(k.ModelContentType.GEOMETRY,this.uniqueGeometries[c]);if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)b.add(k.ModelContentType.TEXTURE,this.uniqueTextures[c]);b.add(k.ModelContentType.OBJECT,this.stageObject)},isDraped:function(){return!1},areVisibilityFlagsSet:function(a,b){for(var c=!0,d=Object.keys(this._visibilityFlags),e=0;e<d.length;e++){var h=d[e];if(h!==b){if(h===a)return this._visibilityFlags[h];
c=c&&this._visibilityFlags[h]}}return c},setVisibilityFlag:function(a,b){this._visibilityFlags[a]=b;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){if(null!=this.stage){var a=this.areVisibilityFlagsSet();return this._shown!=a?((this._shown=a)?this.stageLayer.hasObject(this.stageObject)?this.stageObject.unhideAllFaceRange():this.stageLayer.addObject(this.stageObject):this.visibilityMode===e.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllFaceRanges():this.stageLayer.removeObject(this.stageObject),
!0):!1}},destroy:function(){if(this.stageLayer){var a,b=this.stage;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.remove(k.ModelContentType.MATERIAL,this.uniqueMaterials[a].getId());if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)b.remove(k.ModelContentType.GEOMETRY,this.uniqueGeometries[a].getId());if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.remove(k.ModelContentType.TEXTURE,this.uniqueTextures[a].getId())}b.remove(k.ModelContentType.OBJECT,
this.stageObject.getId());this.stageLayer.hasObject(this.stageObject)&&this.stageLayer.removeObject(this.stageObject);this._shown=!1;this.stage=this.stageLayer=null},mustAlignToTerrain:function(){return this.elevationInfo.mode!==n.MODES.ABSOLUTE_HEIGHT},alignWithElevation:function(a,b){this.elevationAligner&&this.elevationAligner(this,a,b)},setDrawOrder:function(){},getBSRadius:function(){return this.stageObject.getBSRadius()},getCenterObjectSpace:function(){return this.stageObject.getCenter(!0)},
getBoundingBoxObjectSpace:function(a){var b=this.stageObject;a||(a=f.create());f.setMin(a,b.getBBMin(!0));f.setMax(a,b.getBBMax(!0));return a},getProjectedBoundingBox:function(b,c){var d=this.getBoundingBoxObjectSpace(c),e=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],k;for(k=0;k<e.length;k++){var t=e[k];g[0]=d[t[0]];g[1]=d[t[1]];g[2]=d[t[2]];a.multiplyVec3(this.stageObject.objectTransformation,g);h[3*k+0]=g[0];h[3*k+1]=g[1];h[3*k+2]=g[2]}if(b(h,0,8)){f.set(d,f.NEGATIVE_INFINITY);
for(k=0;k<h.length;k+=3)for(e=0;3>e;e++)d[e]=Math.min(d[e],h[k+e]),d[e+3]=Math.max(d[e+3],h[k+e]);return d}return null},getScreenSize:function(){throw Error("Not implemented for this symbol layer/graphic type");}});e.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1};var h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=b.create(),d=function(a){n.call(this,a);this.centerPointInElevationSR=null};d.prototype=new n;d.prototype.constructor=d;return e})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define(["../../../../core/declare",
"../../webgl-engine/Stage","../../webgl-engine/lib/Util","../../support/aaBoundingRect","../../support/aaBoundingBox"],function(q,n,k,f,c){var b=k.assert;q=q(null,{constructor:function(a,b,c,e,f){this.graphics3DSymbolLayer=a;this.renderGeometries=b;this.uniqueMaterials=c;this.uniqueTextures=e;this.boundingBox=f;this.stage=null;this._visibilityFlags={};this._shown=!1},initialize:function(a,b){this.stage=b;var c;if(this.uniqueMaterials)for(c=0;c<this.uniqueMaterials.length;c++)b.add(n.ModelContentType.MATERIAL,
this.uniqueMaterials[c]);if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)b.add(n.ModelContentType.TEXTURE,this.uniqueTextures[c])},isDraped:function(){return!0},areVisibilityFlagsSet:function(a,b){for(var c=!0,e=Object.keys(this._visibilityFlags),f=0;f<e.length;f++){var p=e[f];if(p!==b){if(p===a)return this._visibilityFlags[p];c=c&&this._visibilityFlags[p]}}return c},setVisibilityFlag:function(a,b){this._visibilityFlags[a]=b;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){var a=
this.areVisibilityFlagsSet();return this._shown!=a?(this._shown=a,b(this.stage,"Graphics3DDrapedGraphicLayer must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1},destroy:function(){if(this.stage){var a,b=this.stage;this._shown&&b.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(a=
0;a<this.uniqueMaterials.length;a++)b.remove(n.ModelContentType.MATERIAL,this.uniqueMaterials[a].getId());if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.remove(n.ModelContentType.TEXTURE,this.uniqueTextures[a].getId());this.stage=null}},mustAlignToTerrain:function(){return!1},alignWithElevation:function(){},setDrawOrder:function(a,b,c){this.uniqueMaterials&&this.uniqueMaterials.forEach(function(c){c.setRenderPriority(a);this._shown&&(b[c.getId()]=!0)}.bind(this))},getBSRadius:function(){var a=
0;this.renderGeometries.forEach(function(b){a=Math.max(a,b.bsRadius)});return a},getCenterObjectSpace:function(){return[0,0,0]},getProjectedBoundingBox:function(b,e){c.set(e,c.NEGATIVE_INFINITY);for(var d=0;d<this.renderGeometries.length;d++)this._getRenderGeometryProjectedBoundingRect(this.renderGeometries[d],a,b),c.expand(e,a);return e},_getRenderGeometryProjectedBoundingRect:function(a,b,d){if(this.boundingBox)c.set(e,this.boundingBox);else{var f=a.center;a=a.bsRadius;e[0]=f[0]-a;e[1]=f[1]-a;e[2]=
f[2]-a;e[3]=f[0]+a;e[4]=f[1]+a;e[5]=f[2]+a}d(e,0,2);return c.toRect(e,b)}});var a=f.create(),e=[0,0,0,0,0,0];return q})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define("../../../../geometry/Point ../../lib/glMatrix ../../support/projectionUtils ../../webgl-engine/lib/Util ./Graphics3DSymbolCommonCode ./graphicUtils".split(" "),function(q,n,k,f,c,b){var a=f.VertexAttrConstants;n=n.vec3d;var e=new q,h=n.create(),g=n.create(),d=n.create(),m={perVertexElevationAligner:function(b,
f,k){var r=b.stageObject;b=b.elevationInfo;e.spatialReference=f.spatialReference;for(var t=r.getGeometryRecords(),u=t.length,n=0;n<u;n++){var q=t[n].geometry,y=t[n].transformation;g[0]=y[12];g[1]=y[13];g[2]=y[14];q.invalidateBoundingInfo();for(var y=q.getData().getVertexAttr(),q=y[a.POSITION].data,y=y.mapPos.data,x=q.length/2,B=0,z=0,A=!1,w=0;w<x;w++){e.x=y[z++];e.y=y[z++];e.z=y[z++];d[0]=q[B];d[1]=q[B+1];d[2]=q[B+2];var D=c.computeElevation(f,e,b);h[0]=q[B]+g[0];h[1]=q[B+1]+g[1];h[2]=q[B+2]+g[2];
k.setAltitude(D,h,0);q[B]=h[0]-g[0];q[B+1]=h[1]-g[1];q[B+2]=h[2]-g[2];D=m.updateThresholdInMeters/k.unitInMeters;if(Math.abs(d[0]-q[B])>=D||Math.abs(d[1]-q[B+1])>=D||Math.abs(d[2]-q[B+2])>=D)A=!0;B+=3}A&&r.geometryVertexAttrsUpdated(n)}},perObjectElevationAligner:function(a,d,e){var f=a.elevationInfo,g=f.centerPointInElevationSR,u=0;if(a.stageObject.metadata.usesVerticalDistanceToGround){var n={verticalDistanceToGround:0},u=c.computeElevation(d,g,f,n);b.updateVertexAttributeAuxpos1w(a.stageObject,
n.verticalDistanceToGround)}else u=c.computeElevation(d,g,f);d=a.stageObject.getObjectTransformation();f=[d[12],d[13],d[14]];m.iterativeUpdatesEnabled?e.setAltitudeOfTransformation(u,d):(h[0]=g.x,h[1]=g.y,h[2]=u,k.computeLinearTransformation(g.spatialReference,h,d,e.spatialReference)&&a.stageObject.setObjectTransformation(d));e=m.updateThresholdInMeters/e.unitInMeters;(Math.abs(d[12]-f[0])>=e||Math.abs(d[13]-f[1])>=e||Math.abs(d[14]-f[2])>=e)&&a.stageObject.setObjectTransformation(d)},updateThresholdInMeters:0.01,
iterativeUpdatesEnabled:!0};return m})},"esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode":function(){define("../../../../geometry/Point ../../../../geometry/support/mathUtils ./graphicUtils ./ElevationInfo ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Object3D".split(" "),function(q,n,k,f,c,b,a){var e=b.mat4d,h=b.vec3d.create(),g=e.identity(),d={x:0,y:0,z:0,spatialReference:null},m={createStageObjectForPoint:function(b,c,d,e,f,k,n,q,y,x){var B=c?c.length:0,z=this._context.clippingExtent;
m.reprojectPoint(b,h,this._context.elevationProvider.spatialReference);if(z&&!m.pointInBox2D(h,z))return null;m.reprojectPoint(b,h,this._context.renderSpatialReference);z=this._context.localOriginFactory.getOrigin(h);n=new a({castShadow:!1,metadata:{layerId:q,graphicId:y,usesVerticalDistanceToGround:void 0===x?!1:x},idHint:n});for(q=0;q<B;q++)n.addGeometry(c[q],d[q],e?e[q]:g,f,z);m.setObjectElevation(n,b,k,this._context.renderSpatialReference,this._context.elevationProvider);return n},extendPointGraphicElevationInfo:function(a,
b,c){a=a.elevationInfo;c=c.spatialReference;m.reprojectPoint(b,h,c);a.centerPointInElevationSR={x:h[0],y:h[1],z:b.hasZ?h[2]:void 0,spatialReference:c}},placePointOnPolyline:function(a){var b=a.paths[0],b=n.getPointOnPath(b,n.getPathLength(b)/2);return new q(b[0],b[1],b[2],a.spatialReference)},placePointOnPolygon:function(a){return k.computeCentroid(a)},computeElevation:function(a,b,c,d){var e=0,h=b.z||0,g=0,g=c.mode,m=c.offset||0;g===f.MODES.ON_THE_GROUND?(e=g=a.getElevation(b)||0,d&&(d.verticalDistanceToGround=
0)):g===f.MODES.RELATIVE_TO_GROUND?(g=a.getElevation(b)||0,e=m,null==c.featureExpression&&(e+=h),d&&(d.verticalDistanceToGround=e),e+=g):g===f.MODES.ABSOLUTE_HEIGHT&&(e=h+m,d&&(g=a.getElevation(b)||0,d.verticalDistanceToGround=e-g));return e},applyElevation:function(a,b,c,e,h,g,m){var k=m.mode,n=m.offset,x=0,x=0;d.spatialReference=a.spatialReference;c*=3;h*=3;for(var q=0;q<g;++q)d.x=b[c+0],d.y=b[c+1],d.z=b[c+2],k===f.MODES.ON_THE_GROUND?x=a.getElevation(d)||0:k===f.MODES.RELATIVE_TO_GROUND?(x=a.getElevation(d)||
0,x+=n,null==m.featureExpression&&(x+=d.z)):k===f.MODES.ABSOLUTE_HEIGHT&&(x=d.z+n),e[h+0]=b[c+0],e[h+1]=b[c+1],e[h+2]=x,c+=3,h+=3},setObjectElevation:function(a,b,d,e,f){var g=0;if(a.metadata.usesVerticalDistanceToGround){var n={verticalDistanceToGround:0},g=m.computeElevation(f,b,d,n);k.updateVertexAttributeAuxpos1w(a,n.verticalDistanceToGround)}else g=m.computeElevation(f,b,d);d=a.getObjectTransformation();h[0]=b.x;h[1]=b.y;h[2]=g;c.computeLinearTransformation(b.spatialReference,h,d,e)?a.setObjectTransformation(d):
console.warn("Could not locate symbol object properly, it might be misplaced")},getSingleSizeDriver:function(a){return isFinite(a[0])?a[0]:null},isCounterClockwise:function(a){for(var b=0,c=a.length-1,d=0;d<c;d++)b+=a[d][0]*a[d+1][1]-a[d+1][0]*a[d][1];return 0<=b},copyPointData:function(a,b,c,d,e,h){d*=3;for(var f=0;f<e;++f){var g=a[b++];c[d++]=g[0];c[d++]=g[1];c[d++]=h?g[2]:0}return d/3},copyPathData:function(a,b){for(var c=a.length,d=Array(c),e=Array(c),h=Array(c),f=0,g=0,k=0,n=0,q=0;q<c;++q)n+=
a[q].length;for(var n=new Float64Array(3*n),z=0,A=c-1;0<=A;A--){var w=a[A];if(m.isCounterClockwise(w))d[f++]=w;else{for(var D=w.length,q=0;q<f;++q)D+=d[q].length;q={index:z,pathLengths:Array(f+1),count:D,holeIndices:Array(f)};q.pathLengths[0]=w.length;0<w.length&&(h[k++]={index:z,count:w.length});z=m.copyPointData(w,0,n,z,w.length,b);for(w=0;w<f;++w)D=d[w],q.holeIndices[w]=z,q.pathLengths[w+1]=D.length,0<D.length&&(h[k++]={index:z,count:D.length}),z=m.copyPointData(D,0,n,z,D.length,b);f=0;0<q.count&&
(e[g++]=q)}}for(w=0;w<f;++w)D=d[w],0<D.length&&(h[k++]={index:z,count:D.length}),z=m.copyPointData(D,0,n,z,D.length,b);g<c&&(e.length=g);k<c&&(h.length=k);return{vertexData:n,polygons:e,outlines:h}},copyVertices:function(a,b,c,d,e){b*=3;d*=3;for(var h=0;h<e;++h)c[d++]=a[b++],c[d++]=a[b++],c[d++]=a[b++]},chooseOrigin:function(a,b,c,d){b=Math.floor(b+(c-1)/2);d[0]=a[3*b+0];d[1]=a[3*b+1];d[2]=a[3*b+2]},subtractCoordinates:function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b++]-=d[0],a[b++]-=d[1],a[b++]-=d[2]},
setZ:function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]=d,b+=3},offsetZ:function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]+=d,b+=3},scaleZ:function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]*=d,b+=3},flatArrayToArrayOfArrays:function(a,b,c){var d=[];b*=3;for(var e=0;e<c;++e)d.push([a[b++],a[b++],a[b++]]);return d},reproject:function(a,b,d,e,h,f,g){c.bufferToBuffer(a,d,b,e,f,h,g)},reprojectPoint:function(a,b,d){c.pointToVector(a,b,d)},getGeometryVertexData3D:function(a,b,c,d,e,h){var f=e.spatialReference;
a=m.copyPathData(a,b);b=a.vertexData;var g=b.length/3,k=new Float64Array(b.length);c.equals(f)?m.copyVertices(b,0,k,0,b.length):m.reproject(b,0,c,k,0,f,g);m.applyElevation(e,k,0,b,0,g,h);f.equals(d)||m.reproject(b,0,f,b,0,d,g);return{geometryData:a,vertexData:b,eleVertexData:k}},getGeometryVertexDataDraped:function(a,b,d){a=m.copyPathData(a,!1);var e=a.vertexData,h=e.length/3;b.equals(d)||c.bufferToBuffer(e,b,0,e,d,0,h);return{geometryData:a,vertexData:e}},computeBoundingBox:function(a,b,c,d){d[0]=
Number.MAX_VALUE;d[1]=Number.MAX_VALUE;d[2]=Number.MAX_VALUE;d[3]=-Number.MAX_VALUE;d[4]=-Number.MAX_VALUE;d[5]=-Number.MAX_VALUE;b*=3;for(var e=0;e<c;++e){var h=a[b++],f=a[b++],g=a[b++];h<d[0]&&(d[0]=h);f<d[1]&&(d[1]=f);g<d[2]&&(d[2]=g);h>d[3]&&(d[3]=h);f>d[4]&&(d[4]=f);g>d[5]&&(d[5]=g)}return d},pointInBox2D:function(a,b){return!(a[0]>b[3]||a[0]<b[0]||a[1]>b[4]||a[1]<b[1])},boxesIntersect2D:function(a,b){return!(b[0]>a[3]||b[3]<a[0]||b[1]>a[4]||b[4]<a[1])},boundingBoxClipped:function(a,b){return b?
!m.boxesIntersect2D(a,b):!1},ELEV_MODES:f.MODES};return m})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ./IdGen ./Util ./gl-matrix ./ModelContentType ./IntervalUtilities ./GeometryRecord".split(" "),function(q,n,k,f,c,b,a,e){var h=f.assert,g=c.mat4d,d=c.vec3d,m=f.VertexAttrConstants;q=function(){function c(a){void 0===a&&(a={});this.hiddenIndexRanges={};this.visibleIndexRanges={};this._bvObjectSpace=new l;this._bvWorldSpace=new l;this._bvDirty=!0;this.id=c._idGen.gen(a.idHint);
this.name=a.name;this.castShadow=null!=a.castShadow?a.castShadow:!0;this.metadata=a.metadata;this.objectTransformation=g.identity();this._initializeGeometryRecords(a.geometries,a.materials,a.transformations,a.instanceParameters)}c.prototype._initializeGeometryRecords=function(a,b,c,d){if(Array.isArray(a)){h(b.length===a.length,"Object3D: materials don't match geometries");h(c.length===a.length,"Object3D: transformations don't match geometries");this.geometryRecords=Array(a.length);this.geometries=
a.slice();for(var f=0;f<a.length;f++)h(Array.isArray(b[f]),"Object3D: materials parameter must be array of array"),this.geometryRecords[f]=new e(a[f],b[f].slice(),g.create(c[f]),d?d.slice():null)}else this.geometryRecords=[],this.geometries=[]};c.prototype.getId=function(){return this.id};Object.defineProperty(c.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){h(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,
configurable:!0});c.prototype.getParentLayer=function(){return this.parentLayer};c.prototype.addParentLayer=function(a){this.parentLayer=a};c.prototype.removeParentLayer=function(a){this.parentLayer=null};c.prototype.getNumGeometryRecords=function(){return this.geometryRecords.length};c.prototype.getFirstGeometryIndex=function(a){a=this.geometries.indexOf(a);h(-1<a,"Object3D.getFirstGeometryIndex: geometry not found");return a};c.prototype.findGeometryRecords=function(a){for(var b=[],c=0;c<this.geometries.length;c++)this.geometries[c]===
a&&b.push(this.geometryRecords[c]);return b};c.prototype.getGeometryRecord=function(a){h(0<=a&&a<this.geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this.geometryRecords[a]};c.prototype.getGeometryRecords=function(){return this.geometryRecords};c.prototype.addGeometry=function(a,b,c,d,f){h(Array.isArray(b),"Object3D.addGeometry: materials must be array");this.geometries.push(a);a=new e(a,b.slice(),g.create(c),d,f);this.geometryRecords.push(a);this._notifyDirty("objGeometryAdded",
a);this._invalidateBoundingVolume();return a};c.prototype.hasGeometry=function(a){return-1<this.geometries.indexOf(a)};c.prototype.removeGeometry=function(a){var b=this.geometryRecords.splice(a,1)[0];this.geometries.splice(a,1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();return b};c.prototype.replaceGeometry=function(a,b){h(0<=a&&a<this.geometryRecords.length,"Object3d.replaceGeometry: index out of range");var c=this.geometryRecords[a],d=new e(b,c.materials,c.transformation);
this.geometryRecords[a]=d;this.geometries[a]=b;this._notifyDirty("objGeometryReplaced",[c,d]);this._invalidateBoundingVolume();return c.geometry};c.prototype.replaceGeometryMaterials=function(a,b){h(0<=a&&a<this.geometryRecords.length,"Object3d.replaceGeometryMaterials: index out of range");var c=this.geometryRecords[a],d=c.materials,f=new e(c.geometry,b.slice(),c.transformation);this.geometryRecords[a]=f;this._notifyDirty("objGeometryReplaced",[c,f]);return d};c.prototype.geometryVertexAttrsUpdated=
function(a){this._notifyDirty("vertexAttrsUpdated",this.geometryRecords[a]);this._invalidateBoundingVolume()};c.prototype.geometryColorAttrsUpdated=function(a){this._notifyDirty("colorAttrsUpdated",this.geometryRecords[a])};c.prototype.getHiddenIndexRanges=function(a){return this.hiddenIndexRanges[a.getId()]};c.prototype.getVisibleIndexRanges=function(a){return this.visibleIndexRanges[a.getId()]};c.prototype.isAllHidden=function(){for(var a=0;a<this.geometryRecords.length;a++){var b=this.geometryRecords[a],
c=b.geometry.data.faces.length,b=this.getVisibleIndexRanges(b);if(!b)return!1;for(var d=0;d<c;d++){var e=b[d];if(!e||0<e.length)return!1}}return!0};c.prototype.setFacerangeColors=function(a,b){var c=this.geometryRecords;if(1!==c.length)console.warn("face range colors currently support only one geometry record");else{var c=c[0].geometry,d=c.data.vertexAttributes;if(!(null==c.originalColors&&a.every(function(a){return null==a.color}))&&(null==c.originalColors&&(c.originalColors=d[m.COLOR].data,d[m.COLOR].data=
new c.originalColors.constructor(c.originalColors)),d=d[m.COLOR].data,null!=d)){for(var e=0;e<a.length;e++){var h=a[e],f=null==h.faceRanges?0:12*h.faceRanges[0],g=null==h.faceRanges?d.length:12*(h.faceRanges[1]+1);if(null!=h.color)if("blend"===b)for(var l=h.color[0],k=h.color[1],p=h.color[2],h=h.color[3];f<g;f+=4)d[f+0]=c.originalColors[f+0]*l,d[f+1]=c.originalColors[f+1]*k,d[f+2]=c.originalColors[f+2]*p,d[f+3]=c.originalColors[f+3]*h;else{l=255*h.color[0];k=255*h.color[1];p=255*h.color[2];for(h=
255*h.color[3];f<g;f+=4)d[f+0]=l,d[f+1]=k,d[f+2]=p,d[f+3]=h}else for(;f<g;f++)d[f]=c.originalColors[f]}this.geometryColorAttrsUpdated(0)}}};c.prototype.isPartiallyHidden=function(){for(var a=0;a<this.geometryRecords.length;a++){var b=this.geometryRecords[a],c=b.geometry.data.faces.length;if(b=this.getHiddenIndexRanges(b))for(var d=0;d<c;d++){var e=b[d];if(e&&0<e.length)return!0}}return!1};c.prototype.hideFaceRange=function(b,c){var d=b.id;null==this.hiddenIndexRanges[d]&&(this.hiddenIndexRanges[d]=
[],this.visibleIndexRanges[d]=[]);for(var e=0;e<b.geometry.data.faces.length;e++){null==this.hiddenIndexRanges[d][e]&&(this.hiddenIndexRanges[d][e]=[],this.visibleIndexRanges[d][e]=[]);var h=a.copyIntervals(c);a.convertFaceToIndexRange(h,3);var f=b.geometry.data.faces[e].componentRange,h=a.intersectIntervals(h,f),h=a.offsetIntervals(h,-f[0]);this.hiddenIndexRanges[d][e]=this.hiddenIndexRanges[d][e].concat(h);this.hiddenIndexRanges[d][e]=a.mergeIntervals(this.hiddenIndexRanges[d][e]);0===this.hiddenIndexRanges[d].length?
(delete this.visibleIndexRanges[d],delete this.hiddenIndexRanges[d]):this.visibleIndexRanges[d][e]=a.invertIntervals(this.hiddenIndexRanges[d][e],b.geometry.data.faces[e].indices.position.length-1)}this._notifyDirty("hideFaceRange",b)};c.prototype.hideAllFaceRanges=function(){this.hiddenIndexRanges={};this.visibleIndexRanges={};for(var a=0;a<this.geometryRecords.length;a++){var b=this.geometryRecords[a],c=b.getId();this.hiddenIndexRanges[c]=[];this.visibleIndexRanges[c]=[];for(var d=b.geometry.data.faces.length,
e=0;e<d;e++)this.hiddenIndexRanges[c][e]=[[0,b.geometry.data.faces[e].indices.position.length-1]],this.visibleIndexRanges[c][e]=[];this._notifyDirty("hideFaceRange",b)}return!0};c.prototype.unhideAllFaceRange=function(){this.hiddenIndexRanges={};this.visibleIndexRanges={};this._notifyDirty("unhideAllFaceRange")};c.prototype.getFaceRangeIndexFromTriangleNr=function(a){var b=this.metadata.faceRanges;if(null!=b)for(var c=0;c<b.length;c++)if(b[c][0]<=a&&b[c][1]>=a)return c};c.prototype.getFaceRangeFromTriangleNr=
function(a){a=this.getFaceRangeIndexFromTriangleNr(a);var b=this.metadata.faceRanges;return a?[b[a]]:null};c.prototype.setGeometryTransformation=function(a,b){h(0<=a&&a<this.geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var c=this.geometryRecords[a],d=new e(c.geometry,c.materials,g.create(b));this.geometryRecords[a]=d;this._notifyDirty("objGeometryReplaced",[c,d]);this._invalidateBoundingVolume()};c.prototype.getObjectTransformation=function(){return g.create(this.objectTransformation)};
c.prototype.setObjectTransformation=function(a){g.set(a,this.objectTransformation);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")};c.prototype.getCombinedTransformation=function(a,b){b=b||g.create();g.multiply(this.objectTransformation,a.transformation,b);return b};c.prototype.getCastShadow=function(){return this.castShadow};c.prototype.setCastShadow=function(a){this.castShadow=a};c.prototype.getMetadata=function(){return this.metadata};c.prototype.getName=function(){return this.name};
c.prototype.getBBMin=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};c.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};c.prototype.getCenter=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.center:this._bvWorldSpace.center};c.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};
c.prototype.calcFacerangeBoundingSphere=function(a){var b=null;null!=a&&(1===this.geometries.length&&1===this.geometries[0].numGroups)&&(b=this.getFaceRangeFromTriangleNr(a));if(null==b||1!==b.length)return{center:this.getCenter(),radius:this.getBSRadius()};a=this.geometries[0].calculateBoundingInfo(0,b[0]);b=a.getCenter();g.multiplyVec3(this.geometryRecords[0].transformation,b);g.multiplyVec3(this.objectTransformation,b);return{center:b,radius:a.getBSRadius()*this._getScaleFactor(this.geometryRecords[0].transformation)*
this._getScaleFactor(this.objectTransformation)}};c.prototype._validateBoundingVolume=function(){if(this._bvDirty){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=d.create(),b=d.create(),c=0;c<this.geometryRecords.length;++c)for(var e=this.geometries[c],h=this.geometryRecords[c].transformation,f=0,l=e.getNumGroups();f<l;++f){var m=e.getBoundingInfo(f);g.multiplyVec3(h,m.getBBMin(),a);g.multiplyVec3(h,m.getBBMax(),b);for(var k=0;3>k;++k)this._bvObjectSpace.bbMin[k]=Math.min(this._bvObjectSpace.bbMin[k],
a[k],b[k]),this._bvObjectSpace.bbMax[k]=Math.max(this._bvObjectSpace.bbMax[k],a[k],b[k]);g.multiplyVec3(this.objectTransformation,a);g.multiplyVec3(this.objectTransformation,b);for(k=0;3>k;++k)this._bvWorldSpace.bbMin[k]=Math.min(this._bvWorldSpace.bbMin[k],a[k],b[k]),this._bvWorldSpace.bbMax[k]=Math.max(this._bvWorldSpace.bbMax[k],a[k],b[k])}d.lerp(this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,0.5,this._bvObjectSpace.center);d.lerp(this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,0.5,this._bvWorldSpace.center);
k=this._getScaleFactor(this.objectTransformation);for(c=0;c<this.geometryRecords.length;++c)for(var e=this.geometries[c],h=this.geometryRecords[c].transformation,p=this._getScaleFactor(h),f=0,l=e.getNumGroups();f<l;++f){m=e.getBoundingInfo(f);g.multiplyVec3(h,m.getCenter(),a);var n=d.dist(a,this._bvObjectSpace.center),m=m.getBSRadius()*p;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,n+m);g.multiplyVec3(this.objectTransformation,a,b);n=d.dist(b,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=
Math.max(this._bvWorldSpace.bsRadius,n+m*k)}this._bvDirty=!1}};c.prototype._getScaleFactor=function(a){var b=Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),c=Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9]);a=Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]);return Math.max(Math.max(b,c),a)};c.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace)};c.prototype._notifyDirty=function(a,c,d,e){this._parentLayer&&(d=d||b.OBJECT,this._parentLayer.notifyDirty(a,
c,d,e||this))};c._idGen=new k;return c}();var l=function(){function a(){this.bbMin=d.create();this.bbMax=d.create();this.center=d.create();this.bsRadius=0}a.prototype.init=function(){d.set3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.bbMin);d.set3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.bbMax);d.set3(0,0,0,this.center);this.bsRadius=0};a.prototype.getCenter=function(){return this.center};a.prototype.getBSRadius=function(){return this.bsRadius};return a}();return q})},
"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","./IdGen"],function(q,n,k){return function(){function f(c,b,a,e,h){this.id=f._idGen.gen(c.getId());this.geometry=c;this.materials=b;this.transformation=a;this.instanceParameters=e;this.origin=h}f.prototype.getId=function(){return this.id};f._idGen=new k;return f}()})},"esri/views/3d/layers/graphics/SignedDistanceFunctions":function(){define(["require","exports","../../support/mathUtils"],function(q,n,k){function f(a,
h,f){a=k.clamp(a,0,0.9999991);var d=a*c[0]-Math.floor(a*c[0]),m=a*c[1]-Math.floor(a*c[1]),l=a*c[2]-Math.floor(a*c[2]);a=a*c[3]-Math.floor(a*c[3]);h[f+0]=256*(d-d*b[0]);h[f+1]=256*(m-d*b[1]);h[f+2]=256*(l-m*b[2]);h[f+3]=256*(a-l*b[3])}var c=[16777216,65536,256,1],b=[0,1/256,1/256,1/256],a=[1/16777216,1/65536,1/256,1];n.packFloat=f;n.unpackFloat=function(b,c){var f=b[c+1]/256,d=b[c+2]/256,m=b[c+3]/256,l;l=0+b[c+0]/256*a[0];l+=f*a[1];l+=d*a[2];return l+=m*a[3]};n.computeSignedDistancefieldCicle=function(a,
b){for(var c=new Uint8Array(4*a*a),d=a/2-0.5,m=b/2,l=0;l<a;l++)for(var k=0;k<a;k++){var s=k+a*l,r=k-d,t=l-d,r=Math.sqrt(r*r+t*t)-m,r=r/a+0.5;f(r,c,4*s)}return c};n.computeSignedDistancefieldSquare=function(a,b,c){c&&(b/=Math.SQRT2);for(var d=new Uint8Array(4*a*a),m=0;m<a;m++)for(var l=0;l<a;l++){var k=l-0.5*(a-0.5),s=m-0.5*(a-0.5),r=m*a+l;if(c)var t=(k+s)/Math.SQRT2,s=(s-k)/Math.SQRT2,k=t;k=Math.max(Math.abs(k),Math.abs(s))-0.5*b;k=k/a+0.5;f(k,d,4*r)}return d};n.computeSignedDistancefieldCrossAndX=
function(a,b,c){c&&(b*=Math.SQRT2);b*=0.5;for(var d=new Uint8Array(4*a*a),m=0;m<a;m++)for(var l=0;l<a;l++){var k=l-0.5*a-0.5,s=m-0.5*a-0.5,r=m*a+l;if(c)var t=(k+s)/Math.SQRT2,s=(s-k)/Math.SQRT2,k=t;k=Math.abs(k);s=Math.abs(s);t=void 0;t=k>s?k>b?Math.sqrt((k-b)*(k-b)+s*s):s:s>b?Math.sqrt(k*k+(s-b)*(s-b)):k;t=t/a+0.5;f(t,d,4*r)}return d}})},"esri/views/3d/layers/graphics/Graphics3DObjectSymbolLayer":function(){define("../../../../core/declare ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ../i3s/I3SSymbolLoader ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p){var s=p.assert,r=h.mat4d,t=h.vec3d,u=[1,1,1],v=[10,10,10],C=[g.ModelContentType.MATERIAL,g.ModelContentType.TEXTURE,g.ModelContentType.GEOMETRY];return q([k],{_prepareResources:function(){var a=this.symbol,b=this._getStageIdHint();a.resource&&a.resource.href?this._prepareModelResources(a.resource.href,b):this._preparePrimitiveResources(a.resource?a.resource.primitive:"sphere",b)},_sizeToScale:function(a,b,c,d){for(var e=Array(3),f=2;0<=f;f--){var h=a[f];null!==
h&&isFinite(h)?e[f]=h/(b[f+3]-b[f]):e[f]="symbolValue"===h?c?c[f]:1:null}a=d;b=0;for(f=2;0<=f;f--)h=e[f],null!==h&&(a=h,b=Math.max(b,Math.abs(h)));for(f=2;0<=f;f--)null===e[f]?e[f]=a:0===e[f]&&(e[f]=0.0010*b);return e},_computeSymbolScale:function(a,b){var c=[a.width,a.depth,a.height];return c[0]||c[1]||c[2]?this._sizeToScale(c,b,null,1):null},_preparePrimitiveResources:function(a,b){var c=this.symbol;if("sphere"===a)this._geometryData=m.createPolySphereGeometry(0.5,2,!0),this._geometryOrigin="center";
else if("cube"===a)this._geometryData=m.createBoxGeometry(1),this._geometryOrigin="center";else if("cylinder"===a)this._geometryData=m.createCylinderGeometry(1,0.5,16,[0,0,1],[0,0,0.5]),this._geometryOrigin="bottom";else if("cone"===a)0>c.height?(this._geometryData=m.createConeGeometry(1,0.5,15,!0),c.height=-c.height):this._geometryData=m.createConeGeometry(1,0.5,15,!1),m.cgToGIS(this._geometryData),this._geometryOrigin="bottom";else if("tetrahedron"===a)this._geometryData=m.createTetrahedronGeometry(1),
m.cgToGIS(this._geometryData),this._geometryOrigin="bottom";else if("diamond"===a)this._geometryData=m.createDiamondGeometry(1),m.cgToGIS(this._geometryData),this._geometryOrigin="center";else{console.warn("Unknown object symbol primitive: "+a);this.reject();return}this._geometry=new d(this._geometryData,b);this._context.stage.add(g.ModelContentType.GEOMETRY,this._geometry);var e=[-0.5,-0.5,-0.5,0.5,0.5,0.5];this._symbolScale=this._computeSymbolScale(c,e);this._boundingBox=e;e=this._getMaterialOpacity();
e={specular:[0,0,0],shininess:3,opacity:e,transparent:1>e||this._isPropertyDriven("opacity"),instanced:this._hasPerInstanceColor()?["transformation","color"]:["transformation"]};this._isPropertyDriven("color")?(e.ambient=u,e.diffuse=u):(c=c.material?n.toUnitRGB(c.material.color):u,e.ambient=c,e.diffuse=c);this._material=new l(e,b+"_objectmat");this._context.stage.add(g.ModelContentType.MATERIAL,this._material);this.resolve()},_prepareModelResources:function(a,b){var c={materialParamsMixin:{instanced:this._hasPerInstanceColor()?
["transformation","color"]:["transformation"]},idHint:b};(new e(this._context.streamDataSupplier)).fetchSymbol(a,c).then(function(a){if(!this.isRejected()){var b=a.stageResources,c=this._context.stage,d=this.symbol.material,e;this._isPropertyDriven("color")?e={ambient:u,diffuse:u}:d&&d.color&&(d=n.toUnitRGB(d.color),e={ambient:d.map(function(a){return a/1.5}),diffuse:d});var f=this._computeModelOpacityOverride();a.originalMaterialOpacities=Array(b[g.ModelContentType.MATERIAL].length);b[g.ModelContentType.MATERIAL].forEach(function(b,
c){var d=b.getParameterValues();a.originalMaterialOpacities[c]=d.opacity;e&&b.setParameterValues(e);f.overwrite?b.setParameterValues({opacity:f.overwrite,transparent:f.blendingRequired}):null!=f.multiply&&(d.opacity*=f.multiply,d.transparent=1>d.opacity,b.setParameterValues({opacity:d.opacity,transparent:d.transparent}))});C.forEach(function(a){for(var d=b[a],e=0;d&&e<d.length;e++)c.add(a,d[e])});for(var h=b[g.ModelContentType.GEOMETRY],d=a.geometryTransformations,l=[Number.MAX_VALUE,Number.MAX_VALUE,
Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],m=[0,0,0],k=[0,0,0],p=0;p<h.length;p++)for(var s=h[p],v=0,x=s.getNumGroups();v<x;++v){var q=s.getBoundingInfo(v);r.multiplyVec3(d[p],q.getBBMin(),m);r.multiplyVec3(d[p],q.getBBMax(),k);for(q=0;3>q;++q){if(m[q]>k[q]){var y=m[q];m[q]=k[q];k[q]=y}l[q]=Math.min(l[q],m[q]);l[q+3]=Math.max(l[q+3],k[q])}}this._boundingBox=l;this._symbolScale=this._computeSymbolScale(this.symbol,l);t.scale(a.pivotOffset,-1);h=d.length;for(l=0;l<h;l++)r.translate(d[l],
a.pivotOffset);t.scale(a.pivotOffset,-1);this._i3sModel=a;this.resolve()}}.bind(this),function(){this.reject()}.bind(this))},_computeModelOpacityOverride:function(){var a={overwrite:null,blendingRequired:!1,multiply:null},b=this._getMaterialOpacity();this._isPropertyDriven("opacity")?(a.overwrite=b,a.blendingRequired=!0):this.symbol.material&&void 0!==this.symbol.material.transparency?(a.overwrite=b,a.blendingRequired=1>a.overwrite):1>b&&(a.multiply=b,a.blendingRequired=!0);return a},destroy:function(){this.isFulfilled()||
this.reject();var a=this._context.stage;if(this._i3sModel){var b=this._i3sModel.stageResources;C.forEach(function(c){for(var d=b[c],e=0;d&&e<d.length;e++)a.remove(c,d[e].getId())})}else this._material&&a.remove(g.ModelContentType.MATERIAL,this._material.getId()),this._geometry&&a.remove(g.ModelContentType.GEOMETRY,this._geometry.getId())},createGraphics3DGraphic:function(a,c){var d=a.geometry;if("polyline"===d.type)d=b.placePointOnPolyline(d);else if("polygon"===d.type)d=b.placePointOnPolygon(d);
else if("extent"===d.type)d=d.get("center");else if("point"!==d.type)return this._logWarning("unsupported geometry type for object symbol: "+d.type),null;var e="graphic"+a.uid,f=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,d,c,f,e,a.uid)},layerPropertyChanged:function(a,d,e){if("opacity"===a){if(this._i3sModel){var f=this._computeModelOpacityOverride();this._i3sModel.stageResources[g.ModelContentType.MATERIAL].forEach(function(a,b){if(f.overwrite)a.setParameterValues({opacity:f.overwrite,
transparent:f.blendingRequired});else{var c=this._i3sModel.originalMaterialOpacities[b];null!=f.multiply&&(c*=f.multiply);a.setParameterValues({opacity:c,transparent:1>c})}}.bind(this))}else d=this._getMaterialOpacity(),this._material.setParameterValues({opacity:d,transparent:1>d||this._isPropertyDriven("opacity")});return!0}if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var h=this._context.renderCoordsHelper,l=c.perObjectElevationAligner,m=b.ELEV_MODES.ABSOLUTE_HEIGHT,
k;for(k in d){var p=d[k],r=p._graphics[e];r&&(p=this._getGraphicElevationInfo(p.graphic),r.elevationAligner=p.mode!==m?l:null,r.elevationInfo.set(p),l(r,a,h))}return!0}return!1},_createAs3DShape:function(d,e,h,l,m,k){d=this._hasPerInstanceColor()?{color:a.mixinColorAndOpacity(h.color,h.opacity)}:null;var p=this._computeObjectScale(h,!this._i3sModel),s=this._context.layer.id;if(this._i3sModel){var t=this._i3sModel.stageResources[g.ModelContentType.GEOMETRY],n=this._i3sModel.materialsByComponent,u=
this._i3sModel.geometryTransformations;m=b.createStageObjectForPoint.call(this,e,null,null,null,null,l,m,s,k);if(null===m)return null;for(k=0;k<t.length;k++){s=r.identity();this._applyObjectRotation(h,this.symbol,s);p&&r.scale(s,p);r.multiply(s,u[k]);for(var v=n[k],q=v.length,C=Array(q),K=0;K<q;K++)C[K]=d;m.addGeometry(t[k],v,s,C)}}else n=this.symbol,"bottom"===n.anchor&&"center"===this._geometryOrigin?t=[0,0,0.5]:"center"===n.anchor&&"bottom"===this._geometryOrigin&&(t=[0,0,-0.5]),n=r.identity(),
this._applyObjectRotation(h,this.symbol,n),p&&r.scale(n,p),t&&r.translate(n,t),m=b.createStageObjectForPoint.call(this,e,[this._geometry],[[this._material]],[n],[d],l,m,s,k);if(null===m)return null;m.setCastShadow(!0);h=null;l.mode!==b.ELEV_MODES.ABSOLUTE_HEIGHT&&(h=c.perObjectElevationAligner);l=new f(this,m,null,null,null,h,l,f.VisibilityModes.REMOVE_OBJECT);b.extendPointGraphicElevationInfo(l,e,this._context.elevationProvider);return l},_computeObjectScale:function(a,b){var c;a.size&&this._isPropertyDriven("size")?
(c=this._sizeToScale(a.size,this._boundingBox,this._symbolScale,null),s(null!=c[0],"sizeInfo has no values")):c=this._symbolScale?this._symbolScale.slice(0):b?v.slice(0):[1,1,1];for(var d=this._context.renderCoordsHelper.unitInMeters,e=2;0<=e;e--)c[e]/=d;return 1!==c[0]||1!==c[1]||1!==c[2]?c:null},_applyObjectRotation:function(a,b,c){a=(a.rotationAngle||0)+(b.heading||0);return 0!==a?r.rotateZ(c,-a/180*Math.PI,c):null},_hasPerInstanceColor:function(){return this._isPropertyDriven("color")||this._isPropertyDriven("opacity")}})})},
"esri/views/3d/layers/i3s/I3SSymbolLoader":function(){define("../../../../core/declare dojo/_base/lang ../../support/PromiseLightweight ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Texture".split(" "),function(q,n,k,f,c,b,a,e,h,g){var d=f.mat4d,m=b.assert;return q(null,{constructor:function(a){this.streamDataSupplier=a},destroy:function(){},fetchSymbol:function(a,
b){b=b||{};var c=new k.Promise;this.streamDataSupplier.request(a,"json").then(function(a,d){var e=this._createStageResources(d,b);c.done(e)}.bind(this),function(){c.reject()});return c},_gatherExternalTextures:function(a){for(var b in a.textureDefinitions)for(var c=a.textureDefinitions[b],d=0;d<c.images.length;d++)"href"in c.images[d]&&console.warn("External image resources not yet supported");return{}},_extractTextureImageFromBin:function(a,b){var c=new k.Promise,d=new Uint8Array(a,b.byteOffset,
b.length),d=new Blob([d],{type:b.encoding}),e=window.URL.createObjectURL(d),f=new Image;f.onerror=function(){window.URL.revokeObjectURL(e);c.reject();f.url="";f.onerror=void 0;f.onload=void 0};f.onload=function(){window.URL.revokeObjectURL(e);b.img=f;c.done();f.url="";f.onerror=void 0;f.onload=void 0};f.src=e;return c},_createStageResources:function(b,f){var k=[],r=[],t=[],u=[],v=[],q=[],y="meshsymbol_"+b.model.name,x=b.textureDefinitions,B={},z;for(z in x){var A=x[z],w=A.images[0].data;m(w,"symbol resources must have embedded texture data (at the moment)");
var D="/textureDefinitions/"+z,w=new g(A.encoding+";base64,"+w,y,{noUnpackFlip:!0});v.push(w);B[D]={engineTexObj:w,transparent:"rgba"===A.channels}}x=b.model.geometries;z=b.materialDefinitions;for(A=0;A<x.length;A++){D=x[A];D.params.components||this._createSingleComponent(D);var w=D.params.components,E=w.length,H=D.params.faces,G=D.params.vertexAttributes,I=D.params.topology||"Indexed",O={},J;for(J in G){var F=G[J];m(F.values,"symbol resources with external geometry bin not yet supported");O[J]={data:F.values,
size:F.valuesPerElement}}var K,G=Array(E);if("Indexed"===I)for(J in K=H.componentIndices,H);else"PerAttributeArray"!==I?console.warn("I3S symbol loader: unsupported topology type "+I):1!==E&&console.warn("I3S symbol loader: if topology is not Indexed, only single component geometries are supported");t.push([]);for(E=0;E<w.length;E++){I=w[E];F={type:"triangle",positionKey:"position",indices:{}};if(K)for(J in H){if("componentIndices"!==J){var T=H[J];m(T.values,"symbol resources with external geometry bin not yet supported");
F.indices[J]=new Uint32Array(T.values)}}else{for(var T=O.position.data.length/O.position.size,R=new Uint32Array(T),da=0;da<T;da++)R[da]=da;T=R;for(J in O)F.indices[J]=T}G[E]=F;var S;I.texture&&(S=B[I.texture].engineTexObj.getId());F=u[I.material]?u[I.material][I.texture]:null;F||(F=I.material.substring(I.material.lastIndexOf("/")+1),F=z[F].params,1===F.transparency&&(F.transparency=0),F={ambient:F.diffuse,diffuse:F.diffuse,specular:F.specular,shininess:F.shininess,opacity:1-F.transparency,textureId:S,
doubleSided:!0,cullFace:"none",flipV:!1},F.transparent=1>F.opacity,f.materialParamsMixin&&n.mixin(F,f.materialParamsMixin),F=new h(F,y),u[I.material]||(u[I.material]={}),u[I.material][I.texture]=F,r.push(F));t[A].push(F)}w=new a(new e(G,O),y);D=d.create(D.transformation);k.push(w);q.push(D)}u={stageResources:{}};u.stageResources[c.ModelContentType.TEXTURE]=v;u.stageResources[c.ModelContentType.MATERIAL]=r;u.stageResources[c.ModelContentType.GEOMETRY]=k;u.geometryTransformations=q;u.materialsByComponent=
t;u.pivotOffset=b.model.pivotOffset;return u},_createSingleComponent:function(a){var b=a.params;m(b.material);b.components=[{id:1,material:a.params.material,texture:a.params.texture,region:a.params.texture}];b.faces&&(b.faces.componentIndices=[b.faces.position.count])}})})},"esri/views/3d/layers/graphics/Graphics3DLineSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../core/screenUtils ../../../../geometry/Polygon ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/RenderGeometry".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p){var s=g.vec3d,r=g.mat4d;return q([n],{_prepareResources:function(){var b=this.symbol,c=this._isPropertyDriven("size"),e={idHint:this._getStageIdHint(),width:this._getWidth(b),color:this._getMaterialOpacityAndColor()};if(c||2<e.width)c&&(e.width=0),e.miterLimit=b.miterLimit,e.join=b.join,this._isNativeLineMaterial=!1,this._material=a.createRibbonMaterial(e);else if(0<e.width)this._isNativeLineMaterial=!0,this._material=a.createNativeMaterial(e);else{this.reject();
return}this._context.stage.add(d.ModelContentType.MATERIAL,this._material);this.resolve()},_getWidth:function(a){return null!=a.size?e.pt2px(a.size):1},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(d.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,c){var d=a.geometry;if("polyline"!==d.type&&"polygon"!==d.type&&"extent"!==d.type)return this._logWarning("unsupported geometry type for line symbol: "+
d.type),null;var d="polygon"===d.type||"extent"===d.type?"rings":"paths",f="graphic"+a.uid,h=this._getVertexOpacityAndColor(c,Float32Array,255),g=0;c.size&&this._isPropertyDriven("size")&&(g=b.getSingleSizeDriver(c.size),g=e.pt2px(g));var l=this._getGraphicElevationInfo(a);return l.mode===b.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,d,h,g,l,f):this._createAs3DShape(a,d,h,g,l,f,a.uid)},layerPropertyChanged:function(a,d,e){if("opacity"===a)return this._isNativeLineMaterial?(d=this._material.getColor(),
d[3]=this._getMaterialOpacity(),this._material.setColor(d)):(d=this._material.getParameterValues(),d.color[3]=this._getMaterialOpacity(),this._material.setParameterValues({color:d.color})),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var f=this._elevationInfo.mode;if(null==a||null==f)return!1;var h=b.ELEV_MODES;if(a===h.ON_THE_GROUND&&f===h.ON_THE_GROUND)return!0;if(a!==f&&(a===h.ON_THE_GROUND||f===h.ON_THE_GROUND))return!1;a=f===h.RELATIVE_TO_GROUND?c.perVertexElevationAligner:
null;var f=this._context.elevationProvider,h=this._context.renderCoordsHelper,g;for(g in d){var l=d[g],m=l._graphics[e];m&&(l=l.graphic,m.elevationAligner=a,m.elevationInfo.set(this._getGraphicElevationInfo(l)),c.perVertexElevationAligner(m,f,h))}return!0}return!1},_getOutlineGeometry:function(b,c){return b._outlineSegments?a.createOutlineGeometryFromSegments(c,b._outlineSegments):c},_getGeometry:function(a){a=a.geometry;"extent"===a.type&&(a=h.fromExtent(a));return a},_createAs3DShape:function(d,
e,f,h,g,p,n){var q=this._getGeometry(d),A=q.hasZ,w=this._getOutlineGeometry(q,q[e]);if(0<w.length){d=[];for(var D=[],E=[],H=s.create(),G=Array(6),w=b.getGeometryVertexData3D(w,A,q.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,g),q=w.geometryData.outlines,A=w.eleVertexData,w=w.vertexData,I=0;I<q.length;++I){var O=q[I],J=O.index,F=O.count;if(this._context.clippingExtent&&(b.computeBoundingBox(A,J,F,G),b.boundingBoxClipped(G,this._context.clippingExtent)))continue;
b.chooseOrigin(w,J,F,H);b.subtractCoordinates(w,J,F,H);O=new Float64Array(A.buffer,3*J*A.BYTES_PER_ELEMENT,3*F);J=new Float64Array(w.buffer,3*J*w.BYTES_PER_ELEMENT,3*F);J=a.createPolylineGeometry(J,O,"rings"===e,f,h,!1);J=new l(J,p+"path"+I);J.singleUse=!0;d.push(J);D.push([this._material]);J=r.identity();r.translate(J,H,J);E.push(J)}if(0<d.length)return e=new m({geometries:d,materials:D,transformations:E,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:n},idHint:p}),f=null,g.mode===
b.ELEV_MODES.RELATIVE_TO_GROUND&&(f=c.perVertexElevationAligner),new k(this,e,d,null,null,f,g)}return null},_createAsOverlay:function(c,d,e,h,g,l){var m=this._getGeometry(c);this._material.setRenderPriority(this._symbolLayerOrder);var k=this._getOutlineGeometry(m,m[d]);if(0<k.length){c=[];g=Array(6);for(var n=s.create(),k=b.getGeometryVertexDataDraped(k,m.spatialReference,this._context.overlaySR),m=k.vertexData,k=k.geometryData.outlines,q=0;q<k.length;++q){var D=k[q],E=D.index,D=D.count;b.computeBoundingBox(m,
E,D,g);if(!b.boundingBoxClipped(g,this._context.clippingExtent)){b.chooseOrigin(m,E,D,n);b.subtractCoordinates(m,E,D,n);b.setZ(m,E,D,this._getDrapedZ());D=new Float64Array(m.buffer,3*E*m.BYTES_PER_ELEMENT,3*D);E=r.identity();r.translate(E,n,E);var D=a.createPolylineGeometry(D,null,"rings"===d,e,h,!0),H=new p(D);H.material=this._material;H.center=[0.5*(g[0]+g[3]),0.5*(g[1]+g[4]),0];H.bsRadius=0.5*Math.sqrt((g[3]-g[0])*(g[3]-g[0])+(g[4]-g[1])*(g[4]-g[1]));H.transformation=E;H.name=l;H.uniqueName=l+
"#"+D.id;c.push(H)}}return new f(this,c,null,null,g)}return null}})})},"esri/views/3d/layers/graphics/lineUtils":function(){define("require exports ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/NativeLineMaterial ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),function(q,n,k,f,c,b){function a(a){var b=a.length;return a[0]===a[b-3]&&a[1]===a[b-2]&&a[2]===a[b-1]}var e=b.VertexAttrConstants;n.createRibbonMaterial=function(a){var b={width:a.width,
color:a.color,miterLimit:a.miterLimit,polygonOffset:!0};"miter"===a.join||"bevel"===a.join?b.join=a.join:(b.join="miter",a.join&&console.warn("unsupported join type for line symbol: "+a.join));return new k(b,a.idHint+"_ribbonlinemat")};n.createNativeMaterial=function(a){return new f(a.width,a.color,a.idHint+"_nativelinemat")};n.createOutlineGeometryFromSegments=function(a,b){for(var c=0;c<b.length;c++)for(var e=a[c],f=0;f<b[c].length;f++){for(var k=b[c][f],s=[],r=k[0];r<k[1];r++)s.push(e[r]);0<s.length&&
(void 0).push(s)}};n.isClosed=a;n.createPolylineGeometry=function(b,f,d,m,l,k){var s,r,n;if(d=d&&!a(b)){d=new Float32Array(b.length+3);for(r=0;r<b.length;r++)d[r]=b[r];r=d.length;d[r-3]=b[0];d[r-2]=b[1];d[r-1]=b[2];s=b.length/3+1;r=new Uint32Array(2*(s-1));n=new Uint32Array(2*(s-1))}else s=b.length/3,r=new Uint32Array(2*(s-1)),n=new Uint32Array(2*(s-1)),d=b;b=new Float32Array(1);b[0]=l;for(var u=l=0,v=0;v<s-1;v++)r[l++]=v,r[l++]=v+1,n[u++]=0,n[u++]=0;s={};l={};s[e.POSITION]=r;s[e.COLOR]=n;s[e.SIZE]=
n;l[e.POSITION]={size:3,data:d};l[e.COLOR]={size:4,data:m};l[e.SIZE]={size:1,data:b};f&&(s.mapPos=r,l.mapPos={size:3,data:f});f=[{type:"line",indices:s,positionKey:e.POSITION}];return k?{faces:f[0],vertexAttr:l,id:c.getNewId().toString()}:new c(f,l)}})},"esri/views/3d/webgl-engine/materials/NativeLineMaterial":function(){define("./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(q,n,k,f,c,b){var a=k.vec3d,
e=k.vec2d,h=k.mat4d,g=n.VertexAttrConstants,d=a.create(),m=a.create(),l=a.create(),p=a.create(),s=e.create(),r=e.create(),t=a.create(),u=a.create(),v=function(e,f,k,z){"string"===typeof k&&(z=k,k=void 0);q.basicMaterialConstructor(this,z);this.lineType=k||v.LINES;var A=c.Pos3,w=b.getStride(A)/4;this.canBeMerged=this.lineType===v.LINES;this.setColor=function(a){f=a;this.notifyDirty("matChanged")};this.getColor=function(){return f};this.dispose=function(){};this.getOutputAmount=function(a){a=a/2+1;
if(this.lineType===v.STRIP)return a*w;if(this.lineType===v.LINES)return(2*a-2)*w};this.getVertexBufferLayout=function(){return A};this.fillInterleaved=function(a,b,c,d,e,f){a=a.vertexAttr[g.POSITION].data;if(b||this.lineType===v.LINES){d=a.length/3;for(c=0;c<d;c++){var h=3*c,l=a[h],m=a[h+1],k=a[h+2];if(b)var h=l,p=m,l=b[0]*h+b[4]*p+b[8]*k+b[12],m=b[1]*h+b[5]*p+b[9]*k+b[13],k=b[2]*h+b[6]*p+b[10]*k+b[14];e[f++]=l;e[f++]=m;e[f++]=k;this.lineType===v.LINES&&(0!==c&&c!==d-1)&&(e[f++]=l,e[f++]=m,e[f++]=
k)}}else for(c=0;c<a.length;c++)e[f++]=a[c]};this.intersect=function(b,c,e,f,g,k,v,q,x,A,w,y){if(y){b=b.getData().getVertexAttr("position").position.data;c=Number.MAX_VALUE;for(v=0;v<b.length-5;v+=3){d[0]=b[v];d[1]=b[v+1];d[2]=b[v+2];h.multiplyVec3(e,d);m[0]=b[v+3];m[1]=b[v+4];m[2]=b[v+5];h.multiplyVec3(e,m);x.projectPoint(d,s);x.projectPoint(m,r);if(0>s[2]&&0<r[2])a.subtract(d,m,l),q=x.frustumPlanes,A=-(a.dot(q[4],d)+q[4][3]),q=A/a.dot(l,q[4]),a.scale(l,q,l),a.add(d,l,d),x.projectPoint(d,s);else if(0<
s[2]&&0>r[2])a.subtract(m,d,l),q=x.frustumPlanes,A=-(a.dot(q[4],m)+q[4][3]),q=A/a.dot(l,q[4]),a.scale(l,q,l),a.add(m,l,m),x.projectPoint(m,r);else if(0>s[2]&&0>r[2])continue;q=n.projectVectorVector2D(s,r,f);q<c&&(c=q,a.set(d,t),a.set(m,u))}2>c&&(e=n.linelineDistance3D(t,u,g,k),f=Number.MAX_VALUE,e[0]&&(a.subtract(e[2],g,p),e=a.length(p),a.scale(p,1/e),f=0.98*e/a.dist(g,k)),w(f,p))}};this.getGLMaterials=function(){return{color:C,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=
function(){return[]}};v.STRIP=1;v.LINES=2;var C=function(a,b){q.basicGLMaterialConstructor(this,a);var c=b.get("simple"),d=a.getColor();this.beginSlot=function(a){return a===f.OPAQUE_MATERIAL};this.getProgram=function(){return c};this.bind=function(a,b){a.bindProgram(c);c.setUniform4fv("color",d);1>d[3]&&a.setBlendingEnabled(!0)};this.release=function(a){1>d[3]&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){q.bindView(b.origin,b.view,c)};this.bindInstance=function(a,b){c.setUniformMatrix4fv("model",
b.transformation)};this.getDrawMode=function(b){b=b.gl;return a.lineType===v.STRIP?b.LINE_STRIP:b.LINES}};return v})},"esri/views/3d/layers/graphics/Graphics3DPathSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../support/projectionUtils ../../../../views/3d/lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m){var l=b.vec3d,p=b.mat4d,s=m.assert,r=l.create(),t={};q=q([n],{_prepareResources:function(){var b="c3dsymbol"+this.symbol.id,c=this._getMaterialOpacityAndColor(),e=l.create(c),c=c[3],e={diffuse:e,ambient:e,opacity:c,transparent:1>c||this._isPropertyDriven("opacity"),vertexColors:this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};this._material=new d(e,b+"_3dlinemat");this._context.stage.add(a.ModelContentType.MATERIAL,this._material);this.resolve()},
destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(a.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polyline"!==c.type)return this._logWarning("unsupported geometry type for path symbol: "+c.type),null;var c="polygon"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,d,a.uid)},layerPropertyChanged:function(a,
b,c){if("opacity"===a)return b=this._getMaterialOpacity(),c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var d=this._context.renderCoordsHelper,e=f.ELEV_MODES.ABSOLUTE_HEIGHT,h;for(h in b){var g=b[h],l=g._graphics[c];l&&(g=this._getGraphicElevationInfo(g.graphic),l.elevationAligner=g.mode!==e?v:null,l.elevationInfo.set(g),v(l,a,d))}return!0}return!1},_getPathSize:function(a,
b){var c=a.size&&this._isPropertyDriven("size")?f.getSingleSizeDriver(a.size):this.symbol.size||this.symbol.width||1;return c/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(a,b,d,m,r,s){var n=a.geometry,t=n.hasZ,u=n[b];if(0<u.length){b=[];a=[];for(var q=[],G=l.create(),I=this._context.renderSpatialReference===c.SphericalRenderSpatialReference,O=Array(6),J=this._getPathSize(d,this.symbol),u=f.getGeometryVertexData3D(u,t,n.spatialReference,this._context.renderSpatialReference,
this._context.elevationProvider,m),n=u.geometryData.outlines,t=u.eleVertexData,u=u.vertexData,F=0;F<n.length;++F){var K=n[F],T=K.index,R=K.count;if(this._context.clippingExtent&&(f.computeBoundingBox(t,T,R,O),f.boundingBoxClipped(O,this._context.clippingExtent)))continue;f.chooseOrigin(u,T,R,G);f.subtractCoordinates(u,T,R,G);K=new Float64Array(t.buffer,3*T*t.BYTES_PER_ELEMENT,3*R);T=f.flatArrayToArrayOfArrays(u,T,R);T=g.createTubeGeometry(T,0.5*J,10,I,G);T.getVertexAttr().mapPos={size:3,data:K};this._material.getParams().vertexColors&&
(K=this._getVertexOpacityAndColor(d),T=g.addVertexColors(T,K,!0));K=new h(T,r+"path"+F);K.singleUse=!0;b.push(K);a.push([this._material]);K=p.identity();p.translate(K,G,K);q.push(K)}if(0<b.length)return d=new e({geometries:b,materials:a,transformations:q,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:s},idHint:r}),r=null,m.mode!==f.ELEV_MODES.ABSOLUTE_HEIGHT&&(r=v),new k(this,d,b,null,null,r,m)}return null}});var u=m.VertexAttrConstants,v=function(a,b,c){var d=a.stageObject;a=a.elevationInfo;
for(var e=d.getGeometryRecords(),h=e.length,g=0;g<h;g++){var l=e[g].geometry,m=[e[g].transformation[12],e[g].transformation[13],e[g].transformation[14]],k=l.getData().getVertexAttr(),p=k[u.POSITION].data,n=k.zOffset.data,k=k.mapPos.data,v=k.length/3;s(p.length/3===10*v+2,"unexpected tube geometry");var q=0,F=0;t.spatialReference=b.spatialReference;for(var K=0;K<v;K++){t.x=k[3*K];t.y=k[3*K+1];t.z=k[3*K+2];var T=f.computeElevation(b,t,a),R=10;(0===K||K===v-1)&&R++;for(var da=0;da<R;da++)r[0]=p[q]+m[0],
r[1]=p[q+1]+m[1],r[2]=p[q+2]+m[2],c.setAltitude(T+n[F],r,0),p[q]=r[0]-m[0],p[q+1]=r[1]-m[1],p[q+2]=r[2]-m[2],q+=3,F+=1;l.invalidateBoundingInfo()}d.geometryVertexAttrsUpdated(g)}};return q})},"esri/views/3d/layers/graphics/Graphics3DFillSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ./graphicUtils ../../../../geometry/Polygon ../../../../Color ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y){var x=C.VertexAttrConstants;C=m.vec3d;var B=m.mat4d;q=q([k],{_prepareResources:function(){this._prepareFillResources();this._prepareOutlineResources();this.resolve()},_prepareFillResources:function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),b={color:b,transparent:1>b[3]||this._isPropertyDriven("opacity"),polygonOffset:!1,vertexColors:!0};this._material=new v(b,a+"_colormat");this._context.stage.add(p.ModelContentType.MATERIAL,
this._material)},_prepareOutlineResources:function(){var a=this.symbol.outline;if(this._hasOutline=!(!a||!a.size||!a.color))a={idHint:this._getStageIdHint()+"_outline",color:this._getOutlineColor(),width:n.pt2px(this.symbol.outline.size)},2<a.width?(this._outlineMaterial=e.createRibbonMaterial(a),this._isOutlineNativeLineMaterial=!1):(this._outlineMaterial=e.createNativeMaterial(a),this._isOutlineNativeLineMaterial=!0),this._context.stage.add(p.ModelContentType.MATERIAL,this._outlineMaterial)},destroy:function(){this.isFulfilled()||
this.reject();this._material&&(this._context.stage.remove(p.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._outlineMaterial&&(this._context.stage.remove(p.ModelContentType.MATERIAL,this._outlineMaterial.getId()),this._outlineMaterial=null)},createGraphics3DGraphic:function(b,c){var d=b.geometry;if("polyline"!==d.type&&"polygon"!==d.type&&"extent"!==d.type)return this._logWarning("unsupported geometry type for fill symbol: "+d.type),null;var d="graphic"+b.uid,e=this._getVertexOpacityAndColor(c,
Uint8Array,255),f=this._getGraphicElevationInfo(b);return f.mode===a.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(b,e,f,d):this._createAs3DShape(b,e,f,d,b.uid)},layerPropertyChanged:function(c,d,e){if("opacity"===c)return d=this._material.getColor(),d[3]=this._getMaterialOpacity(),this._material.setColor(d),this._material.setTransparent(1>d[3]),this._outlineMaterial&&(this._isOutlineNativeLineMaterial?(d=this._outlineMaterial.getColor(),d[3]=this._getOutlineOpacity(),this._outlineMaterial.setColor(d)):
(d=this._outlineMaterial.getParameterValues(),d.color[3]=this._getOutlineOpacity(),this._outlineMaterial.setParameterValues({color:d.color}))),!0;if("elevationInfo"===c){c=this._elevationInfo.mode;this._updateElevationInfo();var f=this._elevationInfo.mode;if(null==c||null==f)return!1;var h=a.ELEV_MODES;if(c===h.ON_THE_GROUND&&f===h.ON_THE_GROUND)return!0;if(c!==f&&(c===h.ON_THE_GROUND||f===h.ON_THE_GROUND))return!1;c=f===h.RELATIVE_TO_GROUND?b.perVertexElevationAligner:null;var f=this._context.elevationProvider,
h=this._context.renderCoordsHelper,g;for(g in d){var l=d[g],m=l._graphics[e];m&&(l=l.graphic,m.elevationAligner=c,m.elevationInfo.set(this._getGraphicElevationInfo(l)),b.perVertexElevationAligner(m,f,h))}return!0}return!1},setDrawOrder:function(a,b,c){this._material&&(this._material.setRenderPriority(a+b/2),c[this._material.getId()]=!0);this._outlineMaterial&&(this._outlineMaterial.setRenderPriority(a),c[this._outlineMaterial.getId()]=!0)},_createAs3DShape:function(c,d,e,h,g){var l=this._getPolyGeometry(c),
m=l.hasZ;c=!1;var k;null!=l.rings?(c=!0,k=l.rings):k=l.paths;if(0===k.length)return this._logWarning("no paths found for line symbol"),null;k=this._getOutlineGeometry(l,k);l=a.getGeometryVertexData3D(k,m,l.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,e);D.idHint=h;D.color=d;D.isRings=c;D.data=l;var p;this._hasOutline&&(p=new l.vertexData.constructor(l.vertexData));D.outNum=0;D.outGeometries=[];D.outTransforms=[];D.outMaterials=[];this._createAs3DShapeFill(D);
D.data.vertexData=p;this._createAs3DShapeOutline(D);if(0===D.outNum)return null;d=new s({geometries:D.outGeometries,materials:D.outMaterials,transformations:D.outTransforms,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:g},idHint:h});h=null;e.mode===a.ELEV_MODES.RELATIVE_TO_GROUND&&(h=b.perVertexElevationAligner);return new f(this,d,D.outGeometries,null,null,h,e)},_createAs3DShapeFill:function(b){for(var c=b.data.geometryData.polygons,d=b.data.eleVertexData,e=b.data.vertexData,f=
0;f<c.length;++f){var h=c[f],g=h.count,l=h.index;if(this._context.clippingExtent&&(a.computeBoundingBox(d,l,g,z),a.boundingBoxClipped(z,this._context.clippingExtent)))continue;var m=new Float64Array(d.buffer,3*l*d.BYTES_PER_ELEMENT,3*g),k=new Float64Array(e.buffer,3*l*e.BYTES_PER_ELEMENT,3*g),h=h.holeIndices.map(function(a){return a-l}),h=y(m,h,3);0!==h.length&&(a.chooseOrigin(e,l,g,A),a.subtractCoordinates(e,l,g,A),g=this._createFillGeometry(h,0,k,m,b.color,!1),g=new r(g,b.idHint),g.singleUse=!0,
m=B.identity(),B.translate(m,A,m),b.outGeometries.push(g),b.outMaterials.push([this._material]),b.outTransforms.push(m),b.outNum++)}},_createAs3DShapeOutline:function(b){if(this._hasOutline)for(var c=b.data.geometryData.outlines,d=b.data.eleVertexData,f=b.data.vertexData,h=0;h<c.length;++h){var g=c[h],l=g.index,m=g.count;if(this._context.clippingExtent&&(a.computeBoundingBox(d,l,m,z),a.boundingBoxClipped(z,this._context.clippingExtent)))continue;a.chooseOrigin(f,l,m,A);a.subtractCoordinates(f,l,m,
A);g=new Float64Array(d.buffer,3*l*d.BYTES_PER_ELEMENT,3*m);l=new Float64Array(f.buffer,3*l*f.BYTES_PER_ELEMENT,3*m);l=e.createPolylineGeometry(l,g,b.isRings,w,0,!1);l=new r(l,b.idHint+"outline"+h);l.singleUse=!0;g=B.identity();B.translate(g,A,g);b.outGeometries.push(l);b.outMaterials.push([this._outlineMaterial]);b.outTransforms.push(g);b.outNum++}},_createAsOverlay:function(b,d,e,f){e=this._getPolyGeometry(b);b=!1;var h;null!=e.rings?(b=!0,h=e.rings):h=e.paths;h=this._getOutlineGeometry(e,h);if(0===
h.length)return null;this._material.setRenderPriority(this._symbolLayerOrder+this._symbolLayerOrderDelta/2);this._hasOutline&&this._outlineMaterial.setRenderPriority(this._symbolLayerOrder);e=a.getGeometryVertexDataDraped(h,e.spatialReference,this._context.overlaySR);D.idHint=f;D.color=d;D.isRings=b;D.data=e;var g;this._hasOutline&&(g=new e.vertexData.constructor(e.vertexData));D.outNum=0;D.outGeometries=[];D.outBoundingBox=l.create(l.NEGATIVE_INFINITY);this._createAsOverlayFill(D);D.data.vertexData=
g;this._createAsOverlayOutline(D);return 0<D.outNum?new c(this,D.outGeometries,null,null,D.outBoundingBox):null},_createAsOverlayFill:function(b){for(var c=b.data.vertexData,d=b.data.geometryData.polygons,e=0;e<d.length;++e){var f=d[e],h=f.count,g=f.index,m=new Float64Array(c.buffer,3*g*c.BYTES_PER_ELEMENT,3*h),f=f.holeIndices.map(function(a){return a-g}),m=y(m,f,3);if(0!==m.length&&(a.computeBoundingBox(c,g,h,z),!a.boundingBoxClipped(z,this._context.clippingExtent))){l.expand(b.outBoundingBox,z);
a.chooseOrigin(c,g,h,A);a.subtractCoordinates(c,g,h,A);a.setZ(c,g,h,this._getDrapedZ());h=B.identity();B.translate(h,A,h);m=this._createFillGeometry(m,g,c,null,b.color,!0);f=new u(m);f.material=this._material;var k=z;f.center=[0.5*(k[0]+k[3]),0.5*(k[1]+k[4]),0];f.bsRadius=0.5*Math.sqrt((k[3]-k[0])*(k[3]-k[0])+(k[4]-k[1])*(k[4]-k[1]));f.transformation=h;f.name=b.idHint;f.uniqueName=b.idHint+"#"+m.id;b.outGeometries.push(f);b.outNum++}}},_createAsOverlayOutline:function(b){if(this._hasOutline)for(var c=
b.data.vertexData,d=b.data.geometryData.outlines,f=0;f<d.length;++f){var h=d[f],g=h.index,h=h.count;a.computeBoundingBox(c,g,h,z);if(!a.boundingBoxClipped(z,this._context.clippingExtent)){l.expand(b.outBoundingBox,z);a.chooseOrigin(c,g,h,A);a.subtractCoordinates(c,g,h,A);a.setZ(c,g,h,this._getDrapedZ());h=new Float64Array(c.buffer,3*g*c.BYTES_PER_ELEMENT,3*h);g=B.identity();B.translate(g,A,g);var h=e.createPolylineGeometry(h,null,b.isRings,w,0,!0),m=new u(h);m.material=this._outlineMaterial;var k=
z;m.center=[0.5*(k[0]+k[3]),0.5*(k[1]+k[4]),0];m.bsRadius=0.5*Math.sqrt((k[3]-k[0])*(k[3]-k[0])+(k[4]-k[1])*(k[4]-k[1]));m.transformation=g;m.name=b.idHint+"outline";m.uniqueName=b.idHint+"outline#"+h.id;b.outGeometries.push(m);b.outNum++}}},_getOutlineGeometry:function(a,b){return a._outlineSegments?e.createOutlineGeometryFromSegments(b,a._outlineSegments):b},_getOutlineOpacity:function(){return this._getLayerOpacity()*this.symbol.outline.color.a},_getOutlineColor:function(){var a=this.symbol.outline.color,
b=this._getOutlineOpacity();return h.mixinColorAndOpacity(d.toUnitRGB(a),b)},_getPolyGeometry:function(a){a=a.geometry;"extent"===a.type&&(a=g.fromExtent(a));return a},_createFillGeometry:function(a,b,c,d,e,f){for(var h=a.length,g=new Uint32Array(h),l=new Uint32Array(h),m=0;m<h;m++)g[m]=a[m]+b,l[m]=0;b={};a={};b[x.POSITION]=g;b[x.COLOR]=l;a[x.POSITION]={size:3,data:c};a[x.COLOR]={size:4,data:e};d&&(a.mapPos={size:3,data:d},b.mapPos=g);c=[{type:"triangle",indices:b,positionKey:x.POSITION}];return f?
{faces:c[0],vertexAttr:a,id:t.getNewId().toString()}:new t(c,a)}});var z=l.create(),A=C.create(),w=new Float32Array([255,255,255,255]),D={idHint:null,color:null,isRings:!1,data:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null};return q})},"esri/views/3d/layers/graphics/earcut/earcut":function(){define([],function(){function q(a,b,c,e,f){var h=0,g,m,k;g=b;for(m=c-e;g<c;g+=e)h+=(a[m]-a[g])*(a[g+1]+a[m+1]),m=g;if(f===0<h)for(g=b;g<c;g+=e)k=d(g,k);else for(g=c-
e;g>=b;g-=e)k=d(g,k);return k}function n(a,b,c){c||(c=b);var d;do if(d=!1,!b.steiner&&(a[b.i]===a[b.next.i]&&a[b.i+1]===a[b.next.i+1]||0===e(a,b.prev.i,b.i,b.next.i))){b.prev.next=b.next;b.next.prev=b.prev;b.prevZ&&(b.prevZ.nextZ=b.nextZ);b.nextZ&&(b.nextZ.prevZ=b.prevZ);b=c=b.prev;if(b===b.next)return null;d=!0}else b=b.next;while(d||b!==c);return c}function k(a,c,d,f,m,u,q,C){if(c){if(!C&&void 0!==m){var y=c,x=y;do null===x.z&&(x.z=b(a[x.i],a[x.i+1],m,u,q)),x.prevZ=x.prev,x=x.nextZ=x.next;while(x!==
y);x.prevZ.nextZ=null;x.prevZ=null;var y=x,B,z,A,w,D,E,H=1;do{x=y;A=y=null;for(w=0;x;){w++;z=x;for(B=D=0;B<H&&!(D++,z=z.nextZ,!z);B++);for(E=H;0<D||0<E&&z;)0===D?(B=z,z=z.nextZ,E--):0===E||!z?(B=x,x=x.nextZ,D--):x.z<=z.z?(B=x,x=x.nextZ,D--):(B=z,z=z.nextZ,E--),A?A.nextZ=B:y=B,B.prevZ=A,A=B;x=z}A.nextZ=null;H*=2}while(1<w)}for(y=c;c.prev!==c.next;){x=c.prev;z=c.next;a:{A=a;w=c;B=m;E=u;var G=q;D=w.prev.i;var I=w.i,H=w.next.i,O=A[D],J=A[D+1],F=A[I],K=A[I+1],T=A[H],R=A[H+1],I=O*K-J*F,da=O*R-J*T,S=I-da-
(T*K-R*F);if(0>=S)A=!1;else{var ba=R-J,aa=O-T,$=J-K,Z=F-O,M=void 0,V=void 0,L=void 0,U=L=V=M=void 0;if(void 0!==B){U=O>F?O>T?O:T:F>T?F:T;M=J>K?J>R?J:R:K>R?K:R;O=b(O<F?O<T?O:T:F<T?F:T,J<K?J<R?J:R:K<R?K:R,B,E,G);B=b(U,M,B,E,G);for(U=w.nextZ;U&&U.z<=B;)if(M=U.i,U=U.nextZ,!(M===D||M===H))if(V=A[M],L=A[M+1],M=ba*V+aa*L-da,0<=M&&(V=$*V+Z*L+I,0<=V&&(L=S-M-V,0<=L&&(M&&V||M&&L||V&&L)))){A=!1;break a}for(U=w.prevZ;U&&U.z>=O;)if(M=U.i,U=U.prevZ,!(M===D||M===H))if(V=A[M],L=A[M+1],M=ba*V+aa*L-da,0<=M&&(V=$*V+
Z*L+I,0<=V&&(L=S-M-V,0<=L&&(M&&V||M&&L||V&&L)))){A=!1;break a}}else for(U=w.next.next;U!==w.prev;)if(M=U.i,U=U.next,V=A[M],L=A[M+1],M=ba*V+aa*L-da,0<=M&&(V=$*V+Z*L+I,0<=V&&(L=S-M-V,0<=L&&(M&&V||M&&L||V&&L)))){A=!1;break a}A=!0}}if(A)d.push(x.i/f),d.push(c.i/f),d.push(z.i/f),z.prev=x,x.next=z,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ),y=c=z.next;else if(c=z,c===y){if(C)if(1===C){C=a;A=c;c=d;y=f;z=A;do w=z.prev,x=z.next.next,w.i!==x.i&&(e(C,w.i,z.i,z.next.i)!==e(C,w.i,z.i,x.i)&&
e(C,z.next.i,x.i,w.i)!==e(C,z.next.i,x.i,z.i)&&h(C,w,x)&&h(C,x,w))&&(c.push(w.i/y),c.push(z.i/y),c.push(x.i/y),w.next=x,x.prev=w,A=z.prevZ,z=z.nextZ&&z.nextZ.nextZ,A&&(A.nextZ=z),z&&(z.prevZ=A),z=A=x),z=z.next;while(z!==A);c=z;k(a,c,d,f,m,u,q,2)}else{if(2===C)a:{C=c;do{for(y=C.next.next;y!==C.prev;){if(x=C.i!==y.i){x=a;z=C;A=y;w=void 0;if(w=z.next.i!==A.i)if(w=void 0,w=z.prev.i!==A.i){w=w=void 0;b:{w=z.i;D=A.i;H=z;do{B=H.i;E=H.next.i;if(B!==w&&E!==w&&B!==D&&E!==D&&e(x,B,E,w)!==e(x,B,E,D)&&e(x,w,D,
B)!==e(x,w,D,E)){w=!0;break b}H=H.next}while(H!==z);w=!1}if(w=!w)if(w=void 0,w=h(x,z,A))if(w=void 0,w=h(x,A,z)){H=z.i;B=A.i;A=z;w=!1;D=(x[H]+x[B])/2;H=(x[H+1]+x[B+1])/2;do B=A.i,E=A.next.i,x[B+1]>H!==x[E+1]>H&&D<(x[E]-x[B])*(H-x[B+1])/(x[E+1]-x[B+1])+x[B]&&(w=!w),A=A.next;while(A!==z)}}x=w}if(x){c=g(C,y);C=n(a,C,C.next);c=n(a,c,c.next);k(a,C,d,f,m,u,q);k(a,c,d,f,m,u,q);break a}y=y.next}C=C.next}while(C!==c)}}else k(a,n(a,c),d,f,m,u,q,1);break}}}}function f(b,d,e,f){var h=[],g,m,k,y;g=0;for(m=d.length;g<
m;g++)k=d[g]*f,y=g<m-1?d[g+1]*f:b.length,k=q(b,k,y,f,!1),k===k.next&&(k.steiner=!0),(k=n(b,k))&&h.push(a(b,k));h.sort(function(a,c){return b[a.i]-b[c.i]});for(g=0;g<h.length;g++)c(b,h[g],e),e=n(b,e,e.next);return e}function c(a,b,c){var d=c,e=b.i,f=a[e],e=a[e+1],m=-Infinity,k,q,x;do{q=d.i;x=d.next.i;if(e<=a[q+1]&&e>=a[x+1]){var B=a[q]+(e-a[q+1])*(a[x]-a[q])/(a[x+1]-a[q+1]);B<=f&&B>m&&(m=B,k=a[q]<a[x]?d:d.next)}d=d.next}while(d!==c);if(k){c=a[k.i];d=a[k.i+1];q=f*d-e*c;x=f*e-e*m;for(var B=e-e,z=f-m,
A=e-d,w=c-f,m=q-x-(m*d-e*c),D=0>=m?-1:1,E=k,H=Infinity,G,I,O,J,d=k.next;d!==E;)G=a[d.i],I=a[d.i+1],O=f-G,0<=O&&G>=c&&(J=(B*G+z*I-x)*D,0<=J&&(G=(A*G+w*I+q)*D,0<=G&&0<=m*D-J-G&&(I=Math.abs(e-I)/O,I<H&&h(a,d,b)&&(k=d,H=I)))),d=d.next;c=k}else c=null;c&&(b=g(c,b),n(a,b,b.next))}function b(a,b,c,d,e){a=1E3*(a-c)/e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=1E3*(b-d)/e;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function a(a,
b){var c=b,d=b;do a[c.i]<a[d.i]&&(d=c),c=c.next;while(c!==b);return d}function e(a,b,c,d){a=(a[c+1]-a[b+1])*(a[d]-a[c])-(a[c]-a[b])*(a[d+1]-a[c+1]);return 0<a?1:0>a?-1:0}function h(a,b,c){return-1===e(a,b.prev.i,b.i,b.next.i)?-1!==e(a,b.i,c.i,b.next.i)&&-1!==e(a,b.i,b.prev.i,c.i):-1===e(a,b.i,c.i,b.prev.i)||-1===e(a,b.i,b.next.i,c.i)}function g(a,b){var c=new m(a.i),d=new m(b.i),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function d(a,b){var c=
new m(a);b?(c.next=b.next,c.prev=b,b.next.prev=c,b.next=c):(c.prev=c,c.next=c);return c}function m(a){this.i=a;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}return function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,h=n(a,q(a,0,e,c,!0)),g=[];if(!h)return g;var m,y,x,B;d&&(h=f(a,b,h,c));if(a.length>80*c){m=b=a[0];y=d=a[1];for(var z=c;z<e;z+=c)x=a[z],B=a[z+1],x<m&&(m=x),B<y&&(y=B),x>b&&(b=x),B>d&&(d=B);x=Math.max(b-m,d-y)}k(a,h,g,c,m,y,x);return g}})},"esri/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p){function s(a,b,c,d,e,f,h,g,m,l,k,p,r,s){var n=c.length/3,u=0;k+=2*d.count;var q=d.index,A=d.count,w=m,y=k;v.set(r,x);var C=0<p?1:-1,q=3*q,F=w;r=3*F;for(var D=w+A,w=3*D,E=0;E<A;++E)s&&(x[0]=a[q+0],x[1]=a[q+1],x[2]=a[q+2],v.normalize(x)),e[r+0]=a[q+0],e[r+1]=a[q+1],e[r+2]=a[q+2],f[r+0]=b[q+0],f[r+1]=b[q+1],f[r+2]=b[q+2],h[r+0]=-C*x[0],h[r+1]=-C*x[1],h[r+2]=-C*x[2],g[F]=0,e[w+0]=a[q+0]+p*x[0],e[w+1]=a[q+1]+p*x[1],e[w+2]=a[q+2]+p*x[2],f[w+0]=b[q+0],f[w+1]=b[q+1],
f[w+2]=b[q+2],h[w+0]=C*x[0],h[w+1]=C*x[1],h[w+2]=C*x[2],g[D]=p,r+=3,w+=3,q+=3,F+=1,D+=1;q=0;r=3*(y+n);w=3*y;a=B;b=z;0>p&&(a=z,b=B);for(E=0;E<n;++E)l[r+0]=c[q+a[0]],l[r+1]=c[q+a[1]],l[r+2]=c[q+a[2]],l[w+0]=c[q+b[0]]+A,l[w+1]=c[q+b[1]]+A,l[w+2]=c[q+b[2]]+A,r+=3,w+=3,q+=3;m+=2*d.count;k=k+2*n-(2*d.count+2*n);t(e,f,g,h,u,d.pathLengths[0],d.count,m,l,k,p);m+=4*d.pathLengths[0];k+=2*d.pathLengths[0];u+=d.pathLengths[0];for(c=1;c<d.pathLengths.length;++c)t(e,f,g,h,u,d.pathLengths[c],d.count,m,l,k,p),m+=
4*d.pathLengths[c],k+=2*d.pathLengths[c],u+=d.pathLengths[c]}function r(a,b,c,d,e,f,h){d[f]=d[h];h*=3;f*=3;a[f+0]=a[h+0];a[f+1]=a[h+1];a[f+2]=a[h+2];b[f+0]=b[h+0];b[f+1]=b[h+1];b[f+2]=b[h+2];c[f+0]=e[0];c[f+1]=e[1];c[f+2]=e[2]}function t(a,b,c,d,e,f,h,g,m,l,k){var p=e,s=e+1,n=e+h,t=e+h+1,q=g,u=g+1,x=g+2*f;g=g+2*f+1;0>k&&(p=e+h+1,t=e);l*=3;for(var A=0;A<f;++A){A===f-1&&(0<k?(s=e,t=e+h):(s=e,p=e+h));var y=a,z=p,C=s,B=n,F=w,z=3*z,C=3*C,B=3*B;v.set3(y[z++],y[z++],y[z++],D);v.set3(y[C++],y[C++],y[C++],
E);v.set3(y[B++],y[B++],y[B++],H);v.subtract(E,D,G);v.subtract(H,D,I);v.cross(I,G,F);v.normalize(F,F);r(a,b,d,c,w,q,p);r(a,b,d,c,w,u,s);r(a,b,d,c,w,x,n);r(a,b,d,c,w,g,t);m[l++]=q;m[l++]=x;m[l++]=g;m[l++]=q;m[l++]=g;m[l++]=u;p++;s++;n++;t++;q+=2;u+=2;x+=2;g+=2}}var u=l.VertexAttrConstants,v=a.vec3d,C=a.mat4d,y=v.create(),x=v.create(),B=[0,2,1],z=[0,1,2],A={};q=q([n],{_prepareResources:function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),c=v.create(b),b=b[3],c={diffuse:c,ambient:c,
opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:!0};this._material=new m(c,a+"_3dlinemat");this._context.stage.add(e.ModelContentType.MATERIAL,this._material);this.resolve()},destroy:function(){this.isFulfilled()||this.reject();this._material&&this._context.stage.remove(e.ModelContentType.MATERIAL,this._material.getId())},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for extrude symbol: "+
c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b,Float32Array,255),f=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,f,d,a.uid)},layerPropertyChanged:function(a,b,c){if("opacity"===a)return b=this._getMaterialOpacity(),c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;
var d=this._context.renderCoordsHelper,e=f.ELEV_MODES.ABSOLUTE_HEIGHT,h;for(h in b){var g=b[h],m=g._graphics[c];m&&(g=this._getGraphicElevationInfo(g.graphic),m.elevationAligner=g.mode!==e?F:null,m.elevationInfo.set(g),F(m,a,d))}return!0}return!1},_getExtrusionSize:function(a,b){var c=a.size&&this._isPropertyDriven("size")?f.getSingleSizeDriver(a.size):this.symbol.size||1;return c/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(a,d,e,m,l,r,n){var t=a.geometry;"extent"===
t.type&&(t=c.fromExtent(t));var q=t[d],u=t.hasZ;if(0<q.length){d=[];a=[];var x=[],A=v.create(),w=Array(6),y=this._context.renderSpatialReference===b.SphericalRenderSpatialReference;e=this._getExtrusionSize(e,this.symbol.size);var z=v.create();y||this._context.renderCoordsHelper.worldUpAtPosition(null,z);for(var u=f.getGeometryVertexData3D(q,u,t.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,l),t=u.geometryData.polygons,q=u.eleVertexData,u=u.vertexData,B=u.length/
3,X=new Float64Array(18*B),D=new Float64Array(18*B),E=new Float64Array(18*B),B=new Float64Array(6*B),H=0,G=0;G<t.length;++G){var J=t[G],I=J.count,O=J.index;if(this._context.clippingExtent&&(f.computeBoundingBox(q,O,I,w),f.boundingBoxClipped(w,this._context.clippingExtent)))continue;var ka=new Float64Array(q.buffer,3*O*X.BYTES_PER_ELEMENT,3*I),ga=J.holeIndices.map(function(a){return a-O}),ka=p(ka,ga,3);if(0<ka.length){f.chooseOrigin(u,O,I,A);var ga=new Uint32Array(6*I+2*ka.length),ja=6*I,oa=new Float64Array(X.buffer,
3*H*X.BYTES_PER_ELEMENT,3*ja),la=new Float64Array(D.buffer,3*H*D.BYTES_PER_ELEMENT,3*ja),W=new Float64Array(E.buffer,3*H*E.BYTES_PER_ELEMENT,3*ja),ra=new Float64Array(B.buffer,1*H*B.BYTES_PER_ELEMENT,1*ja);s(u,q,ka,J,oa,W,la,ra,0,ga,0,e,z,y);f.subtractCoordinates(oa,0,ja,A);H+=6*I;J=this._createExtrudeGeometry(ga,{positions:oa,elevation:W,normals:la,heights:ra},m,!1);J=new g(J,r+"path"+G);J.singleUse=!0;d.push(J);a.push([this._material]);J=C.identity();C.translate(J,A,J);x.push(J)}}return 0<d.length?
(m=new h({geometries:d,materials:a,transformations:x,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:n},idHint:r}),r=null,l.mode!==f.ELEV_MODES.ABSOLUTE_HEIGHT&&(r=F),new k(this,m,d,null,null,r,l)):null}this._logWarning("no paths found for extrusion symbol");return null},_createExtrudeGeometry:function(a,b,c,e){for(var f=a.length,h=new Uint32Array(f),g=0;g<f;g++)h[g]=0;g={};f={};g[u.POSITION]=a;g[u.NORMAL]=a;g[u.COLOR]=h;f[u.POSITION]={size:3,data:b.positions};f[u.NORMAL]={size:3,
data:b.normals};f[u.COLOR]={size:4,data:c};f[u.SIZE]={size:1,data:b.heights};b.elevation&&(f.mapPos={size:3,data:b.elevation},g.mapPos=a);a=[{type:"triangle",indices:g,positionKey:u.POSITION}];return e?{faces:a[0],vertexAttr:f,id:d.getNewId().toString()}:new d(a,f)}});var w=v.create(),D=v.create(),E=v.create(),H=v.create(),G=v.create(),I=v.create(),O=v.create(),J=v.create(),F=function(a,b,c){var d=a.stageObject;a=a.elevationInfo;var e=c.setAltitude;A.spatialReference=b.spatialReference;for(var h=
d.getGeometryRecords(),g=h.length,m=0;m<g;m++){var l=h[m].geometry,k=h[m].transformation;J[0]=k[12];J[1]=k[13];J[2]=k[14];l.invalidateBoundingInfo();for(var p=l.getData().getVertexAttr(),l=p[u.POSITION].data,k=p[u.SIZE].data,p=p.mapPos.data,r=l.length/3,s=0,n=0,t=!1,q=0;q<r;q++){A.x=p[n];A.y=p[n+1];A.z=p[n+2];O[0]=l[s];O[1]=l[s+1];O[2]=l[s+2];var v=f.computeElevation(b,A,a);y[0]=l[s]+J[0];y[1]=l[s+1]+J[1];y[2]=l[s+2]+J[2];e(v+k[s/3],y,0);l[s]=y[0]-J[0];l[s+1]=y[1]-J[1];l[s+2]=y[2]-J[2];v=0.01/c.unitInMeters;
if(Math.abs(O[0]-l[s])>v||Math.abs(O[1]-l[s+1])>v||Math.abs(O[2]-l[s+2])>v)t=!0;n+=3;s+=3}t&&d.geometryVertexAttrsUpdated(m)}};return q})},"esri/views/3d/layers/graphics/Graphics3DTextSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./Graphics3DIconSymbolLayer ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/TextTexture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m){var l=[1,1,1],p=[0,0,1],s=b.perObjectElevationAligner;return q([f],{_prepareResources:function(){var a=this.symbol;this._anchor=-1<e.VALID_ANCHOR_STRINGS.indexOf(a.anchor)?a.anchor:"center";this.resolve()},destroy:function(){this.isFulfilled()||this.reject()},createGraphics3DGraphic:function(b,c,d,e){var f=b.geometry,h=!1;if("polyline"===f.type)f=a.placePointOnPolyline(f),h=!0;else if("polygon"===f.type)f=a.placePointOnPolygon(f);else if("extent"===f.type)f=f.get("center");
else if("point"!==f.type)return this._logWarning("unsupported geometry type for text symbol: "+f.type),null;var g=this._context.layer.id+"_label_"+b.uid,m=c.text||this.symbol.text;if(!m||1>m.length)return null;var l=this._getGraphicElevationInfo(b);return this._createAs3DShape(this.symbol,f,m,l,g,b.uid,c,d,e,h)},layerPropertyChanged:function(a,b,c){if("opacity"===a)console.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer");else if("elevationInfo"===a){this._updateElevationInfo();
if(b)for(var d in b){a=b[d];var e=a._graphics[c];e&&this.updateGraphicElevationInfo(a.graphic,e)}return!0}return!1},updateGraphicElevationInfo:function(b,c){var d=this._context,e=this._getGraphicElevationInfo(b);c.elevationAligner=e.mode!==a.ELEV_MODES.ABSOLUTE_HEIGHT?s:null;c.elevationInfo.set(e);s(c,d.elevationProvider,d.renderCoordsHelper)},_defaultElevationInfoNoZ:{mode:a.ELEV_MODES.RELATIVE_TO_GROUND,offset:0},_getGraphicElevationInfo:function(b){var c=this.inherited(arguments);c.mode===a.ELEV_MODES.ON_THE_GROUND?
(c.mode=a.ELEV_MODES.RELATIVE_TO_GROUND,c.offset=1/this._context.renderCoordsHelper.unitInMeters,c.featureExpression={value:0}):c.mode===a.ELEV_MODES.RELATIVE_TO_GROUND&&(0===c.offset&&!b.geometry.get("hasZ"))&&(c.offset=1/this._context.renderCoordsHelper.unitInMeters);return c},_createAs3DShape:function(e,f,s,q,C,y,x,B,z,A){var w=x.centerOffset||[0,0,0,1],D=x.screenOffset||[0,0],E=x.translation||[0,0,0,0],H=x.anchor||this._anchor||"center";this._anchor=H;var G=e.material?k.toUnitRGB(e.material.color):
l,I={shadowColor:0.35<0.299*G[0]+0.587*G[1]+0.114*G[2]?"black":"white",shadowBlur:1};x=null!=z;e=new d(s,{size:n.pt2px(e.size)||12,color:G,font:{family:e.font&&e.font.family?e.font.family:"Arial",weight:e.font&&e.font.weight?e.font.weight:"normal",style:e.font&&e.font.style?e.font.style:"normal"},canvasStyle:I},C,x);s=x?z.addTextTexture(e):null;G=this._getMaterialOpacity();D={textureId:x?s.texture.getId():e.getId(),texCoordScale:e.getTexcoordScale(),occlusionTest:!0,screenOffset:D,anchorPos:H,polygonOffset:!0,
color:[1,1,1,G],transparent:1>G};A&&(D.shaderPolygonOffset=1E-4);A=null;H=JSON.stringify(D);null!=B?(A=B.getMaterial(H),null==A?(A=new m(D,C),B.addMaterial(H,A)):x&&A.setTextureDirty()):A=new m(D,C);x=[A];A=[e.getTextWidth(),e.getTextHeight()];w=g.createPointGeometry(p,E,void 0,A,!1,w,s?s.uvMinMax:null);w=[new h(w,C)];C=a.createStageObjectForPoint.call(this,f,w,[x],null,null,q,C,this._context.layer.id,y,!0);y=null;q.mode!==a.ELEV_MODES.ABSOLUTE_HEIGHT&&(y=b.perObjectElevationAligner);q=new c(this,
C,w,null==B?x:null,null==z?[e]:null,y,q);a.extendPointGraphicElevationInfo(q,f,this._context.elevationProvider);return q}})})},"esri/views/3d/webgl-engine/lib/TextTexture":function(){define("require exports ./Texture ./Util ../../../webgl/Texture ../../../webgl/enums".split(" "),function(q,n,k,f,c,b){return function(){function a(a,b,c){this._idHint=c;this._text=a;this._textLines=a.split(/\r?\n/);this._params=b||{color:[0,0,0]};this._params.size=this._params.size||18;this._params.font=this._params.font||
{family:"Arial"};this._params.font.family=this._params.font.family||"Arial";this._params.font.weight=this._params.font.weight||"normal";this._params.font.style=this._params.font.style||"normal";this._fillStyle="rgb("+this._params.color.map(function(a){return Math.floor(255*a)}).toString()+")"}a.prototype.getId=function(){null==this._id&&(this._id=k.idGen.gen(this._idHint));return this._id};a.prototype.getParams=function(){return this._params};a.prototype.getString=function(){return this._text};a.prototype.initializeThroughRender=
function(a,b){var g=this._create2DCanvas(),d=g.getContext("2d");d.save();var m=this.getTextWidth(),l=this.getTextHeight();g.setAttribute("width",m.toString());g.setAttribute("height",l.toString());b.samplingMode=9729;b.wrapMode=33071;b.flipped=!0;this._params.enableMipmapping&&(m=f.nextHighestPowerOfTwo(m),l=f.nextHighestPowerOfTwo(l),b.hasMipmap=!0,b.samplingMode=9985);this.renderText(1,m,l,d);g=new c(a,b,g);this._params.enableMipmapping&&this._renderMipmap(g);d.restore();return g};a.prototype.getTextWidth=
function(){var a=this._create2DCanvas().getContext("2d");this._setTextProperties(a,this._params.size);var b=0,c;for(c in this._textLines){var d=a.measureText(this._textLines[c]).width;d>b&&(b=d)}c=this._params.font;if("italic"===c.style||"oblique"===c.style||"string"===typeof c.weight&&("bold"===c.weight||"bolder"===c.weight)||"number"===typeof c.weight&&600<c.weight)b+=0.3*a.measureText("A").width;return b};a.prototype.getTextHeight=function(){return this.getLineHeight()*this._textLines.length};
a.prototype.getTexcoordScale=function(){if(this._params.enableMipmapping){var a=this.getTextHeight(),b=this.getTextWidth();return[b/f.nextHighestPowerOfTwo(b),a/f.nextHighestPowerOfTwo(a)]}return[1,1]};a.prototype.getLineHeight=function(){return Math.floor(1.2*this._params.size)};a.prototype.setUnloadFunc=function(a){this._unloadFunc=a};a.prototype.unload=function(){this._unloadFunc&&(this._unloadFunc(this._id),this._unloadFunc=null)};a.prototype.renderText=function(a,b,c,d,f,l){void 0===f&&(f=0);
void 0===l&&(l=0);c=this.getLineHeight()*a;this._setTextProperties(d,this._params.size*a);a="center"===d.textAlign?0.5*b:"right"===d.textAlign?b:0;a+=f;f=0+l;for(var k in this._textLines)d.fillText(this._textLines[k],a,f),f+=c};a.prototype._create2DCanvas=function(){null==a._textCanvas2D&&(a._textCanvas2D=document.createElement("canvas"),a._textCanvas2D.setAttribute("id","canvas2d"),a._textCanvas2D.setAttribute("width","1024"),a._textCanvas2D.setAttribute("height","1024"),a._textCanvas2D.setAttribute("style",
"display:none"));return a._textCanvas2D};a.prototype._setTextProperties=function(a,b){a.fillStyle=this._fillStyle;var c=this._params.font;a.font=c.style+" "+c.weight+" "+b+"px "+c.family;a.textAlign="left";a.textBaseline="top";this._params.canvasStyle&&f.mergeObjects(a,this._params.canvasStyle,a)};a.prototype._renderMipmap=function(a){var b=this._create2DCanvas(),c=b.getContext("2d"),d=parseInt(b.getAttribute("width"),10)/2,f=parseInt(b.getAttribute("height"),10)/2,l=0.5,k=1;do b.setAttribute("width",
d.toString()),b.setAttribute("height",f.toString()),this.renderText(l,d,f,c),a.updateData(k,0,0,d,f,b),l*=0.5,d*=0.5,f*=0.5,k++;while(1<d&&1<f)};return a}()})},"esri/views/3d/layers/graphics/Graphics3DWebStyleSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../support/PromiseLightweight"],function(q,n,k,f){return function(c){function b(a,b){var f=this;c.call(this);this.graphics3DSymbol=this.symbol=null;this.symbol=a;a.fetchSymbol().then(function(a){if(f.isRejected())throw Error();
f.graphics3DSymbol=b(a)}).then(function(){if(f.isRejected())throw Error();f.graphics3DSymbol.then(function(){f.isRejected()||f.resolve()},function(a){throw a;})}).otherwise(function(a){f.isRejected()||f.reject(a)})}k(b,c);b.prototype.createGraphics3DGraphic=function(a,b){return this.graphics3DSymbol.createGraphics3DGraphic(a,b,this)};b.prototype.layerPropertyChanged=function(a,b){return this.graphics3DSymbol.layerPropertyChanged(a,b)};b.prototype.setDrawOrder=function(a,b){return this.graphics3DSymbol.setDrawOrder(a,
b)};b.prototype.destroy=function(){this.isFulfilled()||this.reject();this.graphics3DSymbol&&this.graphics3DSymbol.destroy()};return b}(f.Promise)})},"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":function(){define(["require","exports","../../../../processors/SpatialIndex","../../../../geometry/SpatialReference","../../../../geometry/support/webMercatorUtils"],function(q,n,k,f,c){return function(){function b(){this.spatialIndex=new k;this.spatialIndexNumPendingQueries=this.spatialIndexNumGraphics=
0;this.graphicsCore=this.viewSR=this.layer=this.layerView=null}b.prototype.initialize=function(a,b,c,f){this.layerView=a;this.layer=b;this.viewSR=c;this.graphicsCore=f};b.prototype.destroy=function(){this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.graphicsCore=this.layerView=this.viewSR=null};b.prototype.numNodesUpdating=function(){return 0};b.prototype.isUpdating=function(){return 0<this.spatialIndexNumPendingQueries};b.prototype.hasGraphics=function(){return 0<this.spatialIndexNumGraphics};
b.prototype.intersects=function(a,b,c){var f=this;this.hasGraphics()&&(this.spatialIndexNumPendingQueries++,this.spatialIndex.intersects(a,void 0,void 0,!0).then(function(a){f.spatialIndexNumPendingQueries--;c(a.results,a.results.length);f.layerView._evaluateUpdatingState()}))};b.prototype.shouldAddToSpatialIndex=function(a,b,c){return c||b.mustAlignToTerrain()};b.prototype.addGraphicsToSpatialIndex=function(a){if(this.layerView.loadedGraphics)for(var b=this.layerView.loadedGraphics.toArray(),c=b.length,
f=0;f<c;f++){var d=b[f],m=this.graphicsCore.getGraphics3DGraphicById(d.uid);m&&!m.addedToSpatialIndex&&this.shouldAddToSpatialIndex(d,m,a)&&this.addGraphicToSpatialIndex(d,m)}};b.prototype.addGraphicToSpatialIndex=function(a,b){var h=a.geometry.spatialReference,g=this.viewSR,d={id:a.uid,geometry:null};if(h.equals(g))d.geometry=a.geometry.toJSON();else{var m=void 0;if(h.wkid===f.WGS84.wkid&&g.isWebMercator)m=c.geographicToWebMercator(a.geometry);else if(h.isWebMercator&&g.wkid===f.WGS84.wkid)m=c.webMercatorToGeographic(a.geometry);
else return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;d.geometry=m.toJSON()}this.spatialIndexNumGraphics++;this.spatialIndex.runProcess([d],this.layer.id);return b.addedToSpatialIndex=!0};return b}()})},"esri/processors/SpatialIndex":function(){define("../core/declare dojo/Deferred dojo/_base/lang ./Processor ../workers/WorkerClient ../layers/FeatureLayer".split(" "),function(q,n,k,f,c,b){return q([f],{declaredClass:"esri.processors.SpatialIndex",
index:null,indexType:"rtree",autostart:!1,constructor:function(a){a=a||{};var b=!1!==a.autostart;k.mixin(this,a);this.workerCallback=["./scripts/helpers","./scripts/indexInterface","./indexWorker"];if(!this.fetchWithWorker){var f=this;this.workerClient=new c("./mutableWorker",function(a){this.workerClient=a;this.workerCallback.push("./libs/"+this.indexType);this.workerClient.importScripts(this.workerCallback).then(function(){f._attachedSystem=!0;b&&f.start()})}.bind(this))}this._featCache={}},destroy:function(){this.workerClient&&
this.workerClient.terminate()},addLayer:function(a,c){if(a.graphics&&a.graphics.length||c||a.isInstanceOf(b))if(this._attachedSystem)this.inherited(arguments,[a]);else{var f=this.workerClient,g=this;this.inherited(arguments,[a,!0]);f.importScripts("./libs/"+this.indexType).then(function(){g.runProcess(a.graphics,a.id);g._attachedSystem=!0})}},unsetMap:function(){this.stop();this.workerClient.terminate();this.fetchWithWorker||(this.workerClient=new c(this.workerCallback));this.inherited(arguments);
this.start()},removeLayer:function(a){this.inherited(arguments)},runProcess:function(a,b){if(a&&a.length){var c=this,f=this.workerClient,d=a[0]._graphicsLayer;!b&&0!==b&&(b=d?d.id:"rawFeatures_"+Object.keys(this._featCache).length);this._featCache[b]||(this._featCache[b]={});for(var m,l,k=[],s=a.length,r=d&&d.objectIdField;s--;)if(l=a[s],m=l.attributes&&r?l.attributes[r]:l.id,null==m||!this._featCache[b][m])this._featCache[b][m]=1,l.declaredClass?k.push({id:m,geometry:l.geometry.toJSON(!0),attributes:l.attributes}):
k.push(l);f.postMessage({insert:k,system:this.indexType,options:this.indexOptions,idField:d&&d.objectIdField,layerId:b}).then(function(a){d&&d.emit("process-end",{processor:c,results:{insert:a.insert}})});d&&d.emit("process-start",{processor:this})}},_sendFeaturesFromLayer:function(a,b){var c=b.graphic,f=this.workerClient,d=this,m=c.attributes[a.objectIdField];this._featCache[a.id]||(this._featCache[a.id]={});this._featCache[a.id][m]||(this._featCache[a.id][m]=1,f.postMessage({insert:[{attributes:c.attributes,
geometry:c.geometry.toJSON(!0)}],system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:d,results:{insert:b.insert}})}),a.emit("process-start",{processor:d}))},_notifyProcessStart:function(a,b){},_sendFeaturesFromTask:function(a,b){var c=b.featureSet.features,f=[],d=this.workerClient,m=this,l=c.length,k,s;for(this._featCache[a.id]||(this._featCache[a.id]={});l--;)s=c[l],k=s.attributes[a.objectIdField],this._featCache[a.id][k]||
(this._featCache[a.id][k]=1,f.push(s));d.postMessage({insert:f,system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:m,results:{insert:b.insert}})});a.emit("process-start",{processor:m})},get:function(){},intersects:function(a,b,c,f){return"rtree"!=this.indexType?(console.error("Index.intersects only works with rtree indexes"),a=new n,a.reject({message:"Index.intersects only works with rtree indexes"}),a.promise):this.workerClient.postMessage({search:a,
layerId:b,returnNode:c,onlyIds:f})},within:function(a,b,c){if("rtree"!=this.indexType)return console.error("Index.within only works with rtree indexes"),a=new n,a.reject({message:"Index.within only works with rtree indexes"}),a.promise},nearest:function(a){return"kdtree"!=this.indexType?(console.error("Index.nearest only works with kdtree indexes"),a=new n,a.reject({message:"Index.nearest only works with kdtree indexes"}),a.promise):this.workerClient.postMessage({search:a})}})})},"esri/processors/Processor":function(){define("../core/sniff ../core/declare dojo/_base/lang dojo/_base/array dojo/Evented ../workers/RequestClient ../layers/GraphicsLayer".split(" "),
function(q,n,k,f,c,b,a){return n([c],{declaredClass:"esri.processors.Processor",layers:null,results:null,passFeatures:!0,drawFeatures:!0,requireWorkerSupport:!0,fetchWithWorker:!1,workerCallback:null,workerClient:null,_started:null,_handlers:null,constructor:function(a){a=a||{};k.mixin(this,a);!q("esri-workers")&&(!1!==this.requireWorkerSupport||!1!==a.requireWorkerSupport)?(console.log("Browser doesn't support workers \x26 worker support is required for this processor"),this.addLayer=this.setMap=
this.start=this.runProcess=function(){},this._disabled=!0):(this._handlers={},this._notifyProcessStart=k.hitch(this,this._notifyProcessStart),this._sendFeaturesFromTask=k.hitch(this,this._sendFeaturesFromTask),this._sendFeaturesFromLayer=k.hitch(this,this._sendFeaturesFromLayer),!1!==a.autostart&&this.start())},addLayer:function(a,c){var f=a._task,d=this._handlers[a.id]=[],m="complete";!1===this.drawFeatures&&(a._params.drawMode=!1);this.fetchWithWorker?(this.workerClient||(this.workerClient=b.getClient(this.workerCallback)),
f.requestOptions={workerOptions:{worker:this.workerClient}},this.passFeatures&&d.push(f.on(m,k.partial(this._notifyProcessStart,a)))):this.passFeatures?(m=this.drawFeatures?"graphic-draw":"graphic-add",d.push(a.on(m,k.partial(this._sendFeaturesFromLayer,a)))):d.push(f.on(m,k.partial(this._sendFeaturesFromTask,a)));!0!==c&&a.graphics&&this.runProcess(a.graphics,a.id)},removeLayer:function(a){f.forEach(this._handlers[a.id],function(a){a.remove()});delete this._handlers[a.id]},setMap:function(b){if(this.map)if(b!=
this.map)this.unsetMap();else return;var c=this;f.forEach(this.layers,c.removeLayer);f.forEach(b.graphicsLayerIds,function(a){c.addLayer(b.findLayerById(a))});this._handlers.map=[b.on("layer-add",function(b){b=b.layer;b.isInstanceOf(a)&&c.addLayer(b)}),b.on("layer-remove",function(b){b=b.layer;b.isInstanceOf(a)&&c.removeLayer(b)})];this.map=b},unsetMap:function(){this.map&&(f.forEach(this._handlers.map,function(a){a.remove()}),delete this._handlers.map,f.forEach(this.layers,this.removeLayer),this.map=
null)},start:function(){this.map?this.setMap(this.map):this.layers&&(k.isArray(this.layers)||(this.layers=[this.layers]),f.forEach(this.layers,this.addLayer));this._started=!0;this.emit("start",{processor:this});console.log("processor started")},stop:function(){this._started=!1;for(var a in this._handlers)this._handlers.hasOwnProperty(a)&&(this._handlers[a].remove(),delete this._handlers[a]);this.emit("stop",{processor:this});console.log("processor stopped")},runProcess:function(a,b){},_sendFeaturesFromTask:function(){},
_sendFeaturesFromLayer:function(){},_notifyProcessStart:function(){}})})},"esri/workers/RequestClient":function(){define(["../core/declare","dojo/_base/xhr","../config","./WorkerClient"],function(q,n,k,f){function c(c,d){var f=new b;f.addWorkerCallback(c,d);a.unshift({id:d?c+"::"+d:c,client:f});a.length>e&&a.pop().client.terminate();return f}var b=q([f],{declaredClass:"esri.workers.RequestClient",constructor:function(){this.setWorker(["./mutableWorker","./requestWorker"],function(){})},get:function(a){return this._send("GET",
a)},post:function(a){return this._send("POST",a)},_send:function(a,b){var c=n._ioSetArgs(b);c.xhr=null;var e=c.ioArgs,f=e.url;delete e.url;delete e.args;this.postMessage({method:a,url:f,options:e}).then(this._getSuccessHandler(c),this._getErrorHandler(c),this._getProgressHandler(c));return c},_addHeaderFunctions:function(a){a.getResponseHeader=function(b){var c,e=a.headers;Object.keys(e).forEach(function(a){if(a.toLowerCase()==b.toLowerCase())return c=e[a],!1});return c};a.getAllResponseHeaders=function(){var b=
[],c=a.headers;Object.keys(c).forEach(function(a){b.push(a+": "+c[a])});return b=b.join("\n")};return a},_getSuccessHandler:function(a){var b=this,c=a.ioArgs;return function(e){a.xhr=b._addHeaderFunctions(e);e=a.xhr.getResponseHeader("content-type");if(("xml"==c.handleAs||-1<e.indexOf("xml"))&&"string"==typeof a.xhr.response)a.xhr.response=(new DOMParser).parseFromString(a.xhr.response,"text/xml");a.resolve(a.xhr.response,a.xhr)}},_getErrorHandler:function(a){return function(b){a.reject(b)}},_getProgressHandler:function(a){return function(b){a.progress(b)}}}),
a=[],e=k.request.maxWorkers,h=new b;b.getClient=function(b,d){if(b){var e;a.some(function(a){if(a.id==(d?b+"::"+d:b))e=a.client;return!0});return e||c(b,d)}return h};b.setLimit=function(a){e=k.request.maxWorkers=a};return b})},"esri/workers/WorkerClient":function(){define("dojo/Evented ../core/declare dojo/Deferred dojo/_base/lang dojo/request ../core/sniff ../core/urlUtils require".split(" "),function(q,n,k,f,c,b,a,e){var h=window.Blob||window.webkitBlob||window.mozBlob,g=window.URL||window.webkitURL||
window.mozURL;return n([q],{declaredClass:"esri.workers.WorkerClient",worker:null,_queue:null,constructor:function(a,c){this._isIE=b("ie");this._queue={};this._acceptMessage=f.hitch(this,this._acceptMessage);this._errorMessage=f.hitch(this,this._errorMessage);a&&this.setWorker(a,function(a){this.worker=a;c(this)}.bind(this))},setWorker:function(b,c){if(b instanceof Array){var e=b;b=e.shift()}var f=this._getUrl(b),k=!a.hasSameOrigin(a.makeAbsolute(f),location.href),r;if(!1===f)return console.log("Can not resolve worker path"),
!1;this.worker&&(r=this.worker,r.removeEventListener("message",this._acceptMessage,!1),r.removeEventListener("error",this._errorMessage,!1),r.terminate(),r=null);if(k){k=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(k,function(a){a=g.createObjectURL(new h([a],{type:"text/javascript"}));c(this._createWorker(a,f))}.bind(this))}catch(n){try{k=a.getProxyUrl(k).path+"?"+encodeURI(k),this._useProxy=!0,c(this._createWorker(k,e))}catch(q){return console.log("Can not create worker"),!1}}}else c(this._createWorker(f,
e))},_createWorker:function(a,b){var c=new Worker(a);c.addEventListener("message",this._acceptMessage,!1);c.addEventListener("error",this._errorMessage,!1);this.worker=c;b&&this.importScripts(b);return c},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new k;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});
return c.promise},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c;c=this._getUrl(a,!0);return!1===c?(c=new k,c.reject({message:"Could not load text from "+a}),c.promise):this.postMessage({action:"add-callback",url:c,cbName:b||"main"}).then(f.hitch(this,function(a){a.target=this;this.emit("callback-added",a)}))},importScripts:function(b){Array.isArray(b)||
(b=[b]);b=b.map(function(b){b=this._getUrl(b,!0);this._useProxy&&!a.hasSameOrigin(b,location.href)&&(b=a.getProxyUrl(b).path+"?"+encodeURI(b));return b},this);return this.postMessage({action:"import-script",url:b}).then(f.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}))},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var e=this._queue[c];"progress"==b.status?e.progress(a.data):("error"==
b.status?e.reject(a.data):e.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(b,c){if(!b)return console.error("can not resolve empty path"),!1;b.match(/\.js$/)||(b+=".js");var f=e.toUrl(b);return c?a.makeAbsolute(f):f},_getRemoteText:function(a,b){(a=this._getUrl(a))&&
c.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){b(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new h(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=g.createObjectURL(a));try{return new Worker(a)}catch(b){return console.log(b.message),!1}}})})},"esri/layers/GraphicsLayer":function(){define("../core/Accessor ../core/Collection ../core/promiseUtils ./Layer ./mixins/ScaleRangeLayer ../Graphic dojo/_base/lang".split(" "),
function(q,n,k,f,c,b,a){var e=q.createSubclass({properties:{layer:null,layerView:null,graphics:null}});return f.createSubclass([c],{declaredClass:"esri.layers.GraphicsLayer",viewModulePaths:{"2d":"../views/2d/layers/GraphicsLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},getDefaults:function(b){return a.mixin(this.inherited(arguments),{graphics:[]})},destroy:function(){this.removeAll()},_gfxHdl:null,properties:{elevationInfo:null,graphics:{type:n.ofType(b),set:function(a){var b=this._get("graphics");
b||(a.forEach(function(a){a.layer=this},this),this._gfxHdl=a.on("change",function(a){var b,c,e;e=a.added;for(b=0;c=e[b];b++)c.layer=this;e=a.removed;for(b=0;c=e[b];b++)c.layer=null}.bind(this)),this._set("graphics",a),b=a);b.removeAll();b.addMany(a)}}},add:function(a){this.graphics.add(a);return this},addMany:function(a){this.graphics.addMany(a);return this},removeAll:function(){this.graphics.removeAll();return this},createGraphicsController:function(a){return k.resolve(new e({layer:this,layerView:a.layerView,
graphics:this.graphics}))},remove:function(a){this.graphics.remove(a)},removeMany:function(a){this.graphics.removeMany(a)},graphicChanged:function(a){this.emit("graphic-update",a)}})})},"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":function(){define(["require","exports"],function(q,n){return function(){function k(){this.elevationDirtyGraphicsQueue=[];this.elevationDirtyGraphicsSet={};this.elevationUpdateEventHandle=null;this.eventHandles=[];this.updateElevation=!1;this.graphicsCore=
this.layerView=null}k.prototype.initialize=function(f,c,b,a){var e=this;this.layerView=f;this.graphicsCore=b;this.elevationChangedCallback=c;this.elevationUpdateEventHandle=a.on("elevation-change",function(a){return e.elevationUpdateHandler(a)});this.eventHandles.push(this.layerView.watch("suspended",function(){return e.suspendedChange()}))};k.prototype.destroy=function(){this.elevationDirtyGraphicsSet=this.elevationDirtyGraphicsQueue=null;this.elevationUpdateEventHandle&&(this.elevationUpdateEventHandle.remove(),
this.elevationUpdateEventHandle=null);this.eventHandles.forEach(function(f){return f.remove()});this.elevationChangedCallback=this.graphicsCore=this.layerView=this.eventHandles=null};k.prototype.clear=function(){this.elevationDirtyGraphicsSet={};this.elevationDirtyGraphicsQueue=[]};k.prototype.suspendedChange=function(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&this.markAllGraphicsElevationDirty()};k.prototype.isUpdating=function(){return 0<
this.elevationDirtyGraphicsQueue.length};k.prototype.numNodesUpdating=function(){return this.elevationDirtyGraphicsQueue.length};k.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&0<this.elevationDirtyGraphicsQueue.length};k.prototype.idleUpdate=function(f){if(!f.done()){var c=this.layerView.view,b=this.elevationDirtyGraphicsQueue.length;if(0<b){for(var a=this.graphicsCore.stageLayer.getId(),e=this.graphicsCore.labelStageLayer?this.graphicsCore.labelStageLayer.getId():
null,h=0,g=0,g=0;g<b;g++){var d=this.elevationDirtyGraphicsQueue[g],m=this.graphicsCore.graphics[d];m&&m.alignWithElevation(c.basemapTerrain,c.renderCoordsHelper);delete this.elevationDirtyGraphicsSet[d];h++;if(20<=h){c._stage.processDirtyLayer(a);null!=e&&c._stage.processDirtyLayer(e);if(f.done())break;h=0}}c._stage.processDirtyLayer(a);null!=e&&c._stage.processDirtyLayer(e);this.elevationDirtyGraphicsQueue.splice(0,g+1);c.labelManager.setDirty();this.layerView._evaluateUpdatingState()}}};k.prototype.markAllGraphicsElevationDirty=
function(){for(var f in this.graphicsCore.graphics)this.markGraphicElevationDirty(this.graphicsCore.graphics[f].graphic.uid);this.layerView._evaluateUpdatingState()};k.prototype.markGraphicElevationDirty=function(f){this.elevationDirtyGraphicsSet[f]||(this.elevationDirtyGraphicsSet[f]=!0,this.elevationDirtyGraphicsQueue.push(f))};k.prototype.elevationUpdateHandler=function(f){var c=this,b=f.extent;if(this.layerView.suspended){if(!this.updateElevation&&(f=this.graphicsCore.computedExtent)&&b[2]>f.xmin&&
b[0]<f.xmax&&b[3]>f.ymin&&b[1]<f.ymax)this.updateElevation=!0}else-Infinity===b[0]?this.markAllGraphicsElevationDirty():this.elevationChangedCallback(b,f.spatialReference,function(a,b){for(var f=!1,g=0;g<b;g++){var d=a[g],m=c.graphicsCore.graphics[d];m&&m.mustAlignToTerrain()&&(c.markGraphicElevationDirty(d),f=!0)}f&&c.layerView._evaluateUpdatingState()})};return k}()})},"esri/views/3d/navigation/spherical/NavigationSpherical":function(){define("../Navigation ./ConstraintsSpherical ./AnimationSpherical ./actions/PanSpherical ./actions/ZoomSpherical ./actions/RotateSpherical ../../webgl-engine/lib/Camera ../../support/earthUtils ../../lib/glMatrix".split(" "),
function(q,n,k,f,c,b,a,e,h){var g=h.vec3d,d=h.mat4d,m=g.create(),l=g.create(),p=d.create();return q.createSubclass([n,k],{declaredClass:"esri.views.3d.navigation.spherical.NavigationSpherical",initialize:function(){this.pan=new f({navigation:this});this.zoom=new c({navigation:this});this.rotate=new b({navigation:this})},getInitialCamera:function(){return new a(g.createFrom(4*e.earthRadius,0,0),g.createFrom(e.earthRadius,0,0),g.createFrom(0,0,1))},fixTargetUpVector:function(){this.cameras.target.computeUpOnSphere()},
setPoiAuto:function(a,b){var c=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);this.picker.pickedIntersectionPoint(c,m)&&(this.setCameraFromEyeAndCenter(this.cameras.target.eye,m),g.set(this.cameras.target.center,this.cameras.current.center),b&&this.setCurrentToTarget())},rotateCameraWithPointsOnSphere:function(a,b,c,e,f){var h;null==f&&(f=g.length(a));1E-4<=Math.abs(g.length(a)-f)&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere]: invalid radius for source point (got "+
f+", but expected "+g.length(a)+", "+a+")"),h=g.length(a));1E-4<=Math.abs(g.length(b)-f)&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere: invalid radius for target point (got "+f+", but expected "+g.length(b)+")"),void 0===h&&(h=g.length(b)));void 0!==h&&(f=h);a=this.rotationFromPointsOnSphere(a,b,f,l);d.identity(p);d.rotate(p,a,l);d.multiplyVec3(p,c.eye,e.eye);d.multiplyVec3(p,c.center,e.center);d.multiplyVec3(p,c.up,e.up)},rotationFromPointsOnSphere:function(a,b,c,d){g.cross(a,
b,d);return-Math.acos(1-g.dist2(a,b)/(2*c*c))}})})},"esri/views/3d/navigation/Navigation":function(){define(["../../../core/Accessor","../../../core/Evented","../../../core/watchUtils","./Picker","./mixins/CamerasMixin"],function(q,n,k,f,c){return q.createSubclass([c,n],{properties:{interacting:{get:function(){return this._interacting},readOnly:!0},renderCoordsHelper:{},renderUnitInMeters:{dependsOn:["renderCoordsHelper"],get:function(){return this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:
1}},picker:{},constraints:{},pan:{},zoom:{},rotate:{}},initialize:function(){this._mapCoordsHelperHandle=k.init(this.view,"mapCoordsHelper",function(b){this.mapCoordsHelper=b}.bind(this));this._renderCoordsHelperHandle=k.init(this.view,"renderCoordsHelper",this.updateRenderCoordsHelper.bind(this));this.picker=new f(this,this.view);this._interacting=!1},destroy:function(){this._mapCoordsHelperHandle.remove();this._renderCoordsHelperHandle.remove()},updateRenderCoordsHelper:function(b){this.renderCoordsHelper=
b;this.inherited(arguments)},begin:function(b){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this._interacting=!0;this.notifyChange("interacting")},end:function(b){this._interacting=!1;this.notifyChange("interacting")}})})},"esri/views/3d/navigation/Picker":function(){define(["../../../core/declare","../support/RenderCoordsHelper","../lib/glMatrix","../webgl-engine/lib/Selector"],function(q,n,k,f){var c=k.vec3d,b=c.create(),a=c.create();return q([],{constructor:function(a,b){this.navigation=
a;this.pickAlongRay=b._pickRay.bind(b);this.createPickRay=b._pickRayWithBeginPoint.bind(b);this.selector=new f},pickPointInScreen:function(a,b){return this.pickedIntersectionPoint(this.pickInScreen(a,!1),b)},pickFreePointInScreen:function(e,f){this.createPickRay(e,void 0,this.navigation.currentCamera.viewMatrix,b,a);f||(f=c.create());c.subtract(a,b);c.normalize(a);var g=this.navigation.view.dataExtent,d=g.xmax-g.xmin,m=g.ymax-g.ymin,k=8*Math.max(g.xmax-g.xmin,g.ymax-g.ymin),d=Math.max(d,m,k),m=this.navigation.currentCamera,
k=Math.max(0,g.xmin-m.eye[0],m.eye[0]-g.xmax),g=Math.max(0,g.ymin-m.eye[1],m.eye[1]-g.ymax),g=Math.sqrt(k*k+g*g),k="global"==this.navigation.view.viewingMode?n.Spherical.prototype.getAltitude(m.eye):n.Planar.prototype.getAltitude(m.eye),m=this.navigation._getTerrainElevationBelowCamera(m),m=Math.abs(k-m)+Number.MIN_VALUE,m=Math.pow(Math.max(0,Math.log(d/m)),2),m=d/Math.max(1,m),m=Math.max(m,Math.min(g,d));c.scale(a,m);c.add(b,a,f)},pickInScreen:function(e,f){this.createPickRay(e,void 0,this.navigation.currentCamera.viewMatrix,
b,a);f&&c.set(this.navigation.currentCamera.eye,b);return this.pickAlongRay(b,a,e,e,null,null,this.selector)},pickedIntersectionPoint:function(a,b){if(!a)return!1;b||(b=c.create());return a.getMinResult().getIntersectionPoint(b)}})})},"esri/views/3d/navigation/mixins/CamerasMixin":function(){define("../../../../core/Accessor ../../../../core/Evented ../../webgl-engine/lib/Camera ../../support/mathUtils ../../lib/glMatrix dojo/on".split(" "),function(q,n,k,f,c,b){var a=c.vec4d.create();return q.createSubclass([n],
{declaredClass:"esri.views.3d.navigation.mixins.CamerasMixin",properties:{targetCamera:{get:function(){return this.cameras.target}},currentCamera:{get:function(){return this.cameras.current}},windowSize:{set:function(a){var b=a[0],c=a[1],d=!1,f=this.cameras.target.x-this.cameras.target.padding[3],k=this.cameras.target.y-this.cameras.target.padding[2];if(this.cameras.target.width+f!==b||this.cameras.target.height+k!==c)this.cameras.target.width=b-f,this.cameras.target.height=c-k,this.targetChanged(),
d=!0;f=this.cameras.current.x-this.cameras.current.padding[3];k=this.cameras.current.y-this.cameras.current.padding[2];if(this.cameras.current.width+f!==b||this.cameras.current.height+k!==c)this.cameras.current.width=b-f,this.cameras.current.height=c-k,this.currentChanged(),d=!0;d&&this.currentHasReachedTarget()&&this.currentReachedTarget();this._set("windowSize",a)}},padding:{set:function(b){var c=!1,g=!1;a[0]=b.top;a[1]=b.right;a[2]=b.bottom;a[3]=b.left;f.vectorEquals(this.cameras.current.padding,
a)||(this.cameras.current.padding=a,g=!0);f.vectorEquals(this.cameras.target.padding,a)||(this.cameras.target.padding=a,c=!0);c&&this.targetChanged();g&&this.currentChanged();this.currentHasReachedTarget()&&(c||g)&&this.currentReachedTarget()}}},initialize:function(){var a=this.getInitialCamera();this.cameras={current:a,target:a.copy()}},currentHasReachedTarget:function(){return this.cameras.current.equals(this.cameras.target)},currentHasAlmostReachedTarget:function(){return this.cameras.current.almostEquals(this.cameras.target,
5E-4/this.renderUnitInMeters)},setCamera:function(a,b){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.cameras.target.copyFrom(a);var c=!(b&&b.internalUpdate)||!this._targetCameraChangedByElevationUpdate,d=this.constrainTargetEyeByElevation(c),d=this.applyConstraints(this.cameras.target,!0)||d;this.fixTargetUpVector();this.currentHasReachedTarget()?(this.targetChanged(),d&&c&&(this._targetCameraChangedByElevationUpdate=!0),this.currentReachedTarget()):(void 0!==b&&void 0!==b.animate&&
!b.animate?this.targetAndCurrentChanged(!0):this.targetAnimatedChanged(),d&&c&&(this._targetCameraChangedByElevationUpdate=!0),this._autoUpdateTiltConstraint())},getTargetCamera:function(){console.warn("[Navigation.getTargetCamera()] deprecated; use .targetCamera instead");return this.targetCamera},getCurrentCamera:function(){console.warn("[Navigation.getCurrentCamera()] deprecated; use .currentCamera instead");return this.currentCamera},_cameraFromEyeCenterUp:function(a,b,c){var d=this.cameras.target.copy();
d.eye=a;d.center=b;d.up=c;return d},setCameraFromEyeAndCenter:function(a,b,c){this.setCamera(this._cameraFromEyeCenterUp(a,b,this.cameras.target.up),c)},setCameraFromEyeCenterAndUp:function(a,b,c,d){this.setCamera(this._cameraFromEyeCenterUp(a,b,c),d)},_cameraEvents:{},_prepareCameraEvent:function(a,b){var c=this._cameraEvents[a];c||(c={camera:new k},this._cameraEvents[a]=c);c.camera.copyFrom(b);return c},emitWithCamera:function(a,c){b.emit(this,a,this._prepareCameraEvent(a,c))},targetChanged:function(a){this.inherited(arguments);
this.cameras.target.markViewDirty();var c=this._prepareCameraEvent("targetViewChanged",this.cameras.target);c.interruptedAnimation=!!a;c.finishedAnimation=!1;b.emit(this,"targetViewChanged",c)},targetAnimatedChanged:function(a){this.targetChanged(a);this.animationStarted()},targetAndCurrentChanged:function(a){this.targetChanged(a);this.setCurrentToTarget(!1,a)},currentChanged:function(){this.inherited(arguments);this.cameras.current.markViewDirty();this.emitWithCamera("currentViewChanged",this.cameras.current)},
currentReachedTarget:function(a,c){this.currentChanged();if(!this.pan||!this.pan.continuous||!this.pan.continuous.active){var f=this._prepareCameraEvent("currentViewReachedTarget",this.cameras.current);f.finishedAnimation=!!a;f.interruptedAnimation=!!c;b.emit(this,"currentViewReachedTarget",f)}},setCurrentToTarget:function(a,b){this.cameras.current.copyFrom(this.cameras.target);this.currentReachedTarget(a,b)}})})},"esri/views/3d/navigation/spherical/ConstraintsSpherical":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../constraints/SceneViewTiltConstraint ../../webgl-engine/lib/Util".split(" "),
function(q,n,k,f,c,b,a){var e=f.vec3d,h=e.create();return q.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.ConstraintsSpherical",defaultConstraints:{tilt:new q.Tilt({min:function(){return n.deg2rad(b.MAX_DEFAULT)},max:n.makePiecewiseLinearFunction([[4E3,n.deg2rad(b.MIN_DEFAULT)],[5E4,n.deg2rad(88)],[6E6,n.deg2rad(88)],[2E7,n.deg2rad(b.MAX_DEFAULT)]])}),altitude:new q.Altitude({min:function(){return c.MIN_DEFAULT},max:function(){return c.MAX_DEFAULT}}),collision:new q.Collision},
initialize:function(){this.captainNemoAltitudeThreshold=2E4;this.captainNemoElevationThreshold=-500},limitAltitude:function(a,b,c,f){e.scale(c,a/f,h);e.subtract(b,h,h);var p=this.renderCoordsHelper.getAltitude(h),s=this.constraints.altitude.apply(this,p);if(1E-6<Math.abs(p-s)){a=e.length(b);s+=k.earthRadius;b=e.dot(c,b)/(a*f);b*=-2*a;c=b*b-4*(-(s*s)+a*a);if(0>c)return this.minPoiDist;c=Math.sqrt(c);return c<b?(b-c)/2:(c-b)/2}return a},limitTiltByAltitudeConstraints:function(a,b,c,f){b=e.length(b);
var h=b*b,s=c*c,r=Math.sqrt(h+s-2*b*c*Math.cos(Math.PI-a))-k.earthRadius,t=this.constraints.altitude.min(),q=this.constraints.altitude.max(),v;if((void 0===f||0<f)&&r<t)v=t;else if((void 0===f||0>f)&&r>q)v=q;void 0!==v&&(a=v+k.earthRadius,a=Math.PI-n.acos((-(a*a)+h+s)/(2*b*c)));return a},distanceToSilhouette:function(a,b,c,f,h){h||(h={maxFarNearRatio:0,distance:0});a=e.dot(a.eye,a.eye);b=k.earthRadius*k.earthRadius;h.maxFarNearRatio=this.maxFarNearRatio;this.isNemoMode(a,f)?(f=k.earthRadius+f,h.distance=
Math.sqrt(a-f*f)):a>b?(h.maxFarNearRatio=n.clamp(2E4-19E3*((Math.log(Math.sqrt(a)-k.earthRadius)-7.983)/9.011),1E3,2E4),h.distance=Math.sqrt(a-b)):h.distance=this.maxFarNearRatio*this.minNearDistance;h.distance*=1.2;return h},isNemoMode:function(a,b){var c=k.earthRadius+this.captainNemoAltitudeThreshold;return a<c*c&&b<this.captainNemoElevationThreshold},intersectManifold:function(b,c,e,f){return a.raySphereClosestPositive(b,c,k.earthRadius+e,f)},getFallbackCenterAlongViewDirection:function(a,b,c){var f=
e.dot(a,a),h=k.earthRadius*k.earthRadius,f=f>h?Math.sqrt(f-h)/3:1;e.subtract(b,a,c);e.scale(c,f/e.length(c),c);e.add(c,a)}})})},"esri/views/3d/navigation/mixins/ConstraintsMixin":function(){define("../../../../core/Accessor ../../../../core/watchUtils ../../../../geometry/Point ../../support/mathUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../webgl-engine/lib/Camera ../../webgl-engine/lib/IntervalUtilities".split(" "),function(q,n,k,f,c,b,a,e){function h(a){return new z.Tilt({min:function(){return 0.01},
max:function(){return f.deg2rad(a.tilt.max)}})}function g(a){return new z.Altitude({min:function(){return a.altitude.min},max:function(){return a.altitude.max}})}var d=c.vec3d,m=c.mat4d,l=new k,p=d.create(),s=d.create(),r=m.create(),t=d.create(),u=d.create(),v=d.create(),C=new a,y=d.create(),x={tilt:0,distance:0},B={distance:0,maxFarNearRatio:0},z=q.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.ConstraintsMixin",properties:{userConstraints:{set:function(a){this._disconnectUserConstraints();
this._connectUserConstraints(a);this._set("userConstraints",a)}},elevationProvider:{value:null,set:function(a){null!==this._elevationChangeHandle&&(this._elevationChangeHandle.remove(),this._elevationChangeHandle=null);null!==this._elevationChangeTileHandle&&(this._elevationChangeTileHandle.remove(),this._elevationChangeTileHandle=null);null!==a&&(this._elevationChangeHandle=a.on("elevation-change",this._elevationChangeHandler.bind(this)),this._elevationChangeTileHandle=a.on("elevation-change-tile",
this._elevationChangeTileHandler.bind(this)));this._set("elevationProvider",a)}},minPoiDist:{get:function(){return this._minPoiDistInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},cameraElevationMargin:{get:function(){return this._cameraElevationMarginInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},minNearDistance:{get:function(){return this._minNearDistanceInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},renderUnitInMeters:{},constraintsEnabled:{value:!0}},
constructor:function(){this._userConstraints=null;this._userConstraintsHandles=[];this._clipDistanceHandles=[];this._tiltHandles=[];this._altitudeHandles=[];this.constraints={tilt:this.defaultConstraints.tilt,altitude:this.defaultConstraints.altitude,collision:this.defaultConstraints.collision};this._tiltModeHandler=this._tiltModeHandler.bind(this);this._tiltMaxHandler=this._tiltMaxHandler.bind(this);this._altitudeModeHandler=this._altitudeModeHandler.bind(this);this._altitudeMinMaxHandler=this._altitudeMinMaxHandler.bind(this);
this._clipDistanceModeHandler=this._clipDistanceModeHandler.bind(this);this._clipDistanceNearFarHandler=this._clipDistanceNearFarHandler.bind(this);this._collisionEnabledHandler=this._collisionEnabledHandler.bind(this);this.enableElevationUpdates=!0;this.updateTargetByElevationUpdates=z.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT;this._recomputeTargetCenterForElevationChange=!1;this._terrainElevationAtCameraEye=this._terrainElevationBelowCamera=this._elevationChangeTileHandle=this._elevationChangeHandle=
null;this._autoAltitudeConstraints={min:b.MIN_DEFAULT,max:b.MAX_DEFAULT};this.maxFarNearRatio=2E4;this._minNearDistanceInMeters=2;this._minPoiDistInMeters=4;this._cameraElevationMarginInMeters=5},initialize:function(){this._targetCameraBeforeElevationUpdate=this.cameras.current.copy();this._sceneExtentChangeHandle=this.view.watch("dataExtent",function(a){this._dataExtentChanged()}.bind(this))},_dataExtentChanged:function(){this.view.ready&&(this._updateAltitudeConstraintFromExtent(this.view.dataExtent),
this._reapplyConstraints(),this._camerasChanged())},_updateAutoAltitudeConstraints:function(a){},updateRenderCoordsHelper:function(a,b){this.inherited(arguments);if(!this._userConstraints||"auto"===this._userConstraints.altitude.mode)this.constraints.altitude=z.Altitude.scale(this.defaultConstraints.altitude,a.unitInMeters);if(!this._userConstraints||"auto"===this._userConstraints.tilt.mode)this.constraints.tilt=z.Tilt.scale(this.defaultConstraints.tilt,a.unitInMeters);this._updateAltitudeConstraintFromExtent(this.view.dataExtent);
this._reapplyConstraints();this._camerasChanged()},_updateAltitudeConstraintFromExtent:function(a){0<a.xmax-a.xmin&&(this._updateAutoAltitudeConstraints(a),(!this._userConstraints||"auto"===this._userConstraints.altitude.mode)&&this._autoUpdateAltitudeConstraint())},destroy:function(){this._disconnectUserConstraints();this._sceneExtentChangeHandle.remove()},_updateTargetCenterForElevation:function(a){if(a||this.enableElevationUpdates&&this.updateTargetByElevationUpdates)(a=this.getCameraIntersectTerrain(this.cameras.target.eye,
this.cameras.target.center,this.cameras.target.up,0.02))&&!a.equals(this.cameras.target)&&this.setCamera(a,{internalUpdate:!0})},step:function(){if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active||this.pan.active||this.zoom.active||this.rotate.active)&&this._recomputeTargetCenterForElevationChange){var a=this._targetCameraChangedByElevationUpdate;this._updateTargetCenterForElevation();a&&(this._targetCameraChangedByElevationUpdate=!0);this._recomputeTargetCenterForElevationChange=!1}this.inherited(arguments)},
applyConstraints:function(a,b){if(!this.constraintsEnabled)return!1;var c=this._cameraElevationAngle(a,x),e=this.constraints.tilt.min(c.distance),f=this.constraints.tilt.max(c.distance),h=0;!b&&c.tilt>f?h=c.tilt-f:c.tilt<e&&(h=c.tilt-e);c=!1;0.01<Math.abs(h)&&(d.cross(p,a.up,s),m.identity(r),m.rotate(r,h,s),m.multiplyVec3(r,p),d.add(a.center,p,a.eye),m.multiplyVec3(r,a.up),c=!0);d.subtract(a.center,a.eye,t);h=a.distance;e=this.limitAltitude(h,a.center,t,h);h!==e&&(d.scale(t,-e/h),d.add(a.center,t,
a.eye),c=!0);this._autoUpdateTiltConstraint(f);return c},limitTiltByConstraints:function(a,b,c,d){if(!this.constraintsEnabled)return a;var e=this.constraints.tilt.min(c),f=this.constraints.tilt.max(c);if((void 0===d||0<d)&&a>=f)a=f;else if((void 0===d||0>d)&&a<=e)a=e;a=this.limitTiltByAltitudeConstraints(a,b,c,d);this._autoUpdateTiltConstraint(f);return a},_autoUpdateAltitudeConstraint:function(){var a=this._userConstraints&&this._userConstraints.altitude;a&&"auto"===a.mode&&a.autoUpdate(this.constraints.altitude.min(this),
this.constraints.altitude.max(this))},_autoUpdateTiltConstraint:function(a){var b=this._userConstraints&&this._userConstraints.tilt;void 0===a&&(a=this.constraints.tilt.max(this.cameras.target.distance));b&&"auto"===b.mode&&b.autoUpdate(f.rad2deg(a))},_disconnectUserConstraints:function(){if(this._userConstraints){this._userConstraintsHandles.forEach(function(a){a.remove()});this._userConstraints=null;this._userConstraintsHandles.length=0;var a=this.renderUnitInMeters;this.constraints.tilt=z.Tilt.scale(this.defaultConstraints.tilt,
a);this.constraints.altitude=z.Altitude.scale(this.defaultConstraints.altitude,a)}},_connectUserConstraints:function(a){a&&(this._userConstraints=a,this._userConstraintsHandles.push(n.init(a,"tilt.mode",this._tiltModeHandler),n.init(a,"clipDistance.mode",this._clipDistanceModeHandler),n.init(a,"altitude.mode",this._altitudeModeHandler),n.init(a,"collision.enabled",this._collisionEnabledHandler)))},_camerasChanged:function(){this.targetChanged();this.currentChanged();this.currentHasReachedTarget()&&
this.currentReachedTarget()},_reapplyConstraints:function(){var a=!1;this.applyConstraints(this.cameras.current)&&(a=!0);this.applyConstraints(this.cameras.target)&&(a=!0);a&&this._camerasChanged()},_userConstraintsChanged:function(){this._reapplyConstraints()},_altitudeMinMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltModeHandler:function(a){this._tiltHandles.forEach(function(a){a.remove()});this._tiltHandles.length=
0;"auto"===a?this.constraints.tilt=z.Tilt.scale(this.defaultConstraints.tilt,this.renderUnitInMeters):(this._tiltHandles.push(this._userConstraints.watch("tilt.max",this._tiltMaxHandler)),this.constraints.tilt=h(this._userConstraints));this._tiltMaxHandler()},_altitudeModeHandler:function(a){this._altitudeHandles.forEach(function(a){a.remove()});this._altitudeHandles.length=0;"auto"===a?(this.constraints.altitude=z.Altitude.scale(this.defaultConstraints.altitude,this.renderUnitInMeters),this._autoUpdateAltitudeConstraint()):
(this._altitudeHandles.push(this._userConstraints.watch("altitude.min",this._altitudeMinMaxHandler),this._userConstraints.watch("altitude.max",this._altitudeMinMaxHandler)),this.constraints.altitude=g(this._userConstraints));this._altitudeMinMaxHandler()},_collisionEnabledHandler:function(a,b,c){this.constraints.collision=new z.Collision(this._userConstraints.collision.enabled);this._userConstraintsChanged()},_clipDistanceNearFarHandler:function(a,b,c){"auto"!==this._userConstraints.clipDistance.mode&&
(this.cameras.target.near=this._userConstraints.clipDistance.near,this.cameras.target.far=this._userConstraints.clipDistance.far,this.cameras.current.near=this._userConstraints.clipDistance.near,this.cameras.current.far=this._userConstraints.clipDistance.far);this._camerasChanged()},_clipDistanceModeHandler:function(a){this._clipDistanceHandles.forEach(function(a){a.remove()});this._clipDistanceHandles.length=0;"auto"!==a&&this._clipDistanceHandles.push(this._userConstraints.watch(["clipDistance.near",
"clipDistance.far"],this._clipDistanceNearFarHandler));this._clipDistanceNearFarHandler()},_updateAutoNearFar:function(a){var b=this._userConstraints&&this._userConstraints.clipDistance;if(!(b&&"auto"!==b.mode)){var c=this.renderUnitInMeters,d=this.distanceToSilhouette(a,this.view.dataExtent,c,this._getTerrainElevationBelowCamera(a),B);a.far=d.distance/c;a.far/d.maxFarNearRatio>this.minNearDistance?a.near=a.far/d.maxFarNearRatio:(a.near=this.minNearDistance,a.far=a.near*d.maxFarNearRatio);b&&a===
this.cameras.current&&b.autoUpdate(a.near,a.far)}},constrainTargetEyeByElevation:function(a){if(!this.elevationProvider||!this.elevationProvider.spatialReference)return!1;var b=this.cameras.target;a&&this._targetCameraBeforeElevationUpdate.copyFrom(b);return this._applyTargetEyeElevationConstraint(b.eye,this._getTerrainElevationBelowCamera(b))},constrainTargetEyeByElevationAndMoveLookAt:function(){d.set(this.cameras.target.eye,v);this.constrainTargetEyeByElevation()&&(d.subtract(v,this.cameras.target.eye),
d.subtract(this.cameras.target.center,v))},targetChanged:function(a){this.inherited(arguments);this._targetCameraChangedByElevationUpdate=!1;this._updateAutoNearFar(this.cameras.target);this.currentHasReachedTarget()&&this.currentReachedTarget()},currentChanged:function(){this._updateAutoNearFar(this.cameras.current);this.inherited(arguments)},_applyTargetEyeElevationConstraint:function(a,b){if(!this.constraintsEnabled)return!1;var c=this.renderCoordsHelper,d=c.getAltitude(a);return this.constraints.collision.enabled&&
d-b<this.cameraElevationMargin?(c.setAltitude(b+this.cameraElevationMargin,a,0),!0):!1},_cameraElevationAngle:function(a,b){b=b||{tilt:0,distance:0};this.renderCoordsHelper.worldUpAtPosition(a.center,u);d.subtract(a.eye,a.center,p);var c=d.length(p),e=Math.acos(d.dot(p,u)/c/d.length(u));b.tilt=e;b.distance=c;return b},_elevationChangeTileHandler:function(a){if(this.enableElevationUpdates&&this._targetCameraChangedByElevationUpdate&&this.constraintsEnabled){var b=!1,c=a.tile.extent;a=this.renderCoordsHelper.fromRenderCoords(this._targetCameraBeforeElevationUpdate.eye,
l,a.spatialReference);c[0]<=a.x&&(c[1]<=a.y&&c[2]>a.x&&c[3]>a.y)&&(C.copyFrom(this.cameras.target),this.cameras.target.copyFrom(this._targetCameraBeforeElevationUpdate),this.constrainTargetEyeByElevation(),b=!C.equals(this.cameras.target),b=this.applyConstraints(this.cameras.target)||b);b&&(this.targetChanged(),this._targetCameraChangedByElevationUpdate=!0)}},_elevationChangeHandler:function(a){var b=this.renderCoordsHelper,c=this.cameras.target.eye,d=a.extent,f=b.fromRenderCoords(c,a.spatialReference),
h=d[0]<=f.x&&d[1]<=f.y&&d[2]>f.x&&d[3]>f.y;h&&(this._terrainElevationAtCameraEye=null);if(this.enableElevationUpdates&&this.constraintsEnabled){var g=!1;h&&(this._targetCameraChangedByElevationUpdate||this._targetCameraBeforeElevationUpdate.copyFrom(this.cameras.target),g=this._applyTargetEyeElevationConstraint(c,this._getTerrainElevationBelowCamera(this.cameras.target)));g&&(this.targetChanged(),this._targetCameraChangedByElevationUpdate=!0);this._recomputeTargetCenterForElevationChange||(h=b.fromRenderCoords(this.cameras.target.center,
a.spatialReference),b=Math.max(h.x,f.x),c=Math.min(h.x,f.x),a=Math.max(h.y,f.y),f=Math.min(h.y,f.y),b=e.intersectIntervals([[c,b]],[[d[0],d[2]]]),d=e.intersectIntervals([[f,a]],[[d[1],d[3]]]),0<b.length&&0<d.length&&(this._recomputeTargetCenterForElevationChange=!0))}},_getTerrainElevationBelowCamera:function(a){if(!this.elevationProvider||!this.elevationProvider.spatialReference)this._terrainElevationBelowCamera=0;else if(!this._terrainElevationAtCameraEye||!a.eye||!(this._terrainElevationAtCameraEye[0]===
a.eye[0]&&this._terrainElevationAtCameraEye[1]===a.eye[1]&&this._terrainElevationAtCameraEye[2]===a.eye[2])){var b=this.renderCoordsHelper.fromRenderCoords(a.eye,this.elevationProvider.spatialReference);this._terrainElevationBelowCamera=this.elevationProvider.getElevation(b)||0;this._terrainElevationAtCameraEye=a.eye}return this._terrainElevationBelowCamera},getCenterIntersectTerrain:function(a,b,c){c||(c=d.create());d.set(b,c);var e=this.picker.pickAlongRay(a,c);this.picker.pickedIntersectionPoint(e,
c)||this.getCenterIntersectManifold(a,b,c)||this.getFallbackCenterAlongViewDirection(a,b,c);return c},getCenterIntersectManifold:function(a,b,c){d.subtract(b,a,p);return this.intersectManifold(a,p,0,c)},getCameraIntersectTerrain:function(a,b,c,e){var f=this.cameras.current.copy();a&&(f.eye=a);b&&(f.center=b);c&&(f.up=c);this.getCenterIntersectTerrain(f.eye,f.center,y);d.dist2(f.eye,y)<this.minPoiDist&&this.constraintsEnabled&&(a=this.constraints.collision.enabled,d.set(f.viewForward,p),d.scale(p,
this.minPoiDist),a?d.subtract(y,p,f.eye):d.add(f.eye,p,y),b=this.renderCoordsHelper,c=b.getAltitude(f.eye),a&&c<this.cameraElevationMargin&&(d.subtract(y,f.eye,p),b.setAltitude(this.cameraElevationMargin,f.eye),d.add(f.eye,p,y)),f.markViewDirty());0<e?(a=d.dist(f.eye,f.center),d.dist(y,f.center)>a*e&&(f.center=y)):f.center=y;return f}});z.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT=!0;z.Tilt=function(a){this.min=a.min;this.max=a.max};z.Tilt.scale=function(a,b){return 1===b?a:new z.Tilt({min:function(c){return a.min(c*
b)},max:function(c){return a.max(c*b)}})};z.Tilt.prototype.apply=function(a,b){return f.clamp(a,this.min(b),this.max(b))};z.Altitude=function(a){this.min=a.min;this.max=a.max};z.Altitude.scale=function(a,b){return 1===b?a:new z.Altitude({min:function(c){return a.min(c)/b},max:function(c){return a.max(c)/b}})};z.Altitude.prototype.apply=function(a,b){return f.clamp(b,this.min(a),this.max(a))};z.Collision=function(a){this.enabled=null!=a?a:!0};return z})},"esri/views/3d/navigation/spherical/AnimationSpherical":function(){define(["../mixins/AnimationMixin",
"../../lib/glMatrix","../../support/mathUtils"],function(q,n,k){function f(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f}function c(a,b){return Math.sqrt(f(a,b))}function b(a){this.interpolate=function(a,b,c){c=Math.min(9*c,0.3);k.slerpOrLerp(a.center,b.center,c,a.center,d);k.slerpOrLerp(a.eye,b.eye,c,a.eye,d);k.slerp(a.up,b.up,c);a.fov=k.lerp(a.fov,b.fov,c);a.padding=h.lerp(a.padding,b.padding,c,g);a.computeUpOnSphere()}}function a(a,b,f){b=b||250;f=f||b;var s=0,
r=0,n=0,q=0,v=function(a,c,h,g){var m=e.dist(a,c);if(0.1>m)return e.set(c,a),0;var r=Math.min(Math.sqrt(m*f),b);g=Math.min(g+f*h,r);h=Math.min(g/m*h,1);k.slerpOrLerp(a,c,h,a,d);return g};this.interpolate=function(d,e,x){s=v(d.eye,e.eye,x,s);r=v(d.center,e.center,x,r);q=v(d.padding,e.padding,x,q,{dist:c,lerp:function(a,b,c){return h.lerp(a,b,c,g)},set:function(a){d.padding=a}});n=a.easeInOutInterpLinear(f,b,d.fov,e.fov,x,n,{dist:function(a,b){return Math.abs(b-a)},lerp:k.lerp,set:function(a){d.fov=
a}});d.computeUpOnSphere()}}var e=n.vec3d,h=n.vec4d,g=h.create(),d=1E-4;return q.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.AnimationSpherical",constructor:function(){this.interpolationTypes={linear:b,easeInOut:a}}})})},"esri/views/3d/navigation/mixins/AnimationMixin":function(){define(["../../../../core/Accessor","dojo/on"],function(q,n){return q.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.AnimationMixin",properties:{interpolation:{set:function(k){if("string"===
typeof k){var f=this.interpolationTypes[k];f?this._set("interpolation",new f(this)):console.error("[AnimationMixin] Invalid interpolation type "+k)}else this._set("interpolation",k)}}},getDefaults:function(){return{interpolation:"linear"}},easeInOutInterpLinear:function(k,f,c,b,a,e,h){var g=h.dist(c,b);if(g<0.1/this.renderUnitInMeters)return h.set(b,c),0;f=Math.min(Math.sqrt(g*k),f);e=Math.min(e+k*a,f);k=Math.min(e/g*a,1);h.set(h.lerp(c,b,k),c);return e},step:function(k){this.inherited(arguments);
this.currentHasReachedTarget()?this.pan.updateContinuous(k):(this.currentHasAlmostReachedTarget()||this.interpolation.interpolate(this.cameras.current,this.cameras.target,0.0010*k),this.currentHasAlmostReachedTarget()?this.setCurrentToTarget(!0):this.currentChanged())},animationStarted:function(){n.emit(this,"animationStarted")},stop:function(){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.currentHasAlmostReachedTarget()?this.currentReachedTarget(!0):this.setCurrentToTarget()}})})},
"esri/views/3d/navigation/spherical/actions/PanSpherical":function(){define("./ActionSpherical ../../mixins/PanMixin ../../../lib/glMatrix ../../../support/earthUtils ../../../support/mathUtils ../../../webgl-engine/lib/Util ../../ContinuousAction ../../NavigationConstants".split(" "),function(q,n,k,f,c,b,a,e){var h=k.vec2d,g=k.vec3d,d=k.vec4d,m=k.mat4d,l=g.create(),p=g.create(),s=g.create(),r=g.create(),t=g.create(),u=g.create(),v=m.create(),C=e.Pan.Mode,y=e.Pan.Direction,x=e.Pan.Vertical,B=e.Pan.Momentum;
return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.spherical.actions.PanSpherical",constructor:function(){this._lastPanActionPtr=this._panMode=0;this._lastPanActions=[];this._plane=d.create();this._isMomentumPanning=!1;this.continuous=new a;for(var b=0;b<B.BUFFER_SIZE;b++)this._lastPanActions[b]={point:g.create(),pointScreen:h.create(),time:0}},begin:function(a,c){this.inherited(arguments);this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=g.length(this._navPickPoint):
(this._navSphereRadius=g.length(this.targetCamera.center),this._navSphereRadius<0.9*f.earthRadius&&(this._navSphereRadius=f.earthRadius),this.createPickRay(a,a,this.currentCamera.viewMatrix,l,p),g.subtract(p,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,p,this._navSphereRadius-f.earthRadius,this._navPickPoint)||this.closestPointOnSphereSilhouette(this.currentCamera.eye,l,this._navSphereRadius,this._navPickPoint));var d=!1;this.renderCoordsHelper.getAltitude(this.currentCamera.eye)<
x.ELEVATION_THRESHOLD&&(this._navSphereRadius>g.length(this.currentCamera.eye)?d=!0:(g.normalize(g.subtract(this.targetCamera.eye,this._navPickPoint,s)),d=Math.abs(0.5*Math.PI-Math.acos(g.dot(this._navPickPoint,s)/g.length(this._navPickPoint)))<x.ANGLE_THRESHOLD));d?(this._panMode=C.VERTICAL,g.normalize(g.subtract(this.targetCamera.eye,this.targetCamera.center,s)),this.updatePlane(this._navPickPoint,s)):(this._panMode=C.HORIZONTAL,this._addToLastPanActions(void 0===c?b.performance.now():c,this._navPickPoint,
a));h.set(a,this._dragLastPoint);h.set(a,this._dragBeginPoint);this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(a,c){if(this._panMode===C.HORIZONTAL){if(0>=this._navSphereRadius)return;this.createPickRay(a,this._dragBeginPoint,this._mouseDownCamera.viewMatrix,l,p);g.subtract(p,this._mouseDownCamera.eye);this.intersectManifold(this._mouseDownCamera.eye,p,this._navSphereRadius-f.earthRadius,this._targetOnSphere)||this.closestPointOnSphereSilhouette(this._mouseDownCamera.eye,l,this._navSphereRadius,
this._targetOnSphere);this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,this._mouseDownCamera,this.targetCamera,this._navSphereRadius);this._addToLastPanActions(void 0===c?b.performance.now():c,this._targetOnSphere,a)}else{this.createPickRay(this._dragLastPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,l,p);g.subtract(p,l);if(!b.rayPlane(l,p,this._plane,r))return;this.createPickRay(a,this._dragBeginPoint,this.currentCamera.viewMatrix,l,p);g.subtract(p,l);if(!b.rayPlane(l,
p,this._plane,t))return;g.subtract(t,r);g.subtract(this.targetCamera.eye,t);g.subtract(this.targetCamera.center,t);h.set(a,this._dragLastPoint)}this.constrainTargetEyeByElevationAndMoveLookAt();h.set(a,this._dragLastPoint);this.fixTargetUpVector();this.targetAndCurrentChanged();this.inherited(arguments)},end:function(a,b){this._panMode===C.HORIZONTAL&&this._initiateMomentumPanning(a,b);this._navSphereRadius=0;this.inherited(arguments)},_initiateMomentumPanning:function(a,b){if(0<h.dist(this._dragLastPoint,
a)&&0<this._navSphereRadius){this.update(a,b);var c=this._lastPanActionPtr;do if(c=(c-1+B.BUFFER_SIZE)%B.BUFFER_SIZE,this._lastPanActions[this._lastPanActionPtr].time-this._lastPanActions[c].time>1E3*B.INPUT_FILTER)break;while(this._lastPanActionPtr!==c);c++;c%=B.BUFFER_SIZE;c===this._lastPanActionPtr&&(c=(this._lastPanActionPtr-1+B.BUFFER_SIZE)%B.BUFFER_SIZE);var d=0.0010*(this._lastPanActions[this._lastPanActionPtr].time-this._lastPanActions[c].time);if(0<d){var e=this.rotationFromPointsOnSphere(this._lastPanActions[c].point,
this._lastPanActions[this._lastPanActionPtr].point,this._navSphereRadius,this.continuous.direction);this.continuous.velocity=e/d;var e=h.create(),f=h.create();this.normalizeCoordinate(this._lastPanActions[c].pointScreen,e);this.normalizeCoordinate(this._lastPanActions[this._lastPanActionPtr].pointScreen,f);c=Math.min(h.dist(e,f)/d/B.DURATION_LONG_VEL,1);this.continuous.timer=B.DURATION_SHORT+c*(B.DURATION_LONG-B.DURATION_SHORT);this._isMomentumPanning=!0;this.animationStarted();return!0}this.currentReachedTarget()}else this.setPoiAuto(a,
!0);return!1},beginContinuous:function(a){this.inherited(arguments);this.setCurrentToTarget();0===this.continuous.status&&g.set3(0,0,0,this.continuous.direction);if(!(this.continuous.status&a)){this.continuous.status|=a;if(a&(y.LEFT|y.RIGHT|y.FORWARD|y.BACKWARD))this._computePanAxis(a,u),g.add(this.continuous.direction,u);else{var b=this.continuous.status&(y.UP|y.DOWN);this.continuous.radiusChange=b===y.UP?1:b===y.DOWN?-1:0}this.continuous.velocity=this._computePanVelocity()}this.continuous.timer=
0},updateContinuous:function(a){if(this.continuous)if(this.continuous.active){a=this.continuous.step(a);var b=0.01<g.dot(this.continuous.direction,this.continuous.direction);if(0<Math.abs(this.continuous.radiusChange)){var c=1+a*this.continuous.radiusChange;g.scale(this.targetCamera.center,c);g.scale(this.targetCamera.eye,c);this.continuous.velocity=this._computePanVelocity();b||(this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged(!0))}b&&(m.identity(v),m.rotate(v,a,this.continuous.direction),
m.multiplyVec3(v,this.targetCamera.eye),m.multiplyVec3(v,this.targetCamera.center),m.multiplyVec3(v,this.targetCamera.up),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.targetAndCurrentChanged())}else this._isMomentumPanning&&(this._isMomentumPanning=!1,this.targetAndCurrentChanged(!0))},endContinuous:function(a){this.continuous.status&=~a;if(0===this.continuous.status)this.continuous.stop(),this.continuous.radiusChange=0;else if(a&(y.LEFT|y.RIGHT|y.FORWARD|y.BACKWARD))this._computePanAxis(a,
u),g.subtract(this.continuous.direction,u),0.01>g.length(this.continuous.direction)&&g.set3(0,0,0,this.continuous.direction);else{var b=this.continuous.status&(y.UP|y.DOWN);this.continuous.radiusChange=b==y.UP?1:b==y.DOWN?-1:0}this.inherited(arguments)},_computePanAxis:function(a,b){g.subtract(this.targetCamera.center,this.targetCamera.eye,b);g.cross(b,this.targetCamera.up);if(a===y.LEFT||a===y.RIGHT)g.normalize(b),g.cross(b,this.targetCamera.center);(a===y.RIGHT||a===y.FORWARD)&&g.negate(b);g.normalize(b)},
_computePanVelocity:function(){var a=0.5*Math.abs(g.length(this.targetCamera.eye)-f.earthRadius),a=c.clamp(a,1,2*f.earthRadius);return c.acos(1-a*a/(2*f.earthRadius*f.earthRadius))},_addToLastPanActions:function(a,b,c){this._lastPanActionPtr=(this._lastPanActionPtr+1)%5;this._lastPanActions[this._lastPanActionPtr].time=a;g.set(b,this._lastPanActions[this._lastPanActionPtr].point);h.set(c,this._lastPanActions[this._lastPanActionPtr].pointScreen)},updatePlane:function(a,b){d.set4(b[0],b[1],b[2],-g.dot(b,
a),this._plane)}})})},"esri/views/3d/navigation/spherical/actions/ActionSpherical":function(){define(["../../Action","../../../support/mathUtils","../../../lib/glMatrix"],function(q,n,k){var f=k.vec3d,c=k.mat4d,b=f.create(),a=c.create();return q.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.actions.ActionSpherical",constructor:function(){this._targetOnSphere=f.create();this._navSphereRadius=0},closestPointOnSphereSilhouette:function(e,h,g,d){f.cross(e,h,b);f.cross(b,e,d);f.scale(d,
1/f.length(d)*g);e=-n.asin(g/f.length(e));c.identity(a);c.rotate(a,e,b);c.multiplyVec3(a,d)},rotateCameraWithPointsOnSphere:function(a,b,c,d,f){return this.navigation.rotateCameraWithPointsOnSphere(a,b,c,d,f)},rotationFromPointsOnSphere:function(a,b,c,d){return this.navigation.rotationFromPointsOnSphere(a,b,c,d)}})})},"esri/views/3d/navigation/Action":function(){define(["../../../core/Accessor","../../../core/Evented","../webgl-engine/lib/Camera","../lib/glMatrix","dojo/on"],function(q,n,k,f,c){var b=
f.vec3d,a=f.vec2d;return q.createSubclass([n],{properties:{type:{},navigation:{},picker:{readOnly:!0,aliasOf:"navigation.picker"},currentCamera:{aliasOf:"navigation.currentCamera"},targetCamera:{aliasOf:"navigation.targetCamera"},constraints:{readOnly:!0,aliasOf:"navigation.constraints"},renderCoordsHelper:{readOnly:!0,aliasOf:"navigation.renderCoordsHelper"},minPoiDist:{readOnly:!0,aliasOf:"navigation.minPoiDist"}},constructor:function(){this._tmpEvent={type:null,phase:null,x:void 0,y:void 0};this._mouseDownCamera=
new k;this._navPickPoint=b.create();this._dragLastPoint=a.create();this._dragBeginPoint=a.create();this.active=!1},initialize:function(){var a=this;["minPoiDist","renderCoordsHelper","constraints","picker"].forEach(function(b){this.navigation.watch(b,function(){a.notifyChange(b)})}.bind(this))},emit:function(a,b,f){this._tmpEvent.type=this.type;this._tmpEvent.phase=a;this._tmpEvent.x=b;this._tmpEvent.y=f;c.emit(this,a,this._tmpEvent);c.emit(this.navigation,this.type,this._tmpEvent)},intersectManifold:function(a,
b,c,d){return this.navigation.intersectManifold(a,b,c,d)},fixTargetUpVector:function(){return this.navigation.fixTargetUpVector()},setPoiAuto:function(a,b){return this.navigation.setPoiAuto(a,b)},normalizeCoordinate:function(a,b){b[0]=a[0]/this.currentCamera.width;b[1]=a[1]/this.currentCamera.height},worldUpAtPosition:function(a,b){return this.renderCoordsHelper.worldUpAtPosition(a,b)},applyConstraints:function(a,b){return this.navigation.applyConstraints(a,b)},constrainTargetEyeByElevation:function(a){return this.navigation.constrainTargetEyeByElevation(a)},
constrainTargetEyeByElevationAndMoveLookAt:function(){return this.navigation.constrainTargetEyeByElevationAndMoveLookAt()},targetAndCurrentChanged:function(a){return this.navigation.targetAndCurrentChanged(a)},targetAnimatedChanged:function(a){return this.navigation.targetAnimatedChanged(a)},currentReachedTarget:function(a){return this.navigation.currentReachedTarget(a)},setCurrentToTarget:function(){return this.navigation.setCurrentToTarget()},animationStarted:function(){return this.navigation.animationStarted()},
limitAltitude:function(a,b,c,d){return this.navigation.limitAltitude(a,b,c,d)},limitTiltByConstraints:function(a,b,c,d){return this.navigation.limitTiltByConstraints(a,b,c,d)},createPickRay:function(a,b,c,d,f){return this.picker.createPickRay(a,b,c,d,f)},pickAlongRay:function(a,b,c,d,f,k){return this.picker.pickAlongRay(a,b,c,d,f,k)},pickPointInScreen:function(a,b){return this.picker.pickPointInScreen(a,b)},pickFreePointInScreen:function(a,b){return this.picker.pickFreePointInScreen(a,b)},pickInScreen:function(a){return this.picker.pickInScreen(a)}})})},
"esri/views/3d/navigation/mixins/PanMixin":function(){define(["../../../../core/declare"],function(q){return q([],{declaredClass:"esri.views.3d.navigation.mixins.PanMixin",type:"pan",begin:function(n){this.navigation.begin(this);this.active=!0;this.emit("begin")},update:function(n){this.emit("update")},end:function(n){this.active=!1;this.emit("end");this.navigation.end(this)},beginContinuous:function(n){this.navigation.begin(this);this.active=!0;this.emit("begin")},updateContinuous:function(n){this.continuous&&
this.continuous.active&&this.emit("update")},endContinuous:function(n){this.active=!1;this.emit("end");this.navigation.end(this)}})})},"esri/views/3d/navigation/ContinuousAction":function(){define(["../../../core/Accessor","../lib/glMatrix"],function(q,n){var k=n.vec3d;return q.createSubclass({properties:{active:{get:function(){return 0!==this.velocity},dependsOn:["velocity"],readOnly:!0},velocity:{}},constructor:function(){this.direction=k.create();this.status=this.timer=this.velocity=0},stop:function(){this.status=
this.velocity=this.timer=0;k.set3(0,0,0,this.direction)},step:function(f){var c;f*=0.0010;0<this.timer?(f=Math.min(f,this.timer),c=this.velocity*f*(1-f/(2*this.timer)),this.velocity*=1-f/this.timer,this.timer-=f):c=this.velocity*f;return c}})})},"esri/views/3d/navigation/spherical/actions/ZoomSpherical":function(){define(["./ActionSpherical","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../support/earthUtils"],function(q,n,k,f){var c=k.vec2d,b=k.vec3d,a=k.mat4d,e=b.create(),h=b.create(),
g=b.create(),d=a.create(),m=b.create(),l=b.create();return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.spherical.actions.ZoomSpherical",constructor:function(){},begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=b.length(this._navPickPoint):(this._navSphereRadius=b.length(this.targetCamera.center),this._navSphereRadius<0.9*f.earthRadius&&(this._navSphereRadius=f.earthRadius),this.createPickRay(a,a,this.currentCamera.viewMatrix,
e,h),b.subtract(h,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,h,this._navSphereRadius-f.earthUtils,this._navPickPoint)||(this._navSphereRadius=0));this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(k){var m=this.targetCamera;m.copyFrom(this._mouseDownCamera);b.subtract(m.center,m.eye,g);var l=b.length(g);this.normalizeCoordinate(k,e);var n=12*(e[1]-this.normalizedAnchorPoint[1]);k=l*Math.pow(2,n);0>n&&k<this.navigation.minPoiDist&&(k=this.navigation.minPoiDist);
k=this.limitAltitude(k,m.center,g,l,0>n?-1:1);1E-6>Math.abs(l-k)||(0<this._navSphereRadius&&k<l&&(n=1-(1-k/l)*(1-this._navSphereRadius/b.length(m.center)),b.scale(m.center,n)),b.scale(g,-k/l),b.add(m.center,g,m.eye),l=!1,0<this._navSphereRadius&&(a.lookAt(m.eye,m.center,m.up,d),this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,d,e,h),b.normalize(b.subtract(h,m.eye)),this.intersectManifold(m.eye,h,this._navSphereRadius-f.earthRadius,this._targetOnSphere)||(this.closestPointOnSphereSilhouette(m.eye,
e,this._navSphereRadius,this._targetOnSphere),l=!0),this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,m,m,this._navSphereRadius),this.fixTargetUpVector()),this.applyConstraints(m),this.constrainTargetEyeByElevation(),this.targetAndCurrentChanged(),c.set(this._dragBeginPoint,this._dragLastPoint),l&&(a.lookAt(m.eye,m.center,m.up,d),this._dragLastPoint=this.currentCamera.projectPoint(this._navPickPoint,d)),m=this._toYDownCoord(this._dragLastPoint),this.emit("update",m[0],m[1]))},
stepAtPoint:function(c,g,k,n){b.set(g,l);g=b.length(l);b.subtract(this.targetCamera.eye,this.targetCamera.center,m);var q=b.length(m),v=q*c,v=(c=1>=c)&&v<this.minPoiDist?this.minPoiDist:this.limitAltitude(v,l,m,-q,c?-1:1);c=v/q;1E-6>Math.abs(q-v)||(n&&(q=b.length(this.targetCamera.center),b.scale(this.targetCamera.center,(g+c*(q-g))/q)),b.scale(m,c),b.add(this.targetCamera.center,m,this.targetCamera.eye),n&&k&&(a.lookAt(this.targetCamera.eye,this.targetCamera.center,this.targetCamera.up,d),this.createPickRay(k,
k,d,e,h),b.normalize(b.subtract(h,this.targetCamera.eye)),g<b.length(this.targetCamera.eye)&&this.intersectManifold(this.targetCamera.eye,h,g-f.earthRadius,this._targetOnSphere)?this.rotateCameraWithPointsOnSphere(l,this._targetOnSphere,this.targetCamera,this.targetCamera,g):n=!1),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevation(),n&&this.fixTargetUpVector(),this.navigation.currentHasAlmostReachedTarget()?this.targetAndCurrentChanged():this.targetAnimatedChanged())}})})},
"esri/views/3d/navigation/mixins/ZoomMixin":function(){define(["../../../../core/declare","../../lib/glMatrix"],function(q,n){var k=n.vec2d,f=n.vec3d,c=f.create();return q([],{declaredClass:"esri.views.3d.navigation.mixins.ZoomMixin",type:"zoom",constructor:function(){this.normalizedAnchorPoint=k.create()},begin:function(b){this.navigation.begin(this);k.set(b,this._dragBeginPoint);this.normalizeCoordinate(b,this.normalizedAnchorPoint);b=this._toYDownCoord(this._dragBeginPoint);this.active=!0;this.emit("begin",
b[0],b[1])},update:function(b){},end:function(b){this.active=!1;b=this._toYDownCoord(this._dragBeginPoint);this.emit("end",b[0],b[1]);this.navigation.end(this)},stepScreen:function(b,a){this.active||(f.set(this.currentCamera.center,c),0<b&&!this.pickPointInScreen(a,c)&&"local"===this.navigation.view.viewingMode&&this.pickFreePointInScreen(a,c),this.step(Math.pow(0.6,b),c,a))},step:function(b,a,c){if(!this.active){this.navigation.begin(this);this.targetCamera.copyFrom(this.currentCamera);var h=1E-6<
f.dist(a,this.targetCamera.center);this.stepAtPoint(b,a,c,h);this.navigation.end(this)}},stepAtPoint:function(b,a,c,f){},_toYDownCoord:function(b){return[b[0],this.currentCamera.height-b[1]]}})})},"esri/views/3d/navigation/spherical/actions/RotateSpherical":function(){define(["./ActionSpherical","../../mixins/RotateMixin"],function(q,n){return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.spherical.actions.RotateSpherical"})})},"esri/views/3d/navigation/mixins/RotateMixin":function(){define(["../../../../core/declare",
"../../lib/glMatrix","../../support/mathUtils","../NavigationConstants"],function(q,n,k,f){var c=n.vec2d,b=n.vec3d,a=n.mat4d,e=b.create(),h=b.create(),g=c.create(),d=a.create(),m=b.create(),l=[3,1.5],p=f.Rotate.PivotPoint;return q([],{declaredClass:"esri.views.3d.navigation.mixins.RotateMixin",type:"rotate",constructor:function(){this._rotLastPoint=c.create()},begin:function(a,b){this.navigation.begin(this);this.active=!0;this.emit("begin");this.setPoiAuto(a);this.normalizeCoordinate(a,this._rotLastPoint)},
update:function(a,b){void 0===b&&(b=p.POI);var c,d;switch(b){case p.EYE:c=this.targetCamera.center;d=this.targetCamera.eye;break;default:c=this.targetCamera.eye,d=this.targetCamera.center,b!==p.POI&&console.error("[RotateMixin.update]: invalid pivot specified")}this._applyRotation(a,b,c,d);this.constrainTargetEyeByElevation();this.fixTargetUpVector();this.targetAndCurrentChanged();this.emit("update")},_applyRotation:function(f,r,n,q){this.renderCoordsHelper.worldUpAtPosition(q,e);this.normalizeCoordinate(f,
g);f=(g[1]-this._rotLastPoint[1])*l[r-1];var v=(g[0]-this._rotLastPoint[0])*l[r-1];b.subtract(n,q,h);var C=b.length(h),y=k.acos(b.dot(h,e)/C);r===p.POI?f=this.limitTiltByConstraints(y+f,q,C)-y:(y=0.5*Math.PI-y,C=0.495*Math.PI,f=y-Math.max(-C,Math.min(C,y+-0.5*f)));a.identity(d);b.cross(this.targetCamera.up,h,m);r==p.POI&&(v=-v);a.rotate(d,v,e);a.rotate(d,f,m);a.multiplyVec3(d,h);b.add(q,h,n);a.multiplyVec3(d,this.targetCamera.up);c.set(g,this._rotLastPoint)},end:function(a){this.active=!1;this.emit("end");
this.navigation.end(this)}})})},"esri/views/3d/navigation/planar/NavigationPlanar":function(){define("../Navigation ./ConstraintsPlanar ./AnimationPlanar ./actions/PanPlanar ./actions/RotatePlanar ./actions/ZoomPlanar ../../webgl-engine/lib/Camera ../../lib/glMatrix".split(" "),function(q,n,k,f,c,b,a,e){var h=e.vec3d,g=h.create(),d=h.create(),m=h.create(),l=h.create();return q.createSubclass([n,k],{declaredClass:"esri.views.3d.navigation.planar.NavigationPlanar",initialize:function(){this.pan=new f({navigation:this});
this.zoom=new b({navigation:this});this.rotate=new c({navigation:this})},getInitialCamera:function(){return new a(h.createFrom(0,0,100),h.createFrom(0,0,0),h.createFrom(0,1,0))},fixTargetUpVector:function(){var a=this.renderCoordsHelper.worldUp,b=this.cameras.target;h.direction(b.center,b.eye,l);var c=h.dot(l,a);0.9999>=Math.abs(c)&&(h.scale(l,c,l),h.subtract(a,l,b.up),h.normalize(b.up))},setPoiAuto:function(a,b){var c=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,
a);if(c.getMinResult().getIntersectionPoint(g)&&c.getMaxResult().getIntersectionPoint(d)){var e=5/this.renderUnitInMeters,f=c.getMinResult().dist-e,e=c.getMaxResult().dist+e,k=h.dist(this.cameras.target.eye,this.cameras.target.center);if(k<=f||k>=e){if(c.getMinResult().object){c.getMaxResult().dist=void 0;c.intersectObject(c.getMinResult().object);if(void 0===c.getMaxResult().dist){console.error("[NavigationPlanar.setPoiAuto] Did not obtain maximum intersection distance");return}c.getMaxResult().getIntersectionPoint(d);
h.lerp(g,d,0.5,m)}else h.set(g,m);this.setCameraFromEyeAndCenter(this.cameras.target.eye,m,{animate:!1})}}}})})},"esri/views/3d/navigation/planar/ConstraintsPlanar":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../support/RenderCoordsHelper ../../constraints/SceneViewTiltConstraint ../../lib/glMatrix ../../webgl-engine/lib/Util ../../../../geometry/support/scaleUtils".split(" "),function(q,n,k,f,c,b,a,e){var h=b.vec3d,g=b.vec4d,d=g.create(),m=h.create(),
l=h.create();return q.createSubclass({declaredClass:"esri.views.3d.navigation.planar.ConstraintsPlanar",defaultConstraints:{tilt:new q.Tilt({min:function(){return n.deg2rad(c.MAX_DEFAULT)},max:n.makePiecewiseLinearFunction([[4E3,n.deg2rad(c.MIN_DEFAULT)],[1E4,n.deg2rad(88)],[6E6,n.deg2rad(88)]])}),altitude:new q.Altitude({min:function(a){return a._autoAltitudeConstraints.min},max:function(a){return a._autoAltitudeConstraints.max}}),collision:new q.Collision},_updateAutoAltitudeConstraints:function(a){var b=
Math.max(a.xmax-a.xmin,a.ymax-a.ymin);a.hasZ&&(b=Math.max(b,a.zmax-a.zmin));b=3*b/Math.atan((this._targetCameraBeforeElevationUpdate||this.targetCamera)._fov/2);a=e.getUnitValueForSR(a.spatialReference);this._autoAltitudeConstraints.min=0;this._autoAltitudeConstraints.max=b*a},limitAltitude:function(a,b,c,d){return this.constraints.altitude.apply(this,a)},limitTiltByAltitudeConstraints:function(a,b,c,d){return a},distanceToSilhouette:function(a,b,c,d,e){e||(e={maxFarNearRatio:0,distance:0});e.maxFarNearRatio=
this.maxFarNearRatio;var g=f.Planar.prototype.getAltitude(a.eye),q=g*=c;d=g-d;var y=this.elevationProvider?this.elevationProvider.getElevationBounds():null;y&&(g=0<=d?q-c*y[0]:c*y[1]-q);var q=b.xmax-b.xmin,y=b.ymax-b.ymin,x=8*Math.max(b.xmax-b.xmin,b.ymax-b.ymin),q=Math.max(q,y,x);h.subtract(a.center,a.eye,l);m[0]=0<l[0]?b.xmax:b.xmin;m[1]=0<l[1]?b.ymax:b.ymin;m[2]=0<l[2]?q/2:-q/2;h.subtract(m,a.eye);h.normalize(l);a=h.dot(m,l);a=1.1*a*c;y=g+k.earthRadius;y=Math.sqrt(y*y-k.earthRadius*k.earthRadius);
b=Math.max(b.xmax-b.xmin,b.ymax-b.ymin);x=1E-4*b*c;c=n.clamp((g-x)/(0.0010*b*c-x),0,1);e.distance=n.lerp(y,a,c*c*c);e.maxFarNearRatio=2E4;e.distance*=Math.max(Math.log(Math.abs(d)),1);e.distance=Math.min(e.distance,Math.max(34064E4,q));return e},intersectManifold:function(b,c,e,f){var k=this.renderCoordsHelper.worldUp;g.set4(k[0],k[1],k[2],e,d);return!a.rayPlane(b,c,d,f)||0>h.dot(h.subtract(f,b,m),c)?!1:!0},getFallbackCenterAlongViewDirection:function(a,b,c){h.set(b,c)}})})},"esri/views/3d/navigation/planar/AnimationPlanar":function(){define(["../mixins/AnimationMixin",
"../../lib/glMatrix","../../support/mathUtils"],function(q,n,k){function f(a,b){var c=b[0]-a[0],e=b[1]-a[1],f=b[2]-a[2],h=b[3]-a[3];return c*c+e*e+f*f+h*h}function c(a,b){return Math.sqrt(f(a,b))}function b(a){this.interpolate=function(a,b,c){c=Math.min(5*c,0.3);e.lerp(a.eye,b.eye,c);e.lerp(a.center,b.center,c);e.lerp(a.up,b.up,c);a.fov=k.lerp(a.fov,b.fov,c);a.padding=h.lerp(a.padding,b.padding,c,g)}}function a(a,b,f){b=b||250;f=f||b;var p=0,n=0,r=0,q=0,u=0;this.interpolate=function(v,C,y){p=a.easeInOutInterpLinear(f,
b,v.eye,C.eye,y,p,e);n=a.easeInOutInterpLinear(f,b,v.center,C.center,y,n,e);r=a.easeInOutInterpLinear(f,b,v.up,C.up,y,r,e);u=a.easeInOutInterpLinear(f,b,v.padding,C.padding,y,u,{dist:c,lerp:function(a,b,c){return h.lerp(a,b,c,g)},set:function(a){v.padding=a}});q=a.easeInOutInterpLinear(f,b,v.fov,C.fov,y,q,{dist:function(a,b){return Math.abs(b-a)},lerp:k.lerp,set:function(a){v.fov=a}})}}var e=n.vec3d,h=n.vec4d,g=h.create();return q.createSubclass({declaredClass:"esri.views.3d.navigation.planar.AnimationPlanar",
constructor:function(){this.interpolationTypes={linear:b,easeInOut:a}}})})},"esri/views/3d/navigation/planar/actions/PanPlanar":function(){define(["./ActionPlanar","../../mixins/PanMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(q,n,k,f){var c=k.vec2d,b=k.vec3d,a=b.create(),e=b.create(),h=b.create(),g=b.create(),d=b.create(),m=b.create(),l=Math.PI/9,p=b.create(),s=b.create();return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.planar.actions.PanPlanar",begin:function(d){this.inherited(arguments);
this.pickPointInScreen(d,a)||this.pickFreePointInScreen(d,a);b.normalize(b.subtract(this.targetCamera.eye,this.targetCamera.center,e));this.renderCoordsHelper.worldUpAtPosition(d,m);var f=b.dot(e,m);0>f&&(b.negate(e),f=-f);var g=Math.asin(f);g>=l?b.set(m,e):(b.subtract(e,b.scale(m,f,h)),b.normalize(e),g>l&&(b.lerp(e,m,(g-l)/(l-l)),b.normalize(e)));this.updatePlane(a,e);c.set(d,this._dragLastPoint);c.set(d,this._dragBeginPoint)},update:function(a){this._intersectPanPlane(this._dragLastPoint,this._dragBeginPoint,
p)&&this._intersectPanPlane(a,this._dragBeginPoint,s)&&(b.subtract(s,p),b.subtract(this.targetCamera.eye,s),b.subtract(this.targetCamera.center,s),c.set(a,this._dragLastPoint),this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged())},_intersectPanPlane:function(a,c,e){this.createPickRay(a,c,this.currentCamera.viewMatrix,g,d);b.subtract(d,g);return f.rayPlane(g,d,this._plane,e)},end:function(a){this.setPoiAuto(a,!0);this._navSphereRadius=0;this.inherited(arguments)}})})},"esri/views/3d/navigation/planar/actions/ActionPlanar":function(){define(["../../Action",
"../../../lib/glMatrix"],function(q,n){var k=n.vec3d,f=n.vec4d;return q.createSubclass({declaredClass:"esri.views.3d.navigation.planar.actions.ActionPlanar",constructor:function(){this._plane=f.create()},updatePlane:function(c,b){f.set4(b[0],b[1],b[2],-k.dot(b,c),this._plane)}})})},"esri/views/3d/navigation/planar/actions/RotatePlanar":function(){define(["./ActionPlanar","../../mixins/RotateMixin"],function(q,n){return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.planar.actions.RotatePlanar"})})},
"esri/views/3d/navigation/planar/actions/ZoomPlanar":function(){define(["./ActionPlanar","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(q,n,k,f){var c=k.vec2d,b=k.vec3d,a=b.create(),e=b.create(),h=b.create(),g=b.create(),d=b.create(),m=b.create();return q.createSubclass([n],{declaredClass:"esri.views.3d.navigation.planar.actions.ZoomPlanar",begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,d)||this.pickFreePointInScreen(a,d);b.normalize(b.subtract(this.targetCamera.eye,
this.targetCamera.center,g));0>g[1]&&b.negate(g);this.updatePlane(d,g)},update:function(d){b.set(this.targetCamera.center,m);this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,a,e);b.subtract(e,a);f.rayPlane(a,e,this._plane,m);this.normalizeCoordinate(d,a);d=4*(this.normalizedAnchorPoint[1]-a[1]);c.set(a,this.normalizedAnchorPoint);this._applyZoom(m,d);d=this._toYDownCoord(this._dragLastPoint);this.emit("update",d[0],d[1])},_applyZoom:function(a,c){b.subtract(a,
this.targetCamera.eye,h);var d=b.length(h),e=d*(1-c);0<=c&&e<this.minPoiDist&&(e=this.minPoiDist);e=this.limitAltitude(e,a,h,d,0<=c?-1:1);1E-6>Math.abs(d-e)||(b.scale(h,c),b.add(this.targetCamera.eye,h),b.lerp(this.targetCamera.center,a,c),this.fixTargetUpVector(),this.targetAndCurrentChanged())},stepAtPoint:function(a,c,d,e){b.set(c,m);b.subtract(m,this.targetCamera.eye,h);c=b.length(h);d=c*a;if((a=1>=a)&&d<this.minPoiDist)d=this.minPoiDist;d=this.limitAltitude(d,m,h,c,a?-1:1);a=d/c;1E-6<=Math.abs(c-
d)&&(b.scale(h,d/c),b.subtract(m,h,this.targetCamera.eye),b.lerp(this.targetCamera.center,m,1-a),this.constrainTargetEyeByElevation(),this.fixTargetUpVector(),this.targetAnimatedChanged())}})})},"esri/views/3d/support/Frustum":function(){define(["../../../core/declare","../lib/glMatrix","../support/earthUtils","../webgl-engine/lib/Util"],function(q,n,k,f){var c=n.vec3d,b=n.vec4d;return q([],{constructor:function(){this.planes=Array(6);this.points=Array(8);this.lines=Array(12);this.origin=c.create();
this.direction=c.create();this.dirty=!1;this._altitude=null;for(var a=0;6>a;a++)this.planes[a]=b.create();for(a=0;8>a;a++)this.points[a]=c.create();for(a=0;12>a;a++)this.lines[a]={origin:null,direction:c.create(),endpoint:null}},_makeLine:function(a,b,f){a.origin=b;a.endpoint=f;c.direction(f,b,a.direction)},update:function(a){if(this.dirty){f.matrix2frustumPlanes(a.viewMatrix,a.projectionMatrix,this.points,this.planes);for(var b=0;4>b;b++){var h=b,g=b+4;this._makeLine(this.lines[b],this.points[h],
this.points[g]);this._makeLine(this.lines[b+4],this.points[h],3===b?this.points[0]:this.points[h+1]);this._makeLine(this.lines[b+8],this.points[g],3===b?this.points[4]:this.points[g+1])}c.set(a.eye,this.origin);c.set(a.viewForward,this.direction);this._altitude=null;this.dirty=!1}},altitude:function(){return null!=this._altitude?this._altitude:this._altitude=c.length(this.origin)-k.earthRadius}})})},"esri/views/ui/3d/DefaultUI3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),
function(q,n,k,f,c,b,a){return function(b){function h(){b.call(this)}k(h,b);h.prototype.getDefaults=function(){return a.mixin(this.inherited(arguments),{components:["attribution","zoom","navigation-toggle","compass"]})};return h=f([c.subclass("esri.views.ui.3d.DefaultUI3D")],h)}(c.declared(b))})},"esri/layers/graphics/controllers/I3SOnDemandController":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../views/3d/support/ResourceController ../../../views/3d/layers/i3s/I3SNodeLoader ../../../views/3d/layers/i3s/I3SIndexTraversal ../../../views/3d/layers/i3s/I3SUtil ../../../views/3d/layers/i3s/I3SLodHandling ../../../views/3d/layers/i3s/I3SViewportQueries ../../../layers/SceneLayer ../../../layers/IntegratedMeshLayer ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Evented ../../../core/Promise ../../../core/Logger ../../../core/watchUtils ../../../core/HandleRegistry ../../../views/3d/support/PromiseLightweight ../../../views/3d/support/projectionUtils ../../../views/3d/lib/glMatrix".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B){function z(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return[c,a[c]];return[-1,void 0]}var A=B.vec3d,w=u.getLogger("esri.layers.SceneService");return function(r){function n(a){r.call(this);this.nodeIndex={};this.screenSizeFactor=0;this.updating=!1;this.updatingPercentage=0;this._lodFactorProperty=null;this._numNodesLoading=0;this._progressMaxNumNodes=1;this._animFrameFunctionQueue=[[],[]];this._requiredAttributesDirty=!0;this._restartNodeLoading=
this._updatesDisabled=!1;this._handles=new C}k(n,r);Object.defineProperty(n.prototype,"isMeshPyramid",{get:function(){return"meshpyramids"===this.layer.store.profile||"MeshPyramid"===this.layer.store.lodType},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"streamDataSupplier",{get:function(){return this.layerView.view.resourceController.registerClient(this.layerView,b.ClientType.SCENE,this.addUrlTokenFunction)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"crsVertex",
{get:function(){return h.getVertexCrs(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"crsIndex",{get:function(){return h.getIndexCrs(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"rootNodeVisible",{get:function(){var a=this._rootNodeId&&this.nodeIndex[this._rootNodeId];return a&&this._viewportQueries?this._viewportQueries.isNodeVisible(a):!0},enumerable:!0,configurable:!0});n.prototype.initialize=function(){var a=this;this.updateEventListener=
{needsUpdate:function(){return a._needsAnimationFrameHandler()},idleFrame:function(b){return a._animationFrameHandler(b)},idleBegin:function(){return a._startNodeLoading()},idleEnd:function(){return a.cancelNodeLoading()}};this.updateEventListenerWhileSuspended={idleBegin:function(){return a._startNodeLoadingWhileSuspended()}};this._lodHandling=new g(this.layerViewRequiredFunctions,this.layerViewOptionalFunctions);this.layerView._controller=this;var b=this.layer;this._defaultGeometrySchema=b.store.defaultGeometrySchema;
this._fields=b.fields;this._attributeStorageInfo=b.attributeStorageInfo;this._rootNodeUrl=b.store.rootNode;b=this._rootNodeUrl.split("/");this._rootNodeId=b[b.length-1];this.layer instanceof m?"mesh"===this.layer.geometryType?this._lodFactorProperty="qualitySettings.sceneService.3dObject.lodFactor":"point"===this.layer.geometryType&&(this._lodFactorProperty="qualitySettings.sceneService.point.lodFactor"):this.layer instanceof l&&(this._lodFactorProperty="qualitySettings.sceneService.integratedMesh.lodFactor");
b=c([this.layer,this.layerView]).then(function(){a.setClippingArea(a.layerView.view.clippingArea);var b=a.layerView.view.resourceController,c=!1;a._handles.add(v.init(a.layerView,"suspended",function(d){null!=a.layerView.setVisibility&&a.layerView.setVisibility(!d);c&&b.deregisterIdleFrameWorker(a);d?b.registerIdleFrameWorker(a,a.updateEventListenerWhileSuspended):b.registerIdleFrameWorker(a,a.updateEventListener);c=!0}),"layerview");a._lodFactorProperty&&a._handles.add(a.layerView.view.watch(a._lodFactorProperty,
function(){return a._qualityChanged()}),"quality")});this.addResolvingPromise(b)};n.prototype.destroy=function(){this.layerView.view.resourceController.deregisterIdleFrameWorker(this);this.layerView.view.resourceController.deregisterClient(this.layerView);this._handles.destroy();this._nodeLoader=null};n.prototype._modifyNumNodesLoading=function(a){this._numNodesLoading+=a};n.prototype._getRequiredAttributes=function(){if(null==this._attributeStorageInfo||!this._fields)return[];var a=Object.create(null);
this.layer.renderer&&this.layer.renderer.collectRequiredFields(a);this.layer.labelsVisible&&this.layer.labelingInfo&&this.layer.labelingInfo.forEach(function(b){b._collectRequiredFields(a)});var b=this._attributeStorageInfo,c=this._fields;return Object.keys(a).map(function(a){var d=z(b,a)[0],e=z(c,a)[1];return{index:d,name:a,field:e,attributeStorageInfo:b[d]}}).filter(function(a){return-1!==a.index&&null!=a.field})};n.prototype._rendererChanged=function(){this._restartNodeLoading=this._requiredAttributesDirty=
!0};n.prototype._labelsVisibleChanged=function(){var a=this._getRequiredAttributes(),b=!0;a.length===this._requiredAttributes.length&&(b=this._requiredAttributes.every(function(b){return-1!==z(a,b.name)[0]}));b&&(this._restartNodeLoading=this._requiredAttributesDirty=!0)};n.prototype._labelingInfoChanged=function(){};n.prototype.setClippingArea=function(a){var b=[];x.extentToBoundingBox(a,b,this.layerView.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null};n.prototype._qualityChanged=
function(){this._restartNodeLoading=!0};n.prototype.updateClippingArea=function(a){this.setClippingArea(a);this._restartNodeLoading=!0};n.prototype.queueAnimationFrameFunctionCall=function(a,b,c,d,e){null!=this._nodeLoader&&this._animFrameFunctionQueue[e||0].push({fct:a,that:b,args:c,cancelFunc:d})};n.prototype.getBaseUrl=function(){return h.addTrailingSlash(this.layer.parsedUrl.path)};n.prototype.updateElevationChanged=function(a,b,c){h.findIntersectingNodes(a,b,this.nodeIndex.root,this.crsIndex,
this.nodeIndex,c);for(a=0;a<c.length;a++)b=c.data[a],b.computedMbs&&(b.computedMbs[3]=-1);c.length&&this.restartNodeLoading()};n.prototype.restartNodeLoading=function(){this._restartNodeLoading=!0};n.prototype._needsAnimationFrameHandler=function(){return!0};n.prototype._animationFrameHandler=function(a){this._restartNodeLoading&&(this.cancelNodeLoading(),this._startNodeLoading());if(null!=this._nodeLoader){for(var b;0<this._animFrameFunctionQueue[0].length&&!a.done();)b=this._animFrameFunctionQueue[0].shift(),
b.fct.apply(b.that,b.args);b=5-this._numNodesLoading;for(null!=this._indexLoader&&0<b&&this._indexLoader.continueTraversal(b);0<this._animFrameFunctionQueue[1].length&&!a.done();)b=this._animFrameFunctionQueue[1].shift(),b.fct.apply(b.that,b.args);this._evaluateUpdatingState();this._lodHandling.lodGlobalHandling()}};n.prototype._evaluateUpdatingState=function(){var a=null!=this._indexLoader?this._indexLoader.getQueueSize()+3*this._numNodesLoading:0,b=0<a;0===a&&(this._progressMaxNumNodes=1);this._progressMaxNumNodes=
Math.max(a,this._progressMaxNumNodes);b!==this._get("updating")&&this._set("updating",b);a=100*a/this._progressMaxNumNodes;a!==this._get("updatingPercentage")&&this._set("updatingPercentage",a)};n.prototype._initViewData=function(){var a=this.layerView.view,b=a.navigation.targetCamera,c=a.renderCoordsHelper;this.camPos=b.eye;this.screenSizeFactor=1/b.perPixelRatio;this._poi=A.create();var e=A.create(),f=A.create();A.subtract(b.center,b.eye,e);A.normalize(e);c.worldUpAtPosition(b.center,f);e=Math.acos(A.dot(f,
e))-0.5*Math.PI;A.lerp(b.eye,b.center,Math.max(0,Math.min(1,e/(0.5*Math.PI))),this._poi);e=this._lodFactorProperty&&this.layerView.view.get(this._lodFactorProperty)||1;f=this.layerViewOptionalFunctions.traversalOptions.elevationInfo;this._viewportQueries=new d(this.crsIndex,c,b,this._clippingArea,null!=this.layerViewOptionalFunctions.traversalOptions?this.layerViewOptionalFunctions.traversalOptions.errorMetricToUse:null,f?a.basemapTerrain:null,f,{screenspaceErrorBias:e,maxDistance:25E7,angleDependentLoD:0.5>
e});this.notifyChange("rootNodeVisible")};n.prototype._startNodeLoadingWhileSuspended=function(){var a=this;this._initViewData();this._removeInvisibleNodes(function(b){return a._viewportQueries.isNodeVisible(b)})};n.prototype._startNodeLoading=function(){var b=this;this._restartNodeLoading=!1;if(!this._updatesDisabled&&null!=this.streamDataSupplier){this._initViewData();var c=null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions?this.layerViewOptionalFunctions.getTexturePrefetchFunctions():
void 0,d=this.isMeshPyramid&&null!=this._defaultGeometrySchema&&null!=this._defaultGeometrySchema.ordering;null!=this.layerViewOptionalFunctions.getLoadedAttributes&&this._requiredAttributesDirty&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesDirty=!1,this._handles.add([this.layer.watch("renderer",function(){return b._rendererChanged()}),this.layer.watch("labelsVisible",function(){return b._labelsVisibleChanged()}),this.layer.watch("labelingInfo",function(){return b._labelingInfoChanged()})],
"requiredAttributes"));this._nodeLoader=new a(this.streamDataSupplier,this._bundleLoadedCallback.bind(this),this.queueAnimationFrameFunctionCall.bind(this),void 0,this.layerView.view.renderCoordsHelper,this.crsIndex,c?c._calcDesiredTextureLOD:void 0,c?c._imageIsPartOfTextureBundle:void 0,c?c._matId2Meta:void 0,c?c._texId2Meta:void 0,c?c.useCompressedTextures:void 0,w,this._defaultGeometrySchema,this._requiredAttributes,d);this._indexLoader=new e(this.getBaseUrl(),this._rootNodeUrl,this._rootNodeId,
this._poi,this.nodeIndex,this.streamDataSupplier,this._viewportQueries,function(a,c){return b._processNodeIndexDocument(a,c)},function(a){return b._lodHandling.finishedLevel(a)},this.layerViewOptionalFunctions._nodeDebugVisualizer,w,this.layerViewOptionalFunctions.traversalOptions);this._indexLoader.start();c=this._removeInvisibleNodes(function(a){return b._indexLoader.nodeIsVisible(a)});d=null!=this.layerViewOptionalFunctions.traversalOptions&&!0===this.layerViewOptionalFunctions.traversalOptions.perLevelTraversal?
"perLevel":this.isMeshPyramid?"global":"swap";this._lodHandling.startNodeLoading(this._indexLoader.nodeIsVisible.bind(this._indexLoader),this._indexLoader.nodeTraversalState.bind(this._indexLoader),d,this.nodeIndex,c,this._rootNodeId);this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler();this._evaluateUpdatingState()}};n.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._indexLoader};n.prototype.cancelNodeLoading=
function(){if(this.isNodeLoading()){this._indexLoader.cancel();this._nodeLoader.cancel();this.streamDataSupplier.cancelRequestsBulk(this.streamDataSupplier.getRequestedURLs());for(var a=0;a<this._animFrameFunctionQueue.length;a++)for(var b=0;b<this._animFrameFunctionQueue[a].length;b++)void 0!==this._animFrameFunctionQueue[a][b].cancelFunc&&this._animFrameFunctionQueue[a][b].cancelFunc();this._numNodesLoading=0;this._animFrameFunctionQueue=[[],[]];this._indexLoader=this._nodeLoader=void 0;this._lodHandling.cancelNodeLoading();
this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler();this._evaluateUpdatingState()}};n.prototype._removeInvisibleNodes=function(a){for(var b={},c=this.layerViewRequiredFunctions.getAddedNodeIDs(),d=0;d<c.length;d++){var e=c[d],f=this.nodeIndex[e];this._isNodeVisibleWithParents(f,a)?b[e]=f:this._removeNodeData(f)}return b};n.prototype._isNodeVisibleWithParents=function(a,b){var c,d=a;do c=b(d),d=d.parentNode,d=null!=
d?this.nodeIndex[d.id]:null;while(c&&null!=d);return c};n.prototype._removeNodeData=function(a){this._lodHandling.setLodGlobalDirty();this.layerViewRequiredFunctions.removeNodeData(a)};n.prototype._processNodeIndexDocument=function(a,b){var c=this,d=new y.Promise;if(null!=a.featureData&&0<a.featureData.length)if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a,!0)){var e=this.layerViewOptionalFunctions.getLoadedAttributes,e=null!=e?e(a):void 0;null!=e&&e!==this._requiredAttributes&&this._nodeLoader.loadAttributes(a,
a.baseUrl,this._requiredAttributes).then(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,b)}).catch(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,{})});this._lodHandling.shouldLoadNode(a,b)&&(e=this._lodHandling.lodSwapBuildInfoForNode(a))&&null==e.swapPairs&&this._lodHandling.lodSwapBundleLoaded(a,null,e)}else if(this._lodHandling.shouldLoadNode(a,b)){e=this._lodHandling.lodSwapBuildInfoForNode(a);if(this.layerViewRequiredFunctions.isOverMemory())return d.done(),
d;this._modifyNumNodesLoading(1);for(var f=[],h=0;h<a.featureData.length;h++){var g=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(a,h),k=g.wasPartiallyHidden;(!g.alreadyLoaded||k)&&f.push(h)}this.queueAnimationFrameFunctionCall(this._nodeLoader.loadNodeData,this._nodeLoader,[a,f,d,null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions,e],void 0,1);d.then(function(){return c._modifyNumNodesLoading(-1)},function(){return c._modifyNumNodesLoading(-1)});return d}d.done();return d};
n.prototype._bundleLoadedCallback=function(a,b,c,d,e,f,h,g){this._lodHandling.lodSwapBundleLoaded(a,b,g);this.layerViewRequiredFunctions.addBundle(a,b,c,d,e,f,h);null!=this.layerViewOptionalFunctions.setPolygonOffset&&(b=this._lodHandling.shouldSetPolygonOffset(a))&&this.layerViewOptionalFunctions.setPolygonOffset(a,b)};f([p.property({readOnly:!0})],n.prototype,"isMeshPyramid",null);f([p.property({readOnly:!0})],n.prototype,"streamDataSupplier",null);f([p.property({readOnly:!0})],n.prototype,"crsVertex",
null);f([p.property({readOnly:!0})],n.prototype,"crsIndex",null);f([p.property({readOnly:!0})],n.prototype,"nodeIndex",void 0);f([p.property()],n.prototype,"camPos",void 0);f([p.property()],n.prototype,"screenSizeFactor",void 0);f([p.property()],n.prototype,"layerView",void 0);f([p.property()],n.prototype,"layerViewRequiredFunctions",void 0);f([p.property()],n.prototype,"layerViewOptionalFunctions",void 0);f([p.property()],n.prototype,"layer",void 0);f([p.property()],n.prototype,"addUrlTokenFunction",
void 0);f([p.property({readOnly:!0})],n.prototype,"updating",void 0);f([p.property({readOnly:!0})],n.prototype,"updatingPercentage",void 0);f([p.property({readOnly:!0})],n.prototype,"rootNodeVisible",null);return n=f([p.subclass("esri.layers.graphics.controllers.I3SOnDemandController")],n)}(p.declared(s,t,r))})},"esri/views/3d/layers/i3s/I3SNodeLoader":function(){define("require exports dojo/_base/lang ../../webgl-engine/lib/Util ./I3SUtil ./I3SBinaryReader ../../support/PromiseLightweight ../../support/projectionUtils ../../lib/glMatrix ../../support/PromiseNativeOrShim ../../../../core/urlUtils".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d){var m=f.assert,l=h.vec4d,p={};return function(){function f(a,b,c,e,h,k,m,l,p,n,q,D,E,H,G){this.bundleLoadedCallback=b;this.queueFunctionCall=c;this.debugVis=e;this.renderCoordsHelper=h;this.indexSR=k;this.calcDesiredTextureLOD=m;this.imageIsPartOfTextureBundle=l;this.matId2Meta=p;this.texId2Meta=n;this.useCompressedTextures=q;this.logger=D;this.defaultGeometrySchema=E;this.requiredAttributes=H;this.bypassFeatureData=G;this.texIdToPromises={};this.loadShared=function(a){if(null==
a.sharedResource)return g.resolve({});var b=d.makeAbsolute(a.sharedResource.href,a.baseUrl)+"/";a.sharedResource.hrefConcat=b;return this.loadJSON(b).then(function(a){f.fixTextureEncodings(a);f.addAbsoluteHrefTexture(a,b);return a})};this.loader=a;this.cancelled=!1}f.prototype.waitForAnimationFrame=function(){var a=this;return new g(function(b,c){a.queueFunctionCall(b,null,[],c)})};f.prototype.cancel=function(){this.cancelled=!0};f.prototype.loadJSON=function(a){var b=this.loader.request(a,"json");
return new g(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};f.prototype.loadBinary=function(a){var b=this.loader.request(a,"binary");return new g(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};f.prototype.loadImage=function(a){var b=this.loader.request(a,"image");return new g(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};f.prototype.loadAttribute=function(a,e,f){a=c.addTrailingSlash(d.makeAbsolute(f,
a));return this.loadBinary(a).then(function(a){return b.readBinaryAttribute(e,a)})};f.prototype.loadAttributes=function(a,b,c){var d=this,e=c.map(function(c){return d.loadAttribute(b,c.attributeStorageInfo,a.attributeData[c.index].href)});return g.all(e).then(function(a){for(var b={},d=0;d<c.length;++d)a[d]&&(b[c[d].name]=a[d]);return b})};f.prototype.prepareBinaryGeometryData=function(a,c,d,e){k.mixin(a.geometries[0].params,d);a.faceRanges[0][0]=0;a.faceRanges[0][1]=d.header.fields.vertexCount/3-
1;!e&&null==d.vertexAttributes.region&&delete d.vertexAttributes.region;if(null!=d.featureAttributes){e=d.featureAttributes;if(e.faceRange){a.faceRanges=[];for(var f=b.createTypedView(c,e.faceRange),h=e.faceRange.valuesPerElement,g=0;g<d.header.fields.featureCount;g++)a.faceRanges[g]=[f[g*h],f[g*h+1]]}if(e.id){a.featureIds=[];f=1;g=b.valueType2TypedArrayClassMap[e.id.valueType];"UInt64"===e.id.valueType&&(g=Uint32Array,f=2);c=new g(c,e.id.byteOffset,e.id.count*e.id.valuesPerElement*f);for(g=0;g<d.header.fields.featureCount;g++)if(a.featureIds[g]=
c[g*e.id.valuesPerElement*f],2===f){h=c[g*e.id.valuesPerElement*f+1];if(2097150<=h)throw Error("ID exceeded maximum range supported by javascript (max \x3d 53bit-1 \x3d 9007199254740991)");a.featureIds[g]+=4294967296*h}}}};f.prototype.loadNodeData=function(a,c,e,h,m){var l=this,p=null==a.features,n=a.baseUrl,q={},A=this.loadShared(a),w=A.then(function(a){return l.loadReferencedShared(a,n)}),D=null;null!=this.requiredAttributes&&(D=this.loadAttributes(a,n,this.requiredAttributes));var E=null;null!=
a.geometryData&&(E=a.geometryData.map(function(a,b){if(-1===c.indexOf(b))return null;var e=d.makeAbsolute(a.href,n);a.hrefConcat=e;return l.loadBinary(e)}));g.all([A,w]).then(function(d){var e=d[0];d=d[1];l.handleCancelled();a.sharedResource&&(q[a.sharedResource.hrefConcat]=e,k.mixin(q,d));d=c.map(function(c){return l.loadFeatureData(a,c,e).then(function(d){l.handleCancelled();p&&f.buildNodeFeatures(a,c,d);var k=l.collectGeometries(a,c,d,e);d=null;d=null!=E&&null!=E[c]?E[c].then(function(d){q[a.geometryData[c].hrefConcat]=
d;var f=Object.keys(e.materialDefinitions)[0],f=e.materialDefinitions[f].params.vertexRegions,h=b.createGeometryDataIndex(d,l.defaultGeometrySchema,f);l.prepareBinaryGeometryData(k[0],d,h,f);return k}):g.resolve(k);var m=h?l.loadTextures(k,e,l.matId2Meta,l.texId2Meta).then(function(a){var b={};a.forEach(function(a){var c=a.i3sTexId;b[c]={i3sTexId:c,data:a.data,encoding:a.encoding,desiredLOD:a.desiredLOD,createdTextureForDomImage:function(){l.texIdToPromises[c]&&delete l.texIdToPromises[c]}}});return b}):
null;return g.all([m,d,D])}).then(function(b){var d=b[0],e=b[1];b=b[2];l.handleCancelled();void 0!==l.debugVis&&l.debugVis.show(a,l.indexSR,"green");var f=null;b&&(f={attributeData:b,loadedAttributes:l.requiredAttributes});return l.callbackWrapped(a,e,f,q,d,c,m)}).catch(function(b){l.handleCancelled();return l.callbackWrapped(a,null,null,q,null,c,m)})});return g.all(d)}).catch(function(b){if(!l.cancelled)return b=c.map(function(b){return l.callbackWrapped(a,null,null,q,null,b,m)}),g.all(b)}).then(function(){e.done()})};
f.prototype.callbackWrapped=function(b,c,d,e,f,h,k){var m=this;return this.waitForAnimationFrame().then(function(){return new g(function(g,l){var p=new a.Promise,n=m.bundleLoadedCallback;n(b,c,d,e,p,f,h,k);p.then(g,l)})})};f.addAbsoluteHrefTexture=function(a,b){var c=a.textureDefinitions;if(void 0!==c)for(var e in c)if(c.hasOwnProperty(e))for(var f=c[e],h=0;h<f.images.length;h++){var g=f.images[h];Array.isArray(f.encoding)?g.hrefConcat=g.href.map(function(a){return d.makeAbsolute(a,b)}):g.hrefConcat=
d.makeAbsolute(g.href,b)}};f.fixTextureEncodings=function(a){a=a.textureDefinitions;if(null!=a)for(var b in a){var c=a[b];if(Array.isArray(c.encoding))for(var d=0;d<c.encoding.length;d++){var e=c.encoding[d];"data:"===e.substring(0,5)&&(c.encoding[d]=e.substring(5))}else e=c.encoding,"data:"===e.substring(0,5)&&(c.encoding=e.substring(5))}};f.prototype.loadReferencedShared=function(a,b){var c=this;if(null==a||null==a.materialDefinitions)return g.resolve({});var e=Object.keys(a.materialDefinitions).filter(function(b){return a.materialDefinitions[b]&&
null!=a.materialDefinitions[b].href}).map(function(c){return d.makeAbsolute(a.materialDefinitions[c].href,b)+"/"});return g.all(e.map(function(a){return c.loadJSON(a).then(function(b){return[a,b]})})).then(function(a){for(var b={},c=0;c<a.length;c++){var d=a[c],e=d[0],d=d[1];f.fixTextureEncodings(d);f.addAbsoluteHrefTexture(d,e);b[e]=d}return b})};f.prototype.loadTexture=function(a,b,d,e,f,h){var k=this,l=-1<h?d.encoding[h]:d.encoding;d=l===c.DDS_ENCODING_STRING;var p=this.imageIsPartOfTextureBundle(e);
m(!(d&&p),"DDS in multi texture bundles not supported at the moment");return d?this.loadBinary(a).then(function(a){return k.cancelled?g.reject():{i3sTexId:b,data:a,encoding:l,desiredLOD:f}}):p?this.loadBinary(a).then(function(c){var d;try{var p=void 0,n;-1<h?(m(Array.isArray(e.byteOffset)&&Array.isArray(e.length),"texture encoding is array, but image byteOffset/length isn't"),p=e.byteOffset[h],n=e.length[h]):(p=e.byteOffset,n=e.length);var s=new Uint8Array(c,p,n),q=new Blob([s],{type:l});d=window.URL.createObjectURL(q)}catch(u){d=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",k.logger.error("error loading texture "+a+": "+u)}var z=new Image;c=new g(function(a,c){var e=function(){window.URL.revokeObjectURL(d);z.onerror=void 0;z.onload=void 0};z.onerror=function(a){e();c(a)};z.onload=function(){e();k.cancelled?c():a({i3sTexId:b,data:z,encoding:l,desiredLOD:f})}});z.src=d;return c}):this.loadImage(a).then(function(a){return k.cancelled?
g.reject():{i3sTexId:b,data:a,encoding:l,desiredLOD:f}})};f.getAllEngineMBS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].engineMBS);return b};f.prototype.loadTextures=function(a,b,d,e){for(var h=[],k=0;k<a.length;k++)for(var l=a[k].geometries,p=f.getAllEngineMBS(a[k].features),n=0;n<l.length;++n)for(var q=l[n],w=q.params.components.length,D=0;D<w;D++){var E=q.params.components[D],H=E.materialID,E=E.textureID||"none";if(!(d[H]&&null!=d[H][E])&&null==e[E]&&"none"!==E)if(null!=this.texIdToPromises[E])h.push(this.texIdToPromises[E]);
else{(null==b.textureDefinitions||null==b.textureDefinitions[E])&&this.logger.warn("textureDefinitions missing in shared resource. i3sTexId: "+E);H=b.textureDefinitions[E];m(void 0!==H,"geometry wants unknown texture "+E);var G=this.calcDesiredTextureLOD(p,H.images);if(0!==H.images.length){var I=H.images[G],O=c.getAppropriateTextureEncoding(H.encoding,this.useCompressedTextures()),H=this.loadTexture(-1<O?I.hrefConcat[O]:I.hrefConcat,E,H,I,G,O);h.push(H);this.texIdToPromises[E]=H}}}return g.all(h)};
f.getIdFromJsonPointer=function(a){a=a.split("/");return a[a.length-1]};f.buildNodeFeatures=function(a,b,c){null==a.features&&(a.features=[]);for(var d in c.featureData)a.features.push({id:c.featureData[d].id,mbs:a.mbs,block:b})};f.prototype.collectGeometries=function(a,b,c,d){var h=[],g=!1,k=0,p=a.features.length-1;null==a.featureData[b].featureRange?g=!0:(k=a.featureData[b].featureRange[0],p=a.featureData[b].featureRange[1]);for(;k<=p;++k){var n=a.features[k];if(!n.engineMBS){var q=l.create();e.mbsToMbs(n.mbs,
this.indexSR,q,this.renderCoordsHelper.spatialReference);q[3]=n.mbs[3];n.engineMBS=q}if(!(g&&n.block!==b)){for(var w=c.featureData,q=void 0,D=0;D<w.length;D++)if(w[D].id===n.id){q=w[D];break}m(null!=q,"I3S: unable to find feature data in specified block in node.id "+a.id+" feature.id "+n.id);var w=q.geometries,D=[],E=[];if(null!=w)for(var H=0;H<w.length;H++){var G=q.geometries[H];if("GeometryReference"===G.type){for(var I=f.getIdFromJsonPointer(G.params.$ref),O=void 0,J=0;J<c.geometryData.length;J++){var F=
c.geometryData[J];if(F.id+""===I){O=F;break}}m(null!=O,"I3S: Unable to find referenced geometry");null==O.params.material&&(this.logger.warn("material definition is missing in featureData, node: "+a.id),J=Object.keys(d.materialDefinitions)[0],O.params.material="/materialDefinitions/"+J);null==O.params.components&&(O.params.components=null!=O.params.texture?[{material:O.params.material,materialID:f.getIdFromJsonPointer(O.params.material),texture:O.params.texture,textureID:f.getIdFromJsonPointer(O.params.texture),
id:1}]:[{material:O.params.material,materialID:f.getIdFromJsonPointer(O.params.material),id:1}],null!=O.params.faces&&null!=O.params.faces.position&&(O.params.faces.position.componentIndices=[0]));F=void 0;F=null;for(J=0;J<h.length;J++)if(1===h[J].geometries.length&&h[J].geometries[0].id+""===I){F=h[J];break}null===F&&(F={features:[],featureDataPositions:[],featureDataAttributes:[],faceRanges:[],geometries:[O]},h.push(F));F.features.push(n);F.featureDataAttributes.push(q.attributes);F.featureDataPositions.push(q.position);
F.faceRanges.push(G.params.faceRange)}else D.push(G),null!=G.params.faceRange&&E.push(G.params.faceRange)}else null!=q.position&&D.push({id:n.id,type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0,0]}}});0===E.length&&(E=null);0<D.length&&h.push({features:[n],featureDataAttributes:[q.attributes],featureDataPositions:[q.position],geometries:D,faceRanges:E})}}return h};f.prototype.idHash=function(a){var b=0,c=a.length;if(0===c)return b;for(var d=0;d<c;d++)var e=a.charCodeAt(d),b=(b<<
5)-b+e,b=b|0;return b};f.prototype.loadFeatureData=function(a,b,c){if(this.bypassFeatureData&&this.defaultGeometrySchema){a=this.idHash(a.id);var e=b=void 0;null!=c.materialDefinitions&&(b=Object.keys(c.materialDefinitions)[0]);null!=c.textureDefinitions&&(e=Object.keys(c.textureDefinitions)[0]);c=f.buildDefaultFeatureData(a,b,e,null);return g.resolve(c)}c=d.makeAbsolute(a.featureData[b].href,a.baseUrl);a.featureData[b].hrefConcat=c;return this.loadJSON(c)};f.buildDefaultFeatureData=function(a,b,
c,d){return{featureData:[{id:a,position:[0,0,0],pivotOffset:[0,0,0],mbb:d,layer:"Default",geometries:[{id:1,type:"GeometryReference",params:{$ref:"/geometryData/0",faceRange:[0,0]}}]}],geometryData:[{id:0,type:"ArrayBufferView",params:{type:"triangles",material:"/materialDefinitions/"+b,texture:null!=c?"/textureDefinitions/"+c:void 0}}]}};f.prototype.handleCancelled=function(){if(this.cancelled)throw p;};return f}()})},"esri/views/3d/layers/i3s/I3SUtil":function(){define("require exports ../../lib/glMatrix ../../support/earthUtils ../../support/projectionUtils ../../../../core/requireUtils ../../../../core/promiseUtils ../../../../core/Error ../../../../core/urlUtils ../../../../geometry/support/webMercatorUtils dojo/_base/lang dojo/promise/all ../../../../request ../../../../geometry/SpatialReference ../../../../geometry/support/scaleUtils ../../webgl-engine/Stage ../../webgl-engine/materials/Material ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Layer ../../webgl-engine/lib/Util ./I3SBinaryReader".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B){function z(a){return a&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10)}function A(a){var b=new p(z(a.store.indexCRS||a.store.geographicCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function w(a){var b=new p(z(a.store.vertexCRS||a.store.projectedCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function D(c,d,e){void 0===e&&(e=["*"]);return c?b.when(q,["../../../../tasks/support/Query","../../../../tasks/QueryTask"]).then(function(a){var b=
a[1];a=new a[0]({objectIds:[d],outFields:e});return(new b(c.parsedUrl.path)).execute(a)}).then(function(b){return b&&b.features&&0<b.features.length?b.features[0].attributes:a.reject(Error("Feature not found in companion feature layer."))}):a.reject(Error("Companion feature layer not present."))}function E(b,c,d,e,f){void 0===e&&(e=["*"]);var g=e.some(function(a){return"*"===a});return m(c.attributeData.map(function(d,k){if(!g&&!e.some(function(a){return b[k].name===a}))return a.resolve(null);var m=
h.makeAbsolute(d.href,c.baseUrl);return l(m,{query:{token:f},responseType:"array-buffer"}).then(function(a){return B.readBinaryAttribute(b[k],a.data)}).otherwise(function(){return null})})).then(function(a){for(var c={},e=0;e<a.length;e++)null!=a[e]&&(c[b[e].name]=a[e][d]);return c})}var H=k.vec4d,G=k.vec3d,I=k.mat4d,O=x.assert,J=H.create();n.DDS_ENCODING_STRING="image/vnd-ms.dds";n.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"];n.addTrailingSlash=function(a){"/"!==a[a.length-
1]&&(a+="/");return a};n.extractWkid=z;n.getIndexCrs=A;n.getVertexCrs=w;n.checkSpatialReference=function(a,b,c){var d=A(a),f=w(a);if(!g.canProject(d,b)||!g.canProject(f,b))throw new e("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{layer:a,viewSR:b,indexSR:d,vertexSR:f});if("local"===c&&(null==s.getUnitValue(d)||null==s.getUnitValue(f)))throw new e("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",
{layer:a,indexSR:d,vertexSR:f});};n.processNormals=function(a,b,d){switch(b){case "none":b=a.normals;d=a.positions;var e=a.normalInd,f=a.positionInd;O(a.normalInd.length===a.positionInd.length);a=G.create();for(var h=G.create(),g=0;g<f.length;g+=3){var k=3*f[g],m=d[k],l=d[k+1],p=d[k+2],k=3*f[g+1];a[0]=d[k]-m;a[1]=d[k+1]-l;a[2]=d[k+2]-p;k=3*f[g+2];h[0]=d[k]-m;h[1]=d[k+1]-l;h[2]=d[k+2]-p;G.cross(a,h,a);G.normalize(a);for(k=0;3>k;k++)m=3*e[g+k],b[m]=a[0],b[m+1]=a[1],b[m+2]=a[2]}break;case "east-north-up":break;
case "earth-centered":d(a.normals,c.SphericalRenderSpatialReference);break;case "vertex-reference-frame":break;default:throw Error("Received unexpected normalReferenceFrame: "+b);}};n.getAppropriateTextureEncoding=function(a,b){if(Array.isArray(a)){if(b){var c=a.indexOf(n.DDS_ENCODING_STRING);if(-1<c)return c}for(c=0;c<a.length;c++)if(-1<n.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(a[c]))return c;throw Error("Could not find appropriate texture encoding (among "+a.toString()+")");}return-1};
n.findIntersectingNodes=function(a,b,d,e,f,h){if(null!=d&&(c.mbsToMbs(d.mbs,e,J,b),0!==this.intersectBoundingBoxWithMbs(a,J))){h.push(d);for(var g=null!=d.children?d.children.length:0,k=0;k<g;k++)this.findIntersectingNodes(a,b,f[d.children[k].id],e,f,h)}};n.intersectBoundingBoxWithMbs=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=0;if(c<a[0])var g=a[0]-c,h=h+g*g;d<a[1]&&(g=a[1]-d,h+=g*g);e<a[2]&&(g=a[2]-e,h+=g*g);c>a[3]&&(g=c-a[3],h+=g*g);d>a[4]&&(g=d-a[4],h+=g*g);e>a[5]&&(g=e-a[5],h+=g*g);if(h>
f*f)return 0;if(0<h)return 1;h=Infinity;c-a[0]<h&&(h=c-a[0]);d-a[1]<h&&(h=d-a[1]);e-a[2]<h&&(h=e-a[2]);a[3]-c<h&&(h=a[3]-c);a[4]-d<h&&(h=a[4]-d);a[5]-e<h&&(h=a[5]-e);return h>f?2:1};n.makeNodeDebugVisualizer=function(a,b,d){function e(a){return{ambient:a,diffuse:[0,0,0],transparent:!0,opacity:0.5,blendModeOneOne:!1}}var h=new u(v.createCylinderGeometry(1,1,64,[0,0,1],[0,0,0],!1),"debugCylinder"),g=new u(v.createSphereGeometry(1),"debugSphere"),k={red:new t(e([0.8,0,0]),"debugMaterialRed"),grey:new t(e([0.4,
0.4,0.4]),"debugMaterialGrey"),brown:new t(e([0.2,0.1,0]),"debugMaterialBrown"),green:new t(e([0,0.8,0]),"debugMaterialGreen"),blue:new t(e([0,0,0.8]),"debugMaterialBlue"),yellow:new t(e([0.8,0.8,0]),"debugMaterialYellow"),magenta:new t(e([0.8,0,0.8]),"debugMaterialMagenta")},m;for(m in k)a.add(r.ModelContentType.MATERIAL,k[m]);a.add(r.ModelContentType.GEOMETRY,h);d=new y(d+"_debug",{interaction:"IGNORED"},d+"_debug");a.add(r.ModelContentType.LAYER,d);a.addToViewContent([d.getId()]);var l=G.create(),
p=I.create();return{engineLayer:d,added:{},show:function(a,d,e){var g=a.computedMbs;g||(g=H.create(),c.mbsToMbs(a.mbs,d,g,b.spatialReference));var m="node"+a.id+"dbg";G.set(g,l);var n=g[3];if(n>f.earthRadius/10&&b.spatialReference===c.SphericalRenderSpatialReference){this.showWS(l,Math.max(0.01*n,1E4),e,m+"_center");var g=G.length(l),r=f.earthRadius;r+n>g&&(n=(g*g+r*r-n*n)/(2*g),G.scale(l,n/g),n=Math.sqrt(r*r-n*n))}I.identity(p);I.scale(p,[n,n,0.05*n]);e=k[e];O(e);e=new C({name:m,geometries:[h],materials:[[e]],
transformations:[p],castShadow:!1,idHint:m});c.computeLinearTransformation(d,a.mbs,p,b.spatialReference);null!=l&&(p[12]=l[0],p[13]=l[1],p[14]=l[2]);e.setObjectTransformation(p);this._addToStage(e,m)},showWS:function(a,b,c,d){var e=I.identity();I.scale(e,[b,b,b]);b=k[c];O(b);e=new C({name:d,geometries:[g],materials:[[b]],transformations:[e],castShadow:!1,idHint:d});b=I.identity();I.translate(b,a);e.setObjectTransformation(b);this._addToStage(e,d)},_addToStage:function(b,c){a.add(r.ModelContentType.OBJECT,
b);this.engineLayer.addObject(b);var d=this.added[c];void 0!==d&&(a.remove(r.ModelContentType.OBJECT,d.getId()),this.engineLayer.removeObject(d));this.added[c]=b},clear:function(){for(var b in this.added){var c=this.added[b];a.remove(r.ModelContentType.OBJECT,c.getId());this.engineLayer.removeObject(c)}this.added={}},dispose:function(){this.clear();for(var b in k)a.remove(r.ModelContentType.MATERIAL,k[b].getId());a.remove(r.ModelContentType.GEOMETRY,h.getId());a.remove(r.ModelContentType.LAYER,this.engineLayer.getId())}}};
n.postData=function(a,b,c){var d=new XMLHttpRequest;d.open("PUT","/put.php"+a,!0);d.setRequestHeader("Content-type",c);d.send(b)};n.whenGraphicAttributes=function(b,c,e,f,h){f=f.filter(function(a){return!c.attributes.hasOwnProperty(a)});if(0===f.length)return a.resolve(c);var g=function(a){d.mixin(c.attributes,a);return c},k=b.companionFeatureLayer,m=b.attributeStorageInfo;return k?D(k,e,f).then(g):m&&(e=h(),null!=e)?E(m,e.node,e.index,f,b.token).then(g):a.reject()};n.queryAttributesFromFeatureLayer=
D;n.queryAttributesFromCachedAttributes=E;n.binaryIndexOf=function(a,b){for(var c=0,d=a.length-1;c<d;){var e=c+(d-c>>1);b>a[e]?c=e+1:d=e}return b===a[c]?c:~c}})},"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define(["require","exports","dojo/_base/lang","../../../../core/Logger","../../../../core/Error"],function(q,n,k,f,c){function b(a,b,d){for(var e="",f=0,h=0,g=0,k=0;f<d;)if(h=a[b+f],128>h)e+=String.fromCharCode(h),f++;else if(191<h&&224>h){if(f+1>=d)throw new c("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");
g=a[b+f+1];e+=String.fromCharCode((h&31)<<6|g&63);f+=2}else{if(f+2>=d)throw new c("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");g=a[b+f+1];k=a[b+f+2];e+=String.fromCharCode((h&15)<<12|(g&63)<<6|k&63);f+=3}return e}function a(a,b){for(var c={byteOffset:0,byteCount:0,fields:Object.create(null)},d=0,e=0;e<b.length;e++){var f=b[e],h=f.valueType||f.type;c.fields[f.property]=(0,n.valueType2ArrayBufferReader[h])(a,d);d+=n.valueType2TypedArrayClassMap[h].BYTES_PER_ELEMENT}c.byteCount=
d;return c}function e(a,d,e){var f=[],h,g=0,k;for(k=0;k<a;k+=1){h=d[k];if(0<h){if(f.push(b(e,g,h-1)),0!==e[g+h-1])throw new c("string-array-error","Invalid string array: missing null termination.");}else f.push(null);g+=h}return f}function h(a,b){return new n.valueType2TypedArrayClassMap[b.valueType](a,b.byteOffset,b.count*b.valuesPerElement)}function g(a,b){return new Uint8Array(a,b.byteOffset,b.byteCount)}function d(b,d,e){b=null!=d.header?a(b,d.header):{byteOffset:0,byteCount:0,fields:{count:e}};
e={header:b,byteOffset:b.byteCount,byteCount:0,entries:Object.create(null)};for(var f=b.byteCount,h=0;h<d.ordering.length;h++){var g=d.ordering[h],m=k.clone(d[g]);m.count=b.fields.count;if("String"===m.valueType){if(m.byteOffset=f,m.byteCount=b.fields[g+"ByteCount"],"UTF-8"!==m.encoding)throw new c("unsupported-encoding","Unsupported String encoding.",{encoding:m.encoding});}else if(l(m.valueType)){var n=p(m.valueType),f=f+(0!==f%n?n-f%n:0);m.byteOffset=f;m.byteCount=n*m.valuesPerElement*m.count}else throw new c("unsupported-value-type",
"Unsupported binary valueType",{valueType:m.valueType});f+=m.byteCount;e.entries[g]=m}e.byteCount=f-e.byteOffset;return e}function m(a,b,d){b!==a&&s.error("Invalid "+d+" buffer size\n expected: "+a+", actual: "+b+")");if(b<a)throw new c("buffer-too-small","Binary buffer is too small",{expectedSize:a,actualSize:b});}function l(a){return n.valueType2TypedArrayClassMap.hasOwnProperty(a)}function p(a){return l(a)&&n.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}var s=f.getLogger("esri.layers.SceneService");
n.readHeader=a;n.readStringArray=e;n.createTypedView=h;n.createRawView=g;n.createAttributeDataIndex=d;n.createGeometryDataIndex=function(b,c,d){var e=a(b,c.header),f=e.byteCount,h={header:e,byteOffset:e.byteCount,byteCount:0,vertexAttributes:k.clone(c.vertexAttributes)},g=h.vertexAttributes;!d&&null!=g.region&&delete g.region;for(d=0;d<c.ordering.length;d++){var l=c.ordering[d];null!=g[l]&&(g[l].byteOffset=f,g[l].count=e.fields.vertexCount,f+=p(g[l].valueType)*g[l].valuesPerElement*e.fields.vertexCount)}if(c.faces){h.faces=
k.clone(c.faces);g=h.faces;for(d=0;d<c.ordering.length;d++)name=c.ordering[d],g[name].byteOffset=f,g[name].count=e.fields.vertexCount;f+=p(g[name].valueType)*g[name].valuesPerElement*e.fields.vertexCount}if(c.featureAttributes&&c.featureAttributeOrder&&e.fields.featureCount){h.featureAttributes=k.clone(c.featureAttributes);g=h.featureAttributes;for(d=0;d<c.featureAttributeOrder.length;d++)name=c.featureAttributeOrder[d],g[name].byteOffset=f,g[name].count=e.fields.featureCount,l=p(g[name].valueType),
"UInt64"===g[name].valueType&&(l=8),f+=l*g[name].valuesPerElement*e.fields.featureCount}m(f,b.byteLength,"geometry");h.byteCount=f-h.byteOffset;return h};n.readBinaryAttribute=function(a,b,f){a["attributeByteCounts "]&&!a.attributeByteCounts&&(s.error("Warning: Trailing space in 'attributeByteCounts '."),a.attributeByteCounts=a["attributeByteCounts "]);"ObjectIds"===a.ordering[0]&&a.hasOwnProperty("objectIds")&&(s.error("Warning: Case error in objectIds"),a.ordering[0]="objectIds");f=d(b,a,f);m(f.byteOffset+
f.byteCount,b.byteLength,"attribute");if(a=f.entries.attributeValues||f.entries.objectIds){if("String"===a.valueType){f=f.entries.attributeByteCounts;var k=h(b,f);b=g(b,a);return e(f.count,k,b)}return h(b,a)}throw new c("bad-attribute-storage-info","Bad attributeStorageInfo specification.");};n.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array};n.valueType2ArrayBufferReader=
{Float32:function(a,b){return(new DataView(a,0)).getFloat32(b,!0)},Float64:function(a,b){return(new DataView(a,0)).getFloat64(b,!0)},UInt8:function(a,b){return(new DataView(a,0)).getUint8(b)},Int8:function(a,b){return(new DataView(a,0)).getInt8(b)},UInt16:function(a,b){return(new DataView(a,0)).getUint16(b,!0)},Int16:function(a,b){return(new DataView(a,0)).getInt16(b,!0)},UInt32:function(a,b){return(new DataView(a,0)).getUint32(b,!0)},Int32:function(a,b){return(new DataView(a,0)).getInt32(b,!0)}};
n.isValueType=l;n.getBytesPerValue=p})},"esri/views/3d/support/PromiseNativeOrShim":function(){define(["./PromiseShim"],function(q){return null!=window.Promise&&"function"===typeof window.Promise?window.Promise:q})},"esri/views/3d/support/PromiseShim":function(){define(["require","exports"],function(q,n){function k(b,a,c){setTimeout(b,0,a,c)}function f(b){return null!=b&&"object"===typeof b&&"then"in b&&"function"===typeof b.then}var c;(function(b){b[b.Pending=0]="Pending";b[b.Rejected=1]="Rejected";
b[b.Resolved=2]="Resolved"})(c||(c={}));return function(){function b(a){var b=this;this.init(c.Pending);a(function(a){return b.resolve(a)},function(a){return b.reject(a)})}b.prototype.then=function(a,e){if(this.state===c.Pending){var f=b.pending(a,e);this._addToChain(f);return f}if(this.state===c.Resolved)return null!=a?b.tryResolveAsync(a,this.value):b.resolve(this.value);if(this.state===c.Rejected)return null!=e?b.tryResolveAsync(e,this.error):b.reject(this.error)};b.prototype.catch=function(a){return this.then(null,
a)};b.resolve=function(a){if(a instanceof b)return a;if(f(a)){var e=Object.create(b.prototype);e.init(c.Pending);a.then(function(a){e.resolve(a)},function(a){e.reject(a)});return e}var h=Object.create(b.prototype);h.init(c.Resolved,a);return h};b.reject=function(a){var e=Object.create(b.prototype);e.init(c.Rejected,null,a);return e};b.all=function(a){var c=a.length;if(0===c)return b.resolve([]);var f=a.map(b.resolve),g=b.pending();a=function(){0===--c&&g.resolve(f.map(b.getValue))};for(var d=function(a){g.reject(a)},
k=0;k<f.length;k++)f[k].then(a,d);return g};b.prototype.init=function(a,b,c,f,d){void 0===b&&(b=null);void 0===c&&(c=null);void 0===f&&(f=null);void 0===d&&(d=null);this.state=a;this.value=b;this.error=c;this.callback=f;this.errback=d;this.chainedPromise=this.firstPromise=null};b.pending=function(a,e){var f=Object.create(b.prototype);f.init(c.Pending,null,null,a,e);return f};b.getValue=function(a){return a.value};b.prototype._unchain=function(){this.errback=this.callback=this.chainedPromise=null};
b.prototype._addToChain=function(a){a.chainedPromise=this.firstPromise;this.firstPromise=a};b.tryResolveAsync=function(a,e){var f=Object.create(b.prototype);f.init(c.Pending);k(function(){f.tryResolve(a,e)});return f};b.prototype.tryResolve=function(a,b){try{var c=a(b);this.resolve(c)}catch(f){console.error(f.stack instanceof Error?f.stack:f),this.reject(f)}};b.prototype.resolve=function(a){var e=this;this.state===c.Pending?a instanceof b?a.state===c.Pending?(this._unchain(),a._addToChain(this)):
a.state===c.Resolved?this.resolve(a.value):a.state===c.Rejected&&this.reject(a.error):f(a)?a.then(function(a){e.resolve(a)},function(a){e.reject(a)}):(this.state=c.Resolved,this.value=a,this.resolveHandlers()):console.error("Error: Promise is already resolved")};b.prototype.reject=function(a){this.state===c.Pending?(this.state=c.Rejected,this.error=a,this.rejectHandlers()):console.error("Error: Promise is already resolved")};b.prototype.resolveHandlers=function(){this.callResolveHandlers(this.firstPromise);
this.firstPromise=null};b.prototype.callResolveHandlers=function(a){null!=a&&(this.callResolveHandlers(a.chainedPromise),null!=a.callback?a.tryResolve(a.callback,this.value):a.resolve(this.value))};b.prototype.rejectHandlers=function(){this.callRejectHandlers(this.firstPromise);this.firstPromise=null};b.prototype.callRejectHandlers=function(a){null!=a&&(this.callRejectHandlers(a.chainedPromise),null!=a.errback?a.tryResolve(a.errback,this.error):a.reject(this.error))};return b}()})},"esri/views/3d/layers/i3s/I3SIndexTraversal":function(){define(["require",
"exports","./GoogPriorityQueue","../../support/PromiseLightweight","../../../../core/urlUtils"],function(q,n,k,f,c){return function(){function b(a,b,c,f,d,k,l,p,n,r,q,u){void 0===u&&(u={initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1});this.baseURL=a;this.startNodeUrl=b;this.rootId=c;this.poi=f;this.nodeIndex=d;this.streamDataSupplier=k;this.viewportQueries=l;this.processNodeIndexDocument=p;this.finishedLevelCallback=n;this.debugVis=r;this.logger=q;this.traversalOptions=u;this.queues=[];this.knownNodes=
new Set;this.dataLoadingPerLevel=[];this.numIndicesLoading=this.currentLevel=0;this.cancelled=this.queueTraversalEnabled=!1}b.prototype.start=function(){var a=this;this._nodeTraversalState={};this._nodeIsVisibleCached={};this.dataLoadingPerLevel=[];this.currentLevel=0;this.rootUrl=c.makeAbsolute(this.startNodeUrl,this.baseURL);this.traversalOptions.initDepthFirst?(this.initPromise=new f.Promise,this.getNode(this.rootUrl,this.rootId,this.initQueryCallback.bind(this),this.initQueryErrback.bind(this)),
this.initPromise.then(function(){a.cancelled||(a.queueTraversalEnabled=!0)})):(this.enqueue(0,{id:this.rootId,hrefConcat:this.rootUrl},0),this.queueTraversalEnabled=!0)};b.prototype.initQueryErrback=function(){this.initPromise.done()};b.prototype.continueTraversal=function(a){var b=this;if(this.queueTraversalEnabled){a=null==a?5:a;for(var c=0;c<this.queues.length;c++)if(!(this.traversalOptions.perLevelTraversal&&this.currentLevel!==c)){for(var f=this.queues[c];0<a--&&!f.isEmpty();)(function(a){var c=
b.queues[a].dequeue();b.dataLoadingPerLevel[a]++;var f=function(){b.dataLoadingPerLevel[a]--};b.getNode(c.hrefConcat,c.id,function(c,h){null==h.parentNode?(b.nodeTraversalState(h.id),b.enqueueConnected(c,h,a),b.processNodeIndexDocument(h,void 0).then(f,f)):b.getNode(b.concatHref(h.parentNode,c),h.parentNode.id,function(g,k){b.nodeTraversalState(h.id);b.enqueueConnected(c,h,a);b.processNodeIndexDocument(h,k).then(f,f)})},f)})(c);this.traversalOptions.perLevelTraversal&&(f.isEmpty()&&0===this.dataLoadingPerLevel[c])&&
(this.finishedLevelCallback.call(null,this.currentLevel),this.currentLevel++)}}};b.prototype.isQueueTraversalEnabled=function(){return this.queueTraversalEnabled};b.prototype.getQueueSize=function(){for(var a=0,b=0;b<this.queues.length;b++)a+=this.queues[b].getCount();return a};b.prototype.cancel=function(){this.queueTraversalEnabled=!1;for(var a=0;a<this.queues.length;a++)this.queues[a].clear();this.cancelled=!0};b.prototype.isLoading=function(){return 0<this.numIndicesLoading||0<this.getQueueSize()};
b.prototype.nodeIsVisible=function(a){if(null!=this._nodeIsVisibleCached[a.id])return this._nodeIsVisibleCached[a.id];this._nodeIsVisibleCached[a.id]=this.viewportQueries.isNodeVisible(a);return this._nodeIsVisibleCached[a.id]};b.prototype.nodeTraversalState=function(a){if(null!=this._nodeTraversalState[a])return this._nodeTraversalState[a];var b=this.nodeIndex[a];if(null==b)return null;var c=null,f=!1;if(null!=b.parentNode){c=this.nodeIndex[b.parentNode.id];if(null==c)return null;var d=this._nodeTraversalState[c.id];
null!=d&&(f=d.nodeIsTooHighLOD)}var d=this.viewportQueries.hasLOD(b),k=this.viewportQueries.isTooHighLOD(b),c=this.viewportQueries.isChosenLOD(b,c,k,f);this._nodeTraversalState[b.id]={visited:!0,nodeHasLOD:d,nodeIsTooHighLOD:k,isChosenLOD:c};return this._nodeTraversalState[a]};b.prototype.getNode=function(a,b,c,f){var d=this;this.numIndicesLoading++;this.nodeIndex[b]?(c(a,this.nodeIndex[b]),this.numIndicesLoading--):this.streamDataSupplier.request(a,"json").then(function(a,b){d.nodeIndex[b.id]=b;
b.baseUrl=a;c(a,b);d.numIndicesLoading--},function(b){null!=f&&f(b);d.loadErrorCallback(a);d.numIndicesLoading--})};b.prototype.initQueryCallback=function(a,b){if(this.cancelled)this.initPromise.done();else if(this.nodeTraversalState(b.id),this.enqueueConnected(a,b,0),this.isLeafNode(b))this.initPromise.done();else{for(var f=1E9,g=void 0,d=0;d<b.children.length;++d){var k=b.children[d];if(this.nodeIsVisible(k)&&(!this.viewportQueries.hasLOD(b)||!this.viewportQueries.isTooHighLOD(b))){var l=this.viewportQueries.distToPOI(k,
this.poi);l<f&&(f=l,g=k)}}g?(f=c.makeAbsolute(g.href,a),this.getNode(f,g.id,this.initQueryCallback.bind(this),this.initQueryErrback.bind(this))):this.initPromise.done()}};b.prototype.isLeafNode=function(a){return null==a.children};b.prototype.concatHref=function(a,b){return c.makeAbsolute(a.href,b)};b.prototype.enqueue=function(a,b,c){this.traversalOptions.perLevelTraversal||(c=0);for(this.knownNodes.add(b.id);this.queues.length<=c;)this.queues.push(new k.goog.structs.PriorityQueue),this.dataLoadingPerLevel.push(0);
this.queues[c].enqueue(a,b)};b.prototype.enqueueConnected=function(a,b,c){if(!this.cancelled&&null!=b){var f=this.nodeTraversalState(b.id);if(b.id!==this.rootId&&null!=b.parentNode&&!this.knownNodes.has(b.parentNode.id)){var d={id:b.parentNode.id,hrefConcat:this.concatHref(b.parentNode,a)};this.enqueue(this.viewportQueries.distToPOI(b.parentNode,this.poi),d,c-1)}else b.id===this.rootId&&(!this.knownNodes.has(b.id)&&this.nodeIsVisible(b))&&this.enqueue(this.viewportQueries.distToPOI(b,this.poi),{id:b.id,
hrefConcat:a},c);if(b.children)for(var k=0,l=b.children;k<l.length;k++){var p=l[k],d=this.nodeIsVisible(p);if(!this.knownNodes.has(p.id)&&(!f.nodeHasLOD||!f.nodeIsTooHighLOD)&&d)d={id:p.id,hrefConcat:this.concatHref(p,a)},this.enqueue(this.viewportQueries.distToPOI(p,this.poi),d,c+1)}if(this.traversalOptions.neighborhood&&b.neighbors){f=0;for(b=b.neighbors;f<b.length;f++)k=b[f],d=this.nodeIsVisible(k),!this.knownNodes.has(k.id)&&d&&(d={id:k.id,hrefConcat:this.concatHref(k,a)},this.enqueue(this.viewportQueries.distToPOI(k,
this.poi),d,c))}}};b.prototype.loadErrorCallback=function(a){this.logger.warn("Error loading node: "+a)};return b}()})},"esri/views/3d/layers/i3s/GoogPriorityQueue":function(){define([],function(){var q={};(function(){function n(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=
typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function k(a,b){var c=a.split("."),e=h;c[0]in e||!e.execScript||e.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)c.length||void 0===b?e=e[f]?e[f]:e[f]={}:e[f]=b}function f(a,
b){this.d=a;this.b=b}function c(a){if("array"!=n(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function b(c){this.a=[];if(c)a:{var d,e;if(c instanceof b){d=c.a;e=[];for(var h=d.length,k=0;k<h;k++)e.push(d[k].getKey());d=e;e=c.a;for(var h=[],k=e.length,n=0;n<k;n++)h.push(e[n].b);e=h;if(0>=c.a.length){c=this.a;for(h=0;h<d.length;h++)c.push(new f(d[h],e[h]));break a}}else{d=[];h=0;for(k in c)d[h++]=k;h=[];k=0;for(e in c)h[k++]=c[e];e=h}for(h=0;h<d.length;h++)a(this,d[h],e[h])}}function a(a,
b,c){var e=a.a;e.push(new f(b,c));b=e.length-1;a=a.a;for(c=a[b];0<b;)if(e=b-1>>1,a[e].getKey()>c.getKey())a[b]=a[e],b=e;else break;a[b]=c}function e(){b.call(this)}var h=this;f.prototype.getKey=function(){return this.d};f.prototype.c=function(){return new f(this.d,this.b)};b.prototype.remove=function(){var a=this.a,b=a.length,e=a[0];if(!(0>=b)){if(1==b)c(a);else{a[0]=a.pop();for(var a=0,b=this.a,f=b.length,h=b[a];a<f>>1;){var k=2*a+1,n=2*a+2,k=n<f&&b[n].getKey()<b[k].getKey()?n:k;if(b[k].getKey()>
h.getKey())break;b[a]=b[k];a=k}b[a]=h}return e.b}};b.prototype.c=function(){return new b(this)};b.prototype.g=function(){return this.a.length};b.prototype.h=function(){return 0==this.a.length};b.prototype.clear=function(){c(this.a)};(function(){function a(){}var c=b;a.prototype=c.prototype;e.i=c.prototype;e.prototype=new a})();e.prototype.f=function(b,c){a(this,b,c)};e.prototype.e=function(){return this.remove()};k("goog.structs.PriorityQueue",e);k("goog.structs.PriorityQueue.prototype.enqueue",e.prototype.f);
k("goog.structs.PriorityQueue.prototype.dequeue",e.prototype.e);k("goog.structs.PriorityQueue.prototype.isEmpty",e.prototype.h);k("goog.structs.PriorityQueue.prototype.clear",e.prototype.clear);k("goog.structs.PriorityQueue.prototype.clone",e.prototype.c);k("goog.structs.PriorityQueue.prototype.getCount",e.prototype.g)}).call(q);return q})},"esri/views/3d/layers/i3s/I3SLodHandling":function(){define(["require","exports"],function(q,n){return function(){function k(f,c){this.layerViewRequiredFunctions=
f;this.layerViewOptionalFunctions=c;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={}}k.prototype.startNodeLoading=function(f,c,b,a,e,h){this._lodGlobalDirty=!1;this._lodMode=b;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};this._nodeIndex=a;this._rootId=h;this._nodeTraversalState=c;this._nodeIsVisible=f;if("swap"===this._lodMode){for(var g in e)f=e[g],this._nodeTraversalState(f.id).nodeHasLOD&&!this._nodeTraversalState(f.id).isChosenLOD&&
(this._lodSwapNodeIndex[g]=f);this._lodSwapBuildUnmatchingFeatureLookups()}};k.prototype.cancelNodeLoading=function(){this._lodSwapNodeIndex={}};k.prototype.shouldLoadNode=function(f,c){var b=this._nodeTraversalState(f.id),a=b.nodeHasLOD,b=b.isChosenLOD;return"perLevel"!==this._lodMode?b||!a:b||!a?!0:this.layerViewOptionalFunctions.traversalOptions.allowPartialOverlaps?this._someSubtreesIncomplete(f):this._allSubtreesIncomplete(f)};k.prototype.shouldSetPolygonOffset=function(f){return"perLevel"===
this._lodMode?!this._nodeTraversalState(f.id).isChosenLOD:!1};k.prototype._allSubtreesIncomplete=function(f){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(f))return!1;var c=!0;if(null!=f.children)for(var b=0;b<f.children.length;++b){var a=f.children[b];this._nodeIsVisible(a)&&(a=this._nodeIndex[a.id],c=c&&(null==a||this._allSubtreesIncomplete(a)))}return c};k.prototype._someSubtreesIncomplete=function(f){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(f))return!1;var c=!1;if(null!=
f.children)for(var b=0;b<f.children.length;++b){var a=f.children[b];this._nodeIsVisible(a)&&(a=this._nodeIndex[a.id],c=c||null==a||this._allSubtreesIncomplete(a))}return c};k.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0};k.prototype.finishedLevel=function(f){"perLevel"===this._lodMode&&this._deleteUpToLevelRecurse(f-1,0,this._nodeIndex[this._rootId])};k.prototype._deleteUpToLevelRecurse=function(f,c,b){if(null!=b&&!(c>f)&&(this._nodeTraversalState(b.id).isChosenLOD||this.layerViewRequiredFunctions.removeNodeData(b),
null!=b.children))for(var a=0;a<b.children.length;++a)this._deleteUpToLevelRecurse(f,c+1,this._nodeIndex[b.children[a].id])};k.prototype.lodSwapBundleLoaded=function(f,c,b){if(null!=b)if(null!=b.swapPairs&&0<Object.keys(b.swapPairs).length){if(null!=c){f=b.swapPairs;b={};for(var a=0;a<c.length;a++)for(var e=c[a].features,h=0;h<e.length;h++)b[e[h].id]=!0;for(var g in f){c=f[g];a=[];e=c.features;for(h=0;h<e.length;h++)null!=b[e[h]]&&a.push(e[h]);this.layerViewRequiredFunctions.removeFeatures(c.node,
c.features)}}}else{for(a in b.nodesHigherInTree)this.layerViewRequiredFunctions.removeNodeData(b.nodesHigherInTree[a]);for(a in b.nodesDeeperInTree)this.layerViewRequiredFunctions.removeNodeData(b.nodesDeeperInTree[a])}this._lodGlobalDirty=!0};k.prototype.lodGlobalHandling=function(){if("global"===this._lodMode&&(!0===this._lodGlobalDirty||this.layerViewRequiredFunctions.isOverMemory())){var f=this._rootId;null!=f&&(this._lodGlobalHandlingRecursion({id:f,mbs:null},this._nodeIndex,!1,!1,0),this._lodGlobalHandlingRecursionRemoveIntermediate(f,
this._nodeIndex,!1,0),this._lodGlobalDirty=!1)}};k.prototype.lodSwapBuildInfoForNode=function(f){if(!this._nodeTraversalState(f.id).nodeHasLOD)return null;if("swap"===this._lodMode){var c={},b={},a=!1,e=!1,h=f.id+"",g;for(g in this._lodSwapNodeIndex){var d=this._lodSwapNodeIndex[g];null!=this.layerViewRequiredFunctions.getAddedFeatures(d.id)&&(a=null===f.parentNode||0===(d.id+"").indexOf(h),e=null==d.parentNode||0===h.indexOf(d.id+""),!0===e&&(b[d.id]=d),!0===a&&(c[d.id]=d))}return{nodesHigherInTree:b,
nodesDeeperInTree:c}}if("perLevel"===this._lodMode&&this._nodeTraversalState(f.id).isChosenLOD)return c={},this._getNodesRecurse(f,c),{nodesHigherInTree:null,nodesDeeperInTree:c}};k.prototype._getNodesRecurse=function(f,c){if(null!=f.children)for(var b=0;b<f.children.length;++b){var a=f.children[b],e=this._nodeIndex[a.id];null!=e&&(c[a.id]=e,this._getNodesRecurse(e,c))}};k.prototype._lodSwapBuildUnmatchingFeatureLookups=function(){this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};for(var f in this._lodSwapNodeIndex){var c=
this._lodSwapNodeIndex[f],b=this.layerViewRequiredFunctions.getAddedFeatures(c.id);if(null!=b)for(var a=0;a<b.length;a++){var e=b[a];this._lodSwapFeatureLookup[e.id]=c;null!=e.rootFeature&&(null==this._lodSwapRootFeatureLookup[e.rootFeature]&&(this._lodSwapRootFeatureLookup[e.rootFeature]=[]),this._lodSwapRootFeatureLookup[e.rootFeature].push({node:c,featureId:e.id}))}}};k.prototype._validateLodTreeVisibilities=function(){if(null!=this.layerViewOptionalFunctions.getAllAddedFeatures){var f=this.layerViewOptionalFunctions.getAllAddedFeatures();
console.debug("validating lod tree: ");var c={},b={},a=!0,e;for(e in f)for(var h=f[e],g=0;g<h.length;g++){var d=h[g];null!=c[d.id]&&c[d.id]!==e&&(console.debug("node "+e+" !! encountered feature "+d.id+" already in node "+c[d.id]),a=!1);null!=b[d.id]&&b[d.id]!==e&&(console.debug("node "+e+" !! encountered feature "+d.id+" already as rootFeature in node "+b[d.id]),a=!1);c[d.id]=e;null!=d.rootFeature&&b[d.rootFeature]!==e&&(null!=b[d.rootFeature]&&(console.debug("node "+e+" !! encountered rootFeature "+
d.rootFeature+" already in node "+b[d.rootFeature]),a=!1),null!=c[d.rootFeature]&&(console.debug("node "+e+" !! encountered rootFeature "+d.rootFeature+" already as feature"),a=!1),b[d.rootFeature]=e)}return a}};k.prototype._lodGlobalHandlingRecursion=function(f,c,b,a,e){var h=f.id,g=c[h];if(null==g)return b=null!=f.mbs?this._nodeIsVisible(f):!1,a||!b;h=this._nodeTraversalState(h);f=this._nodeIsVisible(g);var h=h.isChosenLOD,d=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(g,0).alreadyLoaded,
k=!0;if(null!=g.children)for(var l=0;l<g.children.length;++l)this._lodGlobalHandlingRecursion(g.children[l],c,d&&h||b,h||a,e+1)||(k=!1);c=this.layerViewRequiredFunctions.isOverMemory();if(d&&!h&&((a?b:k)||c))this.setLodGlobalDirty(),this.layerViewRequiredFunctions.removeNodeData(g),d=!1;d&&this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(g,!(h&&!a));b=k||d;if(h&&d||!f||a)b=!0;h&&(!d&&f)&&(b=!1);return b};k.prototype._lodGlobalHandlingRecursionRemoveIntermediate=
function(f,c,b,a){var e=c[f];if(null!=e){var h=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(e,0).alreadyLoaded;f=this._nodeTraversalState(f).isChosenLOD;if(null!=e.children)for(var g=0;g<e.children.length;++g)this._lodGlobalHandlingRecursionRemoveIntermediate(e.children[g].id,c,h||b,a+1);b&&(!f&&h)&&(this.layerViewRequiredFunctions.removeNodeData(e),this.setLodGlobalDirty())}};return k}()})},"esri/views/3d/layers/i3s/I3SViewportQueries":function(){define("require exports ../../lib/glMatrix ./I3SUtil ../../webgl-engine/lib/Util ../../support/projectionUtils ../graphics/Graphics3DSymbolCommonCode ../../../../geometry/Point".split(" "),
function(q,n,k,f,c,b,a,e){var h=k.vec3d,g=k.vec4d;return function(){function d(a,b,d,f,k,n,q,v){void 0===v&&(v={});this.indexSR=a;this.renderCoordsHelper=b;this.extent=f;this.errorMetric=k;this.elevationProvider=n;this.elevationInfo=q;this.options=v;this.fp=[];this._tmp1=[0,0,0];this._tmp2=[0,0,0];this._tmp3=[0,0,0];this._tmp0=[0,0,0];this.maxDistance=v.maxDistance||Number.MAX_VALUE;this.screenspaceErrorBias=v.screenspaceErrorBias||1;this.enableLoD=!1!==v.disableLod;for(f=0;8>f;++f)this.fp[f]=g.create();
c.matrix2frustumPlanes(d.viewMatrix,d.projectionMatrix,this.fp);this.engineSR=b.spatialReference;this._screenSizeFactor=1/d.perPixelRatio;this._camPos=d.eye;this._center=d.center;this._camDir=h.subtract(this._center,this._camPos,[0,0,0]);h.normalize(this._camDir);this.tmpPoint=new e({x:0,y:0,z:0,spatialReference:a})}d.prototype.computedMbs=function(c){c.computedMbs||(c.computedMbs=g.create(),c.computedMbs[3]=-1);var d=c.computedMbs;0>d[3]&&(d[0]=c.mbs[0],d[1]=c.mbs[1],d[2]=c.mbs[2],d[3]=c.mbs[3],
this.elevationProvider&&(this.tmpPoint.x=d[0],this.tmpPoint.y=d[1],this.tmpPoint.z=d[2],d[2]=a.computeElevation(this.elevationProvider,this.tmpPoint,this.elevationInfo)),b.mbsToMbs(d,this.indexSR,d,this.engineSR));return d};d.prototype.isNodeVisible=function(a){a=this.computedMbs(a);return this.isMBSinExtent(a)&&this.isMBSVisible(a)};d.prototype.isMBSinExtent=function(a){return!this.extent?!0:0!==f.intersectBoundingBoxWithMbs(this.extent,a)};d.prototype.isMBSVisible=function(a){var b=a[0],c=a[1],
d=a[2];a=a[3];var e=this.fp;return e[0][0]*b+e[0][1]*c+e[0][2]*d+e[0][3]<=a&&e[1][0]*b+e[1][1]*c+e[1][2]*d+e[1][3]<=a&&e[2][0]*b+e[2][1]*c+e[2][2]*d+e[2][3]<=a&&e[3][0]*b+e[3][1]*c+e[3][2]*d+e[3][3]<=a&&e[4][0]*b+e[4][1]*c+e[4][2]*d+e[4][3]<=a&&e[5][0]*b+e[5][1]*c+e[5][2]*d+e[5][3]<=a};d.prototype.calcScreenSpaceSize=function(a,b){var c=this.computedMbs(a),d=c[3],c=h.dist2(c,this._camPos)-d*d;return 0>c?0.5*Number.MAX_VALUE:b/Math.sqrt(c)*this._screenSizeFactor};d.prototype.calcAngleDependentLoD=
function(a){a=this.computedMbs(a);var b=a[3];a=(Math.abs(a[0]*(a[0]-this._camPos[0])+a[1]*(a[1]-this._camPos[1])+a[2]*(a[2]-this._camPos[2]))/h.length(a)+b)/h.dist(a,this._camPos);return Math.min(1,a)};d.prototype.hasLOD=function(a){return this.enableLoD&&void 0!==a.lodSelection||void 0!==a.precision};d.prototype.hasFeatures=function(a){return null!=a.features&&0<a.features.length||null!=a.featureData};d.prototype.getDistancePlanarMode=function(a,b,c){var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];d=d+d+
e*e;if(d<=c*c)return Math.abs(a);c=Math.sqrt(d)-c;return Math.sqrt(a*a+c*c)};d.prototype.getDistanceGlobeMode=function(a,b,c){var d=h.length(b),e=h.length(a)-d;h.scale(a,h.dot(a,b)/h.length2(a),this._tmp0);if(h.dist2(b,this._tmp0)<=c*c)return Math.abs(e);b=h.scale(b,1/d,this._tmp0);var d=h.scale(b,d-c*c/2/d,this._tmp1),f=h.subtract(a,d,this._tmp2),f=h.subtract(f,h.scale(b,h.dot(b,f),this._tmp3),this._tmp2),d=h.add(d,h.scale(f,c/h.length(f),this._tmp2),this._tmp2);c=h.dist(a,d);2E5<=e&&(a=h.subtract(a,
d,this._tmp1),a=h.dot(a,b)/h.length(a),0.08>a&&(a=1E-4),c/=a);return c};d.prototype.getDistance=function(a,c,d){return this.engineSR===b.SphericalRenderSpatialReference?this.getDistanceGlobeMode(a,c,d):this.getDistancePlanarMode(a,c,d)};d.prototype.isTooHighLOD=function(a){if(a.lodSelection&&0<a.lodSelection.length){if(!1===this.hasFeatures(a))return!1;for(var b=0;b<a.lodSelection.length;b++){var c=a.lodSelection[b];if(!(null!=this.errorMetric&&c.metricType!==this.errorMetric)){if("screenSpaceRelative"===
c.metricType)return a=this.computedMbs(a),a=2*this.getDistance(this._camPos,a,a[3])/this._screenSizeFactor,c.maxError*this.screenspaceErrorBias<=a;if("maxScreenThreshold"===c.metricType)return b=this.calcScreenSpaceSize(a,a.mbs[3]),this.options.angleDependentLoD&&(b*=this.calcAngleDependentLoD(a)),b*this.screenspaceErrorBias<c.maxError;if("removedFeatureDiameter"===c.metricType)return 10>this.calcScreenSpaceSize(a,c.maxError)*this.screenspaceErrorBias}}}return!1};d.prototype.isChosenLOD=function(a,
b,c,d){return a.lodSelection&&0<a.lodSelection.length?(c=null!=c?c:this.isTooHighLOD(a),b=!b?!1:null!=d?d:this.isTooHighLOD(b),(c||!a.children)&&!b):!0};d.prototype.distToPOI=function(a,b){var c=this.computedMbs(a);return h.dist(c,b)-c[3]};return d}()})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./FeatureLayer ./support/Field ./support/LabelClass ./mixins/SceneService ../PopupTemplate ../request ../core/lang ../core/kebabDictionary ../core/requireUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/accessorSupport/PropertyOrigin ../core/accessorSupport/utils ../geometry/SpatialReference ../geometry/support/scaleUtils ../renderers/support/jsonUtils ../portal/PortalItem dojo/_base/lang dojo/promise/all".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A,w){function D(a,b){for(var c=b.toLowerCase(),d=0;d<a.length;d++){var e=a[d];if(e.name.toLowerCase()===c)return e}return null}var E=p({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",absoluteHeight:"absolute-height"}),H=["3DObject","Point"],G=u.getLogger("esri.layers.SceneLayer"),I={"features-points":"point","features-lines":"polyline","features-polygons":"polygon"};return function(b){function g(a,c){b.call(this);this.operationalLayerType=
"ArcGISSceneServiceLayer";this.elevationInfo=this.fields=null;this.labelsVisible=!1;this.labelingInfo=null;this.legendEnabled=!0;this.renderer=null;this.cachedDrawingInfo={color:!1};this.spatialReference=null;this.popupEnabled=!0;this.objectIdFilter=this.objectIdField=this.popupTemplate=null}k(g,b);g.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?A.mixin({},{url:a},b):a};g.prototype.getField=function(a){return D(this.fields,a)};g.prototype.readElevationInfo=function(a){a=l.clone(a);
a.mode=E.fromJSON(a.mode);return a};g.prototype.writeElevationInfo=function(a,b){if(a&&(a.mode||a.offset||a.featureExpression)){var c={};a.mode&&(c.mode=E.toJSON(a.mode));a.offset&&(c.offset=a.offset);a.featureExpression&&(c.featureExpression=a.featureExpression);b.layerDefinition={elevationInfo:c}}};Object.defineProperty(g.prototype,"geometryType",{get:function(){return I[this.profile]||"mesh"},enumerable:!0,configurable:!0});g.prototype.readLabelsVisible=function(a,b){return b.showLabels};g.prototype.writeLabelsVisible=
function(a,b){a&&(b.showLabels=!0)};g.prototype.readLabelingInfo=function(a,b,c){a=b.drawingInfo.labelingInfo;if(!a)return null;var d=/\[([^\[\]]+)\]/ig,e=null!=b.fields&&Array.isArray(b.fields)?b.fields:null,f=function(a,b){var c=D(e,b);return"["+(c&&c.name||b)+"]"};return a.map(function(a){var b=new h;b.read(a,c);if((a=b.labelExpression)&&e)b.labelExpression=a.replace(d,f);return b})};g.prototype.writeLabelingInfo=function(a,b,c){a&&(b.layerDefinition={drawingInfo:{labelingInfo:a.map(function(a){return a.write({},
c)})}})};g.prototype.readLegendEnabled=function(a,b){return null!=b.showLegend?b.showLegend:!0};g.prototype.writeLegendEnabled=function(a,b){a||(b.showLegend=!1)};g.prototype.readRenderer=function(a,b,c){if(a=b.drawingInfo.renderer||void 0)(a=B.read(a,b,c)||void 0)||G.error("Failed to create renderer",{rendererDefinition:b.drawingInfo.renderer,layer:this,context:c});return a};g.prototype.readCachedDrawingInfo=function(a,b){if(null==a||"object"!==typeof a)a={};null==a.color&&(a.color=!1);return a};
g.prototype.readSpatialReference=function(a,b){if(null!=b.spatialReference)return y.fromJSON(b.spatialReference);var c=b.store,c=(c=c.indexCRS||c.geographicCRS)&&parseInt(c.substring(c.lastIndexOf("/")+1,c.length),10);return null!=c?new y(c):null};g.prototype.readPopupEnabled=function(a,b){return null!=b.disablePopup?!b.disablePopup:void 0};g.prototype.writePopupEnabled=function(a,b){a||(b.disablePopup=!0)};g.prototype.readPopupTemplate=function(a,b){return b.popupInfo?d.fromJSON(b.popupInfo):void 0};
g.prototype.writePopupTemplate=function(a,b){a&&(b.popupInfo=a.toJSON())};g.prototype.readObjectIdField=function(a,b){!a&&b.fields&&b.fields.some(function(b){"esriFieldTypeOID"===b.type&&(a=b.name);return!!a});return a||void 0};g.prototype.readProfile=function(a,b){return b.store.profile};g.prototype.readNormalReferenceFrame=function(a,b){return b.store.normalReferenceFrame};g.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return w([a._verifyRootNodeAndUpdateExtent(),
a._setCompanionFeatureLayer()])}).then(function(){return a._applyCompanionOverrides()});this.addResolvingPromise(b);return this};g.prototype.createLayerView=function(a){var b=this,c=this.profile||"features-meshes";return s.when(q,"features-meshes"===c||"meshpyramids"===c?"../views/3d/layers/SceneLayerView3D":"../views/3d/layers/SceneLayerGraphicsView3D").then(function(c){return new c({view:a,layer:b})})};g.prototype.read=function(a,b){this.inherited(arguments,[a,b]);a.layerDefinition&&this.inherited(arguments,
[a.layerDefinition,b]);return this};g.prototype.queryExtent=function(a){return this._getCompanionLayerForQuery().then(function(b){return b.queryExtent(a)})};g.prototype.queryFeatureCount=function(a){return this._getCompanionLayerForQuery().then(function(b){return b.queryFeatureCount(a)})};g.prototype.queryFeatures=function(a){return this._getCompanionLayerForQuery().then(function(b){return b.queryFeatures(a)})};g.prototype.queryObjectIds=function(a){return this._getCompanionLayerForQuery().then(function(b){return b.queryObjectIds(a)})};
g.prototype._getCompanionLayerForQuery=function(){var a=this.companionFeatureLayer;return null!=a?r.resolve(a):r.reject(new t("scenelayer:query-not-available","SceneLayer queries are not available without companion feature layer"))};g.prototype._validateLayer=function(a){if(a.layerType&&-1===H.indexOf(a.layerType))throw new t("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new t("layer:service-version-not-supported",
"Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new t("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});a=this.normalReferenceFrame;var b=!1,c=!1;if(null==a)c=b=!0;else{var d=null==x.getUnitValue(this.spatialReference);switch(a){case "east-north-up":case "earth-centered":b=!0;c=d;break;case "vertex-reference-frame":b=!0;c=!d;break;
default:b=!1}}if(!b)throw new t("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!c)throw new t("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with scene spatial reference.");};g.prototype._applyCompanionOverrides=function(){if(this.companionFeatureLayer)for(var a=["popupTemplate","popupEnabled","fields"],b=C.getProperties(this),c=0;c<a.length;c++){var d=a[c];this._buddyIsMoreImportant(d)&&(b.setDefaultOrigin(this.companionFeatureLayer.originOf(d)),
b.set(d,this.companionFeatureLayer[d]),b.setDefaultOrigin("user"))}};g.prototype._setCompanionFeatureLayer=function(){var a=this;return this._fetchCompanionFeatureLayer().then(function(b){a.companionFeatureLayer=b})};g.prototype._fetchCompanionFeatureLayer=function(){var a=this;return-1===["meshpyramids","features-points"].indexOf(this.profile)?r.resolve(null):(this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):this._fetchCompanionFeatureLayerFromUrl()).then(function(a){return a.load()}).otherwise(function(b){null==
a.attributeStorageInfo?G.warn("Companion FeatureLayer could not be loaded and no binary attributes found. Popups will not work for this SceneLayer: "+a.title):G.info("Companion FeatureLayer could not be loaded. Falling back to binary attributes for Popups on this SceneLayer: "+a.title);return null})};g.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(a){var b=this;return a.fetchRelatedItems({relationshipType:"Service2Data",direction:"forward"}).then(function(a){return(a=a.filter(function(a){return"Feature Service"===
a.type})[0])?b._fetchCompanionFeatureLayerFromPortalItem(new z({id:a.id,portal:a.portal})):b._fetchCompanionFeatureLayerFromUrl()}).otherwise(function(){return b._fetchCompanionFeatureLayerFromUrl()})};g.prototype._fetchCompanionFeatureLayerFromPortalItem=function(b){var c=this;return b.load().then(function(a){return c._findMatchingCompanionSublayerUrl(a.url)}).then(function(c){return r.resolve(new a({url:c,portalItem:b}))})};g.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(b){return r.resolve(new a({url:b}))})};
g.prototype._findMatchingCompanionSublayerUrl=function(a){var b=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!b)return r.reject();null==a&&(a=b[1]+"/FeatureServer");var c=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");a={query:{f:"json"},responseType:"json"};var d=b[1]+"/SceneServer",e=parseInt(b[2],10),b=m(this._addUrlToken(d),a).otherwise(function(a){return{layers:null}});a=m(this._addUrlToken(c),a);return w([a,b]).then(function(a){var b=a[0];a=a[1];a=a.data&&a.data.layers;
b=b.data&&b.data.layers;if(!Array.isArray(b))throw Error("expected layers array");if(Array.isArray(a))for(var d=0;d<Math.min(a.length,b.length);d++){if(a[d].id===e)return c+"/"+b[d].id}else if(e<b.length)return c+"/"+b[e].id;throw Error("could not find matching companion sublayer");})};g.prototype._buddyIsMoreImportant=function(a){if(!this.companionFeatureLayer)return!1;var b=v.nameToId(this.originOf(a));a=v.nameToId(this.companionFeatureLayer.originOf(a));return null!=a&&a<=v.OriginId.SERVICE?null==
b||b<v.OriginId.SERVICE:null!=a&&a<=v.OriginId.PORTAL_ITEM?null==b||b<v.OriginId.PORTAL_ITEM:!1};f([c.shared("esri.layers.SceneLayer")],g.prototype,"declaredClass",void 0);f([c.property()],g.prototype,"companionFeatureLayer",void 0);f([c.property()],g.prototype,"operationalLayerType",void 0);f([c.property({type:[e]})],g.prototype,"fields",void 0);f([c.property({readOnly:!0})],g.prototype,"attributeStorageInfo",void 0);f([c.property()],g.prototype,"elevationInfo",void 0);f([c.read("elevationInfo")],
g.prototype,"readElevationInfo",null);f([c.write("elevationInfo")],g.prototype,"writeElevationInfo",null);f([c.property({type:String,dependsOn:["profile"]})],g.prototype,"geometryType",null);f([c.property({type:Boolean})],g.prototype,"labelsVisible",void 0);f([c.read("labelsVisible",["showLabels"])],g.prototype,"readLabelsVisible",null);f([c.write("labelsVisible")],g.prototype,"writeLabelsVisible",null);f([c.property()],g.prototype,"labelingInfo",void 0);f([c.read("labelingInfo",["drawingInfo.labelingInfo"])],
g.prototype,"readLabelingInfo",null);f([c.write("labelingInfo")],g.prototype,"writeLabelingInfo",null);f([c.property({type:Boolean})],g.prototype,"legendEnabled",void 0);f([c.read("legendEnabled",["showLegend"])],g.prototype,"readLegendEnabled",null);f([c.write("legendEnabled")],g.prototype,"writeLegendEnabled",null);f([c.property({json:{writeTo:"layerDefinition.drawingInfo.renderer"}})],g.prototype,"renderer",void 0);f([c.read("renderer",["drawingInfo.renderer"])],g.prototype,"readRenderer",null);
f([c.property()],g.prototype,"cachedDrawingInfo",void 0);f([c.read("cachedDrawingInfo")],g.prototype,"readCachedDrawingInfo",null);f([c.property({type:y})],g.prototype,"spatialReference",void 0);f([c.read("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],g.prototype,"readSpatialReference",null);f([c.property({type:Boolean})],g.prototype,"popupEnabled",void 0);f([c.read("popupEnabled",["disablePopup"])],g.prototype,"readPopupEnabled",null);f([c.write("popupEnabled")],
g.prototype,"writePopupEnabled",null);f([c.property({type:d})],g.prototype,"popupTemplate",void 0);f([c.read("popupTemplate",["popupInfo"])],g.prototype,"readPopupTemplate",null);f([c.write("popupTemplate")],g.prototype,"writePopupTemplate",null);f([c.property({type:String})],g.prototype,"objectIdField",void 0);f([c.read("objectIdField",["fields"])],g.prototype,"readObjectIdField",null);f([c.property()],g.prototype,"objectIdFilter",void 0);f([c.property({type:String})],g.prototype,"profile",void 0);
f([c.read("profile",["store.profile"])],g.prototype,"readProfile",null);f([c.property({readOnly:!0,type:String})],g.prototype,"normalReferenceFrame",void 0);f([c.read("normalReferenceFrame",["store.normalReferenceFrame"])],g.prototype,"readNormalReferenceFrame",null);return g=f([c.subclass()],g)}(c.declared(b,g))})},"esri/layers/mixins/SceneService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Layer ../../core/MultiOriginJSONSupport ./ArcGISService ./OperationalLayer ./PortalLayer ../../core/Error ../../core/urlUtils ../../core/promiseUtils ../../core/requireUtils ../../request dojo/_base/lang dojo/io-query ../../geometry/Extent ../support/arcgisLayerUrl".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v){return function(a){function b(){a.apply(this,arguments);this.fullExtent=this.blendMode=null;this.version={major:Number.NaN,minor:Number.NaN,versionString:""};this.copyright=null;this.sublayerTitleMode="item-title";this.layerId=this.title=null}k(b,a);b.prototype.readFullExtent=function(a,b){var c=b.store,d=c.indexCRS||c.geographicCRS,d=d&&parseInt(d.substring(d.lastIndexOf("/")+1,d.length),10);return null==c||null==c.extent?null:new u({xmin:c.extent[0],
ymin:c.extent[1],xmax:c.extent[2],ymax:c.extent[3],spatialReference:d})};b.prototype.readVersion=function(a,b){var c=b.store,d=null!=c.version?c.version.toString():"",c={major:Number.NaN,minor:Number.NaN,versionString:d},d=d.split(".");2<=d.length&&(c.major=parseInt(d[0],10),c.minor=parseInt(d[1],10));return c};b.prototype.readCopyright=function(a,b){return b.copyrightText};b.prototype.readTitlePortalItem=function(a,b){return"item-title"!==this.sublayerTitleMode?void 0:a};b.prototype.readTitleService=
function(a,b){var c=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return v.titleFromUrlAndName(this.url,b.name);var d=b.name||v.parse(this.url).title;"item-title-and-service-name"===this.sublayerTitleMode&&c&&(d=c+" - "+d);return v.cleanTitle(d)};b.prototype.readLayerId=function(a,b){return b.id};Object.defineProperty(b.prototype,"url",{set:function(a){var b=m.urlToObject(a),c=v.parse(b.path);c&&null!=c.sublayer&&(this.layerId=c.sublayer,b=t.objectToQuery(b.query),
a=c.url.path,b&&(a=a+"?"+b));for(;"/"===a[a.length-1];)a=a.slice(0,-1);this._set("url",a)},enumerable:!0,configurable:!0});b.prototype.writeUrl=function(a,b){a&&(b.url=a);var c=m.urlToObject(a);null!=this.layerId&&c&&(b.url=c.path+"/layers/"+this.layerId,c.query&&Object.keys(c.query)&&(b.url+="?"+t.objectToQuery(c.query)))};Object.defineProperty(b.prototype,"parsedUrl",{get:function(){var a=this._get("url");if(!a)return null;a=m.urlToObject(a);null!=this.layerId&&v.match.test(a.path)&&(a.path=a.path+
"/layers/"+this.layerId);return a},enumerable:!0,configurable:!0});b.prototype._addUrlToken=function(a){var b=r.mixin({},this.parsedUrl.query,{token:this.token}),b=t.objectToQuery(b);a+=b?"?"+b:"";null==this._canUseXhr&&(this._canUseXhr=m.canUseXhr(a));return!this._canUseXhr?m.addProxy(a):a};b.prototype.readRootNode=function(a,b){return b.store.rootNode};b.prototype._verifyRootNodeAndUpdateExtent=function(){var a=this;return this._fetchRootNode().then(function(b){return a._updateExtentFromRootNode(b)})};
b.prototype._updateExtentFromRootNode=function(a){if(!(null==this.fullExtent||this.fullExtent.hasZ)&&null!=a&&Array.isArray(a.mbs)&&4===a.mbs.length){var b=a.mbs[2];a=a.mbs[3];this.fullExtent.zmin=b-a;this.fullExtent.zmax=b+a}};b.prototype._fetchRootNode=function(){if(!this.rootNode)return l.resolve();var a=m.join(this.parsedUrl.path,this.rootNode);return s(this._addUrlToken(a),{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}).otherwise(function(b){throw new d("sceneservice:root-node-missing",
"Root node missing.",{error:b,url:a});})};b.prototype._fetchService=function(){var a=this;return(null==this.layerId&&/SceneServer\/*$/i.test(this.url)?this._fetchFirstLayerId().then(function(b){null!=b&&(a.layerId=b)}):l.resolve()).then(function(){return a._fetchServiceLayer()})};b.prototype._fetchFirstLayerId=function(){return s(this._addUrlToken(this.url),{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){if(a.data&&Array.isArray(a.data.layers)&&0<a.data.layers.length)return a.data.layers[0].id})};
b.prototype._fetchServiceLayer=function(){var a=this;return s(this._addUrlToken(this.parsedUrl.path),{query:{f:"json"},responseType:"json"}).then(function(b){b.ssl&&(a.url=a.url.replace(/^http:/i,"https:"));b=b.data;a.read(b,{origin:"service",url:a.parsedUrl});a._validateLayer(b)})};b.prototype._validateLayer=function(a){};b.prototype.createGraphicsController=function(a){var b=this;a.layer=this;a.addUrlTokenFunction=this._addUrlToken.bind(this);var c=p.when(q,"../graphics/controllers/I3SOnDemandController").then(function(b){return new b(a)});
c.then(function(a){b.emit("graphics-controller-create",{graphicsController:a})});return c};f([c.shared({id:{json:{origins:{service:{readable:!1},portalItem:{readable:!1}}}}})],b.prototype,"properties",void 0);f([c.property({type:u})],b.prototype,"fullExtent",void 0);f([c.read("fullExtent",["store.indexCRS","store.geographicCRS"])],b.prototype,"readFullExtent",null);f([c.property({readOnly:!0})],b.prototype,"version",void 0);f([c.read("version",["store.version"])],b.prototype,"readVersion",null);f([c.property({type:String})],
b.prototype,"copyright",void 0);f([c.read("copyright",["copyrightText"])],b.prototype,"readCopyright",null);f([c.property({type:String})],b.prototype,"sublayerTitleMode",void 0);f([c.property({type:String})],b.prototype,"title",void 0);f([c.read("portal-item","title")],b.prototype,"readTitlePortalItem",null);f([c.read("service","title",["name"])],b.prototype,"readTitleService",null);f([c.property({type:Number})],b.prototype,"layerId",void 0);f([c.read("service","layerId",["id"])],b.prototype,"readLayerId",
null);f([c.property()],b.prototype,"url",null);f([c.write("url")],b.prototype,"writeUrl",null);f([c.property({dependsOn:["layerId"]})],b.prototype,"parsedUrl",null);f([c.property()],b.prototype,"store",void 0);f([c.property({type:String})],b.prototype,"rootNode",void 0);f([c.read("rootNode",["store.rootNode"])],b.prototype,"readRootNode",null);return b=f([c.subclass("esri.layers.mixins.SceneService")],b)}(c.declared(b,e,a,h,g))})},"esri/layers/IntegratedMeshLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./mixins/SceneService ../core/Error ../geometry/SpatialReference dojo/_base/lang".split(" "),
function(q,n,k,f,c,b,a,e,h,g){return function(a){function b(c,e){a.call(this);this.geometryType="mesh";this.operationalLayerType="IntegratedMeshLayer";this.spatialReference=null}k(b,a);b.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?g.mixin({},{url:a},b):a};b.prototype.readSpatialReference=function(a,b){if(null!=b.spatialReference)return h.fromJSON(b.spatialReference);var c=b.store,c=(c=c.indexCRS||c.geographicCRS)&&parseInt(c.substring(c.lastIndexOf("/")+1,c.length),10);return null!=
c?new h(c):null};b.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return a._verifyRootNodeAndUpdateExtent()});this.addResolvingPromise(b);return this};b.prototype.read=function(a,b){this.inherited(arguments,[a,b]);a.layerDefinition&&this.inherited(arguments,[a.layerDefinition,b]);return this};b.prototype._validateLayer=function(a){if(a.layerType&&"IntegratedMesh"!==a.layerType)throw new e("integratedmeshlayer:layer-type-not-supported",
"IntegratedMeshLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new e("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new e("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});};f([c.shared("esri.layers.IntegratedMeshLayer")],
b.prototype,"declaredClass",void 0);f([c.shared({"3d":"../views/3d/layers/SceneLayerView3D"})],b.prototype,"viewModulePaths",void 0);f([c.property({type:String,readOnly:!0})],b.prototype,"geometryType",void 0);f([c.property()],b.prototype,"operationalLayerType",void 0);f([c.property({type:h})],b.prototype,"spatialReference",void 0);f([c.read("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],b.prototype,"readSpatialReference",null);return b=f([c.subclass()],b)}(c.declared(b,
a))})},"esri/views/3d/layers/ElevationLayerView3D":function(){define(["../../../core/declare","../../../core/promiseUtils","../../../core/Error","./TiledLayerView3D"],function(q,n,k,f){return q(f,{declaredClass:"esri.views.3d.layers.ElevationLayerView3D",initialize:function(){var c=this.get("view.map.ground.layers");(!c||-1===c.indexOf(this.layer))&&this.addResolvingPromise(n.reject(new k("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground")))},
isTransparent:function(){return!0}})})},"esri/views/3d/layers/TiledLayerView3D":function(){define("dojo/request/xhr ../../../core/declare ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Error ../../../layers/support/arcgisLayerUrl ../../layers/LayerView ../terrain/terrainUtils ./support/LayerViewUpdatingPercentage".split(" "),function(q,n,k,f,c,b,a,e,h){function g(a){var b=null,c=a.search(/\/rest\/services\//i);0<c&&(b=a.substring(0,c+6));return b}return n([a,h],{declaredClass:"esri.views.3d.layers.TiledLayerView3D",
_numUpdating:0,_maxNumUpdating:0,_isUpdating:!1,minDataLevel:0,maxDataLevel:Infinity,initialize:function(){var a=this.layer.tileInfo,b=e.checkIfTileInfoSupportedForView(a,this.layer.fullExtent,this.view.spatialReference,this.view.basemapTerrain.manifold);if(b){var h={layer:this.layer,error:b};switch(b.name){case "tilingscheme:local-gcs-not-supported":b=new c("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",h);break;case "tilingscheme:spatial-reference-mismatch":case "tilingscheme:global-unsupported-spatial-reference":b=
new c("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",h);break;default:b=new c("tiledlayerview3d:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",h)}this.addResolvingPromise(f.reject(b))}else b=k.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){if(!this.view.basemapTerrain.tilingScheme.compatibleWith(a)){var b=new c("tiledlayerview3d:tiling-scheme-incompatible",
"The tiling scheme of this layer is incompatible with the tiling scheme of the surface");return f.reject(b)}}.bind(this)),this.addResolvingPromise(b);this._checkServiceVersionCompatibility();var g=Infinity,n=0;a.lods.forEach(function(a){g=Math.min(a.level,g);n=Math.max(a.level,n)});n=Math.min(n,e.getKnownTiledServiceLevelCap(this.layer.url));this.minDataLevel=g;this.maxDataLevel=n},getTileUrl:function(a,b,c){return this.layer.getTileUrl(a,b,c)},isTransparent:function(){return this.layer.tileInfo&&
"JPEG"!==this.layer.tileInfo.format},_checkServiceVersionCompatibility:function(){if(!b.isHostedAgolService(this.layer.url))if(10.22>this.layer.version){var a=new c("layerview:service-version-too-old","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+this.layer.version,{minVersion:10.22,detectedVersion:this.layer.version});this.addResolvingPromise(f.reject(a))}else if(10.22===this.layer.version){var a=g(this.layer.url),e=new c("tiledlayerview3d:service-missing-cors-patch",
"Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied."),a=q(a+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(a){if(!a||a.error)throw e;}).otherwise(function(){throw e;});this.addResolvingPromise(a)}},_evaluateUpdatingState:function(a){this._isUpdating=!!a;this.notifyChange("updating")},isUpdating:function(){return this._isUpdating}})})},"esri/views/3d/layers/support/LayerViewUpdatingPercentage":function(){define(["../../../../core/Accessor"],
function(q){return q.createSubclass([],{properties:{updating:{readOnly:!0},updatingPercentageValue:{value:100,readOnly:!0},updatingPercentage:{dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}},constructor:function(){}})})},"esri/views/3d/layers/FeatureLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/promise/all ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DLayerViewCore ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../../layers/GraphicsLayerView ../../../layers/FeatureLayer ../../../layers/graphics/controllers/SnapshotController ../support/PromiseLightweight ../../../core/watchUtils ./support/projectExtentUtils ../../../core/Error ../../../core/promiseUtils ../../../layers/graphics/QueryEngine".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v){return function(d){function g(){d.call(this);this.controller=null;this.supportsDraping=!0;this._overlayUpdating=null;this._progressMaxNumNodes=0;this._eventHandles=[];this._controllerClientSideFiltering=!1;this.fullExtentInViewSpatialReference=this._suspendResumeExtent=null;this._isUpdating=!1}k(g,d);Object.defineProperty(g.prototype,"drawingOrder",{set:function(a){this.layerViewCore.graphicsCore.setDrawingOrder(a);this._set("drawingOrder",a)},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"hasDraped",{get:function(){return this.layerViewCore.graphicsCore.hasDraped},enumerable:!0,configurable:!0});g.prototype.initialize=function(){var b=this;this.spatialIndex=new a;this.layerViewCore=new e({owner:this,layer:this.layer,spatialIndex:this.spatialIndex,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,labelingEnabled:this.layer.isInstanceOf(m),elevationAlignmentEnabled:!0,verticalScaleEnabled:!0,updateSuspendResumeExtent:function(){return b.updateSuspendResumeExtent()},
updateClippingExtent:function(a){return b.updateClippingExtent(a)}});this.layerViewCore.initialize();this.drawingOrder=this.view.getDrawingOrder(this.layer.uid);this.createController();this.layerViewCore.labeling&&this.addResolvingPromise(this.layerViewCore.labeling.initLabelingInfo());this.addResolvingPromise(this.validateMaximumFeatureCount());this.addResolvingPromise(this.validateGeometryType());var c=r.toView(this).then(function(a){b.fullExtentInViewSpatialReference=a});c&&this.addResolvingPromise(c);
this._evaluateUpdatingState()};g.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.controller&&(this.controller.destroy(),this.controller=null);this.layerViewCore&&(this.layerViewCore.destroy(),this.layerViewCore=null);this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.loadedGraphics=null};g.prototype.getRenderingInfo=function(a){var b=this.inherited(arguments);if(b&&b.color){var c=b.color;b.color=[c.r/255,
c.g/255,c.b/255,c.a]}return b};g.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===c?(d=a,!0):!1});var e=new p.Promise;null!==d?e.done(d):e.reject();return e};g.prototype.getGraphics3DGraphics=function(){return this.layerViewCore.graphicsCore.getGraphics3DGraphics()};g.prototype.getGraphics3DGraphicsKeys=function(){return this.layerViewCore.graphicsCore.getGraphics3DGraphicsKeys()};g.prototype.queryGraphics=
function(){return this._queryEngine?this._queryEngine.queryFeatures():this._rejectQuery()};g.prototype.queryFeatures=function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()};g.prototype.queryObjectIds=function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()};g.prototype.queryFeatureCount=function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()};g.prototype.queryExtent=function(a){return this._queryEngine?
this._queryEngine.queryExtent(a):this._rejectQuery()};g.prototype.whenGraphicBounds=function(a){return this.layerViewCore.graphicsCore.whenGraphicBounds(a)};g.prototype._rejectQuery=function(){return u.reject(new t("FeatureLayerView3D","Not ready to execute query"))};g.prototype._notifySuspendedChange=function(){this.notifyChange("suspended")};g.prototype._notifyDrapedDataChange=function(){this.notifyChange("hasDraped");this.emit("draped-data-change")};g.prototype.canResume=function(){return this.inherited(arguments)&&
this.layerViewCore&&this.layerViewCore.canResume()};g.prototype._evaluateUpdatingState=function(){if(this.layerViewCore.elevationAlignment){var a;a=0+this.layerViewCore.elevationAlignment.numNodesUpdating();a+=this.layerViewCore.graphicsCore.numNodesUpdating();var b;b=(b=(b=this.controller&&this.controller.isQueryInProgress)||this._overlayUpdating)||!(this.view.basemapTerrain&&this.view.basemapTerrain.ready);var c;c=(c=0<a||b)||this.spatialIndex.isUpdating();this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);
0===a&&(this._progressMaxNumNodes=1);this._isUpdating=c;this.notifyChange("updating");this._set("updatingPercentageValue",b?100:100*a/this._progressMaxNumNodes)}else this._isUpdating=!1,this.notifyChange("updating"),this._set("updatingPercentageValue",100)};g.prototype.isUpdating=function(){return this._isUpdating};g.prototype.createController=function(){var a=this,c=this.layer.createGraphicsController({layerView:this,options:{maxPageSize:300,extent:this.view.clippingArea}});s.whenTrueOnce(this.view,
"basemapTerrain.ready",function(){b([a,c]).then(function(b){b=b[1];b instanceof l&&(a.controller=b,a._eventHandles.push(a.controller.watch("isQueryInProgress",function(){return a._evaluateUpdatingState()})));a.loadedGraphics=b.graphics;a._queryEngine=new v({features:a.loadedGraphics,objectIdField:a.layer.objectIdField});a._evaluateUpdatingState()})})};g.prototype.updateClippingExtent=function(a){if(this.controller){if(this._controllerClientSideFiltering)return!1;this.controller.extent?(this.controller.extent=
null,this._controllerClientSideFiltering=!0):this.controller.extent=a;return!0}return!1};g.prototype.updateSuspendResumeExtent=function(){return this._suspendResumeExtent=h.enlargeExtent(this.layerViewCore.graphicsCore.computedExtent,this._suspendResumeExtent,1.2)};g.prototype.validateGeometryType=function(){var a=this.layer;switch(a.geometryType){case "multipatch":case "multipoint":return u.reject(new t("featurelayerview3d:unsupported-geometry-type","Unsupported geometry type ${geometryType}",{geometryType:a.geometryType}))}};
g.prototype.validateMaximumFeatureCount=function(){return 0>g.maximumFeatureCount||!this.layer.url?u.resolve():this.layer.queryFeatureCount().then(function(a){if(a>g.maximumFeatureCount)throw new t("featurelayerview3d:maximum-feature-count-exceeded","The maximum number of allowed features (${maximumFeatureCount}) has been exceeded (layer has ${numberOfFeatures} features)",{maximumFeatureCount:g.maximumFeatureCount,numberOfFeatures:a});})};g.prototype.getStats=function(){var a=this.layerViewCore.graphicsCore.getGraphics3DGraphics(),
b="null",c=this._suspendResumeExtent;c&&(b=[c[0],c[1],c[2],c[3]].map(function(a){return a.toPrecision(4)}).join(", "));var c="null",d=this.layerViewCore.graphicsCore.computedExtent;d&&(c=[d.xmin,d.ymin,d.xmax,d.ymax].map(function(a){return a.toPrecision(4)}).join(", "));return{numCollection:this.loadedGraphics.length,numGraphics:Object.keys(a).length,numElevationUpdating:this.layerViewCore.elevationAlignment.numNodesUpdating(),numSpatialIndexUpdating:this.spatialIndex.numNodesUpdating(),numGraphicsUpdating:this.layerViewCore.graphicsCore.numNodesUpdating(),
visibilityFrustum:this.layerViewCore.frustumVisibility.canResume(),visibilityScale:this.layerViewCore.scaleVisibility.canResume(),resumeExtent:b,computedExtent:c,updating:this.updating,suspended:this.suspended}};g.maximumFeatureCount=-1;f([c.property()],g.prototype,"drawingOrder",null);f([c.property()],g.prototype,"loadedGraphics",void 0);f([c.property()],g.prototype,"hasDraped",null);f([c.property()],g.prototype,"controller",void 0);return g=f([c.subclass("esri.views.3d.layers.FeatureLayerView3D")],
g)}(c.declared(d,g))})},"esri/views/3d/layers/graphics/Graphics3DLayerViewCore":function(){define("require exports ../../../../core/HandleRegistry ./Graphics3DCore ./Graphics3DLabeling ./Graphics3DScaleVisibility ./Graphics3DFrustumVisibility ./Graphics3DElevationAlignment ./Graphics3DVerticalScale".split(" "),function(q,n,k,f,c,b,a,e,h){return function(){function g(d){var g=this;this._handles=new k;this.layer=d.layer;this.owner=d.owner;this.spatialIndex=d.spatialIndex;this.updateClippingExtent=d.updateClippingExtent;
this.updateSuspendResumeExtent=d.updateSuspendResumeExtent;this.elevationChanged=d.elevationChanged;this.graphicsCore=new f;d.frustumVisibilityEnabled&&(this.frustumVisibility=new a,this._handles.add([this.owner.view.on("resize",function(){return g.frustumVisibility.viewChange()}),this.owner.view.navigation.on("currentViewChanged",function(){return g.frustumVisibility.viewChange()})]));d.scaleVisibilityEnabled&&(d.spatialIndex?(this.scaleVisibility=new b,this._handles.add(this.layer.watch("minScale,maxscale",
function(){return g.scaleVisibility.layerMinMaxScaleChangeHandler()}))):console.warn("scaleVisibility requires a spatialIndex"));d.elevationAlignmentEnabled&&(this.elevationAlignment=new e,this._handles.add(this.layer.watch("elevationInfo",function(){return g.graphicsCore.elevationInfoChange()})));d.labelingEnabled&&(this.labeling=new c,this._handles.add(this.layer.watch("labelsVisible",function(){return g.labeling.showLabelsChange()})));d.verticalScaleEnabled&&(this.verticalScale=new h({sourceSpatialReference:this.layer.spatialReference,
destSpatialReference:this.owner.view.spatialReference}))}g.prototype.initialize=function(){var a=this;this.spatialIndex&&this.spatialIndex.initialize(this.owner,this.layer,this.owner.view.spatialReference,this.graphicsCore);this.frustumVisibility&&this.frustumVisibility.initialize(this.owner);var b=this.owner.view.basemapTerrain;this.scaleVisibility&&this.scaleVisibility.initialize(this.owner,this.layer,this.spatialIndex,this.graphicsCore,b);this.elevationAlignment&&this.elevationAlignment.initialize(this.owner,
function(b,c,e){return a._elevationChanged(b,c,e)},this.graphicsCore,b);this.labeling&&this.labeling.initialize(this.owner,this.layer,this.graphicsCore);this.graphicsCore.initialize(this.owner,this.layer,this.elevationAlignment,this.scaleVisibility,this.spatialIndex,this.labeling,function(){a.updateSuspendResumeExtent&&a._updateSuspendResumeExtent(a.updateSuspendResumeExtent())},function(b){return a.verticalScale?a.verticalScale.adjust(b):b},b);this._handles.add([this.layer.watch("renderer",function(b){return a.graphicsCore.rendererChange(b)}),
this.owner.watch("fullOpacity",function(){return a.graphicsCore.opacityChange()})]);this._handles.add(this.layer.on("graphic-update",function(b){return a.graphicsCore.graphicUpdateHandler(b)}));this.owner.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate});this.updateClippingExtent&&(this._handles.add(this.owner.view.watch("clippingArea",function(){return a._updateClippingExtent()})),this._updateClippingExtent())};g.prototype.destroy=
function(){this.owner&&this.owner.view.resourceController.deregisterIdleFrameWorker(this);this._handles&&(this._handles.destroy(),this._handles=null);this.frustumVisibility&&(this.frustumVisibility.destroy(),this.frustumVisibility=null);this.scaleVisibility&&(this.scaleVisibility.destroy(),this.scaleVisibility=null);this.elevationAlignment&&(this.elevationAlignment.destroy(),this.elevationAlignment=null);this.labeling&&(this.labeling.destroy(),this.labeling=null);this.graphicsCore&&(this.graphicsCore.destroy(),
this.graphicsCore=null);this.owner=this.layer=null};g.prototype.canResume=function(){return(!this.frustumVisibility||this.frustumVisibility.canResume())&&(!this.scaleVisibility||this.scaleVisibility.canResume())};g.prototype._needsIdleUpdate=function(){return this.frustumVisibility&&this.frustumVisibility.needsIdleUpdate()||this.scaleVisibility&&this.scaleVisibility.needsIdleUpdate()||this.elevationAlignment&&this.elevationAlignment.needsIdleUpdate()?!0:!1};g.prototype._idleUpdate=function(a){this.frustumVisibility&&
this.frustumVisibility.idleUpdate(a);this.scaleVisibility&&this.scaleVisibility.idleUpdate(a);this.elevationAlignment&&this.elevationAlignment.idleUpdate(a)};g.prototype._updateSuspendResumeExtent=function(a){this.frustumVisibility&&this.frustumVisibility.setExtent(a);this.scaleVisibility&&this.scaleVisibility.setExtent(a)};g.prototype._updateClippingExtent=function(){var a=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(a,this.owner.view.spatialReference)&&(this.updateClippingExtent(a)||
this.graphicsCore.recreateAllGraphics())};g.prototype._elevationChanged=function(a,b,c){this.elevationChanged?this.elevationChanged(a,b,c):this.spatialIndex&&this.spatialIndex.intersects(a,b,c)};return g}()})},"esri/views/3d/layers/graphics/Graphics3DLabeling":function(){define("require exports dojo/promise/all dojo/Deferred ../../webgl-engine/lib/TextTextureAtlas ../../webgl-engine/lib/MaterialCollection ../../webgl-engine/materials/HUDMaterial ./Graphics3DWebStyleSymbol ../../../../layers/support/LabelClass ../../lib/glMatrix".split(" "),
function(q,n,k,f,c,b,a,e,h,g){var d=g.vec3d;q=function(){function g(){this.hudMaterialCollection=this.textTextureAtlas=null;this.showLabelsChangeOnResume=!1;this.labelClasses=[];this.eventHandles=[];this.graphicsCore=this.layer=this.layerView=null}g.prototype.initialize=function(a,b,c){var d=this;this.layerView=a;this.layer=b;this.graphicsCore=c;this.layerView.view.labelManager.addSceneServiceLayerView(this);this.eventHandles.push(this.layerView.watch("suspended",function(){return d.suspendedChange()}))};
g.prototype.destroy=function(){this.layerView.view.labelManager.removeSceneServiceLayerView(this);this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.labelClasses=null;this.eventHandles.forEach(function(a){return a.remove()});this.graphicsCore=this.layer=this.layerView=this.eventHandles=null};g.prototype.clear=function(){this.layerView.view.labelManager.setDirty();
this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null)};g.prototype.suspendedChange=function(){!1===this.layerView.suspended&&this.showLabelsChangeOnResume&&this.showLabelsChange()};g.prototype.initLabelingInfo=function(){var a=this,b=new f;this.layer.then(function(){var c=a.layer.labelingInfo&&a.layer.labelingInfo.filter(function(a){return!!a.symbol});if(c&&0<c.length){a.labelClasses=
Array(c.length);for(var d=[],f=function(b){var f=a.graphicsCore.getOrCreateGraphics3DSymbol(c[b].symbol);f.then(function(){var d=a.labelClasses,h=c[b],g;g=f instanceof e?f.graphics3DSymbol:f;d[b]={labelClass:h,graphics3DSymbolLayer:g,graphics3DGraphics:[]}});d.push(f)},h=0;h<c.length;h++)f(h);k(d).then(function(){b.resolve()})}else b.resolve()});return b.promise};g.prototype.createLabelsForGraphic=function(a,d){if(this.labelClasses&&0<this.labelClasses.length&&d._graphics[0])for(var e=0;e<this.labelClasses.length;e++){var f=
this.labelClasses[e];if(h.evaluateWhere(f.labelClass.where,a.attributes)){var g=f.labelClass.getLabelExpression();if(g&&(g=h.buildLabelText(g,a.attributes,this.layer.fields))){var e=f.graphics3DSymbolLayer.childGraphics3DSymbols[0],k=this.evalLabelPlacementParams(a,d);null==this.textTextureAtlas&&(this.textTextureAtlas=new c(this.layer.id,this.layerView.view._stage),this.hudMaterialCollection=new b(this.layerView.view._stage));if(g=e.createGraphics3DGraphic(a,{text:g,centerOffset:k.centerOffset,translation:k.translation,
screenOffset:k.screenOffset,anchor:k.anchor},this.hudMaterialCollection,this.textTextureAtlas))g._labelClass=f.labelClass,d.addLabelGraphic(g),f.graphics3DGraphics.push(d),g.setVisibilityFlag("VISIBILITY_LABEL_SHOW",this.layerLabelsEnabled()),this.layerView.view.labelManager.setInitialLabelGraphicState(g);break}}}return d};g.prototype.evalLabelPlacementParams=function(b,c){var f=m[this.layer.labelingInfo[0].labelPlacement]||m["default"];if("polygon"===b.geometry.type||"polyline"===b.geometry.type||
"extent"===b.geometry.type)return{anchor:"center"};if("point"!==b.geometry.type)return{anchor:f.anchor};var h=c.graphics3DSymbol,g=(h instanceof e?h.graphics3DSymbol:h).symbol.symbolLayers.getItemAt(0),h={screenOffset:[0,0],centerOffset:[0,0,0,-1],translation:c.getCenterObjectSpace(),anchor:f.anchor};if("Icon"===g.type)if(g=c._graphics[0].getScreenSize(),c.isDraped())h.anchor="center";else{var k=c._graphics[0].stageObject.getGeometryRecords()[0].materials[0];k instanceof a?(k=k.getParams(),h.screenOffset=
[g[0]/2*(f.normalizedOffset[0]-2*(k.anchorPos[0]-0.5)),g[1]/2*(f.normalizedOffset[1]-2*(k.anchorPos[1]-0.5))]):h.screenOffset=[g[0]/2*f.normalizedOffset[0],g[1]/2*f.normalizedOffset[1]]}else"Object"===g.type&&(g=c._graphics[0].getBoundingBoxObjectSpace(),g=[g[3]-g[0],g[4]-g[1],g[5]-g[2]],k=Math.max(g[0],g[1]),h.centerOffset[0]=1.1*k/2*f.normalizedOffset[0],h.translation[2]+=1.1*g[2]/2*f.normalizedOffset[1],g=d.length(g),h.centerOffset[2]=1.1*g/2*f.normalizedOffset[2]);return h};g.prototype.layerLabelsEnabled=
function(){return this.layer.labelsVisible};g.prototype.getGraphics3DGraphics=function(){return this.graphicsCore.getGraphics3DGraphics()};g.prototype.getGraphics3DGraphicsKeys=function(){return this.graphicsCore.getGraphics3DGraphicsKeys()};g.prototype.showLabelsChange=function(){var a=this;if(this.layerView.suspended)this.showLabelsChangeOnResume=!0;else if(this.layerView.loadedGraphics){var b=this.layerLabelsEnabled();this.layerView.loadedGraphics.forEach(function(c){var d=a.graphicsCore.getGraphics3DGraphicById(c.uid);
if(d){if(b&&0===d._labelGraphics.length){d=a.createLabelsForGraphic(c,d);for(c=0;c<d._labelGraphics.length;c++){var e=d._labelGraphics[c];e.initialize(a.graphicsCore.labelStageLayer,a.layerView.view._stage)}}for(c=0;c<d._labelGraphics.length;c++)e=d._labelGraphics[c],e.setVisibilityFlag("VISIBILITY_LABEL_SHOW",b)}});this.layerView.view.labelManager.setDirty();this.showLabelsChangeOnResume=!1}};g.prototype.elevationInfoChange=function(){this.labelClasses&&this.labelClasses.forEach(function(a){a.graphics3DSymbolLayer.layerPropertyChanged("elevationInfo",
{})})};return g}();var m={"above-center":{normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{normalizedOffset:[0,0,1],anchor:"center"},"center-left":{normalizedOffset:[-1,0,0],anchor:"right"},
"center-right":{normalizedOffset:[1,0,0],anchor:"left"}};n={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],
"center-right":["esriServerPointLabelPlacementCenterRight"]};var l,p;for(p in n)g=n[p],l=m[p],g.forEach(function(a){m[a]=l});Object.freeze&&(Object.freeze(m),Object.keys(m).forEach(function(a){Object.freeze(m[a]);Object.freeze(m[a].normalizedOffset)}));return q})},"esri/views/3d/webgl-engine/lib/TextTextureAtlas":function(){define("require exports ./Texture ./ModelContentType ../../../webgl/Texture ../../../webgl/enums".split(" "),function(q,n,k,f,c,b){var a=function(){function a(b){this.textTextures=
{};this.id=k.idGen.gen(b)}a.prototype.getId=function(){return this.id};a.prototype.dispose=function(){};a.prototype.deferredLoading=function(){return!1};a.prototype.getWidth=function(){return 512};a.prototype.getHeight=function(){return 512};a.prototype.initializeThroughRender=function(b,f){var d=a._create2Dcanvas(),k=d.getContext("2d");k.save();k.clearRect(0,0,512,512);f.wrapMode=33071;f.samplingMode=9729;f.flipped=!0;for(var l in this.textTextures){var n=this.textTextures[l];n.textTexture.renderText(1,
n.placement.width,n.placement.height,k,n.placement.atlasOffX,n.placement.atlasOffY)}d=new c(b,f,d);k.restore();return d};a.prototype.setUnloadFunc=function(a){this._unloadFunc=a};a.prototype.unload=function(){null!=this._unloadFunc&&(this._unloadFunc(this.id),this._unloadFunc=null)};a._create2Dcanvas=function(){a._textCanvas2D||(a._textCanvas2D=document.createElement("canvas"),a._textCanvas2D.setAttribute("id","canvas2d"),a._textCanvas2D.setAttribute("width",(512).toString()),a._textCanvas2D.setAttribute("height",
(512).toString()),a._textCanvas2D.setAttribute("style","display:none"));return a._textCanvas2D};return a}();return function(){function b(a,c){this._textureAtlasSubtextures=[];this._curLineHeight=this._curY=this._curX=0;this._idHint=a;this._stage=c}b.prototype.dispose=function(){for(var a=0;a<this._textureAtlasSubtextures.length;a++)this._stage.remove(f.TEXTURE,this._textureAtlasSubtextures[a].getId());this._textureAtlasSubtextures=[]};b.prototype.addTextTexture=function(b){for(var c=JSON.stringify(b.getParams())+
"_"+b.getString(),d=0;d<this._textureAtlasSubtextures.length;d++){var e=this._textureAtlasSubtextures[d].textTextures[c];if(null!=e)return e.placement}var k=null;0===this._textureAtlasSubtextures.length&&(k=new a(this._idHint),this._textureAtlasSubtextures.push(k));var d=b.getTextWidth(),e=b.getTextHeight(),n,q;this._curLineHeight=Math.max(this._curLineHeight,e);512>this._curX+d&&512>this._curY+this._curLineHeight||(512>this._curY+this._curLineHeight+e?(this._curX=0,this._curY+=this._curLineHeight):
(k=new a(this._idHint),this._textureAtlasSubtextures.push(k),this._curY=this._curX=0),this._curLineHeight=e);n=this._curX;q=this._curY;this._curX+=d;null!=k&&this._stage.add(f.TEXTURE,k);k=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];d={uvMinMax:[n/512,1-(q+e)/512,(n+d)/512,1-q/512],atlasOffX:n,atlasOffY:q,width:d,height:e,texture:k};k.textTextures[c]={placement:d,textTexture:b};return d};return b}()})},"esri/views/3d/webgl-engine/lib/MaterialCollection":function(){define(["require",
"exports","./ModelContentType"],function(q,n,k){return function(){function f(c){this.materials={};this.stage=c}f.prototype.getMaterial=function(c){return this.materials[c]};f.prototype.addMaterial=function(c,b){this.materials[c]=b;this.stage.add(k.MATERIAL,b)};f.prototype.dispose=function(){for(var c in this.materials)this.stage.remove(k.MATERIAL,this.materials[c].getId());this.materials={}};return f}()})},"esri/views/3d/layers/graphics/Graphics3DScaleVisibility":function(){define(["require","exports"],
function(q,n){return function(){function k(){this._scaleRangeActive=!1;this.layerScaleRangeVisibilityDirty=this.layerScaleRangeVisibility=!0;this.layerScaleRangeVisibilityQuery=!1;this.basemapTerrain=this.graphicsCore=this.extent=this.spatialIndex=this.layer=this.layerView=this.scaleChangeEventHandle=null}k.prototype.initialize=function(f,c,b,a,e){this.layerView=f;this.layer=c;this.spatialIndex=b;this.graphicsCore=a;this._scaleRangeActive=null!==c.minScale&&0<c.minScale&&8E7>c.minScale||1E3<c.maxScale;
this.basemapTerrain=e;this.layerMinMaxScaleChangeHandler(!1)};k.prototype.destroy=function(){this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);this.graphicsCore=this.spatialIndex=this.extent=this.layerView=null};k.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty};k.prototype.canResume=function(){return this.layerScaleRangeVisibility};k.prototype.setExtent=function(f){this.extent=f;
this.layerScaleRangeVisibilityDirty=!0};k.prototype.idleUpdate=function(f){this.layerView.view.basemapTerrain&&(!f.done()&&this.layerScaleRangeVisibilityDirty)&&(this.updateSuspendScaleVisible(),this.layerScaleRangeVisibilityDirty=!1)};k.prototype.scaleRangeActive=function(){return this._scaleRangeActive};k.prototype.updateSuspendScaleVisibleFinish=function(f){this.layerScaleRangeVisibilityQuery=!1;this.layerScaleRangeVisibility!==f&&(this.layerScaleRangeVisibility=f,this.layerView._notifySuspendedChange())};
k.prototype.updateSuspendScaleVisible=function(){var f=this,c=this.layerView.view.basemapTerrain;!this.extent||!c||!this._scaleRangeActive?this.updateSuspendScaleVisibleFinish(!0):this.layerScaleRangeVisibilityQuery||(this.layerScaleRangeVisibilityQuery=!0,c.queryVisibleScaleRange(this.extent,this.layer.minScale,this.layer.maxScale,function(b){return f.updateSuspendScaleVisibleFinish(b)}))};k.prototype.visibleAtScale=function(f){var c=this.layer.minScale;return f>this.layer.maxScale&&(!c||f<c)};k.prototype.visibleAtScaleLabel=
function(f,c){return f>c.maxScale&&(!c.minScale||f<c.minScale)};k.prototype.graphicVisible=function(f,c){var b;c.centroid?b=c.centroid:"point"===f.geometry.type&&(b=f.geometry);return b?(b=this.layerView.view.basemapTerrain?this.layerView.view.basemapTerrain.getScale(b):1,this.visibleAtScale(b)):!0};k.prototype.updateGraphicScaleVisibility=function(f,c){if(this._scaleRangeActive&&c.addedToSpatialIndex){var b=this.graphicVisible(f,c);return c.setVisibilityFlag("VISIBILITY_SCALERANGE",b)}return!1};
k.prototype.scaleUpdateHandler=function(f){var c=this;if(!this.layerView.suspended&&this.spatialIndex.hasGraphics()){var b=f.extent,a=f.scale;this.spatialIndex.intersects(b,f.spatialReference,function(e,f){for(var g=c.visibleAtScale(a),d=!1,k=0;k<f;k++){var l=c.graphicsCore.getGraphics3DGraphicById(e[k]);if(l){var n=l.centroid;if(!n||!(b[0]>n.x||b[1]>n.y||b[2]<n.x||b[3]<n.y)){for(var n=l.setVisibilityFlag("VISIBILITY_SCALERANGE",g),q=0;q<l._labelGraphics.length;q++){var r=l._labelGraphics[q];if(r._labelClass&&
null!=r._labelClass.minScale&&null!=r._labelClass.maxScale)var t=c.visibleAtScaleLabel(a,r._labelClass),n=n||r.setVisibilityFlag("VISIBILITY_SCALERANGE_LABEL",t)}n&&c.layerView.view.labelManager.setDirty();n&&l.isDraped()&&(d=!0)}}}d&&c.layerView._notifyDrapedDataChange()})}this.layerScaleRangeVisibilityDirty=!0};k.prototype.layerMinMaxScaleChangeHandler=function(f){var c=this;void 0===f&&(f=!0);var b=this.layer;(this._scaleRangeActive=null!==b.minScale&&0<b.minScale&&8E7>b.minScale||1E3<b.maxScale)&&
!this.scaleChangeEventHandle?(this.scaleChangeEventHandle=this.basemapTerrain.on("scale-change",function(a){return c.scaleUpdateHandler(a)}),this.layerView.suspended||this.spatialIndex.addGraphicsToSpatialIndex(this._scaleRangeActive)):!this._scaleRangeActive&&this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);!this.layerView.suspended&&f&&this.graphicsCore.updateAllGraphicsVisibility();this.layerScaleRangeVisibilityDirty=!0};return k}()})},"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":function(){define("require exports ../../support/earthUtils ../../support/projectionUtils ../../support/intersectionUtils ../../lib/glMatrix".split(" "),
function(q,n,k,f,c,b){var a=b.vec3d,e=b.vec4d,h=-0.3*k.earthRadius;q=0.5*Math.PI;var g=180*(q/Math.PI),d=q*k.earthRadius,m=0.9*k.earthRadius,l=function(){function b(){this.extent=Array(4);this.planes=Array(4);this.maxSpan=0;this.center={origin:a.create(),direction:a.create()};for(var c=0;4>c;c++)this.extent[c]={origin:a.create(),direction:a.create(),cap:{next:null,direction:a.create()}},this.planes[c]=e.create();this.planes[4]=e.create()}b.prototype.update=function(b,c,d,e,g){a.set3(b[0],b[1],h,this.extent[0].origin);
a.set3(b[2],b[1],h,this.extent[1].origin);a.set3(b[2],b[3],h,this.extent[2].origin);a.set3(b[0],b[3],h,this.extent[3].origin);if(!g)for(g=0;4>g;g++)f.vectorToVector(this.extent[g].origin,e,this.extent[g].origin,d);a.add(this.extent[0].origin,this.extent[2].origin,this.center.origin);a.scale(this.center.origin,0.5);c(this.center.origin,this.center.direction);for(g=0;4>g;g++)d=this.extent[g],c(d.origin,d.direction),e=this.extent[3===g?0:g+1],d.cap.next=e.origin,a.direction(e.origin,d.origin,d.cap.direction),
a.cross(this.extent[g].cap.direction,this.extent[g].direction,this.planes[g]),this.planes[g][3]=-a.dot(this.planes[g],this.extent[g].origin);this.maxSpan=Math.max(Math.abs(b[0]-b[2]),Math.abs(b[1]-b[3]))};b.prototype.isVisibleInFrustumGlobal=function(b){if(0>a.dot(this.center.direction,b.direction))return!0;for(var c=0;4>c;c++)if(0>a.dot(this.extent[c].direction,b.direction))return!0;return!1};b.prototype.isVisibleInFrustum=function(a,b){if("global"===a.viewingMode){if(this.maxSpan>(a.spatialReference.isWGS84?
g:d))return!0;if(b.altitude()>=m)return this.isVisibleInFrustumGlobal(b)}for(var e=0;e<this.extent.length;e++){var f=this.extent[e];if(c.frustumRay(b.planes,f.origin,null,f.direction)||c.frustumLineSegment(b.planes,f.origin,f.cap.next,f.cap.direction))return!0}for(e=0;e<b.lines.length;e++)if(f=b.lines[e],c.frustumLineSegment(this.planes,f.origin,f.endpoint,f.direction))return!0;return!1};return b}();return function(){function a(){this.frustumVisibilityDirty=this.frustumVisibility=!0;this.extent=null;
this.extentEngine=new l;this.extentEngineDirty=!0;this.layerView=this.renderSREqualsViewSR=null}a.prototype.initialize=function(a){this.layerView=a;this.renderSREqualsViewSR=a.view.renderSpatialReference.equals(a.view.spatialReference)};a.prototype.destroy=function(){this.extentEngine=this.extent=this.layerView=null};a.prototype.needsIdleUpdate=function(){return this.frustumVisibilityDirty};a.prototype.canResume=function(){return this.frustumVisibility};a.prototype.setExtent=function(a){this.extent=
a;this.frustumVisibilityDirty=this.extentEngineDirty=!0};a.prototype.viewChange=function(){this.frustumVisibilityDirty=!0};a.prototype.idleUpdate=function(a){!a.done()&&this.frustumVisibilityDirty&&(this.updateSuspendFrustumVisible(),this.frustumVisibilityDirty=!1)};a.prototype.updateExtentEngine=function(){if(this.extentEngineDirty){this.extentEngineDirty=!1;var a=this.layerView.view;this.extentEngine.update(this.extent,a.renderCoordsHelper.worldUpAtPosition,a.renderSpatialReference,a.spatialReference,
this.renderSREqualsViewSR)}};a.prototype.updateSuspendFrustumVisible=function(){if(this.extent){this.updateExtentEngine();var a=this.layerView.view.getFrustum(),a=this.extentEngine.isVisibleInFrustum(this.layerView.view,a);a!==this.frustumVisibility&&(this.frustumVisibility=a,this.layerView._notifySuspendedChange())}else this.frustumVisibility=!0};return a}()})},"esri/views/3d/layers/graphics/Graphics3DVerticalScale":function(){define(["require","exports","../../../../geometry/support/scaleUtils"],
function(q,n,k){return function(){function f(c){this.sourceSpatialReference=c.sourceSpatialReference;this.destSpatialReference=c.destSpatialReference}f.prototype.adjust=function(c){var b=this._getVerticalUnitScale();1!==b&&(c=c.slice(),this._scaleVerticalUnits(c,b));return c};f.prototype._getVerticalUnitScale=function(){if(this.sourceSpatialReference.equals(this.destSpatialReference))return 1;var c=this._getVerticalUnitValueForSR(this.sourceSpatialReference),b=this._getVerticalUnitValueForSR(this.destSpatialReference);
return c/b};f.prototype._getVerticalUnitValueForSR=function(c){c=k.getUnitValueForSR(c);return 1E5<c?1:c};f.prototype._vertexListsScaleZ=function(c,b){for(var a=0,e=c.length;a<e;++a)for(var f=c[a],g=0,d=c.length;g<d;++g)f[g][2]*=b};f.prototype._scaleVerticalUnits=function(c,b){for(var a=0,e=c.length;a<e;++a){var f=c[a].geometry;if(f.hasZ)this._geometryIsPoint(f)?null!==f.z&&(f.z*=b):this._geometryIsPolyline(f)?this._vertexListsScaleZ(f.paths,b):this._geometryIsPolygon(f)&&this._vertexListsScaleZ(f.rings,
b);else break}};f.prototype._geometryIsPoint=function(c){return"point"===c.type};f.prototype._geometryIsPolygon=function(c){return"polygon"===c.type};f.prototype._geometryIsPolyline=function(c){return"polyline"===c.type};return f}()})},"esri/views/3d/layers/support/projectExtentUtils":function(){define(["require","exports","../../../../portal/support/geometryServiceUtils","../../../../core/promiseUtils"],function(q,n,k,f){n.toView=function(c){var b=c.view.spatialReference,a=c.layer.fullExtent&&c.layer.fullExtent.spatialReference;
return!a||a.equals(b)||"local"!==c.view.viewingMode?f.resolve(null):k.create(c.layer.portalItem).then(function(a){return a.project([c.layer.fullExtent],b)}).then(function(a){if(!c.destroyed&&a&&Array.isArray(a)&&1===a.length)return a[0]}).otherwise(function(){return null})}})},"esri/views/3d/layers/SceneLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Logger ../../../core/lang dojo/_base/lang dojox/color/_base dojo/has ../../layers/LayerView ../../../Graphic ../../../symbols/Symbol3D ./i3s/I3SUtil ./i3s/I3SBinaryReader ./i3s/I3SProjectionUtil ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../support/projectionUtils ../support/aaBoundingBox ../webgl-engine/Stage ../webgl-engine/lib/Layer ../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../webgl-engine/lib/Object3D ../webgl-engine/lib/Texture ../webgl-engine/materials/Material ../webgl-engine/lib/Util ../webgl-engine/lib/base64Binary ../lib/glMatrix ../../../layers/IntegratedMeshLayer".split(" "),
function(q,n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A,w,D,E,H,G,I,O,J){function F(a,b,c,d){var e=!1,f;b.encoding===r.DDS_ENCODING_STRING?f=E.DDS_ENCODING:e=!(S(a.width)&&S(a.height));a=b.usedByEngineMats.some(function(a){return a.getParams().atlasRegions})||b.atlas;c=(c||!a)&&!e;return{mipmap:c,wrapClamp:a||!b.wrap,disableAnisotropy:a&&c&&d,encoding:f,noUnpackFlip:!0}}function K(a,b){for(var c=b.toLowerCase(),d=0,e=Object.keys(a);d<e.length;d++){var f=e[d];if(f.toLowerCase()===c)return a[f]}return null}
var T=e.getLogger("esri.layers.SceneService"),R=G.assert,da=G.clamp,S=G.isPowerOfTwo,ba=G.fallbackIfUndefined,aa=G.objectEmpty,$=G.VertexAttrConstants,Z=[1,1,1,1],M=B.ModelContentType,V=[0.8,0.8,0.8],L=[0.5,0.5,0.5],U=1,N=null;return function(e){function l(){e.apply(this,arguments)}k(l,e);l.prototype.initialize=function(){var a=this;r.checkSpatialReference(this.layer,this.view.spatialReference,this.view.viewingMode);var c=this.layer.version,c=!m("trident")||1<c.major||1===c.major&&3<c.minor;this.useCompressedTextures=
this.view.has("s3tc")&&c;this._disableAtlasAnisotropy=(this._enableAtlasMipMaps=this.view.has("standardDerivatives"))&&!this.view.has("shaderTextureLOD");this._initGraphicsController();this.dbg=!1;this.maxGpuMemory=1E3;this.geoMemoryEstimate=this.texMemoryEstimate=this.gpuMemoryEstimate=0;this._stage=this.view._stage;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._colorOverride=null;for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;this._whiteTexture=
new E(c,"white",{width:8,height:8});this._stage.add(B.ModelContentType.TEXTURE,this._whiteTexture);this._layerEventHandles=[b.init(this.layer,"renderer",function(b){return a._rendererChange(b)}),b.watch(this,"fullOpacity",function(b){return a._opacityChange(b)}),b.init(this.layer,"objectIdFilter",function(){return a._objectIdFilterChange()}),b.init(this.view,"clippingArea",function(){return a._clippingAreaChanged()})];this._addThisLayerToStage();this.setVisibility(!this.suspended);this.debugLODVis=
this.debugNodeVis=!1};l.prototype.destroy=function(){this._stage.remove(B.ModelContentType.TEXTURE,this._whiteTexture.getId());this._removeThisLayerFromStage();this._layerEventHandles.forEach(function(a){a.remove()});this._stage=null;null!=this._controller&&(this._controller.destroy(),this._controller=null);this._nodeId2Meta=this._texId2Meta=this._matId2Meta=null};l.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)};l.prototype.isUpdating=
function(){return this._controller&&this._controller.updating};l.prototype.memEstimateTextureAdded=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate+=a;this.texMemoryEstimate+=a};l.prototype.memEstimateTextureRemoved=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate-=a;this.texMemoryEstimate-=a};l.prototype.memEstimateGeometryAdded=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate+=a;this.geoMemoryEstimate+=a};l.prototype.memEstimateGeometryRemoved=
function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate-=a;this.geoMemoryEstimate-=a};l.prototype.isBundleAlreadyAddedToStage=function(a,b){var c=!1,d=!1;if(null!=this._nodeId2Meta[a.id]&&this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[b])for(var d=!0,e=this._nodeId2Meta[a.id].engineObjectsPerBundle[b],f=0;f<e.length&&!(c=e[f].isPartiallyHidden());f++);return{wasPartiallyHidden:c,alreadyLoaded:d}};l.prototype._initGraphicsController=function(){var a=
this,b={addBundle:this._addBundle.bind(this),isBundleAlreadyAddedToStage:this.isBundleAlreadyAddedToStage.bind(this),isOverMemory:this.isOverMemory.bind(this),removeNodeData:this._removeNodeDataFromStage.bind(this),removeFeatures:this._removeFeatures.bind(this),getAddedFeatures:this._getAddedFeatures.bind(this),getAddedNodeIDs:this._getAddedNodeIDs.bind(this),areAllBundlesLoaded:this._areAllBundlesLoaded.bind(this),wholeNodeSwitchEnabled:!0},c={additionalStartNodeLoadingHandler:this._startNodeLoading.bind(this),
additionalCancelNodeLoadingHandler:this.cancelNodeLoading.bind(this),getTexturePrefetchFunctions:function(){return{_calcDesiredTextureLOD:a._calcDesiredTextureLOD.bind(a),_imageIsPartOfTextureBundle:a._imageIsPartOfTextureBundle.bind(a),_matId2Meta:a._matId2Meta,_texId2Meta:a._texId2Meta,useCompressedTextures:function(){return a.useCompressedTextures}}},_nodeDebugVisualizer:this._nodeDebugVisualizer,setPolygonOffset:this._setPolygonOffset.bind(this),traversalOptions:{initDepthFirst:!0,neighborhood:!0,
perLevelTraversal:!1,allowPartialOverlaps:!1},getLoadedAttributes:this.getLoadedAttributes.bind(this),setAttributeData:this.setAttributeData.bind(this)};this.layer.createGraphicsController({layerView:this,layerViewRequiredFunctions:b,layerViewOptionalFunctions:c}).then(function(b){b.watch("rootNodeVisible",function(){a.notifyChange("suspended")})})};l.prototype.setMaxGpuMemory=function(a){this.maxGpuMemory=a};l.prototype.setVisibility=function(a){if(this._stage&&this._engineLayer){var b=this._engineLayer.getId(),
c=0<=this._stage.getViewContent().indexOf(b);!!a!==c&&(b=[b],null!=this._nodeDebugVisualizer&&b.push(this._nodeDebugVisualizer.engineLayer.getId()),a?this._stage.addToViewContent(b):this._stage.removeFromViewContent(b))}};l.prototype.getEngineLayer=function(){return this._engineLayer};l.prototype.getStats=function(){var a={nodesInIndex:0,knownFeatures:0,displayedFeatures:0,displayedGeometries:0,displayedComponents:0,geometryDataSize:0,activeMaterials:0};if(!this._controller)return a;for(var b in this._controller.nodeIndex)if(this._controller.nodeIndex.hasOwnProperty(b)){a.nodesInIndex++;
var c=this._controller.nodeIndex[b];if(null!=c.features)for(var d=0;d<c.features.length;d++)a.knownFeatures++}a.activeMaterials=Object.keys(this._matId2Meta).length;return a};l.prototype._addThisLayerToStage=function(){var a=this._stage;this._initTexture=new E(null,"i3sInitTexture");a.add(M.TEXTURE,this._initTexture);var b=this.layer.id;this._engineLayer=b=new z(b,{},b);a.add(M.LAYER,b);null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose()};l.prototype._removeThisLayerFromStage=function(){this.cancelNodeLoading();
if(null!=this._engineLayer){var a=this._stage;a.remove(M.TEXTURE,this._initTexture.getId());if(null!=this._controller)for(var b in this._controller.nodeIndex)this._controller.nodeIndex.hasOwnProperty(b)&&(this._removeNodeDataFromStage(this._controller.nodeIndex[b]),delete this._controller.nodeIndex[b]);R(aa(this._nodeId2Meta));R(aa(this._matId2Meta));R(aa(this._texId2Meta));a.remove(M.LAYER,this._engineLayer.getId());null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose();this._nodeDebugVisualizer=
void 0;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._engineLayer=void 0;this.gpuMemoryEstimate=0}};l.prototype._startNodeLoading=function(){this._updateAllTextureLOD()};l.prototype.cancelNodeLoading=function(){null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.clear();this._requestedTexImageIds={}};l.prototype._isAllHidden=function(a){a=this._nodeId2Meta[a.id].engineObjects;for(var b=0;b<a.length;b++)if(!a[b].isAllHidden())return!1;return!0};
l.prototype.getLoadedAttributes=function(a){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length)return a.engineObjects[0].getMetadata().loadedAttributes};l.prototype.setAttributeData=function(a,b,c){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length){a=a.engineObjects[0];var d=a.getMetadata();d.loadedAttributes=b;d.attributeData=c;this._setObjectSymbology(a)}};l.prototype._createUnitTestData=function(a){var b=this.view.navigation.targetCamera,b={viewParams:{eye:b.eye,center:b.center,
up:b.up,viewMatrix:b.viewMatrix,projectionMatrix:b.projectionMatrix,fovX:b.fovX,viewport:b.viewport,perPixelRatio:b.perPixelRatio},visibleObjects:[]};a=a.getAll("objects");for(var c in a){var d=a[c];if(d.getParentLayer()===this._engineLayer){var e=d.getMetadata(),d=e.i3sNode,e=e.features.map(function(a){return a.id});e.sort();b.visibleObjects.push({featureIDs:e,nodeId:d})}}console.debug(""+b.visibleObjects.length);return JSON.stringify(b)};l.prototype.isOverMemory=function(){return this.gpuMemoryEstimate>
this.maxGpuMemory?(T.warn("over memory: "+this.gpuMemoryEstimate+" tex "+this.texMemoryEstimate+" geom "+this.geoMemoryEstimate),!0):!1};l.prototype._getAddedFeatures=function(a){if(null==this._nodeId2Meta[a])return null;var b=[];a=this._nodeId2Meta[a].engineObjects;for(var c=0;c<a.length;c++)b=b.concat(a[c].getMetadata().features);return b};l.prototype._getAddedNodeIDs=function(){return Object.keys(this._nodeId2Meta)};l.prototype._calcEngineMaterialTransparencyParams=function(a,b,c){var d=this.fullOpacity,
e=1-da(ba(b.transparency,0),0,1),d=d*e;a=1>d||a&&h.endsWith(a.channels,"a")||!0===b.useVertexColorAlpha||c;return{opacity:d,transparent:a}};l.prototype._calcEngineMaterialDoubleSidedParams=function(a){return null!=a.doubleSided?a.doubleSided:!0};l.prototype._calcEngineMaterialCullFaceParams=function(a){return a.cullFace?a.cullFace:null!=a.doubleSided?a.doubleSided?"none":"back":"none"};l.prototype._createEngineMaterial=function(a,b,c,d,e,f){var h,k;null!=a&&(h=(k=this._texId2Meta[b])&&k.engineTex?
k.engineTex.getId():this._initTexture.getId());var l=c.params,m=ba(l.diffuse,V),n,p;null!=a&&(p=r.getAppropriateTextureEncoding(a.encoding,this.useCompressedTextures),n=-1<p?a.encoding[p]:a.encoding);"standard"!==c.type&&T.warn("Unknown material type '"+c.type+"', must be 'standard'");void 0===l.reflectivity&&T.warn("Material parameter 'reflectivity' is missing.");c=this.layer instanceof J;h={ambient:this._colorOverride||m,diffuse:this._colorOverride||m,specular:ba(l.specular,L),shininess:ba(l.shininess,
64),atlasRegions:l.vertexRegions,textureId:h&&this._colorOverride?this._whiteTexture.getId():h,vertexColors:!0,flipV:!1,doubleSided:this._calcEngineMaterialDoubleSidedParams(l),cullFace:this._calcEngineMaterialCullFaceParams(l),writeStencil:c};c||(m=this._calcEngineMaterialTransparencyParams(a,l),g.mixin(h,m));h=new H(h,d);h.metadata={i3sMatId:d,i3sTexId:b,i3sTex:a,i3sMatParams:l};if(null!=a){k?k.usedByEngineMats.push(h):(k={id:b,featureMBS:{},usedByEngineMats:[h],images:a.images,encoding:n,encodingIdx:p,
atlas:!0===a.atlas,wrap:"none"!==a.wrap[0]||"none"!==a.wrap[1]},this._texId2Meta[b]=k);for(a=0;a<e.length;a++)l=e[a],k.featureMBS[l.id]=l.engineMBS;if(void 0!==f[b]){null==k.engineTex&&(e=f[b].data,a=F(e,k,this._enableAtlasMipMaps,this._disableAtlasAnisotropy),k.engineTex=new E(e,k.id,a),this._stage.add(M.TEXTURE,k.engineTex),k.desiredLOD=f[b].desiredLOD,k.curLOD=k.desiredLOD,this.memEstimateTextureAdded(k.engineTex));e=k.engineTex.getId();for(a=0;a<k.usedByEngineMats.length;a++)l=k.usedByEngineMats[a],
null==this._colorOverride&&l.setParameterValues({textureId:e}),l.metadata.originalTextureId=e;f[b].createdTextureForDomImage();delete f[b]}else this._updateTextureLOD(k)}this._matId2Meta[d]||(this._matId2Meta[d]={});this._matId2Meta[d][b]={engineMat:h,refCount:1};return h};l.prototype._createVertexAndIndexArrays=function(a,b,c){var d,e=a.params.vertexAttributes,f={},g;for(g in e)if(e.hasOwnProperty(g)&&"classification"!==g){var h=e[g];d=t.valueType2TypedArrayClassMap[h.valueType];R(null!=d,"unsupported vertex attribute value type: "+
h.valueType);f[g]={data:new d(b,h.byteOffset,h.count*h.valuesPerElement),size:h.valuesPerElement}}if(null==f[$.COLOR]){d=t.valueType2TypedArrayClassMap.UInt8;f[$.COLOR]={data:new d(4*e.position.count),size:4};for(var k=0;k<f[$.COLOR].data.length;k++)f[$.COLOR].data[k]=0===k%3?255:0}g=!1;null==f[$.NORMAL]&&(g=!0,d=t.valueType2TypedArrayClassMap.Float32,f[$.NORMAL]={data:new d(3*e.position.count),size:3});var e=[],h=a.params.faces,l;if(null!=h&&"PerAttributeArray"!==a.params.topology){var m={};for(name in h)h.hasOwnProperty(name)&&
(d=h[name],R(0===d.count%3),R(d.count===h.position.count),R("UInt32"===d.valueType),m[name]=d.byteOffset);var n=a.params.components.length;l=Array(n);for(var p=h.position.componentIndices||[0],q=0;q<n;q++){var r=a.params.components[q],s=q<n-1?p[q+1]-p[q]:h.position.count-p[q];d={type:"triangle",positionKey:"position",indices:{},componentRange:[p[q],p[q]+s]};for(name in h)h.hasOwnProperty(name)&&(d.indices[name]=new Uint32Array(b,m[name],s),m[name]+=4*s);if(null==d.indices[$.COLOR]){d.indices[$.COLOR]=
new Uint32Array(s);for(k=0;k<s;k++)d.indices[$.COLOR][k]=k}if(g&&null==d.indices[$.NORMAL]){d.indices[$.NORMAL]=new Uint32Array(s);for(k=0;k<s;k++)d.indices[$.NORMAL][k]=k}l[q]=d;var k=r.textureID||"none",u=void 0;"none"!==k&&(u=c.textureDefinitions[k],R(void 0!==u,"geometry wants unknown texture "+k));if(u&&!0===u.atlas&&null!=u.regions){R(0<u.regions.length,"texture marked as atlas carries no region definition");k=u.regions[r.regionID].subimageRegion;e=e.concat([65536*k[0],65536*(k[2]-k[0]),65536*
(1-k[3]),65536*(k[3]-k[1])]);k=new Uint32Array(s);for(r=0;r<s;r++)k[r]=e.length/4-1;d.indices[$.REGION]=k}}}else{d={type:"triangle",positionKey:"position",indices:{}};a=f.position.data.length/f.position.size;if(a>U||null==N){for(;a>U;)U*=2;N=new Uint32Array(U);for(k=0;k<U;k++)N[k]=k}a=new Uint32Array(N.buffer,0,a);for(l in f)d.indices[l]=a;a=d.indices[d.positionKey];d.componentRange=[0,null!=a?a.length-1:0];l=[d]}0<e.length&&(a=new Uint16Array(e),f[$.REGION]={data:a,size:4});return{indexArrays:l,
vertexArrays:f}};l.prototype._createEngineMats=function(a,b,c,d,e){for(var f=a.params.components.length,h=Array(f),g=0;g<f;g++){var k=a.params.components[g],l=k.materialID,m=c.materialDefinitions[l];null!=m.href&&(m=d[m.hrefConcat].materialDefinitions[l]);R(void 0!==m,"geometry wants unknown material "+l);var n=k.textureID||"none",p=void 0;"none"!==n&&((null==c.textureDefinitions||null==c.textureDefinitions[n])&&T.warn("textureDefinitions missing in shared resource"),p=c.textureDefinitions[n]);k=
void 0;this._matId2Meta[l]&&this._matId2Meta[l][n]?(l=this._matId2Meta[l][n],k=l.engineMat,l.refCount++):k=this._createEngineMaterial(p,n,m,l,b,e);h[g]=k}return h};l.prototype._areAllBundlesLoaded=function(a,b){if(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjectsPerBundle)return!1;for(var c=0;c<a.featureData.length;c++){if(null==this._nodeId2Meta[a.id].engineObjectsPerBundle[c])return!1;if(!b)for(var d=this._nodeId2Meta[a.id].engineObjectsPerBundle[c],e=0;e<d.length;e++)if(d[e].isPartiallyHidden())return!1}return!0};
l.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"};l.prototype._findGraphic=function(a){a=K(a.attributes,this._getObjectIdField());for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)for(var d=c[b],e=this._nodeId2Meta[d].engineObjects,f=0;f<e.length;f++){var g=e[f].getMetadata().featureIds.indexOf(a);if(-1!==g)return{node:this._controller.nodeIndex[d],nodeId:d,bundleNr:f,index:g}}return null};l.prototype.whenGraphicBounds=function(b){var c=this._findGraphic(b);
if(null!=c){b=this._nodeId2Meta[c.nodeId].engineObjects[c.bundleNr];for(var c=b.getMetadata().faceRanges[c.index],c=b.geometries[0].calculateBoundingInfo(0,c),d=c.bbMin,e=c.bbMax,c=[],f=0;8>f;++f){var g=[f&1?d[0]:e[0],f&2?d[1]:e[1],f&4?d[2]:e[2]];O.mat4d.multiplyVec3(b.objectTransformation,g);c[3*f]=g[0];c[3*f+1]=g[1];c[3*f+2]=g[2]}if(y.bufferToBuffer(c,this.view.renderSpatialReference,0,c,this.view.spatialReference,0,8)){b=x.create(x.NEGATIVE_INFINITY);for(d=0;d<c.length;d+=3)for(e=0;3>e;e++)b[e]=
Math.min(b[e],c[d+e]),b[e+3]=Math.max(b[e+3],c[d+e]);return a.resolve(b)}}return a.reject()};l.prototype.whenGraphicAttributes=function(a,b){var c=this,d=K(a.attributes,this._getObjectIdField());return r.whenGraphicAttributes(this.layer,a,d,b,function(){return c._findGraphic(a)})};l.prototype.getGraphicsFromStageObject=function(b,c){if(this.layer instanceof J)return a.reject();var d=b.getMetadata(),e=b.getFaceRangeIndexFromTriangleNr(c);if(null!=e&&null!=d.graphics&&null!=d.graphics[0].attributes)return a.resolve(d.graphics[e]);
if(null!=e&&null!=d.featureIds&&null!=d.featureIds[e]){var f={};f[this._getObjectIdField()]=d.featureIds[e];for(var g=0,h=Object.keys(d.attributeData);g<h.length;g++){var k=h[g];f[k]=d.attributeData[k][e]}d=new p(null,null,f);d.layer=this.layer;return a.resolve(d)}return a.reject()};l.prototype._addBundle=function(a,b,c,d,e,f,g){if(!0===this.debugNodeVis&&null!=this._nodeDebugVisualizer){var h="grey";switch(a.level){case 1:h="red";break;case 2:h="green";break;case 3:h="blue";break;case 4:h="yellow";
break;case 5:h="magenta";break;case 6:h="brown"}this._nodeDebugVisualizer.show(a,this._controller.crsIndex,h)}var h=this._stage,k={};k[M.OBJECT]={};k[M.GEOMETRY]={};k[M.MATERIAL]={};k[M.TEXTURE]={};var l=this._engineLayer,m=l.getId(),n=d[a.sharedResource.hrefConcat];if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[g])this._applyFilters(a),null!=e&&e.done();else if(!this.isOverMemory()){null==this._nodeId2Meta[a.id]&&
(this._nodeId2Meta[a.id]={engineObjects:[],engineObjectsPerBundle:[]});this._nodeId2Meta[a.id].engineObjectsPerBundle[g]=[];if(null!=b){for(var q=0;q<b.length;q++){var s=b[q].geometries,t=b[q].features,v=b[q].featureDataAttributes,x=d[a.geometryData[g].hrefConcat];R(x instanceof ArrayBuffer,"I3S: geometry data is not an ArrayBuffer");null==x._isReprojected&&(x._isReprojected={});for(var y=a.id+"|"+t[0].id.toString(),z=[],B=[],C=[],E=void 0,F=function(b){var c=s[b],e=G._createVertexAndIndexArrays(c,
x,n);if(0===e.indexArrays.length)return"continue";var g=G._createEngineMats(c,t,n,d,f),h=G._controller.crsIndex,l=G.view.renderSpatialReference;E=u.reprojectPoints(G._controller.isMeshPyramid?u.ReprojectionTypes.PER_VERTEX:u.ReprojectionTypes.BOUNDINGBOX,e.vertexArrays.position.data,a.mbs,x._isReprojected[c.id],h,G._controller.crsVertex,l);x._isReprojected[c.id]=!0;G._controller.isMeshPyramid&&r.processNormals({normals:e.vertexArrays.normal.data,positions:e.vertexArrays.position.data,normalInd:e.indexArrays[0].indices.normal,
positionInd:e.indexArrays[0].indices.position},G.layer.normalReferenceFrame||"none",function(b,c){u.reprojectNormalsPerVertex(b,a.mbs,h,c,l)});var m=E.localTrafo;null!=c.transformation&&(m=O.mat4d.create(c.transformation),O.mat4d.multiply(E.localTrafo,m,m));for(c=0;c<g.length;c++){var p=g[c];k[M.MATERIAL][p.getId()]=p}e=new A(new w(e.indexArrays,e.vertexArrays),y+"_"+b);G.memEstimateGeometryAdded(e.getData());k[M.GEOMETRY][e.getId()]=e;z[b]=e;B[b]=m;C[b]=g},G=this,H=0;H<s.length;++H)F(H);F=[];for(H=
0;H<t.length;H++){var J=new p(void 0,void 0,v[H]);J.set("layer",this.layer);F.push(J)}v=new D({idHint:a.id,name:y,geometries:z,materials:C,transformations:B,castShadow:!0,metadata:{graphics:F,i3sNode:a.id,ceLayer:m,features:t,faceRanges:b[q].faceRanges,featureIds:b[q].featureIds,attributeData:c?c.attributeData:null,loadedAttributes:c?c.loadedAttributes:null,layerId:this.layer.id}});F=O.mat4d.create();O.mat4d.identity(F);O.mat4d.multiply(F,E.globalTrafo,F);v.setObjectTransformation(F);this._nodeId2Meta[a.id].engineObjectsPerBundle[g].push(v);
this._nodeId2Meta[a.id].engineObjects.push(v);k[M.OBJECT][v.getId()]=v;this._setObjectSymbology(v);this._applyFilters(a)}h.beginMod();b=k[M.OBJECT];for(var I in b)b.hasOwnProperty(I)&&l.addObject(b[I]);for(var K in k)if(k.hasOwnProperty(K))for(name in I=k[K],I)I.hasOwnProperty(name)&&null==h.get(K,name)&&h.add(K,I[name]);h.endMod()}null!=e&&e.done()}};l.prototype._clippingAreaChanged=function(){var a=this,b=[];y.extentToBoundingBox(this.view.clippingArea,b,this.view.renderSpatialReference)?this._clippingArea=
b:this._clippingArea=null;this._updateFilters();if(this._controller){var c=this._controller.nodeIndex;c&&Object.keys(this._nodeId2Meta).forEach(function(b){return a._applyFilters(c[b])});this._controller.updateClippingArea(this.view.clippingArea)}};l.prototype._objectIdFilterChange=function(){var a=this;this._updateFilters();if(this._controller){var b=this._controller.nodeIndex;b&&Object.keys(this._nodeId2Meta).forEach(function(c){return a._applyFilters(b[c])})}};l.prototype._updateFilters=function(){var a=
this,b=[];if(this.layer.objectIdFilter){var c=new Float64Array(this.layer.objectIdFilter.ids),d="include"===this.layer.objectIdFilter.method;c.sort();b.push(function(b,e){return a._objectIdFilter(c,d,e)})}this._clippingArea&&b.push(function(b,c){return a._boundingboxFilter(b,a._clippingArea,c)});this._filters=b};l.prototype._objectIdFilter=function(a,b,c){for(var d=0;d<c.length;)0<=r.binaryIndexOf(a,c[d])===b?d++:c.splice(d,1)};l.prototype._boundingboxFilter=function(a,b,c){var d=[0,0,0,0];y.mbsToMbs(a.mbs,
this._controller.crsIndex,d,this.view.renderSpatialReference);d=null!=b?r.intersectBoundingBoxWithMbs(b,d):2;if(2!==d){var e=0;a=this._nodeId2Meta[a.id].engineObjects;for(var f=0;f<a.length;f++){var g=a[f],h=g.getMetadata().featureIds;if(0===d){for(var k=0,g=0;g<h.length&&e+k<c.length;g+=1)c[e+k]===h[g]&&k++;c.splice(e,k)}else{var l=g.getObjectTransformation(),k=g.getGeometryRecords()[0].transformation;O.mat4d.multiply(l,k);if(!(0!==l[1]||0!==l[2]||0!==l[3]||0!==l[4]||0!==l[6]||0!==l[7]||0!==l[8]||
0!==l[9]||0!==l[11]||1!==l[15]))for(var k=(b[0]-l[12])/l[0],m=(b[1]-l[13])/l[5],n=(b[2]-l[14])/l[10],p=(b[3]-l[12])/l[0],q=(b[4]-l[13])/l[5],l=(b[5]-l[14])/l[10],s=g.getGeometryRecords()[0].geometry.getData(),t=s.getFaces()[0].indices.position,s=s.getVertexAttr().position.data,u=g.getMetadata().faceRanges,v=void 0,w=void 0,x=void 0,z=void 0,A=void 0,B=void 0,g=0;g<u.length&&e<c.length;g+=1)if(c[e]===h[g]){for(var v=u[g],C=v[0],D=v[1],v=w=x=Number.MAX_VALUE,z=A=B=-Number.MAX_VALUE;C<=D;C+=1)for(var E=
0;3>E;E+=1)var F=3*t[3*C+E],G=s[F],H=s[F+1],F=s[F+2],v=Math.min(G,v),w=Math.min(H,w),x=Math.min(F,x),z=Math.max(G,z),A=Math.max(H,A),B=Math.max(F,B);v>p||z<k||w>q||A<m||x>l||B<n?c.splice(e,1):e++}}}}};l.prototype._applyFilters=function(a){if(this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._nodeId2Meta[a.id].engineObjects,c=0;c<b.length;c++)b[c].unhideAllFaceRange();if(0!==this._filters.length){for(var d=[],c=0;c<b.length;c++)var e=b[c],d=d.concat(e.getMetadata().featureIds);
c=d.length;for(e=0;e<this._filters.length;e++)this._filters[e](a,d);if(d.length!==c)for(c=a=0;c<b.length;c++){for(var e=b[c],f=[],g=e.getMetadata().faceRanges,h=e.getMetadata().featureIds,k=0;k<h.length;k+=1){var l=h[k],m=g[k];a>=d.length||d[a]!==l?f.push(m):a++}0<f.length&&e.hideFaceRange(e.getGeometryRecords()[0],f)}}}};l.prototype._hideFeatures=function(a,b){for(var c=this._nodeId2Meta[a.id].engineObjects,d=0;d<c.length;d++){for(var e=c[d],f=[],g=e.getMetadata().features,h=e.getMetadata().faceRanges,
k=0;k<b.length;k++)for(var l=b[k],m=0;m<g.length;m++)l===g[m].id&&(null!=h&&1===e.getGeometryRecords().length?f.push(h[m]):e.hideAllFaceRanges());0<f.length&&e.hideFaceRange(e.getGeometryRecords()[0],f)}};l.prototype._removeFeatures=function(a,b){null!=this._nodeId2Meta[a.id]&&(this._hideFeatures(a,b),!0===this._isAllHidden(a)&&this._removeNodeDataFromStage(a))};l.prototype._removeNodeDataFromStage=function(a){if(!(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjects)){for(var b=
this._stage,c=this._engineLayer,d=this._nodeId2Meta[a.id].engineObjects,e=0;e<d.length;++e){var f=d[e];c.removeObject(f);for(var g=f.getGeometryRecords(),h=0;h<g.length;h++){var k=g[h];this.memEstimateGeometryRemoved(k.geometry.getData());b.remove(M.GEOMETRY,k.geometry.getId());for(var l=0;l<k.materials.length;l++){var m=k.materials[l],n=m.getId(),p=m.metadata.i3sMatId,q=m.metadata.i3sTexId||"none",r=this._matId2Meta[p][q];R(0<r.refCount);r.refCount--;0===r.refCount&&this._removeMaterial(n,q,p,m,
b)}}b.remove(M.OBJECT,f.getId())}delete this._nodeId2Meta[a.id]}};l.prototype._removeMaterial=function(a,b,c,d,e){e.remove(M.MATERIAL,a);if("none"!==b){a=this._texId2Meta[b];var f=a.usedByEngineMats;d=f.indexOf(d);R(-1<d);f[d]=f[f.length-1];f.pop();if(1>f.length){if((d=a.engineTex)&&d!==this._initTexture)this.memEstimateTextureRemoved(d),e.remove(M.TEXTURE,a.engineTex.getId());a.engineTex=void 0;a.desiredLOD=-1;a.curLOD=-1;delete this._texId2Meta[b]}}delete this._matId2Meta[c][b];aa(this._matId2Meta[c])&&
delete this._matId2Meta[c]};l.prototype._updateAllTextureLOD=function(){for(var a in this._texId2Meta)this._texId2Meta.hasOwnProperty(a)&&this._updateTextureLOD(this._texId2Meta[a])};l.prototype._calcDesiredTextureLOD=function(a,b){var c,d=0;c=0;for(var e=Object.keys(a);c<e.length;c++){var f=a[e[c]],g=O.vec3.dist(f,this._controller.camPos),f=2*f[3]/g*this._controller.screenSizeFactor;f>d&&(d=f)}d/=9;for(c=b.length-1;0<c&&b[c].size<d;)c--;return c};l.prototype._updateTextureLOD=function(a){var b=this;
a.desiredLOD=this._calcDesiredTextureLOD(a.featureMBS,a.images);if(a.curLOD!==a.desiredLOD&&(0>a.curLOD||!a.curLOD||0===a.desiredLOD||a.desiredLOD>a.curLOD||a.desiredLOD<a.curLOD-1)){if(0===a.images.length)return;var c=a.images[a.desiredLOD],e=-1<a.encodingIdx?c.hrefConcat[a.encodingIdx]:c.hrefConcat;if(!this._requestedTexImageIds[c.id]){var f={metadata:{texMeta:a,image:c}};this._requestedTexImageIds[c.id]=!0;this._imageIsPartOfTextureBundle(c)?this._controller.streamDataSupplier.request(e,"binary",
f).then(this._extractTextureImageFromBlob.bind(this)):this._controller.streamDataSupplier.request(e,"image",f).then(function(a,c,d,e){b._textureImageLoaded(a,c,e.image,e.texMeta)})}}a.engineTex||(a.engineTex=this._initTexture,a.curLOD=-1);if(this.debugLODVis){c=d.fromHsv(270*(a.desiredLOD/a.images.length),100,100).toRgb().map(function(a){return a/255});for(e=0;e<a.usedByEngineMats.length;e++)a.usedByEngineMats[e].setParameterValues({ambient:c,diffuse:c})}};l.prototype._extractTextureImageFromBlob=
function(a,b,c,d){var e=d.texMeta;if(0>e.desiredLOD||d.image.size>e.images[e.desiredLOD].size)delete this._requestedTexImageIds[d.image.id];else{var f=this;R("binary"===c);var g="";try{var h=c=0;-1<e.encodingIdx?(c=d.image.byteOffset[e.encodingIdx],h=d.image.length[e.encodingIdx]):(c=d.image.byteOffset,h=d.image.length);var k=new Uint8Array(b,c,h),l=new Blob([k],{type:e.encoding}),g=window.URL.createObjectURL(l)}catch(m){g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",
T.error("error loading texture "+a+" "+m)}var n=new Image;n.onerror=function(){window.URL.revokeObjectURL(g);n.src="";n.onerror=void 0;n.onload=void 0};n.onload=function(){f._controller.queueAnimationFrameFunctionCall(f._textureImageLoaded,f,[a,n,d.image,d.texMeta,g],void 0,1);window.URL.revokeObjectURL(g);n.src="";n.onerror=void 0;n.onload=void 0};n.src=g}};l.prototype._textureImageLoaded=function(a,b,c,d){delete this._requestedTexImageIds[c.id];if(!(0>d.desiredLOD)){a=d.images[d.desiredLOD];var e=
d.images[d.curLOD];if(!this.isOverMemory()||!(null==e||c.size>e.size))if(!e||c.size>e.size&&c.size<=a.size||c.size<e.size&&c.size>=a.size){if((e=d.engineTex)&&e!==this._initTexture)this.memEstimateTextureRemoved(e),this._stage.remove(M.TEXTURE,d.engineTex.getId());e=F(b,d,this._enableAtlasMipMaps,this._disableAtlasAnisotropy);d.engineTex=new E(b,d.id,e);this._stage.add(M.TEXTURE,d.engineTex);d.curLOD=d.desiredLOD;this.memEstimateTextureAdded(d.engineTex);b=d.engineTex.getId();for(e=0;e<d.usedByEngineMats.length;e++){var f=
d.usedByEngineMats[e];null==this._colorOverride&&f.setParameterValues({textureId:b});f.metadata.originalTextureId=b}c!==a&&(d.curLOD=d.images.indexOf(c),R(-1<d.curLOD),this._requestedTexImageIds[a.id]||(c={metadata:{texMeta:d,image:a}},this._requestedTexImageIds[a.id]=!0,this._controller.streamDataSupplier.request(a.hrefConcat,"binary",c).then(this._extractTextureImageFromBlob.bind(this))))}}};l.prototype._imageIsPartOfTextureBundle=function(a){return!this._controller.isMeshPyramid};l.prototype._setPolygonOffset=
function(a,b){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle)for(var c={polygonOffset:b},d=0;d<this._nodeId2Meta[a.id].engineObjectsPerBundle.length;d++)for(var e=this._nodeId2Meta[a.id].engineObjectsPerBundle[d],f=0;f<e.length;f++)for(var g=e[f].getGeometryRecords(),h=0;h<g.length;h++)for(var k=g[h].materials,l=0;l<k.length;l++)k[l].setParameterValues(c)};l.prototype._rendererChange=function(a){(this._currentRenderer=a)&&(a.colorInfo||a.sizeInfo)&&T.warn("renderer.colorInfo and renderer.sizeInfo are not supported for Scene Services. Use visualVariables instead.")};
l.prototype._getRenderer=function(a){return!a||a.symbol?null:this._rndForScale||this._currentRenderer};l.prototype._getSymbol=function(a){if(a.symbol)return a.symbol;var b=this._getRenderer(a);return b&&b.getSymbol(a)};l.prototype._getRenderingInfo=function(a){var b=this._getRenderer(a),c=this._getSymbol(a);if(!c||!(c instanceof s))return null;var c={symbol:c},d,e;if(b&&b.visualVariables){a=b.getVisualVariableValues(a);for(b=0;b<a.length;b++){var f=a[b],g=f.variable.type;"color"===g?d=f.value:"opacity"===
g&&(e=f.value)}}d&&(c.color=[d.r/255,d.g/255,d.b/255]);null!=e?c.opacity=e:d&&null!=d.a&&(c.opacity=d.a);return c};l.prototype._getSymbolFillColor=function(a){a=a.symbolLayers;for(var b=0;b<a.length;b++){var c=a.getItemAt(b);if("Fill"===c.type&&c.material&&c.material.color)return a=c.material.color,[a.r/255,a.g/255,a.b/255,a.a]}};l.prototype._setObjectSymbology=function(a){if(!(this.layer instanceof J)){for(var b=a.getMetadata(),c=[],d=b.graphics,e=!1,f=d.length,g=b.faceRanges?b.faceRanges.length:
f,h={attributes:{}},k=function(a){g===f&&null==b.attributeData?h=d[a]:Object.keys(b.attributeData).forEach(function(c){h.attributes[c]=b.attributeData[c][a]});var k=l._getRenderingInfo(h),m=null!=b.faceRanges?b.faceRanges[a]:null;if(k){var n=k.color,p=k.opacity;null==n||null==p?(k=l._getSymbolFillColor(k.symbol),n=v.overrideColor(n,p,k,k&&k[3],Z)):n=v.overrideColor(n,p,null,null,Z);1>n[3]&&(e=!0);c.push({faceRanges:m,color:n})}else c.push({faceRanges:m,color:void 0})},l=this,m=0;m<g;m++)k(m);this.layer.cachedDrawingInfo.color?
a.setFacerangeColors(c,"replace"):a.setFacerangeColors(c,"blend");a=a.getGeometryRecords();for(k=0;k<a.length;k++)for(var m=a[k],n=0;n<m.materials.length;n++){var p=m.materials[n],q=p.getParams().transparent,r=p.getParams().opacity;p.metadata.symbolIsTransparent=e;var s=this._calcEngineMaterialTransparencyParams(p.metadata.i3sTex,p.metadata.i3sMatParams,p.metadata.symbolIsTransparent);(q!==s.transparent||r!==s.opacity)&&p.setParameterValues({transparent:s.transparent,opacity:s.opacity})}}};l.prototype._opacityChange=
function(a){for(var b in this._matId2Meta)for(var c in this._matId2Meta[b]){a=this._matId2Meta[b][c].engineMat;var d=a.getParams().transparent,e=a.getParams().opacity,f=this._calcEngineMaterialTransparencyParams(a.metadata.i3sTex,a.metadata.i3sMatParams,a.metadata.symbolIsTransparent);(d!==f.transparent||e!==f.opacity)&&a.setParameterValues({transparent:f.transparent,opacity:f.opacity})}};f([c.property()],l.prototype,"layer",void 0);f([c.property()],l.prototype,"view",void 0);f([c.property()],l.prototype,
"_controller",void 0);f([c.property({dependsOn:["_controller.updating"]})],l.prototype,"updating",void 0);f([c.property({readOnly:!0,aliasOf:"_controller.updatingPercentage"})],l.prototype,"updatingPercentageValue",void 0);return l=f([c.subclass("esri.views.3d.layers.SceneLayerView3D")],l)}(c.declared(l,C))})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(q,n,k,f){q=n.getObject("color",!0,q);q.Color=k;q.blend=k.blendColors;q.fromRgb=
k.fromRgb;q.fromHex=k.fromHex;q.fromArray=k.fromArray;q.fromString=k.fromString;q.greyscale=f.makeGrey;n.mixin(q,{fromCmy:function(c,b,a){n.isArray(c)?(b=c[1],a=c[2],c=c[0]):n.isObject(c)&&(b=c.m,a=c.y,c=c.c);b=1-b/100;a=1-a/100;return new k({r:Math.round(255*(1-c/100)),g:Math.round(255*b),b:Math.round(255*a)})},fromCmyk:function(c,b,a,e){n.isArray(c)?(b=c[1],a=c[2],e=c[3],c=c[0]):n.isObject(c)&&(b=c.m,a=c.y,e=c.b,c=c.c);b/=100;a/=100;e/=100;c=1-Math.min(1,c/100*(1-e)+e);b=1-Math.min(1,b*(1-e)+e);
a=1-Math.min(1,a*(1-e)+e);return new k({r:Math.round(255*c),g:Math.round(255*b),b:Math.round(255*a)})},fromHsl:function(c,b,a){n.isArray(c)?(b=c[1],a=c[2],c=c[0]):n.isObject(c)&&(b=c.s,a=c.l,c=c.h);b/=100;for(a/=100;0>c;)c+=360;for(;360<=c;)c-=360;var e,f;120>c?(e=(120-c)/60,f=c/60,c=0):240>c?(e=0,f=(240-c)/60,c=(c-120)/60):(e=(c-240)/60,f=0,c=(360-c)/60);e=2*b*Math.min(e,1)+(1-b);f=2*b*Math.min(f,1)+(1-b);c=2*b*Math.min(c,1)+(1-b);0.5>a?(e*=a,f*=a,c*=a):(e=(1-a)*e+2*a-1,f=(1-a)*f+2*a-1,c=(1-a)*c+
2*a-1);return new k({r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*c)})}});q.fromHsv=function(c,b,a){n.isArray(c)?(b=c[1],a=c[2],c=c[0]):n.isObject(c)&&(b=c.s,a=c.v,c=c.h);360==c&&(c=0);b/=100;a/=100;var e,f,g;if(0==b)f=g=e=a;else{var d=c/60;c=Math.floor(d);var m=d-c,d=a*(1-b),l=a*(1-b*m);b=a*(1-b*(1-m));switch(c){case 0:e=a;f=b;g=d;break;case 1:e=l;f=a;g=d;break;case 2:e=d;f=a;g=b;break;case 3:e=d;f=l;g=a;break;case 4:e=b;f=d;g=a;break;case 5:e=a,f=d,g=l}}return new k({r:Math.round(255*
e),g:Math.round(255*f),b:Math.round(255*g)})};n.extend(k,{toCmy:function(){var c=1-this.g/255,b=1-this.b/255;return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*c),y:Math.round(100*b)}},toCmyk:function(){var c,b,a,e=this.r/255;c=this.g/255;b=this.b/255;a=Math.min(1-e,1-c,1-b);c=(1-c-a)/(1-a);b=(1-b-a)/(1-a);return{c:Math.round(100*((1-e-a)/(1-a))),m:Math.round(100*c),y:Math.round(100*b),b:Math.round(100*a)}},toHsl:function(){var c=this.r/255,b=this.g/255,a=this.b/255,e=Math.min(c,a,b),f=Math.max(c,
b,a),g=f-e,d=0,k=0,e=(e+f)/2;0<e&&1>e&&(k=g/(0.5>e?2*e:2-2*e));0<g&&(f==c&&f!=b&&(d+=(b-a)/g),f==b&&f!=a&&(d+=2+(a-c)/g),f==a&&f!=c&&(d+=4+(c-b)/g),d*=60);return{h:d,s:Math.round(100*k),l:Math.round(100*e)}},toHsv:function(){var c=this.r/255,b=this.g/255,a=this.b/255,e=Math.min(c,a,b),f=Math.max(c,b,a),e=f-e,g=null,d=0==f?0:e/f;0==d?g=0:(g=c==f?60*(b-a)/e:b==f?120+60*(a-c)/e:240+60*(c-b)/e,0>g&&(g+=360));return{h:g,s:Math.round(100*d),v:Math.round(100*f)}}});return q})},"dojox/main":function(){define(["dojo/_base/kernel"],
function(q){return q.dojox})},"esri/views/3d/layers/i3s/I3SProjectionUtil":function(){define(["../../support/projectionUtils","../../lib/glMatrix","../../webgl-engine/lib/Util"],function(q,n,k){var f=n.vec3d,c=n.mat4d,b=k.assert,a={PER_VERTEX:"perVertex",BOUNDINGBOX:"boundingBox",NO_REPROJECTION:"noReprojection"},e=new Float64Array(3E3);return{ReprojectionTypes:a,reprojectPoints:function(b,e,d,f,k,n,s){b===a.PER_VERTEX?d=this.reprojectPointsPerVertex(e,d,k,n,s,f):b===a.BOUNDINGBOX?d=this.reprojectBoundingBox(e,
d,k,n,s):(b=c.create(),c.identity(b),e=c.create(),q.computeLinearTransformation(k,d,e,s),d={localTrafo:b,globalTrafo:e});return d},reprojectPointsPerVertex:function(a,b,d,f,k,n){var s=c.create();q.computeLinearTransformation(d,b,s,k);var r=c.create(),r=c.inverse(s,r),t=c.create();c.identity(t);if(!n){n=[0,0,0];var u=a.length/3;q.vectorToVector(b,d,n,f);for(d=b=0;d<u;d+=1E3){var v=Math.min(1E3,u-d);for(b=0;b<v;b++)e[3*b]=a[3*(d+b)]+n[0],e[3*b+1]=a[3*(d+b)+1]+n[1],e[3*b+2]=a[3*(d+b)+2]+n[2];q.bufferToBuffer(e,
f,0,e,k,0,v);var C,y,x;for(b=0;b<v;b++)C=e[3*b],y=e[3*b+1],x=e[3*b+2],a[3*(d+b)]=r[0]*C+r[4]*y+r[8]*x+r[12],a[3*(d+b)+1]=r[1]*C+r[5]*y+r[9]*x+r[13],a[3*(d+b)+2]=r[2]*C+r[6]*y+r[10]*x+r[14]}}return{localTrafo:t,globalTrafo:s}},reprojectNormalsPerVertex:function(a,e,d,f,k){b(f.equals(q.SphericalRenderSpatialReference));f=c.create();q.computeLinearTransformation(d,e,f,k);e=c.create();e=c.inverse(f,e);d=a.length/3;for(var n,s=0;s<d;s++)k=a[3*s],f=a[3*s+1],n=a[3*s+2],a[3*s]=e[0]*k+e[4]*f+e[8]*n,a[3*s+
1]=e[1]*k+e[5]*f+e[9]*n,a[3*s+2]=e[2]*k+e[6]*f+e[10]*n},reprojectBoundingBox:function(a,b,d,e,k){for(var n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],s=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],r=0;r<a.length/3;r++)for(var t=[a[3*r],a[3*r+1],a[3*r+2]],u=0;3>u;u++)n[u]=Math.min(n[u],t[u]),s[u]=Math.max(s[u],t[u]);r=this.geographicToProjected(b,d,e);f.add(r,n,n);f.add(r,s,s);for(r=0;3>r;r++)s[r]==n[r]&&(s[r]+=1);r=[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],
s[2]]];for(t=0;4>t;t++)u=r[t],q.vectorToVector(u,e,u,k);e=f.subtract(r[1],r[0],f.create());t=f.subtract(r[2],r[0],f.create());u=f.subtract(r[3],r[0],f.create());f.scale(e,1/(s[0]-n[0]));f.scale(t,1/(s[1]-n[1]));f.scale(u,1/(s[2]-n[2]));var n=f.length(e),s=f.length(t),v=f.length(u);if(3<Math.abs(n-s)||3<Math.abs(n-v)||3<Math.abs(s-v)){for(r=0;r<a.length/3;r++)a[3*r]*=n,a[3*r+1]*=s,a[3*r+2]*=v;f.normalize(e);f.normalize(t);f.normalize(u)}a=c.createFromMatrixRowMajor([e[0],t[0],u[0],0,e[1],t[1],u[1],
0,e[2],t[2],u[2],0,0,0,0,1]);n=[0,0,0,0];q.vectorToVector(b,d,n,k);return{globalTrafo:c.createFromMatrixRowMajor([1,0,0,n[0],0,1,0,n[1],0,0,1,n[2],0,0,0,1]),localTrafo:a}},geographicToProjected:function(a,b,c){return 4326===c.wkid?[a[0],a[1],a[2]]:a}}})},"esri/views/3d/webgl-engine/lib/base64Binary":function(){define(["require","exports"],function(q,n){function k(b){var a=f[b.charAt(b.length-1)],c=f[b.charAt(b.length-2)],h=3*(b.length/4);64===a&&h--;64===c&&h--;a=new ArrayBuffer(h);c=new Uint8Array(a);
b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var g=0,d=0;d<h;d+=3){var k=f[b.charAt(g++)],l=f[b.charAt(g++)],n=f[b.charAt(g++)],q=f[b.charAt(g++)],r=(l&15)<<4|n>>2,t=(n&3)<<6|q;c[d]=k<<2|l>>4;64!==n&&(c[d+1]=r);64!==q&&(c[d+2]=t)}return a}for(var f={},c=0;65>c;c++)f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[c]]=c;n.decode=k;n.decodeFloat32=function(b){return new Float32Array(k(b))};n.decodeUint32=function(b){return new Uint32Array(k(b))};n.decodeInt32=function(b){return new Int32Array(k(b))};
n.encode=function(b){var a;a=b instanceof Uint8Array?b:new Uint8Array(a.buffer,a.byteOffset,a.byteLength);b=a.length%3;for(var c="",f,g=0,d=a.length-b;g<d;g+=3)f=(a[g]<<16)+(a[g+1]<<8)+a[g+2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>18&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f&
63];switch(b){case 1:f=a[a.length-1];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>2];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f<<4&63];c+="\x3d\x3d";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>10],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f>>4&63],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[f<<
2&63],c+="\x3d"}return c}})},"url:esri/views/3d/environment/materials/SimpleAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n#ifndef PANORAMIC\r\n\r\n  const float TWICEPI \x3d 2.0*3.14159265;\r\n  const float ATMOSPHERE_RIM_SEGMENTS \x3d 128.0;\r\n\r\n  uniform vec3 silCircleCenter;\r\n  uniform vec3 silCircleV1;\r\n  uniform vec3 silCircleV2;\r\n  uniform vec2 texV;\r\n\r\n#endif\r\n\r\n  uniform vec3 lightDirection;\r\n\r\n  attribute vec3 $position;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main(void) {\r\n\r\n#ifdef PANORAMIC\r\n\r\n    vec3 pos \x3d $position;\r\n    float ndotl \x3d lightDirection.z;\r\n    vtc \x3d vec2(0, $position.z+0.05);\r\n\r\n#else\r\n\r\n    float phi \x3d $position.x * (TWICEPI / ATMOSPHERE_RIM_SEGMENTS) + 1.0;\r\n    vec3 pos \x3d (sin(phi) * silCircleV1 + cos(phi) * silCircleV2 + silCircleCenter) * $position.y;\r\n    float ndotl \x3d dot(normalize(pos), lightDirection);\r\n\r\n    vtc.x \x3d $position.x / ATMOSPHERE_RIM_SEGMENTS;\r\n    vtc.y \x3d texV.x * (1.0 - $position.z) + texV.y * $position.z;\r\n\r\n#endif\r\n\r\n    falloff \x3d max(0.0, (smoothstep(-1.0, 0.8, ndotl + ndotl)));\r\n\r\n    gl_Position \x3d proj * view * vec4(pos, 1.0);\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec4 color;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor * color * falloff;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/RealisticAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--Vertex Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"vsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n//\r\n// Based on Atmospheric scattering vertex shader by Sean O\'Neil from GPU Gems 2 Chapter 16.\r\n//\r\n// Link:                   http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\r\n// Download Portal:        http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Index.html\r\n// Unmodified Source Code: http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/16.zip\r\n//\r\n// Adapted for WebGIS by Jascha Gr\u00fcbel (jgruebel@esri.com), Z\u00fcrich 2015\r\n//\r\n\r\n  precision mediump  float;\r\n\r\n  //Camera\r\n  uniform vec2 halfSizeNearPlane;\r\n  uniform vec3 v3CameraUp;\r\n  uniform vec3 v3CameraRight;\r\n  uniform vec3 v3CameraDir;\r\n  uniform vec2 v2CameraCenterOffset;\r\n\r\n  //Attributes\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  //Varyings\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n#ifdef HAZE\r\n  varying vec3 v3EyeDir;\r\n#endif\r\n\r\n  void main(void) {\r\n    vec3 v3Pos \x3d $position;\r\n    vtc \x3d $uv0;\r\n    vec2 rayvtc \x3d $uv0 - v2CameraCenterOffset;\r\n\r\n#ifdef HAZE\r\n    v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#else\r\n    vec3 v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#endif\r\n    v3WorldRay \x3d v3EyeDir.z*v3CameraDir + v3EyeDir.y*v3CameraUp + v3EyeDir.x*v3CameraRight;\r\n    gl_Position \x3d vec4(v3Pos, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereScaleFunction"\x3e\x3c![CDATA[\r\n  //Approximation for inner integral based on a radii ratio of 10.25:10\r\n  float scale(float fCos){\r\n    float x \x3d 1.0 - fCos;\r\n    return exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toneMapperConstants"\x3e\x3c![CDATA[\r\n#ifdef HAZE\r\n  const float fOneOverGamma \x3d 1.0;//Gamma \x3d 1.0\r\n#else\r\n  const float fOneOverGamma \x3d 0.454545; // Gamma \x3d 2.2\r\n#endif\r\n  const vec3 v3OneOverGamma \x3d vec3(fOneOverGamma);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"exponentialToneMapper"\x3e\x3c![CDATA[\r\n  //ToneMapping operators\r\n  vec3 expTM(vec3 inputColor,float exposure){\r\n      return pow(1.0 - exp(inputColor * -exposure), v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"reinhardToneMapper"\x3e\x3c![CDATA[\r\n  vec3 reinhardTM(vec3 inputColor, float exposure){\r\n      vec3 intermediate \x3d inputColor *exposure;\r\n      intermediate /\x3d (1.0+intermediate);\r\n      return pow(intermediate, v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"HSVColorSpace"\x3e\x3c![CDATA[\r\n//based on http://gamedev.stackexchange.com/a/59808\r\n// Hue in range [0,1] instead of 360\u00b0\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n    vec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n    vec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n    float d \x3d q.x - min(q.w, q.y);\r\n    float e \x3d 1.0e-10;\r\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUniformsConstantsVaryings"\x3e\x3c![CDATA[\r\n\r\n  //Light\r\n  uniform vec3 v3LightDir;      // The direction vector to the light source\r\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\r\n  uniform vec3 v3InvWavelengthScaled; //v3InvWavelength * fKr4PI + fKm4PI\r\n\r\n  //Radii\r\n  uniform vec4 v4Radii; // inner, inner^2, outer, outer^2,\r\n\r\n  //Atmosphere\r\n  const float fKrESun \x3d 0.075;        // Kr * ESun \x3d 0.005 * 15.0\r\n  const float fKmESun \x3d 0.015;        // Km * ESun \x3d 0.005 * 15\r\n  //uniform float fScale;         // 1 / (fOuterRadius - fInnerRadius)\r\n  //uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepth; // 1.0 / fScaleDepth\r\n\r\n  //uniform float fScaleDepthBlue;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepthBlue; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepthBlue; // 1.0 / fScaleDepth\r\n\r\n  uniform vec4 v4AtmosParams1; //(fScale,fScaleDepth,fScaleOverScaleDepth,fOneOverScaleDepth)\r\n  uniform vec4 v4AtmosParams2; //(g,fScaleDepthBlue,fScaleOverScaleDepthBlue,fOneOverScaleDepthBlue)\r\n#ifndef HAZE\r\n  uniform vec4 v4AtmosParams3; //(g2,fMiePhaseCoefficients,fLowerAlphaBlendBound,fOneOverOuterRadiusMinusAlphaBlendBound)\r\n#endif\r\n\r\n  //Camera\r\n  uniform vec3 v3CameraPos;     // The camera\'s current position\r\n  //uniform float fCameraHeight;  // The camera\'s current height\r\n  //uniform float fCameraHeight2; // fCameraHeight^2\r\n  //uniform float fC; //fCameraHeight2 - fOuterRadius2; // C \x3d ||o-c||^2 - r^2\r\n  //uniform float fCSur; //fCameraHeight2 - (fInnerRadius2 - 63756370000.0); // C \x3d ||o-c||^2 - r^2\r\n  uniform vec4 v4SphereComp; //The camera\'s current height, CameraHeight^2,fC,fCSur\r\n  uniform vec2 nearFar;\r\n\r\n  //Camera HDR\r\n#ifdef HAZE\r\n  const float fExposure \x3d 1.5;\r\n#else\r\n  const float fExposure \x3d 2.0;\r\n#endif\r\n\r\n#ifdef HAZE\r\n  //Depth texture\r\n  uniform sampler2D tDepth;\r\n#endif\r\n\r\n  //Testing variables\r\n  uniform float showTest;\r\n\r\n  //Varyings\r\n  varying vec3 v3EyeDir;\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n  //Loop constants for integral approximation\r\n  const float fSamples \x3d 5.0;\r\n  const int maxSamples \x3d 5;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmospherePrecomputation"\x3e\x3c![CDATA[\r\n    float fInnerRadius \x3d v4Radii[0];   // The inner (planetary) radius\r\n    float fInnerRadius2 \x3d v4Radii[1];  // fInnerRadius^2\r\n    float fOuterRadius \x3d v4Radii[2];   // The outer (atmosphere) radius\r\n    float fOuterRadius2 \x3d v4Radii[3];  // fOuterRadius^2\r\n\r\n    float fCameraHeight \x3d v4SphereComp[0];\r\n    float fCameraHeight2 \x3d v4SphereComp[1];\r\n    float fC \x3d v4SphereComp[2];\r\n    float fCSur \x3d v4SphereComp[3];\r\n\r\n#ifdef PLANAR\r\n    vec3 cameraPosition \x3d vec3(0.0,0.0,fCameraHeight);\r\n#else\r\n    vec3 cameraPosition \x3d v3CameraPos;\r\n#endif\r\n\r\n    //Debug variables\r\n    vec3 test \x3d vec3(0.0,0.0,0.0);\r\n\r\n    //Obtain ray from Camera\r\n    vec3 worldSpaceRay \x3d normalize(v3WorldRay);\r\n\r\n    //Compute Atmosphere intersection; i.e. ray/sphere intersection\r\n    float B \x3d 2.0 * dot(cameraPosition, worldSpaceRay); // B \x3d 2(l * (o-c))\r\n    float det \x3d B*B - 4.0 * fC; // det \x3d B^2 - 4.0* C\r\n\r\n    //idealized sphere intersection to discard early some pixels\r\n    float detSur \x3d B*B - 4.0 * fCSur; // det \x3d B^2 - 4.0* C\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereDiscardPixels"\x3e\x3c![CDATA[\r\n      bool continueComputation \x3d true;\r\n#ifdef HAZE\r\n      // only use red channel from depth texture.\r\n      // see \'Issues\' at https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture\r\n      float depthSample \x3d texture2D(tDepth, vtc).r;\r\n\r\n      float zNear \x3d nearFar[0];\r\n      float zFar \x3d nearFar[1];\r\n\r\n      // http://web.archive.org/web/20130416194336/http://olivers.posterous.com/linear-depth-in-glsl-for-real\r\n      float zNorm \x3d 2.0 * depthSample - 1.0;\r\n      float linDepth \x3d 2.0 * zNear * zFar /\r\n        (zFar + zNear - zNorm * (zFar - zNear));\r\n\r\n      float nearSurfaceT;\r\n      if (detSur\x3e0.0){\r\n        nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n      }\r\n\r\n      float rayEndT;\r\n\r\n      // find intersections with ground, but only between the near and far\r\n      // clipping planes.\r\n      if (depthSample \x3c 1.0 \x26\x26 depthSample \x3e 0.0) {\r\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\r\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\r\n        cameraSpaceRay *\x3d linDepth;\r\n#ifndef PLANAR\r\n        if((fCameraHeight-fInnerRadius)\x3e8000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d nearSurfaceT;\r\n        } else  if ((fCameraHeight-fInnerRadius)\x3e2000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d mix(length(cameraSpaceRay),nearSurfaceT,((fCameraHeight-fInnerRadius)-2000000.0)/6000000.0);\r\n        } else {\r\n          rayEndT \x3d length(cameraSpaceRay);\r\n        }\r\n#else\r\n        rayEndT \x3d length(cameraSpaceRay);\r\n#endif\r\n      } else {\r\n        continueComputation \x3d false;\r\n      }\r\n#ifdef PLANAR\r\n      if (16500.0+ fInnerRadius \x3c fCameraHeight){\r\n        continueComputation \x3d false;\r\n      }\r\n#endif\r\n#else\r\n      if (detSur\x3e0.0){\r\n        float nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n        if (nearSurfaceT \x3e 0.0){\r\n          continueComputation \x3d false;\r\n        }\r\n      }\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUnpackAddUniforms"\x3e\x3c![CDATA[\r\n        float fScale \x3d v4AtmosParams1.x;\r\n        vec2 v2ScaleDepth \x3d vec2(v4AtmosParams1.y,v4AtmosParams2.y);//fScaleDepth, fScaleDepthBlue\r\n        vec2 v2ScaleOverScaleDepth \x3d vec2(v4AtmosParams1.z,v4AtmosParams2.z);//fScaleOverScaleDepth, fScaleOverScaleDepthBlue\r\n        vec2 v2OneOverScaleDepth \x3d vec2(v4AtmosParams1.w,v4AtmosParams2.w);//fOneOverScaleDepth, fOneOverScaleDepthBlue\r\n\r\n#ifndef HAZE\r\n        float g \x3d v4AtmosParams2.x;\r\n        float g2 \x3d v4AtmosParams3.x;\r\n        float fMiePhaseCoefficients \x3d v4AtmosParams3.y;\r\n        float fLowerAlphaBlendBound \x3d v4AtmosParams3.z;\r\n        float fOneOverOuterRadiusMinusAlphaBlendBound \x3d v4AtmosParams3.w;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeRayAndLoopSetup"\x3e\x3c![CDATA[\r\n        float rayStartT \x3d 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\r\n#ifdef HAZE\r\n        float nearT \x3d abs(rayStartT);\r\n        float farT \x3d abs(rayEndT);\r\n#else\r\n        float rayEndT \x3d 0.5 *(-B + sqrt(det)); //far intersection with atmosphere\r\n\r\n#endif\r\n\r\n        float fDistance;//calculate its scattering offset\r\n        // Calculate the ray\'s starting position\r\n        if (rayStartT \x3c 0.0)\r\n        { //ray starts from camera to far\r\n          rayStartT \x3d 0.0;\r\n#ifndef HAZE\r\n          fDistance \x3d fScale*(fInnerRadius - fCameraHeight);\r\n#endif\r\n        }\r\n#ifndef HAZE\r\n        else\r\n        {//outside atmosphere\r\n          fDistance \x3d -1.0;\r\n        }\r\n#endif\r\n\r\n        // Initialize the scattering loop variables\r\n        vec3 v3Start \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n\r\n#ifdef HAZE\r\n        vec3 v3End \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n\r\n        float fEndLength \x3d length(v3End);\r\n        float fLocalCameraHeight \x3d length(v3Start);\r\n\r\n        //computed for the original end point to get consistent light angles after possible inversions\r\n        float fLightAngle \x3d dot(v3LightDir, v3End) / fEndLength;\r\n\r\n        if (nearT \x3e farT)\r\n        {\r\n          if (fLocalCameraHeight \x3c fEndLength)\r\n          {\r\n            //Switch positive slopes for flipped rays\r\n            v3End \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n            v3Start \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n            worldSpaceRay *\x3d -1.0;\r\n            fEndLength \x3d length(v3End);\r\n            fLocalCameraHeight \x3d length(v3Start);\r\n          }\r\n          else if (fLocalCameraHeight \x3d\x3d fEndLength)\r\n          {// create minuscule fake slope for integration if the slope is zero\r\n            fLocalCameraHeight +\x3d 1.0; //BUGFIX, if the height of camera and ground is equal the equation breaks, add fake meter to camera height to get\r\n            //slope for the camera function\r\n          }\r\n        }\r\n\r\n        //Calculate its scattering offset\r\n        // Assumes camera constrains of WSV 3.8\r\n        float fCameraDepth;\r\n        float fCameraDepthBlue;\r\n        if (fLocalCameraHeight \x3e fOuterRadius)\r\n        {\r\n          fDistance \x3d fInnerRadius - fOuterRadius;\r\n        } else\r\n        {//outside atmosphere\r\n          fDistance \x3d fEndLength - fLocalCameraHeight;\r\n        }\r\n\r\n#endif\r\n        vec2 v2OpticalStartDepth \x3d exp(fDistance * v2OneOverScaleDepth);\r\n\r\n        float fRayLength \x3d rayEndT - rayStartT;\r\n        float fSampleLength \x3d fRayLength / fSamples;\r\n        float fScaledLength \x3d fSampleLength * fScale;\r\n        vec3 v3SampleRay \x3d worldSpaceRay * fSampleLength;\r\n        vec3 v3SamplePoint \x3d v3Start + v3SampleRay * 0.5;\r\n\r\n#ifdef HAZE\r\n        float fCameraAngle \x3d dot(-worldSpaceRay, v3End) / fEndLength;\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth;\r\n\r\n        float scaledValues \x3d scale(fLightAngle) + fScaleCameraAngle;\r\n        vec2 v2ScaledValuesDepth \x3d scaledValues * v2ScaleDepth;\r\n#else\r\n        float fCameraAngle \x3d dot(worldSpaceRay, v3Start / length(v3Start));\r\n        float angleMultiplier \x3d fCameraAngle\x3e0.0?fCameraAngle:0.0;\r\n\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth * v2ScaleDepth;\r\n#endif\r\n\r\n        //Loop variables\r\n        vec3 v3FrontColor \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3FrontColorBlue \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3Attenuate\x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3AttenuateBlue \x3d vec3(0.0, 0.0, 0.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeSampleContribution"\x3e\x3c![CDATA[\r\n          float fHeight \x3d length(v3SamplePoint);\r\n          vec2 v2Depth \x3d exp(v2ScaleOverScaleDepth * (fInnerRadius - fHeight));\r\n#ifdef HAZE\r\n          vec2 v2Scatter \x3d v2Depth*v2ScaledValuesDepth-v2CameraOffset;\r\n#else\r\n          float fLightAngle \x3d dot(v3LightDir, v3SamplePoint) / fHeight;\r\n          float fCameraAngle \x3d dot(worldSpaceRay, v3SamplePoint) / fHeight;\r\n          float fTempScaledValues \x3d scale(fLightAngle) - scale(fCameraAngle);\r\n          vec2 v2Scatter \x3d v2CameraOffset + fTempScaledValues*v2Depth* v2ScaleDepth;\r\n#endif\r\n          v3Attenuate \x3d exp(-v2Scatter.x * v3InvWavelengthScaled);\r\n          v3AttenuateBlue \x3d exp(-v2Scatter.y * v3InvWavelengthScaled);\r\n\r\n          v3FrontColor +\x3d v3Attenuate * v2Depth.x;\r\n          v3FrontColorBlue +\x3d v3AttenuateBlue * v2Depth.y;\r\n\r\n          v3SamplePoint +\x3d v3SampleRay;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeHDRColors"\x3e\x3c![CDATA[\r\n        //Phase computation\r\n        //clamp to avoid numerical instability at fCos \x3d\x3d -1.0 (and close values) to display fake sun\r\n        float fCos \x3d clamp(dot(v3LightDir, -worldSpaceRay ),-0.9999999,1.0);\r\n        float fOnePlusCos2 \x3d fCos*fCos + 1.0;\r\n#ifdef HAZE\r\n        // Finally, scale the Rayleigh colors and set up the varying variables for the pixel shader\r\n        vec3 colorCoefficients \x3d (fScaledLength* 0.75 * fOnePlusCos2)*(fKrESun*v3InvWavelength+fKmESun);\r\n\r\n        //Scaled Length is only applied afterwards to save multiplications\r\n        vec3 v3Color \x3d colorCoefficients *v3FrontColor;\r\n        vec3 v3ColorBlue \x3d colorCoefficients *v3FrontColorBlue;\r\n#else\r\n        vec3 v3RayleighCoefficients \x3d (fScaledLength*0.75 * fOnePlusCos2*fKrESun)*v3InvWavelength;\r\n        float fMieCoefficients \x3d fScaledLength*fKmESun * fMiePhaseCoefficients * fOnePlusCos2 / pow(1.0 + g2 - 2.0*g*fCos, 1.5);\r\n\r\n        // Calculate the attenuation factor for the ground\r\n        vec3 v3Color \x3d v3RayleighCoefficients * v3FrontColor + fMieCoefficients * v3FrontColor;\r\n        vec3 v3ColorBlue \x3d v3RayleighCoefficients * v3FrontColorBlue + fMieCoefficients * v3FrontColorBlue;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputePixelColor"\x3e\x3c![CDATA[\r\n\r\n\r\n        //HDR to LDR conversion\r\n        vec3 ldrBlue \x3d expTM(v3ColorBlue,2.0*fExposure);\r\n        vec3 ldrRed \x3d expTM(v3Color,fExposure);\r\n\r\n        //mix reddish and blueish atmosphere\r\n        vec3 LDR \x3d mix(ldrBlue,ldrRed,0.2);\r\n#ifdef HAZE\r\n        LDR *\x3d (1.0-fCameraAngle);\r\n        vec3 hsv \x3d rgb2hsv(LDR);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost haze saturation by 50%\r\n        LDR \x3d hsv2rgb(hsv);\r\n        vec3 finalColor \x3d LDR;\r\n        // when rendering we specify the blend functions such that\r\n        // newDestColor \x3d oldDestColor*(1.0-finalColor) + finalColor\r\n#else\r\n        //reinhard tonemapper for looking upwards\r\n        vec3 ldrReinhard \x3d reinhardTM(v3Color,fExposure);\r\n        LDR +\x3d angleMultiplier*ldrReinhard;\r\n\r\n        //height dependent parameter to smooth out reddish atmosphere\r\n        float side \x3d (rayEndT+rayStartT)*0.5;\r\n        float atmoHeight \x3d sqrt(fCameraHeight2 - side*side);\r\n        float h2 \x3d clamp(1.0-(atmoHeight-fLowerAlphaBlendBound)/(fOuterRadius-fLowerAlphaBlendBound),0.0,1.0);\r\n\r\n        vec3 finalColor \x3d LDR*h2;\r\n        vec3 hsv \x3d rgb2hsv(finalColor);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost sky saturation by 50%\r\n        finalColor \x3d hsv2rgb(hsv);\r\n#endif\r\n#ifdef PLANAR\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#else\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,0.0,16500.0);\r\n        alpha \x3d alpha / (16500.0-0.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#endif\r\n#else\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        float atmosStrength \x3d clamp((length(ldrRed)-0.05)*1.05,0.0,1.0);\r\n        gl_FragColor \x3d vec4(finalColor, atmosStrength*clamp(1.0-(atmoHeight-fInnerRadius)/(fOuterRadius-fInnerRadius),0.0,1.0));\r\n#else\r\n        gl_FragColor \x3d vec4(finalColor, 1.0);\r\n#endif\r\n#endif\r\n\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--Fragment Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"fsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n\r\n  precision mediump  float;\r\n\r\n$atmosphereUniformsConstantsVaryings\r\n\r\n$atmosphereScaleFunction\r\n\r\n  //Conversion implementation found in util.xml\r\n$rgba2float\r\n\r\n\r\n$toneMapperConstants\r\n$exponentialToneMapper\r\n#ifndef HAZE\r\n$reinhardToneMapper\r\n#endif\r\n\r\n$HSVColorSpace\r\n\r\n  void main()\r\n  {\r\n\r\n    $atmospherePrecomputation\r\n\r\n    //Inside Atmosphere\r\n    if (det \x3e\x3d 0.0){\r\n\r\n      $atmosphereDiscardPixels\r\n\r\n      if(continueComputation){\r\n\r\n        $atmosphereUnpackAddUniforms\r\n\r\n        $atmosphereComputeRayAndLoopSetup\r\n\r\n        // Now loop through the sample rays\r\n        for(int i\x3d0; i\x3cmaxSamples; i++)\r\n        {\r\n          $atmosphereComputeSampleContribution\r\n        }\r\n\r\n        $atmosphereComputeHDRColors\r\n\r\n        $atmosphereComputePixelColor\r\n\r\n        //Debug variable overlay\r\n        if(showTest\x3e0.0){\r\n          gl_FragColor \x3d vec4(test,1.0);\r\n        }\r\n\r\n      } else {//Not on surface\r\n        gl_FragColor \x3d vec4(0.0);\r\n      }\r\n    } else {//Outside Atmosphere\r\n      gl_FragColor \x3d vec4(0.0);\r\n    }\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n\r\n  void main(void) {\r\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\r\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  varying vec2 vtc;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor;\r\n  }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/environment/materials/StarMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec4 viewport;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n  attribute float $size;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 posProj \x3d proj * view * model*vec4($position*1.0e25,1.0);//move infinitely far away\r\n\t\tgl_Position \x3d matchPixelCenter(posProj, viewport.zw); //pixel align position\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n\t\tvcolor \x3d $color/1.2;\r\n\t\tvsize \x3d size*5.0;\r\n\t\tgl_PointSize \x3d vsize;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\tvoid main() {\r\n\t\tfloat cap \x3d 0.7;\r\n\t\tfloat scale \x3d 1.0/cap;\r\n\t\tfloat helper \x3d clamp(length(abs(gl_PointCoord-vec2(0.5))),0.0,cap);\r\n\t\tfloat alpha \x3d clamp((cap-helper)*scale,0.0,1.0);\r\n\t\tfloat intensity \x3d alpha*alpha*alpha;\r\n\t\tif (vsize \x3c 3.0)\r\n\t\t\tintensity *\x3d 0.5;\r\n\t\tgl_FragColor \x3d vec4(1.0,1.0,1.0,intensity);\r\n\t\tgl_FragColor.xyz *\x3d vcolor.xyz;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderSimple"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderSimple"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 color;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderTexOnly"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4(position, 1.0)).xyz, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderTexOnly"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 color;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tgl_FragColor \x3d texColor * color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/ssao.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\t\x3csnippet name\x3d"createFsSSAOSrc"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D rnm;\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform float\t\tssaoAtt;\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform float\t\tradius;\r\n\tuniform vec2\t\tnearFar;\r\n\tuniform vec3\t\tpSphere[64];\r\n\r\n\tvarying vec2\t\tuv;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\tconst\tfloat\t\tstrength \x3d .07;\r\n\tconst\tfloat\t\tfalloff \x3d .000002;\r\n\r\n\t$rgba2float\r\n\tvoid main(void) {\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\t\tfloat currentPixelDepth \x3d rgba2float(texture2D(depthMap, uv));\r\n\t\tvec3 ep \x3d vec3(uv.xy, currentPixelDepth);\r\n\t\tvec3 norm \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, uv).xyz;\r\n\t\tfloat bl \x3d .0;\r\n\t\tfloat f \x3d mix(nearFar.x, nearFar.y, currentPixelDepth) / nearFar.x;\r\n\t\tfloat radD \x3d radius / f;\r\n\t\tradD \x3d min(radD, .5);\r\n\t\tfloat depthDifference;\r\n\t\tvec3 ray;\r\n\r\n\t\tfor(int i \x3d 0; i \x3c samples; ++i) {\r\n\t\t\tray \x3d radD*reflect(pSphere[i], fres);\r\n\t\t\tvec2 tc \x3d ep.xy + sign(dot(ray, norm) ) * ray.xy;\r\n\t\t\tif (tc.x \x3e\x3d .0 \x26\x26 tc.y \x3e\x3d .0 \x26\x26 tc.x \x3c\x3d 1.0 \x26\x26 tc.y \x3c\x3d 1.0) {\r\n\t\t\t\tfloat occluderDepth \x3d rgba2float(texture2D(depthMap, tc));\r\n\t\t\t\tvec3 occluderNormal \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, tc).xyz;\r\n\t\t\t\tdepthDifference \x3d currentPixelDepth - occluderDepth;\r\n\t\t\t\tbl +\x3d step(falloff, depthDifference) * (1.0 - dot(occluderNormal, norm)) * (1.0 - smoothstep(falloff, strength, depthDifference));\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfloat ao \x3d 1.0 + bl * (-1.38 / float(samples)) * ssaoAtt;\r\n\t\tgl_FragColor.a \x3d ao;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"getDepthLinear"\x3e\x3c![CDATA[\r\n\tfloat getDepthLinear(vec2 ssC) {\r\n\t\treturn -(rgba2float(texture2D(depthMap, ssC))*(nearFar[1] - nearFar[0])+nearFar[0]);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"createFsSSAOSrcObscurance"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform mat4 projMatrixInv;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\r\n\tuniform float     intensity;\r\n\r\n\tuniform float projScale;\r\n\tuniform float     radius;\r\n\tuniform vec2      nearFar;\r\n\r\n\tuniform vec4      projInfo;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\r\n\tuniform vec2\t  screenDimensions;\r\n\r\n\t//noise texture lookup could be replaced with hash function if WebGL gets XOR functionality\r\n\tuniform vec3\t\tpSphere[64]; //tap position\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform sampler2D rnm; //noise texture\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\tvarying vec2  uv;\r\n\tvarying vec4  camPos;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\t/** Returns a unit vector and a screen-space radius for the tap on a unit disk (the caller should scale by the actual disk radius) */\r\n\t/*uniform float numSpiralTurns;\r\n\tvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\r\n\t\t// Radius relative to ssR\r\n\t\tfloat alpha \x3d (float(sampleNumber) + 0.5) * (1.0 / float(samples));\r\n\t\tfloat angle \x3d alpha * (numSpiralTurns * 6.28) + spinAngle;\r\n\r\n\t\tssR \x3d alpha;\r\n\t\treturn vec2(cos(angle), sin(angle));\r\n\t}*/\r\n\r\n\r\n\tfloat radius2 \x3d radius * radius;\r\n\r\n\tfloat fallOffFunction(float vv, float vn, float bias) {\r\n\t\t// A: From the HPG12 paper\r\n\t\t// Note large epsilon to avoid overdarkening within cracks\r\n\t\t// return float(vv \x3c radius2) * max((vn - bias) / (epsilon + vv), 0.0) * radius2 * 0.6;\r\n\r\n\t\t// B: Smoother transition to zero (lowers contrast, smoothing out corners). [Recommended]\r\n\t\tfloat f \x3d max(radius2 - vv, 0.0); return f * f * f * max(vn-bias, 0.0);\r\n\r\n\t\t// C: Medium contrast (which looks better at high radii), no division.  Note that the\r\n\t\t// contribution still falls off with radius^2, but we\'ve adjusted the rate in a way that is\r\n\t\t// more computationally efficient and happens to be aesthetically pleasing.\r\n\t\t// return 4.0 * max(1.0 - vv * invRadius2, 0.0) * max(vn - bias, 0.0);\r\n\r\n\t\t// D: Low contrast, no division operation\r\n\t\t// return 2.0 * float(vv \x3c radius * radius) * max(vn - bias, 0.0);\r\n\t}\r\n\r\n\r\n\t/** Compute the occlusion due to sample point \\a Q about camera-space point \\a C with unit normal \\a n_C */\r\n\tfloat aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\r\n\t\tvec3 v \x3d Q - C;\r\n\t\tfloat vv \x3d dot(v, v);\r\n\t\tfloat vn \x3d dot(normalize(v), n_C);\r\n\t\treturn fallOffFunction(vv, vn, 0.1);\r\n\t}\r\n\r\n\r\n\t/** Reconstruct camera-space P.xyz from screen-space S \x3d (x, y) in\r\n\t\tpixels and camera-space z \x3c 0.  Assumes that the upper-left pixel center\r\n\t\tis at (0.5, 0.5) [but that need not be the location at which the sample tap\r\n\t\twas placed!]\r\n\r\n\t\tCosts 3 MADD.  Error is on the order of 10^3 at the far plane, partly due to z precision.\r\n\t  */\r\n\tvec3 reconstructCSPosition(vec2 S, float z) {\r\n\t\treturn vec3(( (S.xy) * projInfo.xy + projInfo.zw)*(z*zScale.x+zScale.y), z);\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\t//Hash function used in the HPG12 AlchemyAO paper\r\n\t\t//Not supported in WebGL -\x3e using texture lookup as in old SSAO shader instead\r\n\t\t//ivec2 ssC \x3d ivec2(gl_FragCoord.xy);\r\n\t\t//float randomPatternRotationAngle \x3d float((3 * ssC.x ^ ssC.y + ssC.x * ssC.y) * 10);\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\r\n\t   float currentPixelDepth \x3d getDepthLinear(uv);\r\n\r\n\t   if (-currentPixelDepth\x3enearFar.y || -currentPixelDepth\x3cnearFar.x) {\r\n\t\tgl_FragColor \x3d vec4(0);\r\n\t\treturn;\r\n\t   }\r\n\r\n\t   vec3 currentPixelPos \x3d reconstructCSPosition(gl_FragCoord.xy,currentPixelDepth);\r\n\r\n\t   // get the normal of current fragment\r\n\t   vec4 norm4 \x3d texture2D(normalMap, uv);\r\n\t   vec3 norm \x3d vec3(-1.0) + 2.0 * norm4.xyz;\r\n\t   bool isTerrain \x3d norm4.w\x3c0.5;\r\n\r\n\t   float sum \x3d .0;\r\n\r\n\t   vec4 occluderFragment;\r\n\t   vec3 ray;\r\n\r\n\t   vec3 tapPixelPos;\r\n\r\n\t\t//TODO the factor 2.0 should not be necessary, but makes ssao much nicer. bug or deviation from CE somewhere else?\r\n\t   float ps \x3d projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\r\n\r\n\t   for(int i \x3d 0; i \x3c samples; ++i)\r\n\t   {\r\n\t\t  // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\r\n\t\t  //float ssR;\r\n\t\t  //vec2 unitOffset \x3d tapLocation(i, randomPatternRotationAngle, ssR);\r\n\t\t  // get the depth of the occluder fragment\r\n\t\t  //vec2 offset \x3d vec2(-unitOffset*radius*ssR*ps);\r\n\r\n\t\t  vec2 unitOffset \x3d reflect(pSphere[i], fres).xy;\r\n\t\t  vec2 offset \x3d vec2(-unitOffset*radius*ps);\r\n\r\n\r\n\t\t  //don\'t use current or very nearby samples\r\n\t\t  if ( abs(offset.x)\x3c2.0 || abs(offset.y)\x3c2.0) continue;\r\n\r\n\r\n\t\t  vec2 tc \x3d vec2(gl_FragCoord.xy + offset);\r\n\t\t  if (tc.x \x3c 0.0 || tc.y \x3c 0.0 || tc.x \x3e screenDimensions.x || tc.y \x3e screenDimensions.y) continue;\r\n\t\t  vec2 tcTap \x3d tc/screenDimensions;\r\n\t\t  float occluderFragmentDepth \x3d getDepthLinear(tcTap);\r\n\r\n\t\t  if (isTerrain) {\r\n\t\t  \tbool isTerrainTap \x3d texture2D(normalMap, tcTap).w\x3c0.5;\r\n\t\t  \tif (isTerrainTap)\r\n\t\t  \t\tcontinue;\r\n\t\t  }\r\n\r\n\t\t  tapPixelPos \x3d reconstructCSPosition(tc, occluderFragmentDepth);\r\n\r\n\t\t  sum+\x3d aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\r\n\t   }\r\n\r\n\t   // output the result\r\n\r\n\t\tfloat A \x3d max(1.0-sum*intensity/float(samples),0.0);\r\n\r\n\t\t// Anti-tone map to reduce contrast and drag dark region farther\r\n\t\t// (x^0.2 + 1.2 * x^4)/2.2\r\n\t\tA \x3d (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\r\n\r\n\r\n\t   //gl_FragColor \x3d vec4(norm/2.0+0.5, 1.0);\r\n\t   //gl_FragColor \x3d vec4(-currentPixelDepth/1000.0);\r\n\t   //gl_FragColor \x3d vec4(tapPixelPos.x/100.0);\r\n\t   gl_FragColor \x3d vec4(A);\r\n\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsBlurEdgeAware"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform sampler2D tex;\r\n\r\n\r\n\tuniform vec2 blurSize;\r\n\r\n\r\n\tuniform float g_BlurFalloff;\r\n\tuniform float projScale;\r\n\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform vec2\t\tnearFar;\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\tfloat BlurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness)\r\n\t{\r\n\t\tfloat c \x3d texture2D(tex, uv).r;\r\n\t\tfloat d \x3d getDepthLinear(uv);\r\n\r\n\t\tfloat ddiff \x3d d - center_d;\r\n\r\n\t\tfloat w \x3d exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\r\n\r\n\t\tw_total +\x3d w;\r\n\r\n\t\treturn w*c;\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\tfloat b \x3d 0.0;\r\n\t\tfloat w_total \x3d 0.0;\r\n\r\n\t\tfloat center_d \x3d  getDepthLinear(uv);\r\n\r\n\t\tfloat sharpness \x3d -0.05*projScale/(center_d*zScale.x+zScale.y);\r\n\t\tfor (int r \x3d -RADIUS; r \x3c\x3d RADIUS; ++r)\r\n\t\t{\r\n\t\t\tfloat rf \x3d float(r);\r\n\t\t\tvec2 uvOffset \x3d uv + rf*blurSize;\r\n\t\t\tb +\x3d BlurFunction(uvOffset, rf, center_d, w_total, sharpness);\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d vec4(b/w_total);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc0"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float blurSize;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main() {\r\n\t\tint rad \x3d RADIUS - 1;\r\n\r\n\t\tvec4 sum \x3d vec4(0.0);\r\n\t\tfor (int k \x3d -RADIUS; k \x3c\x3d RADIUS; ++k) { \t\t// NOTE for-variable-init must be a const expression\r\n\t\t\tfloat fi \x3d float(k);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc1"\x3e\x3c![CDATA[\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d sum / float(RADIUS * RADIUS);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurH"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x + fi * blurSize, uv.y)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurV"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x, uv.y + fi * blurSize)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/highlight.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n5-tap gaussian blur with linear sampling\r\nThis technique requires linear filtering on source texture\r\nhttp://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n    blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n    blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n7-tap gaussian blur with sigma\x3d1.5\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.266346;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.038735;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.038735;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap gaussian blur with sigma\x3d2.0\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.202360;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[7]) * 0.028532;\r\n    sum +\x3d texture2D(tex, blurCoordinates[8]) * 0.028532;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap manhattan distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec2 m2 \x3d max(m1.xy, m1.zw);\r\n    float m3 \x3d max(f0, max(m2.x, m2.y));\r\n    gl_FragColor \x3d vec4(m3, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n17-tap manhattan+diagonal distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    vec2 blurSizeD \x3d vec2(blurSize.x * sign(blurSize.x + blurSize.y), blurSize.y * sign(blurSize.x - blurSize.y));\r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n\r\n    blurCoordinates[ 9] \x3d uv + blurSizeD * 1.0;\r\n    blurCoordinates[10] \x3d uv - blurSizeD * 1.0;\r\n    blurCoordinates[11] \x3d uv + blurSizeD * 2.0;\r\n    blurCoordinates[12] \x3d uv - blurSizeD * 2.0;\r\n    blurCoordinates[13] \x3d uv + blurSizeD * 3.0;\r\n    blurCoordinates[14] \x3d uv - blurSizeD * 3.0;\r\n    blurCoordinates[15] \x3d uv + blurSizeD * 4.0;\r\n    blurCoordinates[16] \x3d uv - blurSizeD * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    float f9 \x3d texture2D(tex, blurCoordinates[ 9]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f10 \x3d texture2D(tex, blurCoordinates[10]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f11 \x3d texture2D(tex, blurCoordinates[11]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f12 \x3d texture2D(tex, blurCoordinates[12]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f13 \x3d texture2D(tex, blurCoordinates[13]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f14 \x3d texture2D(tex, blurCoordinates[14]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f15 \x3d texture2D(tex, blurCoordinates[15]).x - 4.0 * 1.41421356237 / 5.0;\r\n    float f16 \x3d texture2D(tex, blurCoordinates[16]).x - 4.0 * 1.41421356237 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec4 m2 \x3d max(vec4(f9,f10,f11,f12), vec4(f13,f14,f15,f16));\r\n    vec4 m3 \x3d max(m1, m2);\r\n    vec2 m4 \x3d max(m3.xy, m3.zw);\r\n    float m6 \x3d max(f0, max(m4.x, m4.y));\r\n    gl_FragColor \x3d vec4(m6, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n(2N+1)^2-tap distance field\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5);\r\n    blurCoordinates \x3d blurSize;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float result \x3d 0.0;\r\n    for (float x\x3d-5.0; x\x3c\x3d5.0; ++x) {\r\n      for (float y\x3d-5.0; y\x3c\x3d5.0; ++y) {\r\n        vec2 duv \x3d vec2(x, y);\r\n        vec2 uv2 \x3d uv + duv * blurCoordinates;\r\n        result \x3d max(result, texture2D(tex, uv2).x - length(duv) / 5.0);\r\n      }\r\n    }\r\n    gl_FragColor \x3d vec4(result, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nMerging blurred halos with source image\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0); \r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform sampler2D origin;\r\n\r\n  uniform vec4 color;\r\n  uniform float exponent;\r\n  uniform float fill;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    // Read the highlight intensity from the blurred highlight image\r\n    float highlight \x3d texture2D(tex, uv).x;\r\n\r\n    // Discard all pixels which are not affected by highlight\r\n    if (highlight \x3d\x3d 0.0) {\r\n      discard;\r\n    }\r\n\r\n    // Discard the interior of highlighted objects, so that only the halo remain\r\n    vec4 origin_color \x3d texture2D(origin, uv);\r\n    if (any(notEqual(origin_color,vec4(0,0,0,0)))) {\r\n      gl_FragColor \x3d vec4(color.xyz, fill);\r\n      return;\r\n    }\r\n\r\n    // Transfer function\r\n    // highlight \x3d pow(highlight, 0.5); // increase contrast, for gaussian blur\r\n    // highlight \x3d pow(highlight, 2.0); // decrease constrast, for manhattan distance\r\n    // highlight \x3d tanh(10*highlight); // test\r\n    highlight \x3d smoothstep(0.0, exponent, highlight);\r\n    // highlight \x3d pow(highlight, exponent);\r\n\r\n    // Blending equation: gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    // I.e., color should not be premultiplied with alpha\r\n    gl_FragColor \x3d vec4(color.xyz, highlight);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/util.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelCenter"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelCenter(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.500123) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 ij \x3d floor(xy * widthHeight);\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 result \x3d (((vec2(.5) + ij) * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[\r\n\tvec4 float2rgba(const in float v) {\r\n\t\tvec4 enc \x3d vec4(1.0, 255.0, 65025.0, 160581375.0) * v;\r\n\t\tenc \x3d fract(enc);\r\n\t\tenc -\x3d enc.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\r\n\t\treturn enc;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\r\n\tfloat rgba2float(vec4 rgba) {\r\n\t\treturn dot(rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcFragDepth"\x3e\x3c![CDATA[\r\n\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\tfloat calcFragDepth(const in float depth) {\r\n\t\t//calc polygon offset\r\n\t\tconst float SLOPE_SCALE \x3d 2.0;\r\n\t\tconst float BIAS \x3d 2.0 * .000015259;\t\t// 1 / (2^16 - 1)\r\n\t\tfloat m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\r\n\t\tfloat result \x3d depth + SLOPE_SCALE * m + BIAS;\r\n\t\treturn clamp(result, .0, .999999);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"evalShadow"\x3e\x3c![CDATA[\r\n\t$rgba2float\r\n\r\n\t// "matrix" parameter used to have const qualifier as well, but IE11 couldn\'t deal with it at time of writing.\r\n\t// once IE11 is fine with it, const should probably be re-introduced\r\n\tfloat evalShadow(const in vec3 vpos, const in float depth, const in sampler2D depthTex, const int num, const in vec4 distance, in mat4 matrix[4], const in float halfPxSz) {\r\n\t\t//choose correct cascade\r\n\t\tint i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\r\n\r\n\t\tif (i \x3e\x3d num) return .0;\r\n\r\n\t\tmat4 mat \x3d i \x3d\x3d 0 ? matrix[0] : i \x3d\x3d 1 ? matrix[1] : i \x3d\x3d 2 ? matrix[2] : matrix[3];\r\n\r\n\t\tvec4 lv \x3d mat * vec4(vpos, 1.0);\r\n\t\tlv.xy /\x3d lv.w;\r\n\r\n\t\t//vertex completely outside? -\x3e no shadow\r\n\t\tvec3 lvpos \x3d .5 * lv.xyz + vec3(.5);\r\n\t\tif (lvpos.z \x3e\x3d 1.0) return .0;\r\n\t\tif (lvpos.x \x3c .0 || lvpos.x \x3e 1.0 || lvpos.y \x3c .0 || lvpos.y \x3e 1.0) return .0;\r\n\r\n\t\t//calc coord in cascade texture\r\n\t\tvec2 uv \x3d vec2(float(i - 2 * (i / 2)) *.5, float(i / 2) * .5) + .5 * lvpos.xy;\r\n\r\n\t\tfloat texSize \x3d .5 / halfPxSz;\r\n\r\n\t\t//filter, offset by half pixels\r\n\t\tvec2 st \x3d fract((vec2(halfPxSz) + uv) * texSize);\r\n\r\n\t\tfloat s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\r\n\t\treturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"normal2envTC"\x3e\x3c![CDATA[\r\n\tvec2 normal2envTC(vec3 normal) {\r\n\t\tfloat v \x3d .5 + .5 * asin(normal.y) * 0.63661977;\r\n\t\tfloat u \x3d .5 - .5 * atan(normal.z, normal.x) * 0.31830988;\r\n\t\treturn vec2(u, v);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderShowDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tattribute vec2 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * vec4($position.x, $position.y, .0, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fragmentShaderShowDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tvarying vec2 vtc;\r\n\t$rgba2float\r\n\tvoid main() {\r\n\t//\tgl_FragColor \x3d vec4(vec3(texture2D(depthTex, vtc).a), 1.0);\r\n\t\tgl_FragColor \x3d vec4(rgba2float(texture2D(depthTex, vtc)));\r\n\t//\tgl_FragColor \x3d texture2D(depthTex, vtc);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsUVQuad"\x3e\x3c![CDATA[\r\n\tattribute vec2 $position;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n\t\tuv \x3d $position * .5 + vec2(.5);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toScreenCoords"\x3e\x3c![CDATA[\r\n\tvec4 toScreenCoords(vec3 vertex) {\r\n\t\tvec4 vClipSpace \x3d proj * view * vec4((model * vec4(vertex, 1.0)).xyz, 1.0);\r\n\t\tvClipSpace.xy *\x3d screenSize;\r\n\t\treturn vClipSpace/abs(vClipSpace.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/BillboardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboard"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tvec3 zDir \x3d normalize(-pos);\r\n\t\tvec3 xDir \x3d normalize(cross(vec3(.0, 1.0, .0), zDir));\r\n\t\tvec3 yDir \x3d cross(zDir, xDir);\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * size;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * size;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBillboard"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec3 lightDirection;\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .15) discard;\r\n\t\tgl_FragColor \x3d texColor;\r\n\t\tgl_FragColor.rgb *\x3d lightAmbient.rgb * lightAmbient.w + lightDiffuse.rgb * lightDiffuse.w * dot(lightDirection, vnormal);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboardDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying float depth;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tpos.x +\x3d (uv01.x - .5) * size;\r\n\t\tpos.y +\x3d (uv01.y - .5) * size;\r\n\t\tvec4 eye \x3d vec4(pos, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\t\tvtc \x3d uv;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/ColorMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n\r\n\tvarying vec4 vColor; \r\n\r\n\tvoid main(void) {\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255;\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vColor * eColor;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/HUDMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"HUDMaterialCommonVariables"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float pixelRatio;\r\n\tuniform vec2 screenOffset;\r\n\tuniform vec2 anchorPos;\r\n\tuniform float polygonOffset;\r\n\tuniform float cameraGroundRelative;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tattribute vec4 $color;\r\n  attribute vec2 $size;\r\n  attribute vec4 $auxpos1;\r\n\r\n\tvarying vec4 vcolor;\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n \tvarying vec4 vtc;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n\tuniform sampler2D framebufferTex;\r\n\tuniform vec3 markerColor;\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelOrigin"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.5) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 ij \x3d floor((xy + .5 * pixelSz) * widthHeight);\r\n\t\tvec2 result \x3d ((ij * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcPosMatchPixelCenter"\x3e\x3c![CDATA[\r\n\r\n\t\tvec3 posModel \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvec3 posView \x3d (view * vec4(posModel, 1.0)).xyz;\r\n\r\n\t\tvec3 vnormal \x3d (modelNormal * vec4($normal, 1.0)).xyz;\r\n\r\n\t\t// groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\r\n\t\tfloat groundRelative \x3d cameraGroundRelative * sign(pointGroundDistance);\r\n\t\tif (groundRelative \x3d\x3d 0.0) groundRelative \x3d 1.0;\r\n\r\n\t\t// view angle dependent part of polygon offset emulation\r\n\t\t// we take the absolute value because the sign that is dropped is\r\n\t\t// instead introduced using the ground-relative position of the symbol and the camera\r\n\t\tfloat cosAlpha \x3d abs(dot(vnormal, normalize(camPos - posModel)));\r\n\t\tif (cosAlpha \x3e .01 \x26\x26 polygonOffset \x3e .0) {\r\n\t\t\tfloat tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\r\n\t\t\tfloat factor \x3d (1.0 - tanAlpha / viewport[2]);\r\n\t\t\t// same side of the terrain\r\n\t\t\tif (groundRelative \x3e 0.0) {\r\n\t\t\t\tposView *\x3d factor;\r\n\t\t\t}\r\n\t\t\t// opposite sides of the terrain\r\n\t\t\telse {\r\n\t\t\t\tposView /\x3d factor;\r\n\t\t\t}\r\n\t\t}\r\n\r\n    \tposView +\x3d centerOffset;\r\n\r\n\t\tvec4 posProj \x3d proj * vec4(posView, 1.0);\r\n\r\n\t\t// constant part of polygon offset emulation\r\n\t\tposProj.z -\x3d groundRelative * polygonOffset * posProj.w;\r\n\r\n\t\tposProjCenter \x3d matchPixelCenter(posProj, viewport.zw);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUD"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\r\n\tvoid main(void) {\r\n\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\r\n\t\tvec2 combinedSize \x3d $size * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tfloat dist \x3d distance(camPos, posModel);\r\n\t\t\tposProj.xy +\x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffset)/ viewport.zw * posProj.w;\r\n\t\t\tvtc.xy \x3d uv;\r\n\t\t\tvsize \x3d $size;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tgl_Position \x3d matchPixelOrigin(posProj, viewport.zw);\r\n\t\tvcolor \x3d $color / 255.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\t    vec2 combinedSize \x3d $size;\r\n\r\n\t    vec4 posProjCenter;\r\n\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tposView.xy +\x3d (uv01 - anchorPos) * combinedSize * scale;\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tposProj \x3d proj * vec4(posView,1.0);\r\n\t\tposProj.xy +\x3d screenOffset / viewport.zw * posProj.w;\r\n\t\tgl_Position \x3d posProj;\r\n\t\tvcolor \x3d $color / 255.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\r\n\x3csnippet name\x3d"calcLabelDirections"\x3e\x3c![CDATA[\r\n\tvec2 uv01 \x3d floor($uv0);\r\n\tvec2 uv \x3d $uv0 - uv01;\r\n\r\n\tvec3 labelDir, labelDirOrtho;\r\n\r\n\tint isUp \x3d 0;\r\n\tvec2 vId \x3d (uv01 - vec2(.5, .5))*2.0;\r\n\r\n\tvec3 viewDirInNormalPlane \x3d normalize(camDir.xyz - dot(camDir.xyz, direction)*direction);\r\n\tfloat angleToNormal \x3d abs(dot(viewDirInNormalPlane,up));\r\n\tfloat angleToDirection \x3d abs(dot(camDir.xyz, direction));\r\n\tif (angleToDirection \x3c 0.985 \x26\x26 angleToNormal \x3c 0.500)\r\n\t{\r\n\t    if (angleToNormal \x3c 0.422) {\r\n\t\t    isUp \x3d 1;\r\n\t\t    labelDir \x3d direction;\r\n\t\t    labelDirOrtho \x3d up;\r\n\t\t    vId.y +\x3d 0.5;\r\n\t\t} else {\r\n\t\t    labelDir \x3d direction;\r\n            labelDirOrtho \x3d cross(viewDirInNormalPlane, direction);\r\n            vId.y +\x3d dot(labelDirOrtho, up)*0.5;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tlabelDir \x3d direction;\r\n\t\tlabelDirOrtho \x3d normalize(cross(up,direction));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirection"\x3e\x3c![CDATA[\r\n  $HUDMaterialCommonVariables\r\n  uniform vec3 direction;\r\n\r\n  $matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\t    vec2 combinedSize \x3d $size * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n \t\t$calcPosMatchPixelCenter\r\n\r\n \t\tvec3 up \x3d vnormal;\r\n \t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n #ifdef OCCL_TEST\r\n \t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n #endif\r\n\r\n \t\t\t$calcLabelDirections\r\n\r\n\t\t    float scale;\r\n\t\t    if (proj[2][3] !\x3d 0.0)  // perspective projection\r\n \t\t\t    scale \x3d posProj.w*0.5/viewport[2];\r\n \t\t\telse                    // othographic projection\r\n \t\t\t    scale \x3d 2.0/proj[0][0]/viewport[2];\r\n\r\n \t\t\tposModel.xyz +\x3d labelDir * vId.x * combinedSize.x * scale ;\r\n \t\t\tposModel.xyz +\x3d labelDirOrtho * vId.y * combinedSize.y * scale;\r\n\r\n      // capability to flip upside down was lost when label texture atlases were implemented. this was the old code:\r\n \t\t\t//vec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n \t\t\t//vec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\t//if (posDirProj.x \x3c posProjUnmodified.x)\r\n \t\t\t//{\r\n \t\t\t//\tif (isUp\x3d\x3d1)\r\n \t\t\t//\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t//\telse\r\n \t\t\t//\t\tuv \x3d texScale-uv;\r\n \t\t\t//}\r\n \t\t\tvtc.xy \x3d uv;\r\n #ifdef OCCL_TEST\r\n \t\t} else {\r\n \t\t\tvtc \x3d vec2(.0);\r\n \t\t}\r\n #endif\r\n\r\n #ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n \t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n \t\tgl_Position \x3d pos4;\r\n \t\tvcolor \x3d $color / 255.0;\r\n \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirectionWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\tuniform vec3 direction;\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\r\n\tvoid main(void) {\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\t    vec2 combinedSize \x3d $size;\r\n\r\n        vec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n\t\tvec3 up \x3d vnormal;\r\n\t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\r\n\t\t\t$calcLabelDirections\r\n\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d minMaxWorldSizeFactor;\r\n\t\t\tif (proj[2][3] !\x3d 0.0)  // perspective projection\r\n\t\t\t\tminMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d 0.5 * minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d 0.5 * min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tposModel.xyz +\x3d labelDir*vId.x*combinedSize.x*scale;\r\n\t\t\tposModel.xyz +\x3d labelDirOrtho*vId.y*combinedSize.y*scale;\r\n\r\n      // capability to flip upside down was lost when label texture atlases were implemented. this was the old code:\r\n\t\t\t//vec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n\t\t\t//vec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\t//if (posDirProj.x\x3cposProjUnmodified.x)\r\n \t\t\t//{\r\n \t\t\t//\tif (isUp\x3d\x3d1)\r\n \t\t\t//\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t//\telse\r\n \t\t\t//\t\tuv \x3d texScale-uv;\r\n \t\t\t//}\r\n \t\t\t//uv.y +\x3d (1.0 - texScale.y);\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvcolor \x3d $color / 255.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDBase"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t#extension GL_OES_standard_derivatives : require\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 overrideColor;\r\n\tuniform vec4 outlineColor;\r\n\tuniform float outlineSize;\r\n\r\n\tvarying vec4 vcolor;\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvarying vec4 vtc;\r\n\tuniform vec3 markerColor;\r\n\tuniform sampler2D framebufferTex;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n#endif\r\n\r\n\tvoid main() {\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n   \t\tif (texture2D(framebufferTex, vtc.zw).rgb !\x3d markerColor)\r\n   \t\t\tdiscard;\r\n#endif\r\n\r\n#ifdef SIGNED_DISTANCE_FIELD\r\n\t\tvec4 color \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n\t\tvec4 fillPixelColor \x3d overrideColor * vcolor;\r\n\r\n\t\t// Distance in [-0.5, 0.5]\r\n\t\tfloat d \x3d dot(texture2D(tex, vtc), vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0)) - 0.5;\r\n\t\t// Distance in output units\r\n\t\tfloat dist \x3d d * vsize.x;\r\n\r\n\t\tfillPixelColor.a *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n\t\tif (outlineSize \x3e 0.25) {\r\n\t\t\tvec4 outlinePixelColor \x3d outlineColor;\r\n\t\t\tfloat clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\r\n\t\t\toutlinePixelColor.a *\x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\r\n\r\n\t\t\t// perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\r\n\t\t\tfloat compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tvec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\r\n\t\t\t\tvec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tcompositeColor /\x3d compositeAlpha;\r\n\r\n\t\t\tgl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tgl_FragColor \x3d fillPixelColor;\r\n\t\t}\r\n\r\n\t\t// visualize SDF:\r\n\t\t// gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d texture2D(tex, vtc, -0.5) * overrideColor * vcolor;\r\n#endif\r\n\r\n\t\tif (gl_FragColor.a \x3c 0.1) {\r\n\t\t\tdiscard;\r\n\t\t}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUD"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDHighlight"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderOcclusionTestPixel"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float polygonOffset;\r\n\tuniform float cameraGroundRelative;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec4 $auxpos1;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\t\tfloat pointGroundDistance \x3d $auxpos1.w;\r\n\r\n\t    vec4 posProjCenter;\r\n\t    if (dot($position, $position) \x3e 0.0) {\r\n\t\t    $calcPosMatchPixelCenter\r\n\t\t} else {\r\n\t\t    posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\r\n\t\t}\r\n\r\n\t\tgl_Position \x3d posProjCenter;\r\n\t\tgl_PointSize \x3d 1.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/LeafCardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCard"\x3e\r\n\t\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $normal;\r\n\tattribute vec4 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tuniform float trafoScale;\r\n\tvarying vec3 vpos;\r\n\r\n\t// TODO optimize?\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tvoid main(void) {\r\n\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0.xy);\r\n\t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w *trafoScale;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w *trafoScale;;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tambientLeaf \x3d normal.w;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal.xyz, 1.0)).xyz);\r\n\t}\r\n]]\x3e\r\n\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderLeafCard"\x3e\r\n\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\tvec3 a \x3d ambient * lightAmbient.rgb * lightAmbient.w;\r\n\t\tvec3 d \x3d diffuse * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(vnormal, lightDirection), .0, 1.0);\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(vpos - camPos, vnormal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n\t\tgl_FragColor \x3d vec4(ambientLeaf * texColor.rgb * (a + d) + s, texColor.a);\r\n\r\n\t\t//gl_FragColor \x3d vec4(ambient,1.0);\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCardDepth"\x3e\x3c![CDATA[\r\n   \tuniform mat4 proj;\r\n   \tuniform mat4 view;\r\n   \tuniform mat4 model;\r\n   \tuniform vec2 nearFar;\r\n\r\n   \tattribute vec3 $position;\r\n   \tattribute vec4 $uv0;\r\n\r\n   \tuniform float trafoScale;\r\n\r\n   \tvarying vec2 vtc;\r\n   \tvarying float depth;\r\n\r\n   \t// TODO optimize?\r\n   \tvec2 rotate(vec2 pos, float angle) {\r\n   \t\tfloat c \x3d cos(angle);\r\n   \t\tfloat s \x3d sin(angle);\r\n   \t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n   \t}\r\n\r\n   \tvoid main(void) {\r\n   \t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n   \t\tvec2 uv01 \x3d floor($uv0.xy);\r\n   \t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n   \t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w*trafoScale;\r\n   \t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w*trafoScale;\r\n   \t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n   \t\tgl_Position \x3d pos4;\r\n   \t\tvtc \x3d uv;\r\n\r\n   \t\tdepth \x3d (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\r\n   \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/Material.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n    attribute mat4 model;\r\n    attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n    attribute vec4 instanceColor;\r\n#endif\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n\r\n#ifdef VERTEXCOLORS\r\n    attribute vec4 $color;\r\n#endif\r\n\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n    varying vec4 vcolor;\r\n#endif\r\n\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n        vcolor \x3d vec4(1,1,1,1);\r\n#endif\r\n#ifdef VERTEXCOLORS\r\n        vcolor *\x3d $color * 0.003921568627451; // \x3d 1/255\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n        vcolor *\x3d instanceColor;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform vec3 camPos;\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\tuniform float opacity;\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\tuniform sampler2D ssaoTex;\r\n\tuniform vec4 viewportPixelSz;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n    varying vec4 vcolor;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n\tvoid main() {\r\n\t\tvec3 a \x3d ambient * lightAmbient.rgb * lightAmbient.w;\r\n\r\n\t\tvec3 viewDir \x3d normalize(vpos - camPos);\r\n\r\n#ifndef DOUBLESIDED\r\n\t\tvec3 normal \x3d vnormal;\r\n#else\r\n\t\tvec3 normal \x3d dot(vnormal, viewDir)\x3e0.0?-vnormal:vnormal;\r\n#endif\r\n\r\n    \tnormal \x3d normalize(normal);\r\n\t\tfloat shadow \x3d 0.0;\r\n#ifdef RECEIVE_SHADOWS\r\n\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n#endif\r\n\t\tvec3 d \x3d (1.0 - shadow) * diffuse * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(normal, lightDirection), .0, 1.0);\r\n\r\n\t\tfloat opacity_ \x3d opacity;\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n        a *\x3d vcolor.rgb;\r\n        d *\x3d vcolor.rgb;\r\n        opacity_ *\x3d vcolor.a;\r\n#endif\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(viewDir, normal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d (1.0 - shadow) * specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n\t\tfloat ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n\t\tssao \x3d viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhong"\x3e\x3c![CDATA[\r\n\t$vsPhongSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhong"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t$fsPhongSrc\r\n\t\tgl_FragColor \x3d vec4(ssao * (a + d) + s, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tgl_FragColor \x3d vec4(ssao * texColor.rgb * (a + d) + s, texColor.a * opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tattribute vec4 $uv0;\r\n\tattribute vec4 $region;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0.xy;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t    regionV \x3d $region/65535.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec2 texSize;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\r\n\t float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\r\n\t\t// from:\r\n\t\t//   - OpenGLES Common Profile Specification Version 2.0.25, Section 3.7.7 - Texture Minification\r\n\t\t//   - https://www.opengl.org/discussion_boards/showthread.php/171485-Texture-LOD-calculation-(useful-for-atlasing)\r\n\t\t//   - http://www.linedef.com/virtual-texture-demo.html\r\n\t\tfloat deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\r\n\t\treturn max(0.5 * log2(deltaMaxSqr), 0.0);\r\n\t}\r\n\r\n\t$fsPhongSrc\r\n\t\tvec2 uv \x3d vtc;\r\n\t\tuv \x3d fract(uv);\r\n\t\t//[umin, vmin, umax, vmax]\r\n\r\n\t\tvec2 atlasScale \x3d regionV.zw - regionV.xy;\r\n\t\tuv \x3d uv.xy * atlasScale + regionV.xy;\r\n\r\n\t\tvec4 texColor;\r\n\t\t#ifdef GL_OES_standard_derivatives\r\n\t\t\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\t\t\t// calculate derivative of continuous texture coordinate\r\n\t\t\t// to avoid mipmapping artifacts caused by manual wrapping in shader\r\n\t\t\tvec2 dUVdx \x3d dFdx(vtc) * atlasScale;\r\n\t\t\tvec2 dUVdy \x3d dFdy(vtc) * atlasScale;\r\n\r\n\t\t\t#ifdef GL_EXT_shader_texture_lod\r\n\t\t\t\t#extension GL_EXT_shader_texture_lod : enable\r\n\r\n\t\t\t\t// workaround for artifacts in Windows 10 using Intel HD Graphics 4000 series\r\n\t\t\t\t// see: https://devtopia.esri.com/Zurich-R-D-Center/arcgis-js-api-canvas3d-issues/issues/768\r\n\t\t\t\tconst float epsilon \x3d 1.0E-32;\r\n\t\t\t\tfloat zeroUVShift \x3d uv.x \x3d\x3d 0.0 \x26\x26 uv.y \x3d\x3d 0.0 ? epsilon : 0.0;\r\n\r\n\t\t\t\ttexColor \x3d texture2DGradEXT(tex, uv + zeroUVShift, dUVdx, dUVdy);\r\n\t\t\t#else\r\n\t\t\t\t// use bias to compensate for difference in automatic vs desired mipmap level\r\n\t\t\t\tvec2 dUVdxAuto \x3d dFdx(uv);\r\n\t\t\t\tvec2 dUVdyAuto \x3d dFdy(uv);\r\n\t\t\t\tfloat mipMapLevel \x3d calcMipMapLevel(dUVdx * texSize, dUVdy * texSize);\r\n\t\t\t\tfloat autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * texSize, dUVdyAuto * texSize);\r\n\t\t\t\ttexColor \x3d texture2D(tex, uv, mipMapLevel - autoMipMapLevel);\r\n\t\t\t#endif\r\n\t\t#else\r\n\t\t\ttexColor \x3d texture2D(tex, uv);\r\n\t\t#endif\r\n\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tgl_FragColor \x3d vec4(ssao * texColor.rgb * (a + d) + s, texColor.a * opacity_);\r\n\t\t//gl_FragColor \x3d regionV;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTexturedRefl"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform sampler2D reflTex;\r\n\tuniform float reflectivity;\r\n\tvarying vec2 vtc;\r\n\r\n\t$normal2envTC\r\n\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tvec4 reflColor \x3d texture2D(reflTex, normal2envTC(reflDir));\r\n\t\tgl_FragColor \x3d vec4(ssao * mix(texColor.rgb * (a + d), reflColor.rgb * lightAmbient.rgb*lightSpecular.w, reflectivity) + s, texColor.a * opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tvarying float depth;\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 eye \x3d view * model * vec4($position, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepth"\x3e\x3c![CDATA[\r\n\t$vsDepthSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsDepthSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 viewNormal;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vec4($normal, 1.0)).xyz);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormal"\x3e\x3c![CDATA[\r\n\t$vsNormalSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsNormalSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlight"\x3e\x3c![CDATA[\r\n\t$vsHighlightSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsHighlightSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n    vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthSrc"\x3e\x3c![CDATA[\r\n\tvarying float depth;\r\n\r\n\tvoid main() {\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\t$fsDepthSrc\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\r\n\t$fsDepthSrc\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormal"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvoid main() {\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormalTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlight"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n    gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/RibbonLineMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsRibbonLine"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tuniform float extLineWidth;\r\n\tuniform float nearPlane;\r\n\r\n\tattribute vec3 $position;\t\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tattribute vec4 $color;\r\n\tvarying vec4 vColor;\r\n\r\n\tattribute float size;\r\n\r\n#ifndef WALL\r\n\tuniform float miterLimit;\r\n\tattribute vec3 $auxpos1;\r\n\tattribute vec3 $auxpos2;\r\n#endif\r\n\r\n#ifdef SCREENSCALE\r\n\tuniform vec2 screenSize;\r\n\t$toScreenCoords\r\n#define VECTYPE vec2\r\n#define ZEROVEC vec2(0.0, 0.0)\r\n#define PERPENDICULAR(v) vec2(v.y, -v.x);\r\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*$uv0.y \x3e 0.0\r\n\r\n#else //ifdef SCREENSCALE\r\n\r\n#define VECTYPE vec3\r\n#define ZEROVEC vec3(0.0, 0.0, 0.0)\r\n// these macros are only valid for "strip" type lines:\r\n#define PERPENDICULAR(v) cross(up/*vec3(0.0, 1.0, 0.0)*/, v)\r\n#define ISOUTSIDE dot(cross(left, right), up/*vec3(0.0, 1.0, 0.0)*/)*$uv0.y \x3c 0.0\r\n\r\n#endif //ifdef SCREENSCALE\r\n\r\n\tfloat interp(float ncp, vec4 a, vec4 b) {\r\n\t\treturn (-ncp - a.z) / (b.z - a.z);\r\n\t}\r\n\r\n#ifdef SCREENSCALE\r\n\r\n  void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next) {\r\n\t\tfloat vnp \x3d nearPlane*0.99;\r\n\r\n\t\t//We have four vertices per point on the line. Start and end vertices \r\n\t\t//are treated differently --\x3e d \x3e 0, d \x3c 0\r\n\t\tfloat d \x3d abs($uv0.y) - 1.1;\r\n\r\n\t\t//current pos behind ncp --\x3e we need to clip\r\n\t\tif(pos.z \x3e -nearPlane) {\t\t\t\r\n\t\t\tif (d \x3c 0.0) {\r\n\t\t\t\t//previous in front of ncp\r\n\t\t\t\tif(prev.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(prev, pos, interp(vnp, prev, pos));\r\n\t\t\t\t\tnext \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t  pos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t\t//next in front of ncp\r\n\t\t\tif(d \x3e 0.0) {\r\n\t\t\t\tif(next.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(pos, next, interp(vnp, pos, next));\r\n\t\t\t\t\tprev \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\telse { \r\n\t\t\t//current position visible \r\n\t\t\t//previous behind ncp\r\n\t\t\tif (prev.z \x3e -nearPlane) {\t\t\t\t\r\n\t\t\t\tprev \x3d mix(pos, prev, interp(vnp, pos, prev));\t\t\t\t\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t//next behind ncp\r\n\t\t\tif (next.z \x3e -nearPlane) {\r\n\t\t\t\tnext \x3d mix(next, pos, interp(vnp, next, pos));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpos\x3d proj * pos;\r\n\t\tpos.xy *\x3d screenSize;\r\n\t\tpos /\x3d pos.w;\r\n\r\n\t\tnext \x3d proj * next;\r\n\t\tnext.xy *\x3d screenSize;\r\n\t\tnext /\x3d next.w;\r\n\r\n\t\tprev \x3d proj * prev;\r\n\t\tprev.xy *\x3d screenSize;\r\n\t\tprev /\x3d prev.w;\t\t\r\n  }\r\n\r\n#endif // SCREENSCALE\r\n\r\n\tvoid main(void) {\r\n\r\n\tfloat lineWidth \x3d extLineWidth + $size; \r\n\r\n#ifdef SCREENSCALE\r\n\r\n#if 0\r\n\t\tvec4 pos \x3d toScreenCoords($position.xyz);\r\n\t\tvec2 left \x3d (pos - toScreenCoords($auxpos1)).xy;\r\n\t\tvec2 right \x3d (toScreenCoords($auxpos2) - pos).xy;\r\n#else\r\n\t\tvec4 pos  \x3d view * vec4((model * vec4($position.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 prev \x3d view * vec4((model * vec4($auxpos1.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 next \x3d view * vec4((model * vec4($auxpos2.xyz, 1.0)).xyz, 1.0); \r\n\r\n\t\tclipAndTransform(pos, prev, next);\r\n\r\n\t\tvec2 left \x3d (pos - prev).xy;\r\n\t\tvec2 right \x3d (next - pos).xy;\r\n#endif\r\n\r\n#else // ifdef SCREENSCALE\r\n\t\tvec4 pos \x3d vec4($position, 1.0);\r\n#ifndef WALL\r\n\t\tvec3 left \x3d $position.xyz - $auxpos1;\r\n\t\tvec3 right \x3d $auxpos2 - $position.xyz;\r\n\t\tvec3 up \x3d normalize($position.xyz);\r\n#endif // ifndef WALL\r\n#endif // ifdef SCREENSCALE\r\n\r\n#ifdef WALL\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tvec3 displacementDir \x3d normalize($position.xyz);//vec3(0.0, 1.0, 0.0);\r\n#else // ifdef WALL\r\n\r\n\t\tfloat leftLen \x3d length(left);\r\n\t\tleft \x3d (leftLen \x3e 0.001) ? left/leftLen : ZEROVEC;\r\n\r\n\t\tfloat rightLen \x3d length(right);\r\n\t\tright \x3d (rightLen \x3e 0.001) ? right/rightLen : ZEROVEC;\r\n\r\n\t\t// determine if vertex is on the "outside or "inside" of the join\r\n\t\tbool isOutside \x3d ISOUTSIDE;\r\n\r\n\t\t// compute miter join position first\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tVECTYPE displacementDir \x3d normalize(left + right);\r\n\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\tif (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\r\n\t\t\tfloat nDotSeg \x3d dot(displacementDir, left);\r\n\t\t\tdisplacementLen /\x3d length(nDotSeg*left - displacementDir);\r\n\r\n\t\t\t// limit displacement of inner vertices\r\n\t\t\tif (!isOutside)\r\n\t\t\t\tdisplacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\r\n\t\t}\r\n\r\n\t\tif (isOutside \x26\x26 (displacementLen \x3e miterLimit*lineWidth)) {\r\n\t\t\t// convert to bevel join if miterLimit is exceeded\r\n\t\t\tif (leftLen \x3c 0.001)\r\n\t\t\t    displacementDir \x3d right;\r\n\t\t\telse if (rightLen \x3c 0.001)\r\n\t\t\t\tdisplacementDir \x3d left;\r\n\t\t\telse\r\n\t\t\t\tdisplacementDir \x3d (abs($uv0.y) - 1.1 \x3c 0.0) ? left : right;\r\n\t\t\tdisplacementDir \x3d normalize(displacementDir);\r\n\t\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\t\tdisplacementLen \x3d lineWidth;\r\n\t\t}\r\n\r\n#endif // ifdef WALL\r\n\r\n#ifdef SCREENSCALE\r\n\t\tpos.xy +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos.xy /\x3d screenSize;\r\n#else\r\n\t\tpos.xyz +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos \x3d proj * view * model * pos;\r\n#endif\r\n\r\n\t\tvtc \x3d $uv0;\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n\t\tgl_Position \x3d pos;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsRibbonLine"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d eColor * vColor;\r\n\t\t//gl_FragColor.a \x3d 1;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/WaterMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderWater"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderWater"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 color;\r\n\tuniform float scale;\r\n\tuniform float speed;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform sampler2D noiseTex;\r\n\tuniform sampler2D reflTex;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\t$evalShadow\r\n\r\n\t$normal2envTC\r\n\r\n\t// TODO optimize?\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tfloat compDelta(vec2 pos) {\r\n\t\tconst float PI_THIRD \x3d 1.04719755;\r\n\r\n\t\tfloat result \x3d .0;\r\n\t\tfloat s \x3d 1.0;\r\n\t\tfor (int i \x3d 0; i \x3c 6; ++i) {\r\n\t\t\tvec2 tc \x3d pos / (20.0 * s);\r\n\t\t\ttc +\x3d rotate(vec2(1.0 + speed, .0), PI_THIRD * float(i));\r\n\t\t\tresult +\x3d s * texture2D(noiseTex, tc).r;\r\n\t\t\ts *\x3d 1.5;\r\n\t\t}\r\n\t\treturn result * scale * .2;\r\n\t}\r\n\r\n\tvoid main() {\r\n\t\tvec3 viewVec \x3d normalize(camPos - vpos);\r\n\r\n\t\tfloat d0 \x3d compDelta(vpos.xz);\r\n\t\tfloat dx \x3d compDelta(vpos.xz + vec2(.05, .0));\r\n\t\tfloat dz \x3d compDelta(vpos.xz + vec2(.0, .05));\r\n\r\n\t\tvec3 normal \x3d normalize(vec3(d0 - dx, .05, d0 - dz));\r\n\r\n\t\tfloat fresnel \x3d clamp(1.0 - 1.25 * dot(viewVec, normal), .0, 1.0);\r\n\r\n\t\tfloat shadow \x3d 0.0;\r\n\t\tif (halfPxSz \x3e\x3d .0) {\r\n\t\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\t\t}\r\n\r\n\t\tvec3 reflDir \x3d reflect(-viewVec, normal);\r\n\t\tif (reflDir.y \x3c .02) reflDir.y \x3d 0.04 - reflDir.y;\r\n\r\n\t\tvec3 reflCol \x3d texture2D(reflTex, normal2envTC(reflDir)).rgb * lightAmbient.rgb*lightSpecular.w;\r\n\t\treflCol *\x3d .5 + max(lightDirection.y, .0) * .5; // ?\t+\r\n\t\tvec3 waterColor \x3d color * (lightAmbient.rgb * lightAmbient.w + (1.0 - shadow) * max(lightDirection.y, .0) * lightDiffuse.rgb * lightDiffuse.w);\r\n\t\tvec3 finalColor \x3d mix(waterColor, reflCol, .15 + .6 * fresnel);\r\n\r\n\t\tvec3 spec \x3d pow(max(dot(reflDir, lightDirection), .001), 80.0) * lightSpecular.rgb * lightSpecular.w * 2.0;\r\n\t\tfinalColor +\x3d (1.0 - shadow) * lightDiffuse.w * spec;\r\n\r\n\t\tgl_FragColor \x3d vec4(finalColor, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/BlendLayers.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBlendLayers"\x3e\x3c![CDATA[\t\t\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\t\r\n\tuniform float scale;\r\n\tuniform vec2 offset;\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\t\t\r\n\t\tgl_Position \x3d vec4($position, 1.0);\r\n\t\tuv \x3d $uv0 * scale + offset;;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBlendLayers"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec2 uv;\r\n\t\r\n\tuniform sampler2D tex;\t\r\n\tuniform float opacity;\r\n\r\n\tvoid main() {\r\n\t\tvec4 color \x3d texture2D(tex, uv);\t\t\r\n\t\tgl_FragColor \x3d vec4(color.xyz, color.a * opacity);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/terrain/TerrainMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform vec3 origin;\r\n  uniform vec2 texOffset;\r\n  uniform float texScale;\r\n  uniform mat4 viewNormal;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  uniform vec3 lightDirection;\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n#ifdef OVERLAY\r\n  uniform vec2 overlayTexOffset;\r\n  uniform vec2 overlayTexScale;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n  void main(void) {\r\n    vpos \x3d $position;\r\n\r\n#ifdef SPHERICAL\r\n    vnormal \x3d normalize(vpos + origin);\r\n#else\r\n    vnormal \x3d vec3(0, 0, 1); // WARNING: up-axis dependent code\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n    wpos \x3d (view * vec4(vpos, 1.0)).xyz;\r\n    wnormal \x3d (viewNormal * vec4(normalize(vpos+origin), 1.0)).xyz;\r\n    wlight \x3d (view  * vec4(lightDirection, 1.0)).xyz;\r\n#endif\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n    vuv \x3d $uv0;\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n    vtc \x3d $uv0*texScale + texOffset;\r\n\r\n#ifdef OVERLAY\r\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainCommon"\x3e\x3c![CDATA[\r\n  uniform vec3 lightDirection;\r\n  uniform vec3 viewDirection;\r\n  uniform sampler2D depthTex;\r\n  uniform int shadowMapNum;\r\n  uniform vec4 shadowMapDistance;\r\n  uniform mat4 shadowMapMatrix[4];\r\n  uniform float depthHalfPixelSz;\r\n  uniform sampler2D ssaoTex;\r\n  uniform vec4 viewportPixelSz;\r\n  uniform sampler2D tex;\r\n  uniform float opacity;\r\n\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n  varying vec2 vtc;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n  const vec3 ambient \x3d vec3(0.2,0.2,0.2);\r\n  const vec3 diffuse \x3d vec3(0.8,0.8,0.8);\r\n  const float diffuseHardness \x3d 2.5;\r\n\r\n#ifdef OVERLAY\r\n  uniform sampler2D overlayTex;\r\n  uniform float overlayOpacity;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n  float lum(vec3 c) {\r\n    float max \x3d max(max(c.r, c.g), c.b);\r\n    float min \x3d min(min(c.r, c.g), c.b);\r\n    return (min + max) * 0.5;\r\n  }\r\n\r\n#ifdef ATMOSPHERE\r\n  vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\r\n    vec3 surfaceColor   \x3d vec3(0.0);\r\n    vec3 fuzzySpecColor \x3d vec3(1.0);\r\n    vec3 subColor       \x3d vec3(0.0);\r\n    float rollOff       \x3d 1.0;\r\n\r\n    vec3 Ln \x3d normalize(lightPos);\r\n    vec3 Nn \x3d normalize(normal);\r\n    vec3 Hn \x3d normalize(view + Ln);\r\n\r\n    float ldn \x3d dot(Ln, Nn);\r\n    float diffComp \x3d max(0.0, ldn);\r\n    float vdn \x3d 1.0 - dot(view, Nn);\r\n    float ndv \x3d dot(view, Ln);\r\n\r\n    vec3 diffContrib \x3d surfaceColor * diffComp;\r\n    float subLamb \x3d max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));\r\n\r\n    vec3 subContrib \x3d subLamb * subColor;\r\n    vec3 vecColor \x3d vec3(vdn);\r\n\r\n    vec3 diffuseContrib \x3d (subContrib + diffContrib);\r\n    vec3 specularContrib \x3d (vecColor * fuzzySpecColor);\r\n\r\n    return (diffContrib + specularContrib) * rollOff;\r\n  }\r\n#endif\r\n\r\n  void main() {\r\n    vec3 a \x3d ambient;\r\n\r\n    float shadow \x3d 0.0;\r\n#ifdef RECEIVE_SHADOWS\r\n    shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n#endif\r\n    float vndl \x3d dot(normalize(vnormal), lightDirection);\r\n    float k \x3d smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\r\n    vec3 d \x3d (1.0 - shadow/1.8) * diffuse * k;\r\n\r\n    float ssao \x3d viewportPixelSz.w \x3c .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n    vec4 texVal \x3d texture2D(tex, vtc);\r\n    vec3 texCol \x3d texVal.rgb;\r\n    float texAlpha \x3d texVal.a;\r\n\r\n#ifdef OVERLAY\r\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\r\n      vec4 overlayTexCol \x3d texture2D(overlayTex, vtcOverlay);\r\n      overlayTexCol *\x3d overlayOpacity;\r\n      texCol \x3d texCol*(1.0-overlayTexCol.a) + overlayTexCol.rgb; // overlayTexCol has pre-multiplied alpha\r\n      texAlpha \x3d overlayTexCol.a + (1.0 - overlayTexCol.a) * texAlpha;\r\n    }\r\n#endif\r\n\r\n    vec3 atm \x3d vec3(0.0);\r\n#ifdef ATMOSPHERE\r\n    float ndotl \x3d max(0.0, min(1.0, vndl));\r\n    atm \x3d atmosphere(wlight, wnormal, -viewDirection);\r\n    atm *\x3d max(0.0, min(1.0, (1.0-lum(texCol)*1.5))); //avoid atmosphere on bright base maps\r\n    atm *\x3d max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\r\n#endif\r\n    vec3 color \x3d atm + texCol * (a + d) * ssao;\r\n    gl_FragColor \x3d vec4(color, texAlpha * opacity);\r\n\r\n  // closing } is missing here, it\'s in the shaders using this snippet below\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainWireframe"\x3e\x3c![CDATA[\r\n#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\n  precision mediump float;\r\n\r\n  struct WireframeSettings {\r\n    float width;\r\n    float falloff;\r\n    float subdivision;\r\n    vec4 color;\r\n    float wireOpacity;\r\n    float surfaceOpacity;\r\n    float near;\r\n    float far;\r\n  };\r\n\r\n  uniform WireframeSettings wireframe;\r\n\r\n    $fsTerrainCommon\r\n\r\n    vec2 dVuv;\r\n    vec2 vuvScaled \x3d vuv * wireframe.subdivision;\r\n    vec2 vuvMod \x3d fract(vuvScaled);\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    dVuv \x3d fwidth(vuvScaled);\r\n#else\r\n    // Something that reasonably works\r\n    dVuv \x3d vec2(0.05);\r\n#endif\r\n\r\n    vec2 edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                                  wireframe.width * dVuv, min(vuvMod, 1.0 - vuvMod));\r\n\r\n    float edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n#ifdef WIREFRAME\r\n    gl_FragColor \x3d vec4(mix(gl_FragColor.rgb, wireframe.color.rgb, edgeFactor * wireframe.color.a),\r\n                        mix(wireframe.surfaceOpacity, wireframe.wireOpacity, edgeFactor));\r\n#endif\r\n\r\n\r\n#ifdef TILE_BORDERS\r\n    dVuv \x3d fwidth(vuv);\r\n    edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                              wireframe.width * dVuv, min(vuv, 1.0 - vuv));\r\n    edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n    gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n    $fsTerrainCommon\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainNormal"\x3e\x3c![CDATA[\r\n  uniform vec3 origin;\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform mat4 viewNormal;\r\n  attribute vec3 $position;\r\n  varying vec3 vnormal;\r\n\r\n  void main(void) {\r\n#ifdef SPHERICAL\r\n    vec4 normal \x3d vec4(normalize($position + origin), 1.0);\r\n#else\r\n    vec4 normal \x3d vec4(0.0, 1.0, 0.0, 1.0);\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n    vnormal \x3d normalize((viewNormal * normal).xyz);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n  attribute vec3 $position;\r\n\r\n  void main() {\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  void main() {\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"*noref":1}});
define("../core/declare ../core/accessorSupport/watch dojo/_base/lang dojo/_base/kernel dojo/dom dojo/Deferred dojo/when ./View ./ViewAnimation ../geometry/SpatialReference ../geometry/support/webMercatorUtils ../geometry/support/scaleUtils ../Camera ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ../Viewpoint ../core/Scheduler ../core/sniff ../core/watchUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/HandleRegistry ../webscene/Environment ./3d/environment/SceneViewEnvironment ./3d/environment/SceneViewEnvironmentManager ./3d/constraints/SceneViewConstraints ./3d/lib/glMatrix ./3d/support/cameraUtils ./3d/support/viewpointUtils ./3d/support/projectionUtils ./3d/webgl-engine/Stage ./3d/webgl-engine/lib/Selector ./3d/support/RenderCoordsHelper ./3d/support/MapCoordsHelper ./3d/support/ResourceController ./3d/support/DisplayQualityProfile ./3d/support/QualitySettings ./3d/support/SharedSymbolResources ./3d/terrain/TerrainSurface ./3d/terrain/terrainUtils ./3d/layers/graphics/LabelManager ./3d/layers/GraphicsView3D ./3d/navigation/spherical/NavigationSpherical ./3d/navigation/planar/NavigationPlanar ./3d/navigation/EventController ./3d/support/Frustum ./ui/3d/DefaultUI3D".split(" "),function(q,
n,k,f,c,b,a,e,h,g,d,m,l,p,s,r,t,u,v,C,y,x,B,z,A,w,D,E,H,G,I,O,J,F,K,T,R,da,S,ba,aa,$,Z,M,V,L,U,N,Q){function P(a,b){return function(){return this._internallyReady?b.apply(this,arguments):this._get(a)}}function X(a,b){return function(c){if(this._internallyReady)return b.apply(this,arguments);this._initialProps[a]=c;this._set(a,c);ma[a]&&this.notifyChange("initialExtentRequired")}}var ca=B.getLogger("esri.views.SceneView"),Y=H.vec3d,fa=Y.create();B=new p(0,0,0);var ea=new l(new p(0,0,0)),ia={point:B,
retval:null},ha={heading:0,tilt:0},ma={camera:["viewpoint"],viewpoint:["extent"],extent:["center","scale"],scale:["zoom"],center:[],zoom:[]},ka=Object.keys(ma);return q(e,{declaredClass:"esri.views.SceneView",properties:{animation:{type:h,value:null},basemapTerrain:{readOnly:!0,value:null},camera:{copy:function(a,b){a.position.x=b.position.x;a.position.y=b.position.y;a.position.z=b.position.z;a.position.spatialReference=b.position.spatialReference;a.heading=b.heading;a.tilt=b.tilt},type:l},canvas:{readOnly:!0,
value:null},center:{copy:function(a,b){if(!a)return b.clone();a.x=b.x;a.y=b.y;a.z=b.z;a.spatialReference=b.spatialReference;return a},type:p},clippingArea:{type:s,dependsOn:["map.clippingArea","map.clippingEnabled","viewingMode"],get:function(){if("global"===this.viewingMode)return null;if(this._userClippingArea)return this._userClippingArea;var a=this.get("map.clippingEnabled"),b=this.get("map.clippingArea");if(!a||!b)return this._clippingArea=null;if(!(b instanceof s))return console.error("Only clippingArea geometries of type Extent are supported"),
this._clippingArea;if(d.canProject(b.spatialReference,this.spatialReference))b=d.project(b,this.spatialReference);else return console.error("Setting clippingArea with incompatible SpatialReference."),this._clippingArea;return this._clippingArea&&b&&this._clippingArea.equals(b)?this._clippingArea:this._clippingArea=b},set:function(a){this._userClippingArea=a;this._set("clippingArea",a)}},constraints:{type:E,value:null},dataExtent:{dependsOn:["basemapTerrain.extent","clippingArea","map"],readOnly:!0,
get:function(){function a(f){if(f&&(f=d.project(f,c)))e&&(f=f.intersection(e)),f&&b.push(f)}var b=[],c=this.spatialReference||g.WGS84,e=this.clippingArea;e&&(e=d.project(e,c));var f=this._get("basemapTerrain");f&&f.spatialReference&&a(new s({xmin:f.extent[0],ymin:f.extent[1],zmin:0,xmax:f.extent[2],ymax:f.extent[3],zmax:0,spatialReference:f.spatialReference}));this.map&&this.map.allLayers.forEach(function(b){a(b.fullExtent)});return 0<b.length?(f=b.reduce(function(a,b){return a.union(b)}),f.hasZ?
(f.zmin=Math.min(0,f.zmin),f.zmax=Math.max(0,f.zmax)):(f.zmin=0,f.zmax=0),f):new s({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:c})}},environment:{value:null,set:function(a){a!==this._defaults.environment&&(this._externallySet.environment=!0);a?a instanceof w?this._set("environment",a):a instanceof A?this.environment.lighting=a.lighting:a.declaredClass?this._set("environment",a):this._set("environment",new w(a)):this._set("environment",new w)}},environmentManager:{},extent:{copy:function(a,
b){a.xmin=b.xmin;a.ymin=b.ymin;a.zmin=b.zmin;a.xmax=b.xmax;a.ymax=b.ymax;a.zmax=b.zmax;a.spatialReference=b.spatialReference},type:s},groundExtent:{dependsOn:["basemapTerrain.extent"],readOnly:!0,get:function(){var a=this._get("basemapTerrain");if(a&&a.spatialReference){var b=a.extent;return new s({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a.spatialReference})}return new s({spatialReference:this.spatialReference||g.WGS84})}},initialExtentRequired:{dependsOn:["map.initialViewProperties.viewpoint"],
get:function(){if(this.get("map.initialViewProperties.viewpoint"))return!1;for(var a=0;a<ka.length;a++)if(this._initialProps&&void 0!==this._initialProps[ka[a]])return!1;return!0}},interacting:{dependsOn:["navigation.interacting"],get:function(){return this.navigation&&this.navigation.interacting}},map:{value:null},mapCoordsHelper:{},navigation:{readOnly:!0,value:null},navigationController:{},qualityProfile:{set:function(a){da.isValidProfile(a)&&(da.apply(a,this),this._set("qualityProfile",a))}},
qualitySettings:{type:S},ready:{dependsOn:["viewingMode"]},renderCoordsHelper:{},scale:{},spatialReference:{dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isDone"]},type:"3d",ui:{type:Q},updating:{},updatingPercentage:0,viewingMode:{dependsOn:["map.initialViewProperties.viewingMode","spatialReference"],get:function(){var a=this.get("map.initialViewProperties.viewingMode"),b=this.spatialReference;a||(a=!b||b.isWebMercator||b.isWGS84?"global":"local");return a},set:function(a){if(-1!==
["local","global"].indexOf(a)){var b=this._get("viewingMode")===a;this._override("viewingMode",a);b&&!this.get("map.initialViewProperties.viewingMode")&&this._internallyReady&&this._initGlobe(this.viewingMode)}else void 0===a&&this._clearOverride("viewingMode")}},viewpoint:{copy:function(a,b){a.rotation=b.rotation;a.scale=b.scale;a.targetGeometry=b.targetGeometry;a.camera=b.camera},dependsOn:["camera"],type:t},zoom:{dependsOn:["scale"]}},getDefaults:function(a){var b=this.inherited(arguments);!b.constraints&&
!a.constraints&&(this._defaults.constraints=new E,b.constraints=this._defaults.constraints);!b.environment&&!a.environment&&(this._defaults.environment=new w,b.environment=this._defaults.environment);b.popup.autoPanEnabled=!1;b.qualitySettings=new S;b.qualityProfile=da.getDefaultProfile();return b},constructor:function(){C.when(this,"ready",this._viewReadyHandler.bind(this));this._internallyReady=!1;this._initialProps={};this._initialDefaultSpatialReference=this._gotoTask=this._userClippingArea=null;
this._initCoordinateSystem();this._frustum=new N;this.navigationController=this._clippingArea=this._constraints=this._animationStateWatcher=null;this.navigationControls=U.PAN;this._defaults={};this._externallySet={};this.resourceController=new R(this);this.labelManager=new Z(this);this._evaluateUpdating=this._evaluateUpdating.bind(this);this._layerViewsUpdatingHandles={};this._navigationHandles=new z;this._navigationPauseNotifications=!1;this._navigationHandles.add([C.on(this,"navigation","currentViewChanged",
this._navigationCurrentViewChanged.bind(this),null,null,!0),C.on(this,"navigation","currentViewReachedTarget",this._navigationCurrentViewReachedTarget.bind(this),null,null,!0),C.on(this,"navigation","targetViewChanged",function(a){this._navigationPauseNotifications||this._navigationTargetViewChanged(a)}.bind(this),null,null,!0),C.on(this,"navigation","animationStarted",function(a){this._navigationPauseNotifications||this._navigationAnimationStarted(a)}.bind(this),null,null,!0)]);this.watch("map",
function(a){a&&a.load&&a.load()})},initialize:function(){this.environmentManager=new D({view:this});this._updateUpdatingMonitorsHandle=this.allLayerViews.on("change",this._updateUpdatingMonitors.bind(this));this._updateUpdatingMonitors({added:this.allLayerViews.toArray(),removed:[],moved:[]});C.whenNot(this,"ready",this._viewUnreadyHandler.bind(this))},destroy:function(){n.dispatchTarget(this);this.environmentManager.destroy();this._disposeGraphicsView();this._updateUpdatingMonitorsHandle.remove();
this._updateUpdatingMonitorsHandle=null;this._navigationHandles.remove();this._navigationHandles=null},destroyLayerViews:function(){for(var a in this._layerViewsUpdatingHandles)this._layerViewsUpdatingHandles[a].remove();this._layerViewsUpdatingHandles={};this._disposeSurface();this.inherited(arguments);this._stage&&(this._stage.dispose(),this._stage=null,this._forwardAASettingsHandle.remove(),this._forwardAASettingsHandle=null);this._setCanvas(null);this.labelManager.destroy();this.labelManager=
null;this.resourceController.destroy();this.resourceController=null},toMap:function(a,b,c){if(!this._internallyReady)return ca.error("#toMap()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,void 0,c);b=this._stage.pick([a.point.x,this.height-a.point.y]).getMinResult();return this._computeMapPointFromIntersectionResult(b,a.retval)},toScreen:function(a,b,c,d){if(!this._internallyReady)return ca.error("#toScreen()","Scene view cannot be used before it is ready"),
null;a=this._normalizePointArgs(a,b,c,d);O.pointToVector(a.point,fa,this.renderSpatialReference);return this.engineToScreen(fa,a.retval)},pixelSizeAt:function(a,b,c){if(!this._internallyReady)return ca.error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null;if("esri.geometry.ScreenPoint"===a.declaredClass){if(!this._stage.pick([a.x,this.height-a.y]).getMinResult().getIntersectionPoint(fa))return 0}else a=this._normalizePointArgs(a,b,c,void 0),O.pointToVector(a.point,fa,this.renderSpatialReference);
return this.navigation.currentCamera.computePixelSizeAt(fa)},hitTest:function(b,c){if(!this._internallyReady)return ca.error("#hitTest()","Scene view cannot be used before it is ready"),null;var d=this._normalizePointArgs(b,c,void 0,void 0),e=[d.point.x,this.height-d.point.y],d=this._stage.pick(e,null,!0).getMinResult(),f=this._computeMapPointFromIntersectionResult(d);return a(this._getGraphicFromStageObject(d.object,d.triangleNr)).otherwise(function(){return null}).then(function(a){var b=[];(a||
f)&&b.push({mapPoint:f,graphic:a});return{screenPoint:e,results:b}})},goTo:function(a,b){if(this._internallyReady){b=k.mixin({animate:!0},b);var c=I.create(this,a,b);this._gotoTask={};return b.animate?this._gotoAnimated(c,b):this._gotoImmediate(c,b)}ca.error("#goTo()","Scene view cannot be used before it is ready")},animateTo:function(a,b){f.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0");return this.goTo(a,b)},takeScreenshot:function(a){if(this._internallyReady){a=
k.mixin({format:"png",quality:100},a||{});var c=new b,d,e;a.includePadding||(d=this.width-this.padding.left-this.padding.right,e=this.height-this.padding.top-this.padding.bottom);var f=d/e;void 0!==a.width&&void 0===a.height?a.height=a.width/f:void 0!==a.height&&void 0===a.width&&(a.width=f*a.height);void 0!==a.height&&(a.height=Math.floor(a.height));void 0!==a.width&&(a.width=Math.floor(a.width));!a.area&&!a.includePadding&&(a.area={x:this.padding.left,y:this.padding.top,width:d,height:e});this._stage.requestScreenCapture(a,
function(a){u.schedule(function(){c.resolve(a)})});return c.promise}ca.error("#takeScreenshot()","Scene view cannot be used before it is ready")},engineToScreen:function(a,b){var c=Y.create();this._stage.getCamera().projectPoint(a,c);var d=c[0],e=this.height-c[1],c=c[2];return b?(b.x=d,b.y=e,b.z=c,b):new r({x:d,y:e,z:c})},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||this.get("defaultsFromMap.isDone")&&
this._initialDefaultSpatialReference||null},validate:function(){var a;v("esri-webgl")?v("safari")&&7.1>v("safari")&&(a=new x("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari \x3c 7.1)",{type:"safari",requiredVersion:7.1,detectedVersion:v("safari")})):a=new x("sceneview:webgl-required","WebGL is required but not supported");return a?y.reject(a):y.resolve()},isSpatialReferenceSupported:function(a,b){var c=null==m.getUnitValue(a),d=a.isWebMercator,e=a.isWGS84,f="local"===
this.viewingMode,g=!(!this._isOverridden("viewingMode")&&!this.get("map.initialViewProperties.viewingMode"));if(g){if(f&&c||!f&&!d&&!e)return!1}else if(c&&!e)return!1;return b&&!$.isTiledLayer(b)&&(e||d)&&!f?(null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=a),!g&&!this.ready&&(this.viewingMode="global"),!1):!0},has:function(a){return this._stage.has(a)},flushDisplayModifications:function(){this._stage.processDirty()},getFrustum:function(){this._frustum.dirty&&this._frustum.update(this.navigation.currentCamera);
return this._frustum},getDrawingOrder:function(a){return this.allLayerViews.findIndex(function(b){return b.layer&&b.layer.uid===a})},getViewForGraphic:function(a){return a.layer?this.allLayerViews.find(function(b){return b.layer===a.layer}):this._graphicsView},whenViewForGraphic:function(a){return a.layer?this.whenLayerView(a.layer):y.resolve(this._graphicsView)},renderSpatialReference:null,_graphicsView:null,_surfaceReadyWatchHandle:null,_forwardAASettingsHandle:null,_gotoImmediate:function(a,b){var c=
this._gotoTask;return a.then(function(a){c===this._gotoTask&&(this.viewpoint=a)}.bind(this))},_gotoAnimated:function(a,b){!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new h({target:a}):this.animation.target=a;var c=this.animation;c.state="waiting-for-target";a.then(function(b){if(!(c.target!==a||this.animation!==c)){c.target=b;c.state="running";b=I.toCamera(this,b);if(!b)throw ca.error("#goTo()","Invalid target specified for animateTo"),
new x("goto:invalid-camera","Invalid camera in conversion from viewpoint");this._cameraAlmostEquals(this.camera,b)?c.finish():(b=G.externalToInternal(this,b),b.almostEquals(this.navigation.targetCamera,5E-4/this.renderCoordsHelper.unitInMeters)?c.finish():(this._navigationPauseNotifications=!0,this._setInternalCamera(b,{animate:!0}),c.state===h.State.STOPPED&&c.stop(),this._navigationPauseNotifications=!1))}}.bind(this)).otherwise(function(){c.target!==a||this.animation!==c||(this.animation=null,
c.finish())});return c},_trackCanvasSize:function(){this.on("resize",function(a){if(this.canvas){this.canvas.width=a.width;this.canvas.height=a.height;var b=this._stage.getCamera();b.width=a.width;b.height=a.height;this._stage.setCamera(b);this.navigation&&(this.navigation.windowSize=[a.width,a.height])}}.bind(this));this.canvas.width=this.width;this.canvas.height=this.height},_computeMapPointFromIntersectionResult:function(a,b){if(a.getIntersectionPoint(fa)){var c=this.spatialReference||g.WGS84;
O.vectorToVector(fa,this.renderSpatialReference,fa,c)||(c=g.WGS84,O.vectorToVector(fa,this.renderSpatialReference,fa,c));b?(b.x=fa[0],b.y=fa[1],b.z=fa[2],b.spatialReference=c):b=new p(fa,c);c=this._get("basemapTerrain");"terrain"===a.intersector&&c&&(c=c.getElevation(b),null!==c&&(b.z=c));return b}return null},_onGeometryPicked:function(a,b,c){a={screenPoint:{x:b[0],y:this.height-b[1]}};if(c=this._computeMapPointFromIntersectionResult(c))a.mapPoint=c;this.emit("click",a)},_getGraphicFromStageObject:function(a,
b){if(!a)return null;var c=a.getMetadata();if(null!=c&&null!=c.layerId){if(c.layerId===this._graphicsView.mockLayerId)return this._graphicsView.getGraphicsFromStageObject(a,b);if(c=this.map.findLayerById(c.layerId))return this.whenLayerView(c).then(function(c){if(c&&null!=c.getGraphicsFromStageObject&&!c.suspended)return c.getGraphicsFromStageObject(a,b)})}return null},_viewingModeToManifold:function(a){return{local:"planar",global:"spherical"}[a]},_initBasemapTerrain:function(a){this._disposeBasemapTerrain();
this._set("basemapTerrain",new aa(this,this._viewingModeToManifold(a)));this.navigation.elevationProvider=this._get("basemapTerrain")},_initGlobe:function(a){this._initCoordinateSystem();this._initNavigation(a);this._stage.setViewParams({backgroundColor:[0,0,0,0],maxFarNearRatio:0,frustumCullingEnabled:!1});this._initBasemapTerrain(a);this._navigationCurrentViewChanged({camera:this.navigation.currentCamera})},_initCoordinateSystem:function(){if(this.spatialReference){var a=this.spatialReference;if(!this.mapCoordsHelper||
!this.mapCoordsHelper.spatialReference.equals(a))this.mapCoordsHelper=new T(this.map,a);var b=this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1,c="global"===this.viewingMode,a=c?O.SphericalRenderSpatialReference:a;a!==this.renderSpatialReference&&(this.renderSpatialReference=a,this.renderCoordsHelper=new (c?K.Spherical:K.Planar)(a),this._stage&&this._stage.setIntersectTolerance(F.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._constraints&&this._constraints.scale(b/this.renderCoordsHelper.unitInMeters))}else this.renderSpatialReference=
this.renderCoordsHelper=this.mapCoordsHelper=null},_paddingEqualsArray:function(a){var b=this.padding;return!b?!0:b.top===a[0]&&b.right===a[1]&&b.bottom===a[2]&&b.left===a[3]},_navigationCurrentViewChanged:function(a){this._frustum.dirty=!0;a=a.camera;var b=a.padding,c=this._get("basemapTerrain"),d=c.spatialReference;d&&(d=this.renderCoordsHelper.fromRenderCoords(a.eye,d),c=c.getElevation(d)||0,a.aboveGround=d.z>=c);this._paddingEqualsArray(b)||(c=this._padding,b={top:b[0],right:b[1],bottom:b[2],
left:b[3]},this._internallyReady?(this._padding=b,this.notifyChange("padding",c,b)):this.padding=b);this._stage.setCamera(a);this.notifyChange("center");this.notifyChange("extent");this.notifyChange("scale");b=this.camera;a=G.internalToExternal(this,a,ea);(!b||!this._cameraAlmostEquals(b,a))&&this.notifyChange("camera")},_cameraAlmostEquals:function(a,b){return 1E-5>Math.abs(a.tilt-b.tilt)&&1E-5>Math.abs(a.heading-b.heading)&&1E-5>Math.abs(a.fov-b.fov)&&a.position.equals(b.position)},_navigationAnimationStarted:function(a){a=
I.fromInternalCamera(this,this.navigation.targetCamera);this.animation?this.animation.target=a:this.animation=new h({target:a})},_navigationTargetViewChanged:function(a){if(this.animation&&"waiting-for-target"!==this.animation.state){a=a.camera;var b=this.spatialReference||g.WGS84,c=G.internalToExternal(this,a);a=new t({camera:c,targetGeometry:O.vectorToPoint(a.center,b,this.renderSpatialReference),scale:G.computeScale(this,a),rotation:I.headingToRotation(c.heading)});this.animation.target=a}},_navigationCurrentViewReachedTarget:function(a){if(a.interruptedAnimation||
a.finishedAnimation)this._gotoTask=null;if(this.animation&&(a.interruptedAnimation||a.finishedAnimation)){this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null);var b=this.animation;this.animation=null;a.finishedAnimation?b.finish():b.stop();this.notifyChange("animation")}},_setInternalCamera:function(a,b){a&&(this.navigation.setCamera(a,b),this._externallySet.camera=!0);return!!a},_setCamera:function(a,b){return this._setInternalCamera(G.externalToInternal(this,
a),b)},_evaluateUpdating:function(){var a=0,b=0,c=!1;this.allLayerViews.forEach(function(d){d.updating&&(c=!0,d=d.updatingPercentage,null!=d&&(++b,a+=d))});this._graphicsView&&this._graphicsView.updating&&(c=!0);c!==this.updating&&(this.updating=c);a=0!==b?a/b:c?100:0;this.updatingPercentage!==a&&(this.updatingPercentage=a)},_updateUpdatingMonitors:function(a){for(var b=0;b<a.removed.length;b++){var c=a.removed[b],d=this._layerViewsUpdatingHandles[c.id];d&&(delete this._layerViewsUpdatingHandles[c.id],
d.remove())}for(b=0;b<a.added.length;b++)c=a.added[b],c.destroyed||(d=c.watch(["updating","updatingPercentage"],this._evaluateUpdating),this._layerViewsUpdatingHandles[c.id]=d);this._evaluateUpdating()},_spatialReferenceSetter:function(a){this.inherited(arguments);this._initCoordinateSystem()},_setInitialView:function(a){if(a&&!this._externallySet.camera){var b=null;a instanceof t&&(!a.camera&&a.targetGeometry instanceof s)&&(b=I.rotationToHeading(a.rotation),a=a.targetGeometry);if(a instanceof t)this.viewpoint=
a;else if(a instanceof l)this.camera=a;else{var c=this._getDesiredHeadingTilt();null!=b&&(c.heading=b);I.create(this,{target:a,heading:c.heading,tilt:c.tilt}).then(function(a){this.navigation._dataExtentChanged();this.viewpoint=a}.bind(this))}}},_pickRay:function(){return this._stage?this._stage.pickRay.apply(this._stage,arguments):null},_pickRayWithBeginPoint:function(){return this._stage?this._stage.pickRayWithBeginPoint.apply(this._stage,arguments):null},_removeHandles:function(a){for(var b=0;b<
a.length;b++){var c=a[b];this[c]&&(this[c].remove(),this[c]=null)}},_setCanvas:function(a){a!==this._get("canvas")&&this._set("canvas",a)},_disposeSurface:function(){this._removeHandles(["_stageFrameTask","_updateDrawingOrderHandle","onViewExtentUpdateHandle","_mapLayersChangeHandle"]);this._disposeBasemapTerrain();this._setNavigation(null);this.environmentManager&&this.environmentManager.disposeRendering()},_disposeBasemapTerrain:function(){var a=this._get("basemapTerrain");a&&(a.destroy(),this._set("basemapTerrain",
null))},_disposeNavigation:function(){var a=this._get("navigation");a&&(a.destroy(),a.elevationProvider=null,this._set("navigation",null));this.navigationController&&(this.navigationControls=this.navigationController.getControls(),this.navigationController.destroy(),this.navigationController=null)},_setNavigation:function(a){this._get("navigation")!==a&&(this._disposeNavigation(),a&&(a.windowSize=[this.width,this.height],a.userConstraints=this.constraints),this._set("navigation",a))},_initNavigation:function(a){a=
a||this.viewingMode;var b={view:this};"global"===a?this._setNavigation(new V(b)):this._setNavigation(new L(b));this.navigationController=new U(this,this.navigationControls)},_initSurface:function(){var a={};a.deactivatedWebGLExtensions=this.deactivatedWebGLExtensions;this.renderCanvas&&(a.canvas=this.renderCanvas);this._stage=new J(c.byId(this.surface),a);this._stage.selectionState=!1;this._stage.onGeometryPicked=this._onGeometryPicked.bind(this);this._forwardAASettingsHandle=C.init(this.qualitySettings,
"antialiasingEnabled",function(){this._stage.setRenderParams({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})}.bind(this));this.sharedSymbolResources=new ba(this._stage,this.resourceController);this.renderCoordsHelper&&this._stage.setIntersectTolerance(F.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters);this._setCanvas(this._stage.getCanvas());this._stageFrameTask=u.addFrameTask(this._stage.getFrameTask());this._trackCanvasSize();this._initGlobe(this.viewingMode)},_initGraphicsView:function(){this._surfaceReadyWatchHandle=
C.whenTrueOnce(this,"basemapTerrain.ready",function(){this._graphicsView=new M({view:this,graphics:this.graphics});this._surfaceReadyWatchHandle=null;this._layerViewsUpdatingHandles[this._graphicsView.mockLayerId]=this._graphicsView.watch("updating",this._evaluateUpdating)}.bind(this))},_disposeGraphicsView:function(){this._surfaceReadyWatchHandle&&(this._surfaceReadyWatchHandle.remove(),this._surfaceReadyWatchHandle=null);if(this._graphicsView){var a=this._graphicsView.mockLayerId;this._layerViewsUpdatingHandles[a].remove();
delete this._layerViewsUpdatingHandles[a];this._graphicsView.destroy();this._graphicsView=null}},_normalizePointArgs:function(a,b,c,d,e){e=e||ia;var f=e.point;f.spatialReference=void 0;"object"===typeof a?(f.x=a.x,f.y=a.y,f.z=a.z,a.spatialReference&&(f.spatialReference=a.spatialReference),e.retval=b):(f.x=a,f.y=b,"number"!==typeof c&&void 0!==c?(f.z=void 0,e.retval=c):(f.z=c,e.retval=d));f.spatialReference||(f.spatialReference=this.spatialReference||g.WGS84);return e},_separateInitialProperties:function(){var a=
{},b={},c={},d=function(a){if(a=ma[a])for(var b=0;b<a.length;b++)c[a[b]]=!0,d(a[b])},e;for(e in this._initialProps){var f=this._initialProps[e];ma[e]?(d(e),a[e]=f):b[e]=f}for(e in c)delete a[e];return{view:a,other:b}},_viewReadyHandler:function(a,b){if(!b){"global"===this.viewingMode&&(this._clippingArea=null);this._internallyReady=!0;this._initSurface();this._initGraphicsView();var c=this._separateInitialProperties(),d;for(d in c.other)this.set(d,c.other[d]);for(d in c.view)this.set(d,c.view[d]);
c=this.get("map.initialViewProperties.viewpoint");d=this.get("initialExtent");c?this._setInitialView(c):d&&d.spatialReference.equals(this.spatialReference)?this._setInitialView(d):"local"===this.viewingMode&&C.whenOnce(this.basemapTerrain,"ready",function(){this._setInitialView(this.groundExtent)}.bind(this));if(!this._externallySet.environment&&(c=this.get("map.initialViewProperties.environment")))this.environment=c;this._initialProps={};this.notifyChange("initialExtentRequired");this._updateDrawingOrderHandle=
this.allLayerViews.on("change",this._updateDrawingOrder.bind(this));this._updateDrawingOrder({added:this.allLayerViews.toArray(),removed:[],moved:[]});this.environmentManager.updateReadyChange(!0)}},_viewUnreadyHandler:function(a,b){b&&(this._initialDefaultSpatialReference=null,this.environmentManager.updateReadyChange(!1),this._disposeGraphicsView(),this._internallyReady=!1,this._disposeSurface(),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this._stage&&
(this._stage.dispose(),this._stage=null,this._forwardAASettingsHandle.remove(),this._forwardAASettingsHandle=null),this._setCanvas(null))},_getDesiredHeadingTilt:function(){if(this._externallySet.camera){var a=this.camera;ha.heading=a.heading;ha.tilt=a.tilt}else ha.heading=0,ha.tilt=0.5;return ha},_cameraSetter:X("camera",function(a){this._setCamera(a,{animate:!1})||ca.error("#camera\x3d","Invalid camera",a)}),_cameraGetter:P("camera",function(a){return G.internalToExternal(this,this.navigation.currentCamera,
a)}),_externalExtent:function(){this._cachedExtentDirty&&(G.toExtent(this,null,null,this._cachedExtent,ea),this._cachedExtentDirty=!1);return this._cachedExtent},_extentGetter:P("extent",function(a){return G.toExtent(this,null,null,a,ea)}),_extentSetter:X("extent",function(a){var b=G.fromExtent(this,a,this._getDesiredHeadingTilt(),ea);b?this.camera=b:this._isIncompatibleSpatialReference(a.spatialReference)?ca.error("#extent\x3d","Extent has an incompatible spatial reference (extent: "+a.spatialReference.wkid+
", view: "+this.spatialReference.wkid+")",a):ca.error("#extent\x3d","Invalid extent",a)}),_isIncompatibleSpatialReference:function(a){return a&&!a.equals(this.spatialReference)&&!d.canProject(a,this.spatialReference)},_scaleGetter:P("scale",function(){return null!=this.navigation?G.computeScale(this,this.navigation.currentCamera):0}),_scaleSetter:X("scale",function(a){var b=this._getDesiredHeadingTilt(),c=this.navigation.currentCamera.center,d=Y.create();O.vectorToVector(c,this.renderSpatialReference,
d,g.WGS84);a=G.scaleToDistance(this,a,d[1]);b=G.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,c,a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}),_zoomGetter:P("zoom",function(){return G.scaleToZoom(this,this.scale)}),_zoomSetter:X("zoom",function(a){this.scale=G.zoomToScale(this,a)}),_centerGetter:P("center",function(a){var b=this.spatialReference||g.WGS84;return O.vectorToPoint(this.navigation.currentCamera.center,this.renderSpatialReference,
a||b,b)}),_centerSetter:X("center",function(a){if(this._isIncompatibleSpatialReference(a&&a.spatialReference))ca.error("#center\x3d","Center has an incompatible spatial reference (center: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a);else{var b=this._getDesiredHeadingTilt();(b=G.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,a,this.navigation.currentCamera.distance))||ca.error("#center\x3d","Invalid center",a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,
b.center,b.up,{animate:!1})}}),_viewpointGetter:P("viewpoint",function(){return I.fromCamera(this,this.camera)}),_viewpointSetter:X("viewpoint",function(a){var b=I.toCamera(this,a);b?this._setCamera(b,{animate:!1}):ca.error("#viewpoint\x3d","Invalid viewpoint",a)}),_screenCenterGetter:function(){var a=this.padding;return new r((this.size[0]-(a.left+a.right))/2+a.left,(this.size[1]-(a.top+a.bottom))/2+a.top)},_updateDrawingOrder:function(){var a=this.allLayerViews.length-1;this.allLayerViews.forEach(function(b,
c){null!=b.drawingOrder&&(b.drawingOrder=a-c)},this)},_paddingSetter:X("padding",function(a){this._set("padding",{top:a&&a.top||0,right:a&&a.right||0,bottom:a&&a.bottom||0,left:a&&a.left||0});this.navigation&&(this.navigation.padding=this._get("padding"))}),_constraintsSetter:X("constraints",function(a){this._set("constraints",a);a===this._defaults.constraints&&(this._defaults.constraints=null,a.scale(1/this.renderCoordsHelper.unitInMeters));this.navigation.userConstraints=a}),_animationSetter:function(a){a!==
this._get("animation")&&(this._internallyReady?(this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null),this._set("animation",a),a&&(this._animationStateWatcher=a.watch("state",function(a){a!==h.State.FINISHED&&a!==h.State.STOPPED||(this.animation=null,a===h.State.FINISHED?this.navigation.setCurrentToTarget():this.navigation.setCamera(this.navigation.currentCamera,{animate:!1}))}.bind(this)))):ca.error("#animation\x3d","Scene view cannot be used before it is ready"))},
_mapSetter:function(a){a!==this._get("map")&&(this.navigation&&this.navigation._dataExtentChanged(),this._mapLayersChangeHandle&&this._mapLayersChangeHandle.remove(),a&&(this._mapLayersChangeHandle=a.allLayers.on("change",this.notifyChange.bind(this,"dataExtent"))),delete this._externallySet.camera,this.inherited(arguments))}})});